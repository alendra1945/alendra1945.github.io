const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/toolbar-1Gd19jM3.js","assets/index-CMTG8_9X.js","assets/index-BlOe3NaJ.css","assets/hint-BmH4jAdq.js","assets/index-sX09ViXM.js","assets/index-MDrvsZSi.js","assets/button-DQGJtAlF.js","assets/container-ol6mo6px.js","assets/animate.es-NHcyLOvC.js","assets/velocity.es-CI47LKMS.js","assets/_commonjsHelpers-C4iS2aBk.js","assets/index-D4opl7EG.js","assets/use-local-storage-Cd7b_o2y.js","assets/index-DHzqgZ2T.js","assets/index-BwCgLK3d.js","assets/use-selection-bouds-D2uotuPQ.js","assets/index-wA7Efter.js","assets/dropdown-menu-lVhqYRWv.js","assets/T4C3DMHT-D8OhLsJw.js","assets/index-BXRGDR3V.js"])))=>i.map(i=>d[i]);
var cr=Object.defineProperty;var On=we=>{throw TypeError(we)};var hr=(we,t,le)=>t in we?cr(we,t,{enumerable:!0,configurable:!0,writable:!0,value:le}):we[t]=le;var at=(we,t,le)=>hr(we,typeof t!="symbol"?t+"":t,le),xi=(we,t,le)=>t.has(we)||On("Cannot "+le);var e=(we,t,le)=>(xi(we,t,"read from private field"),le?le.call(we):t.get(we)),Te=(we,t,le)=>t.has(we)?On("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(we):t.set(we,le),Pe=(we,t,le,p)=>(xi(we,t,"write to private field"),p?p.call(we,le):t.set(we,le),le),Z=(we,t,le)=>(xi(we,t,"access private method"),le);var Ot=(we,t,le,p)=>({set _(M){Pe(we,t,M,le)},get _(){return e(we,t,p)}});import{C as time,B as noopReturn,E as getUnitConverter,G as transformDefinitions,J as getStyleName,y as isNumber,x as isString,j as delegateEvents,f as createSignal,i as insert,c as createComponent,K as IconUpload,a as createRenderEffect,d as className,b as cn,S as Show,t as template,u as use,e as splitProps,g as createEffect,L as batch,l as untrack,p as useContext,n as createContext,o as onMount,s as setAttribute,N as lazy,O as __vitePreload,F as For,k as createMemo,q as useParams,H as Heading}from"./index-CMTG8_9X.js";import{P as PresentationModeState,S as SpreadMode,n as normalizeWheelEventDelta,a as ScrollMode,R as RenderingStates,T as TextLayerMode,g as getPageSizeInches,i as isPortraitOrientation,b as isValidSpreadMode,c as isValidScrollMode,d as isValidRotation,e as createStore,f as createUndoHistory,t as trackStore,u as unwrap,h as getSvgPathFromStroke,C as CanvasMode,j as colorToCss,L as LayerType,p as pointerEventToCanvasPoint,k as getSelectionRects,l as uuid,B as BORDERWIDTH,r as resizeBounds,M as MAX_LAYER,m as penPointsToPathLayer,o as Button}from"./index-MDrvsZSi.js";import{C as Container}from"./container-ol6mo6px.js";import{a as animate}from"./animate.es-NHcyLOvC.js";import{v as velocityPerSecond}from"./velocity.es-CI47LKMS.js";import{g as getAugmentedNamespace}from"./_commonjsHelpers-C4iS2aBk.js";import{c as createElementSize}from"./index-D4opl7EG.js";import{u as useLocalStorage}from"./use-local-storage-Cd7b_o2y.js";const sampleT=5;function calcGeneratorVelocity(we,t,le){const p=Math.max(t-sampleT,0);return velocityPerSecond(le-we(p),t-p)}const defaults={stiffness:100,damping:10,mass:1},calcDampingRatio=(we=defaults.stiffness,t=defaults.damping,le=defaults.mass)=>t/(2*Math.sqrt(we*le));function hasReachedTarget(we,t,le){return we<t&&le>=t||we>t&&le<=t}const spring$1=({stiffness:we=defaults.stiffness,damping:t=defaults.damping,mass:le=defaults.mass,from:p=0,to:M=1,velocity:Me=0,restSpeed:J,restDistance:F}={})=>{Me=Me?time.s(Me):0;const D={done:!1,hasReachedTarget:!1,current:p,target:M},g=M-p,r=Math.sqrt(we/le)/1e3,j=calcDampingRatio(we,t,le),I=Math.abs(g)<5;J||(J=I?.01:2),F||(F=I?.005:.5);let f;if(j<1){const h=r*Math.sqrt(1-j*j);f=w=>M-Math.exp(-j*r*w)*((-Me+j*r*g)/h*Math.sin(h*w)+g*Math.cos(h*w))}else f=h=>M-Math.exp(-r*h)*(g+(-Me+r*g)*h);return h=>{D.current=f(h);const w=h===0?Me:calcGeneratorVelocity(f,h,D.current),E=Math.abs(w)<=J,y=Math.abs(M-D.current)<=F;return D.done=E&&y,D.hasReachedTarget=hasReachedTarget(p,M,D.current),D}},timeStep=10,maxDuration=1e4;function pregenerateKeyframes(we,t=noopReturn){let le,p=timeStep,M=we(0);const Me=[t(M.current)];for(;!M.done&&p<maxDuration;)M=we(p),Me.push(t(M.done?M.target:M.current)),le===void 0&&M.hasReachedTarget&&(le=p),p+=timeStep;const J=p-timeStep;return Me.length===1&&Me.push(M.current),{keyframes:Me,duration:J/1e3,overshootDuration:(le??J)/1e3}}function canGenerate(we){return isNumber(we)&&!isNaN(we)}function getAsNumber(we){return isString(we)?parseFloat(we):we}function createGeneratorEasing(we){const t=new WeakMap;return(le={})=>{const p=new Map,M=(J=0,F=100,D=0,g=!1)=>{const r=`${J}-${F}-${D}-${g}`;return p.has(r)||p.set(r,we(Object.assign({from:J,to:F,velocity:D},le))),p.get(r)},Me=(J,F)=>(t.has(J)||t.set(J,pregenerateKeyframes(J,F)),t.get(J));return{createAnimation:(J,F=!0,D,g,r)=>{let j,I,f,h=0,w=noopReturn;const E=J.length;if(F){w=getUnitConverter(J,g?transformDefinitions.get(getStyleName(g)):void 0);const y=J[E-1];if(f=getAsNumber(y),E>1&&J[0]!==null)I=getAsNumber(J[0]);else{const _=r==null?void 0:r.generator;if(_){const{animation:x,generatorStartTime:S}=r,n=(x==null?void 0:x.startTime)||S||0,i=(x==null?void 0:x.currentTime)||performance.now()-n,s=_(i).current;I=s,h=calcGeneratorVelocity(c=>_(c).current,i,s)}else D&&(I=getAsNumber(D()))}}if(canGenerate(I)&&canGenerate(f)){const y=M(I,f,h,g==null?void 0:g.includes("scale"));j=Object.assign(Object.assign({},Me(y,w)),{easing:"linear"}),r&&(r.generator=y,r.generatorStartTime=performance.now())}return j||(j={easing:"ease",duration:Me(M(0,100)).overshootDuration}),j}}}}const spring=createGeneratorEasing(spring$1);var _tmpl$$3=template("<div id=file-upload>"),_tmpl$2$2=template('<div class="absolute group-hover/file:opacity-100 opacity-0 border border-dashed border-sky-400 inset-0 z-30 bg-transparent flex items-center justify-center h-32 mt-4 w-full max-w-[8rem] mx-auto rounded-md">'),_tmpl$3=template('<div class=w-full><div class="p-10 group/file block rounded-lg cursor-pointer w-full relative overflow-hidden"><div class="flex flex-col items-center justify-center"><p class="relative z-20 font-sans font-bold text-neutral-700 dark:text-neutral-300 text-base">Upload file</p><p class="relative z-20 font-sans font-normal text-neutral-400 dark:text-neutral-400 text-base mt-2">Drag or drop your files here or click to upload</p></div><div class="relative w-full mt-10 max-w-xl mx-auto">');const mainVariant={intial:{x:[null,0],y:[null,0],opacity:[null,1]},animate:{x:[null,20],y:[null,-20],opacity:[null,.9]},transition:{easing:spring({stiffness:300,damping:20})}},FileUpload=()=>{let we;const[t,le]=createSignal([]),p=(M=!1)=>{M?animate(we,mainVariant.intial):animate(we,mainVariant.animate,mainVariant.transition)};return(()=>{var M=_tmpl$3(),Me=M.firstChild,J=Me.firstChild,F=J.nextSibling;return Me.addEventListener("mouseleave",()=>p(!0)),Me.addEventListener("mouseenter",()=>p()),Me.$$click=()=>{},insert(F,createComponent(Show,{get when(){return!t().length},get children(){return[(()=>{var D=_tmpl$$3(),g=we;return typeof g=="function"?use(g,D):we=D,insert(D,createComponent(IconUpload,{class:"h-4 w-4 text-neutral-600 dark:text-neutral-300"})),createRenderEffect(()=>className(D,cn("relative group-hover/file:shadow-2xl z-40 bg-white dark:bg-neutral-900 flex items-center justify-center h-32 mt-4 w-full max-w-[8rem] mx-auto rounded-md","shadow-[0px_10px_50px_rgba(0,0,0,0.1)]"))),D})(),_tmpl$2$2()]}})),M})()};delegateEvents(["click"]);function commonjsRequire(we){throw new Error('Could not dynamically require "'+we+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(t,le){module.exports=t.pdfjsLib=le()})(globalThis,()=>(()=>{var __webpack_modules__=[,(we,t)=>{var mt;Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=T,t.bytesToString=Ne,t.createValidAbsoluteUrl=Ce,t.getModificationDate=De,t.getUuid=it,t.getVerbosityLevel=oe,t.info=fe,t.isArrayBuffer=q,t.isArrayEqual=Le,t.isNodeJS=void 0,t.normalizeUnicode=Ze,t.objectFromMap=Ye,t.objectSize=qe,t.setVerbosityLevel=Q,t.shadow=W,t.string32=ze,t.stringToBytes=He,t.stringToPDFString=o,t.stringToUTF8String=H,t.unreachable=Ee,t.utf8StringToString=te,t.warn=O;const le=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=le;const p=[1,0,0,1,0,0];t.IDENTITY_MATRIX=p;const M=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=M;const Me=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=Me;const J=1.35;t.LINE_FACTOR=J;const F=.35;t.LINE_DESCENT_FACTOR=F;const D=F/J;t.BASELINE_FACTOR=D;const g={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=g;const r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=r;const j="pdfjs_internal_editor_";t.AnnotationEditorPrefix=j;const I={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=I;const f={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=f;const h={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=h;const w={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=w;const E={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=E;const y={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=y;const _={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=_;const x={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=x;const S={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=S;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=n;const i={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=i;const s={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=s;const c={O:"PageOpen",C:"PageClose"};t.PageActionEventType=c;const v={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=v;const z={NONE:0,BINARY:1};t.CMapCompressionType=z;const u={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=u;const N={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=N;let re=v.WARNINGS;function Q(Xe){Number.isInteger(Xe)&&(re=Xe)}function oe(){return re}function fe(Xe){re>=v.INFOS&&console.log(`Info: ${Xe}`)}function O(Xe){re>=v.WARNINGS&&console.log(`Warning: ${Xe}`)}function Ee(Xe){throw new Error(Xe)}function T(Xe,Be){Xe||Ee(Be)}function P(Xe){switch(Xe==null?void 0:Xe.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ce(Xe,Be=null,Ue=null){if(!Xe)return null;try{if(Ue&&typeof Xe=="string"){if(Ue.addDefaultProtocol&&Xe.startsWith("www.")){const ft=Xe.match(/\./g);(ft==null?void 0:ft.length)>=2&&(Xe=`http://${Xe}`)}if(Ue.tryConvertEncoding)try{Xe=H(Xe)}catch{}}const nt=Be?new URL(Xe,Be):new URL(Xe);if(P(nt))return nt}catch{}return null}function W(Xe,Be,Ue,nt=!1){return Object.defineProperty(Xe,Be,{value:Ue,enumerable:!nt,configurable:!0,writable:!1}),Ue}const d=function(){function Be(Ue,nt){this.constructor===Be&&Ee("Cannot initialize BaseException."),this.message=Ue,this.name=nt}return Be.prototype=new Error,Be.constructor=Be,Be}();t.BaseException=d;class m extends d{constructor(Be,Ue){super(Be,"PasswordException"),this.code=Ue}}t.PasswordException=m;class k extends d{constructor(Be,Ue){super(Be,"UnknownErrorException"),this.details=Ue}}t.UnknownErrorException=k;class ye extends d{constructor(Be){super(Be,"InvalidPDFException")}}t.InvalidPDFException=ye;class ve extends d{constructor(Be){super(Be,"MissingPDFException")}}t.MissingPDFException=ve;class X extends d{constructor(Be,Ue){super(Be,"UnexpectedResponseException"),this.status=Ue}}t.UnexpectedResponseException=X;class Se extends d{constructor(Be){super(Be,"FormatError")}}t.FormatError=Se;class Re extends d{constructor(Be){super(Be,"AbortException")}}t.AbortException=Re;function Ne(Xe){(typeof Xe!="object"||(Xe==null?void 0:Xe.length)===void 0)&&Ee("Invalid argument for bytesToString");const Be=Xe.length,Ue=8192;if(Be<Ue)return String.fromCharCode.apply(null,Xe);const nt=[];for(let ft=0;ft<Be;ft+=Ue){const ut=Math.min(ft+Ue,Be),be=Xe.subarray(ft,ut);nt.push(String.fromCharCode.apply(null,be))}return nt.join("")}function He(Xe){typeof Xe!="string"&&Ee("Invalid argument for stringToBytes");const Be=Xe.length,Ue=new Uint8Array(Be);for(let nt=0;nt<Be;++nt)Ue[nt]=Xe.charCodeAt(nt)&255;return Ue}function ze(Xe){return String.fromCharCode(Xe>>24&255,Xe>>16&255,Xe>>8&255,Xe&255)}function qe(Xe){return Object.keys(Xe).length}function Ye(Xe){const Be=Object.create(null);for(const[Ue,nt]of Xe)Be[Ue]=nt;return Be}function Oe(){const Xe=new Uint8Array(4);return Xe[0]=1,new Uint32Array(Xe.buffer,0,1)[0]===1}function Fe(){try{return new Function(""),!0}catch{return!1}}class Y{static get isLittleEndian(){return W(this,"isLittleEndian",Oe())}static get isEvalSupported(){return W(this,"isEvalSupported",Fe())}static get isOffscreenCanvasSupported(){return W(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?W(this,"platform",{isWin:!1,isMac:!1}):W(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Be,Ue;return W(this,"isCSSRoundSupported",(Ue=(Be=globalThis.CSS)==null?void 0:Be.supports)==null?void 0:Ue.call(Be,"width: round(1.5px, 1px)"))}}t.FeatureTest=Y;const Ae=[...Array(256).keys()].map(Xe=>Xe.toString(16).padStart(2,"0"));class ke{static makeHexColor(Be,Ue,nt){return`#${Ae[Be]}${Ae[Ue]}${Ae[nt]}`}static scaleMinMax(Be,Ue){let nt;Be[0]?(Be[0]<0&&(nt=Ue[0],Ue[0]=Ue[1],Ue[1]=nt),Ue[0]*=Be[0],Ue[1]*=Be[0],Be[3]<0&&(nt=Ue[2],Ue[2]=Ue[3],Ue[3]=nt),Ue[2]*=Be[3],Ue[3]*=Be[3]):(nt=Ue[0],Ue[0]=Ue[2],Ue[2]=nt,nt=Ue[1],Ue[1]=Ue[3],Ue[3]=nt,Be[1]<0&&(nt=Ue[2],Ue[2]=Ue[3],Ue[3]=nt),Ue[2]*=Be[1],Ue[3]*=Be[1],Be[2]<0&&(nt=Ue[0],Ue[0]=Ue[1],Ue[1]=nt),Ue[0]*=Be[2],Ue[1]*=Be[2]),Ue[0]+=Be[4],Ue[1]+=Be[4],Ue[2]+=Be[5],Ue[3]+=Be[5]}static transform(Be,Ue){return[Be[0]*Ue[0]+Be[2]*Ue[1],Be[1]*Ue[0]+Be[3]*Ue[1],Be[0]*Ue[2]+Be[2]*Ue[3],Be[1]*Ue[2]+Be[3]*Ue[3],Be[0]*Ue[4]+Be[2]*Ue[5]+Be[4],Be[1]*Ue[4]+Be[3]*Ue[5]+Be[5]]}static applyTransform(Be,Ue){const nt=Be[0]*Ue[0]+Be[1]*Ue[2]+Ue[4],ft=Be[0]*Ue[1]+Be[1]*Ue[3]+Ue[5];return[nt,ft]}static applyInverseTransform(Be,Ue){const nt=Ue[0]*Ue[3]-Ue[1]*Ue[2],ft=(Be[0]*Ue[3]-Be[1]*Ue[2]+Ue[2]*Ue[5]-Ue[4]*Ue[3])/nt,ut=(-Be[0]*Ue[1]+Be[1]*Ue[0]+Ue[4]*Ue[1]-Ue[5]*Ue[0])/nt;return[ft,ut]}static getAxialAlignedBoundingBox(Be,Ue){const nt=this.applyTransform(Be,Ue),ft=this.applyTransform(Be.slice(2,4),Ue),ut=this.applyTransform([Be[0],Be[3]],Ue),be=this.applyTransform([Be[2],Be[1]],Ue);return[Math.min(nt[0],ft[0],ut[0],be[0]),Math.min(nt[1],ft[1],ut[1],be[1]),Math.max(nt[0],ft[0],ut[0],be[0]),Math.max(nt[1],ft[1],ut[1],be[1])]}static inverseTransform(Be){const Ue=Be[0]*Be[3]-Be[1]*Be[2];return[Be[3]/Ue,-Be[1]/Ue,-Be[2]/Ue,Be[0]/Ue,(Be[2]*Be[5]-Be[4]*Be[3])/Ue,(Be[4]*Be[1]-Be[5]*Be[0])/Ue]}static singularValueDecompose2dScale(Be){const Ue=[Be[0],Be[2],Be[1],Be[3]],nt=Be[0]*Ue[0]+Be[1]*Ue[2],ft=Be[0]*Ue[1]+Be[1]*Ue[3],ut=Be[2]*Ue[0]+Be[3]*Ue[2],be=Be[2]*Ue[1]+Be[3]*Ue[3],We=(nt+be)/2,et=Math.sqrt((nt+be)**2-4*(nt*be-ut*ft))/2,rt=We+et||1,ot=We-et||1;return[Math.sqrt(rt),Math.sqrt(ot)]}static normalizeRect(Be){const Ue=Be.slice(0);return Be[0]>Be[2]&&(Ue[0]=Be[2],Ue[2]=Be[0]),Be[1]>Be[3]&&(Ue[1]=Be[3],Ue[3]=Be[1]),Ue}static intersect(Be,Ue){const nt=Math.max(Math.min(Be[0],Be[2]),Math.min(Ue[0],Ue[2])),ft=Math.min(Math.max(Be[0],Be[2]),Math.max(Ue[0],Ue[2]));if(nt>ft)return null;const ut=Math.max(Math.min(Be[1],Be[3]),Math.min(Ue[1],Ue[3])),be=Math.min(Math.max(Be[1],Be[3]),Math.max(Ue[1],Ue[3]));return ut>be?null:[nt,ut,ft,be]}static bezierBoundingBox(Be,Ue,nt,ft,ut,be,We,et){const rt=[],ot=[[],[]];let tt,_e,ne,Ie,je,$e,Ke,Qe;for(let _t=0;_t<2;++_t){if(_t===0?(_e=6*Be-12*nt+6*ut,tt=-3*Be+9*nt-9*ut+3*We,ne=3*nt-3*Be):(_e=6*Ue-12*ft+6*be,tt=-3*Ue+9*ft-9*be+3*et,ne=3*ft-3*Ue),Math.abs(tt)<1e-12){if(Math.abs(_e)<1e-12)continue;Ie=-ne/_e,0<Ie&&Ie<1&&rt.push(Ie);continue}Ke=_e*_e-4*ne*tt,Qe=Math.sqrt(Ke),!(Ke<0)&&(je=(-_e+Qe)/(2*tt),0<je&&je<1&&rt.push(je),$e=(-_e-Qe)/(2*tt),0<$e&&$e<1&&rt.push($e))}let ht=rt.length,lt;const st=ht;for(;ht--;)Ie=rt[ht],lt=1-Ie,ot[0][ht]=lt*lt*lt*Be+3*lt*lt*Ie*nt+3*lt*Ie*Ie*ut+Ie*Ie*Ie*We,ot[1][ht]=lt*lt*lt*Ue+3*lt*lt*Ie*ft+3*lt*Ie*Ie*be+Ie*Ie*Ie*et;return ot[0][st]=Be,ot[1][st]=Ue,ot[0][st+1]=We,ot[1][st+1]=et,ot[0].length=ot[1].length=st+2,[Math.min(...ot[0]),Math.min(...ot[1]),Math.max(...ot[0]),Math.max(...ot[1])]}}t.Util=ke;const U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function o(Xe){if(Xe[0]>="ï"){let Ue;if(Xe[0]==="þ"&&Xe[1]==="ÿ"?Ue="utf-16be":Xe[0]==="ÿ"&&Xe[1]==="þ"?Ue="utf-16le":Xe[0]==="ï"&&Xe[1]==="»"&&Xe[2]==="¿"&&(Ue="utf-8"),Ue)try{const nt=new TextDecoder(Ue,{fatal:!0}),ft=He(Xe);return nt.decode(ft)}catch(nt){O(`stringToPDFString: "${nt}".`)}}const Be=[];for(let Ue=0,nt=Xe.length;Ue<nt;Ue++){const ft=U[Xe.charCodeAt(Ue)];Be.push(ft?String.fromCharCode(ft):Xe.charAt(Ue))}return Be.join("")}function H(Xe){return decodeURIComponent(escape(Xe))}function te(Xe){return unescape(encodeURIComponent(Xe))}function q(Xe){return typeof Xe=="object"&&(Xe==null?void 0:Xe.byteLength)!==void 0}function Le(Xe,Be){if(Xe.length!==Be.length)return!1;for(let Ue=0,nt=Xe.length;Ue<nt;Ue++)if(Xe[Ue]!==Be[Ue])return!1;return!0}function De(Xe=new Date){return[Xe.getUTCFullYear().toString(),(Xe.getUTCMonth()+1).toString().padStart(2,"0"),Xe.getUTCDate().toString().padStart(2,"0"),Xe.getUTCHours().toString().padStart(2,"0"),Xe.getUTCMinutes().toString().padStart(2,"0"),Xe.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ge{constructor(){Te(this,mt,!1);this.promise=new Promise((Be,Ue)=>{this.resolve=nt=>{Pe(this,mt,!0),Be(nt)},this.reject=nt=>{Pe(this,mt,!0),Ue(nt)}})}get settled(){return e(this,mt)}}mt=new WeakMap,t.PromiseCapability=Ge;let Ve=null,Je=null;function Ze(Xe){return Ve||(Ve=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Je=new Map([["ﬅ","ſt"]])),Xe.replaceAll(Ve,(Be,Ue,nt)=>Ue?Ue.normalize("NFKC"):Je.get(nt))}function it(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Xe=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Xe);else for(let Be=0;Be<32;Be++)Xe[Be]=Math.floor(Math.random()*255);return Ne(Xe)}const pt="pdfjs_internal_id_";t.AnnotationPrefix=pt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var we,le,p,M,Nt,ai,F,D,g,r,j,I,f,h,w,oi,y,_,Mi,S,n;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(s){if(typeof s=="string"||s instanceof URL?s={url:s}:(0,_util.isArrayBuffer)(s)&&(s={data:s}),typeof s!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:v}=c,z=s.url?getUrlProp(s.url):null,u=s.data?getDataProp(s.data):null,N=s.httpHeaders||null,re=s.withCredentials===!0,Q=s.password??null,oe=s.range instanceof PDFDataRangeTransport?s.range:null,fe=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let O=s.worker instanceof PDFWorker?s.worker:null;const Ee=s.verbosity,T=typeof s.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(s.docBaseUrl)?s.docBaseUrl:null,P=typeof s.cMapUrl=="string"?s.cMapUrl:null,Ce=s.cMapPacked!==!1,W=s.CMapReaderFactory||DefaultCMapReaderFactory,d=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,m=s.StandardFontDataFactory||DefaultStandardFontDataFactory,k=s.stopAtErrors!==!0,ye=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,ve=s.isEvalSupported!==!1,X=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!_util.isNodeJS,Se=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,Re=typeof s.disableFontFace=="boolean"?s.disableFontFace:_util.isNodeJS,Ne=s.fontExtraProperties===!0,He=s.enableXfa===!0,ze=s.ownerDocument||globalThis.document,qe=s.disableRange===!0,Ye=s.disableStream===!0,Oe=s.disableAutoFetch===!0,Fe=s.pdfBug===!0,Y=oe?oe.length:s.length??NaN,Ae=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!_util.isNodeJS&&!Re,ke=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:W===_display_utils.DOMCMapReaderFactory&&m===_display_utils.DOMStandardFontDataFactory&&P&&d&&(0,_display_utils.isValidFetchUrl)(P,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(d,document.baseURI),U=s.canvasFactory||new DefaultCanvasFactory({ownerDocument:ze}),o=s.filterFactory||new DefaultFilterFactory({docId:v,ownerDocument:ze}),H=null;(0,_util.setVerbosityLevel)(Ee);const te={canvasFactory:U,filterFactory:o};if(ke||(te.cMapReaderFactory=new W({baseUrl:P,isCompressed:Ce}),te.standardFontDataFactory=new m({baseUrl:d})),!O){const De={verbosity:Ee,port:_worker_options.GlobalWorkerOptions.workerPort};O=De.port?PDFWorker.fromPort(De):new PDFWorker(De),c._worker=O}const q={docId:v,apiVersion:"3.11.174",data:u,password:Q,disableAutoFetch:Oe,rangeChunkSize:fe,length:Y,docBaseUrl:T,enableXfa:He,evaluatorOptions:{maxImageSize:ye,disableFontFace:Re,ignoreErrors:k,isEvalSupported:ve,isOffscreenCanvasSupported:X,canvasMaxAreaInBytes:Se,fontExtraProperties:Ne,useSystemFonts:Ae,cMapUrl:ke?P:null,standardFontDataUrl:ke?d:null}},Le={ignoreErrors:k,isEvalSupported:ve,disableFontFace:Re,fontExtraProperties:Ne,enableXfa:He,ownerDocument:ze,disableAutoFetch:Oe,pdfBug:Fe,styleElement:H};return O.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const De=_fetchDocument(O,q),Ge=new Promise(function(Ve){let Je;oe?Je=new _transport_stream.PDFDataTransportStream({length:Y,initialData:oe.initialData,progressiveDone:oe.progressiveDone,contentDispositionFilename:oe.contentDispositionFilename,disableRange:qe,disableStream:Ye},oe):u||(Je=(it=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(it):(0,_display_utils.isValidFetchUrl)(it.url)?new _displayFetch_stream.PDFFetchStream(it):new _displayNetwork.PDFNetworkStream(it))({url:z,length:Y,httpHeaders:N,withCredentials:re,rangeChunkSize:fe,disableRange:qe,disableStream:Ye})),Ve(Je)});return Promise.all([De,Ge]).then(function([Ve,Je]){if(c.destroyed)throw new Error("Loading aborted");const Ze=new _message_handler.MessageHandler(v,Ve,O.port),it=new WorkerTransport(Ze,c,Je,Le,te);c._transport=it,Ze.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(s,c){if(s.destroyed)throw new Error("Worker was destroyed");const v=await s.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(s.destroyed)throw new Error("Worker was destroyed");return v}function getUrlProp(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(_util.isNodeJS&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(s){if(_util.isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return(0,_util.stringToBytes)(s);if(typeof s=="object"&&!isNaN(s==null?void 0:s.length)||(0,_util.isArrayBuffer)(s))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const t=class t{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Ot(t,we)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,v,z;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((v=this._transport)==null?void 0:v.destroy())}catch(u){throw(z=this._worker)!=null&&z.port&&delete this._worker._pendingDestroy,u}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};we=new WeakMap,Te(t,we,0);let PDFDocumentLoadingTask=t;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,v,z=!1,u=null){this.length=c,this.initialData=v,this.progressiveDone=z,this.contentDispositionFilename=u,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,v){for(const z of this._rangeListeners)z(c,v)}onDataProgress(c,v){this._readyCapability.promise.then(()=>{for(const z of this._progressListeners)z(c,v)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const v of this._progressiveReadListeners)v(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,v){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,v){this._pdfInfo=c,this._transport=v,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(z=>{if(!z)return z;const u=[];for(const N in z)u.push(...z[N]);return u}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,v,z,u=!1){Te(this,M);Te(this,le,null);Te(this,p,!1);this._pageIndex=c,this._pageInfo=v,this._transport=z,this._stats=u?new _display_utils.StatTimer:null,this._pdfBug=u,this.commonObjs=z.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:v=this.rotate,offsetX:z=0,offsetY:u=0,dontFlip:N=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:v,offsetX:z,offsetY:u,dontFlip:N})}getAnnotations({intent:c="display"}={}){const v=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,v.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:v,intent:z="display",annotationMode:u=_util.AnnotationMode.ENABLE,transform:N=null,background:re=null,optionalContentConfigPromise:Q=null,annotationCanvasMap:oe=null,pageColors:fe=null,printAnnotationStorage:O=null}){var m,k;(m=this._stats)==null||m.time("Overall");const Ee=this._transport.getRenderingIntent(z,u,O);Pe(this,p,!1),Z(this,M,ai).call(this),Q||(Q=this._transport.getOptionalContentConfig());let T=this._intentStates.get(Ee.cacheKey);T||(T=Object.create(null),this._intentStates.set(Ee.cacheKey,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const P=!!(Ee.renderingIntent&_util.RenderingIntentFlag.PRINT);T.displayReadyCapability||(T.displayReadyCapability=new _util.PromiseCapability,T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(k=this._stats)==null||k.time("Page Request"),this._pumpOperatorList(Ee));const Ce=ye=>{var ve,X;T.renderTasks.delete(W),(this._maybeCleanupAfterRender||P)&&Pe(this,p,!0),Z(this,M,Nt).call(this,!P),ye?(W.capability.reject(ye),this._abortOperatorList({intentState:T,reason:ye instanceof Error?ye:new Error(ye)})):W.capability.resolve(),(ve=this._stats)==null||ve.timeEnd("Rendering"),(X=this._stats)==null||X.timeEnd("Overall")},W=new InternalRenderTask({callback:Ce,params:{canvasContext:c,viewport:v,transform:N,background:re},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:oe,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!P,pdfBug:this._pdfBug,pageColors:fe});(T.renderTasks||(T.renderTasks=new Set)).add(W);const d=W.task;return Promise.all([T.displayReadyCapability.promise,Q]).then(([ye,ve])=>{var X;if(this.destroyed){Ce();return}(X=this._stats)==null||X.time("Rendering"),W.initializeGraphics({transparency:ye,optionalContentConfig:ve}),W.operatorListChanged()}).catch(Ce),d}getOperatorList({intent:c="display",annotationMode:v=_util.AnnotationMode.ENABLE,printAnnotationStorage:z=null}={}){var oe;function u(){re.operatorList.lastChunk&&(re.opListReadCapability.resolve(re.operatorList),re.renderTasks.delete(Q))}const N=this._transport.getRenderingIntent(c,v,z,!0);let re=this._intentStates.get(N.cacheKey);re||(re=Object.create(null),this._intentStates.set(N.cacheKey,re));let Q;return re.opListReadCapability||(Q=Object.create(null),Q.operatorListChanged=u,re.opListReadCapability=new _util.PromiseCapability,(re.renderTasks||(re.renderTasks=new Set)).add(Q),re.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(oe=this._stats)==null||oe.time("Page Request"),this._pumpOperatorList(N)),re.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:v=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:v===!0},{highWaterMark:100,size(u){return u.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(z=>_xfa_text.XfaText.textContent(z));const v=this.streamTextContent(c);return new Promise(function(z,u){function N(){re.read().then(function({value:oe,done:fe}){if(fe){z(Q);return}Object.assign(Q.styles,oe.styles),Q.items.push(...oe.items),N()},u)}const re=v.getReader(),Q={items:[],styles:Object.create(null)};N()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const v of this._intentStates.values())if(this._abortOperatorList({intentState:v,reason:new Error("Page was destroyed."),force:!0}),!v.opListReadCapability)for(const z of v.renderTasks)c.push(z.completed),z.cancel();return this.objs.clear(),Pe(this,p,!1),Z(this,M,ai).call(this),Promise.all(c)}cleanup(c=!1){Pe(this,p,!0);const v=Z(this,M,Nt).call(this,!1);return c&&v&&this._stats&&(this._stats=new _display_utils.StatTimer),v}_startRenderPage(c,v){var u,N;const z=this._intentStates.get(v);z&&((u=this._stats)==null||u.timeEnd("Page Request"),(N=z.displayReadyCapability)==null||N.resolve(c))}_renderPageChunk(c,v){for(let z=0,u=c.length;z<u;z++)v.operatorList.fnArray.push(c.fnArray[z]),v.operatorList.argsArray.push(c.argsArray[z]);v.operatorList.lastChunk=c.lastChunk,v.operatorList.separateAnnots=c.separateAnnots;for(const z of v.renderTasks)z.operatorListChanged();c.lastChunk&&Z(this,M,Nt).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:v,annotationStorageSerializable:z}){const{map:u,transfers:N}=z,Q=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:v,annotationStorage:u},N).getReader(),oe=this._intentStates.get(v);oe.streamReader=Q;const fe=()=>{Q.read().then(({value:O,done:Ee})=>{if(Ee){oe.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(O,oe),fe())},O=>{if(oe.streamReader=null,!this._transport.destroyed){if(oe.operatorList){oe.operatorList.lastChunk=!0;for(const Ee of oe.renderTasks)Ee.operatorListChanged();Z(this,M,Nt).call(this,!0)}if(oe.displayReadyCapability)oe.displayReadyCapability.reject(O);else if(oe.opListReadCapability)oe.opListReadCapability.reject(O);else throw O}})};fe()}_abortOperatorList({intentState:c,reason:v,force:z=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!z){if(c.renderTasks.size>0)return;if(v instanceof _display_utils.RenderingCancelledException){let u=RENDERING_CANCELLED_TIMEOUT;v.extraDelay>0&&v.extraDelay<1e3&&(u+=v.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:v,force:!0})},u);return}}if(c.streamReader.cancel(new _util.AbortException(v.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[u,N]of this._intentStates)if(N===c){this._intentStates.delete(u);break}this.cleanup()}}}get stats(){return this._stats}}le=new WeakMap,p=new WeakMap,M=new WeakSet,Nt=function(c=!1){if(Z(this,M,ai).call(this),!e(this,p)||this.destroyed)return!1;if(c)return Pe(this,le,setTimeout(()=>{Pe(this,le,null),Z(this,M,Nt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:v,operatorList:z}of this._intentStates.values())if(v.size>0||!z.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Pe(this,p,!1),!0},ai=function(){e(this,le)&&(clearTimeout(e(this,le)),Pe(this,le,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Te(this,F,new Set);Te(this,D,Promise.resolve())}postMessage(c,v){const z={data:structuredClone(c,v?{transfer:v}:null)};e(this,D).then(()=>{for(const u of e(this,F))u.call(this,z)})}addEventListener(c,v){e(this,F).add(v)}removeEventListener(c,v){e(this,F).delete(v)}terminate(){e(this,F).clear()}}F=new WeakMap,D=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=(g=document==null?void 0:document.currentScript)==null?void 0:g.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,c){let v;try{if(v=new URL(s),!v.origin||v.origin==="null")return!1}catch{return!1}const z=new URL(c,v);return v.origin===z.origin},PDFWorkerUtil.createCDNWrapper=function(s){const c=`importScripts("${s}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:s=null,port:c=null,verbosity:v=(0,_util.getVerbosityLevel)()}={}){var z;if(this.name=s,this.destroyed=!1,this.verbosity=v,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((z=e(_PDFWorker,r))!=null&&z.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(e(_PDFWorker,r)||Pe(_PDFWorker,r,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const c=new Worker(s),v=new _message_handler.MessageHandler("main","worker",c),z=()=>{c.removeEventListener("error",u),v.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},u=()=>{this._webWorker||z()};c.addEventListener("error",u),v.on("test",re=>{if(c.removeEventListener("error",u),this.destroyed){z();return}re?(this._messageHandler=v,this._port=c,this._webWorker=c,this._readyCapability.resolve(),v.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),v.destroy(),c.terminate())}),v.on("ready",re=>{if(c.removeEventListener("error",u),this.destroyed){z();return}try{N()}catch{this._setupFakeWorker()}});const N=()=>{const re=new Uint8Array;v.send("test",re,[re.buffer])};N();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const v=`fake${PDFWorkerUtil.fakeWorkerId++}`,z=new _message_handler.MessageHandler(v+"_worker",v,c);s.setup(z,c);const u=new _message_handler.MessageHandler(v,v+"_worker",c);this._messageHandler=u,this._readyCapability.resolve(),u.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){var s;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(s=e(_PDFWorker,r))==null||s.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){var v;if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(v=e(this,r))==null?void 0:v.get(s.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};r=new WeakMap,Te(_PDFWorker,r);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,v,z,u,N){Te(this,w);Te(this,j,new Map);Te(this,I,new Map);Te(this,f,new Map);Te(this,h,null);this.messageHandler=c,this.loadingTask=v,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:u.ownerDocument,styleElement:u.styleElement}),this._params=u,this.canvasFactory=N.canvasFactory,this.filterFactory=N.filterFactory,this.cMapReaderFactory=N.cMapReaderFactory,this.standardFontDataFactory=N.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=z,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,v=_util.AnnotationMode.ENABLE,z=null,u=!1){let N=_util.RenderingIntentFlag.DISPLAY,re=_annotation_storage.SerializableEmpty;switch(c){case"any":N=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":N=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(v){case _util.AnnotationMode.DISABLE:N+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:N+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:N+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,re=(N&_util.RenderingIntentFlag.PRINT&&z instanceof _annotation_storage.PrintAnnotationStorage?z:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${v}`)}return u&&(N+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:N,cacheKey:`${N}_${re.hash}`,annotationStorageSerializable:re}}destroy(){var z;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(z=e(this,h))==null||z.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const u of e(this,I).values())c.push(u._destroy());e(this,I).clear(),e(this,f).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const v=this.messageHandler.sendWithPromise("Terminate",null);return c.push(v),Promise.all(c).then(()=>{var u;this.commonObjs.clear(),this.fontLoader.clear(),e(this,j).clear(),this.filterFactory.destroy(),(u=this._networkStream)==null||u.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:v}=this;c.on("GetReader",(z,u)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=N=>{this._lastProgress={loaded:N.loaded,total:N.total}},u.onPull=()=>{this._fullReader.read().then(function({value:N,done:re}){if(re){u.close();return}(0,_util.assert)(N instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(N),1,[N])}).catch(N=>{u.error(N)})},u.onCancel=N=>{this._fullReader.cancel(N),u.ready.catch(re=>{if(!this.destroyed)throw re})}}),c.on("ReaderHeadersReady",z=>{const u=new _util.PromiseCapability,N=this._fullReader;return N.headersReady.then(()=>{var re;(!N.isStreamingSupported||!N.isRangeSupported)&&(this._lastProgress&&((re=v.onProgress)==null||re.call(v,this._lastProgress)),N.onProgress=Q=>{var oe;(oe=v.onProgress)==null||oe.call(v,{loaded:Q.loaded,total:Q.total})}),u.resolve({isStreamingSupported:N.isStreamingSupported,isRangeSupported:N.isRangeSupported,contentLength:N.contentLength})},u.reject),u.promise}),c.on("GetRangeReader",(z,u)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const N=this._networkStream.getRangeReader(z.begin,z.end);if(!N){u.close();return}u.onPull=()=>{N.read().then(function({value:re,done:Q}){if(Q){u.close();return}(0,_util.assert)(re instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(re),1,[re])}).catch(re=>{u.error(re)})},u.onCancel=re=>{N.cancel(re),u.ready.catch(Q=>{if(!this.destroyed)throw Q})}}),c.on("GetDoc",({pdfInfo:z})=>{this._numPages=z.numPages,this._htmlForXfa=z.htmlForXfa,delete z.htmlForXfa,v._capability.resolve(new PDFDocumentProxy(z,this))}),c.on("DocException",function(z){let u;switch(z.name){case"PasswordException":u=new _util.PasswordException(z.message,z.code);break;case"InvalidPDFException":u=new _util.InvalidPDFException(z.message);break;case"MissingPDFException":u=new _util.MissingPDFException(z.message);break;case"UnexpectedResponseException":u=new _util.UnexpectedResponseException(z.message,z.status);break;case"UnknownErrorException":u=new _util.UnknownErrorException(z.message,z.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}v._capability.reject(u)}),c.on("PasswordRequest",z=>{if(Pe(this,h,new _util.PromiseCapability),v.onPassword){const u=N=>{N instanceof Error?e(this,h).reject(N):e(this,h).resolve({password:N})};try{v.onPassword(u,z.code)}catch(N){e(this,h).reject(N)}}else e(this,h).reject(new _util.PasswordException(z.message,z.code));return e(this,h).promise}),c.on("DataLoaded",z=>{var u;(u=v.onProgress)==null||u.call(v,{loaded:z.length,total:z.length}),this.downloadInfoCapability.resolve(z)}),c.on("StartRenderPage",z=>{if(this.destroyed)return;e(this,I).get(z.pageIndex)._startRenderPage(z.transparency,z.cacheKey)}),c.on("commonobj",([z,u,N])=>{var re;if(!this.destroyed&&!this.commonObjs.has(z))switch(u){case"Font":const Q=this._params;if("error"in N){const O=N.error;(0,_util.warn)(`Error during font loading: ${O}`),this.commonObjs.resolve(z,O);break}const oe=Q.pdfBug&&((re=globalThis.FontInspector)!=null&&re.enabled)?(O,Ee)=>globalThis.FontInspector.fontAdded(O,Ee):null,fe=new _font_loader.FontFaceObject(N,{isEvalSupported:Q.isEvalSupported,disableFontFace:Q.disableFontFace,ignoreErrors:Q.ignoreErrors,inspectFont:oe});this.fontLoader.bind(fe).catch(O=>c.sendWithPromise("FontFallback",{id:z})).finally(()=>{!Q.fontExtraProperties&&fe.data&&(fe.data=null),this.commonObjs.resolve(z,fe)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(z,N);break;default:throw new Error(`Got unknown common object type ${u}`)}}),c.on("obj",([z,u,N,re])=>{var oe;if(this.destroyed)return;const Q=e(this,I).get(u);if(!Q.objs.has(z))switch(N){case"Image":if(Q.objs.resolve(z,re),re){let fe;if(re.bitmap){const{width:O,height:Ee}=re;fe=O*Ee*4}else fe=((oe=re.data)==null?void 0:oe.length)||0;fe>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Q._maybeCleanupAfterRender=!0)}break;case"Pattern":Q.objs.resolve(z,re);break;default:throw new Error(`Got unknown object type ${N}`)}}),c.on("DocProgress",z=>{var u;this.destroyed||(u=v.onProgress)==null||u.call(v,{loaded:z.loaded,total:z.total})}),c.on("FetchBuiltInCMap",z=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(z):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",z=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(z):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var z;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:v}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((z=this._fullReader)==null?void 0:z.filename)??null},v).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const v=c-1,z=e(this,f).get(v);if(z)return z;const u=this.messageHandler.sendWithPromise("GetPage",{pageIndex:v}).then(N=>{if(this.destroyed)throw new Error("Transport destroyed");const re=new PDFPageProxy(v,N,this,this._params.pdfBug);return e(this,I).set(v,re),re});return e(this,f).set(v,u),u}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,v){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:v})}getFieldObjects(){return Z(this,w,oi).call(this,"GetFieldObjects")}hasJSActions(){return Z(this,w,oi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Z(this,w,oi).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",v=e(this,j).get(c);if(v)return v;const z=this.messageHandler.sendWithPromise(c,null).then(u=>{var N,re;return{info:u[0],metadata:u[1]?new _metadata.Metadata(u[1]):null,contentDispositionFilename:((N=this._fullReader)==null?void 0:N.filename)??null,contentLength:((re=this._fullReader)==null?void 0:re.contentLength)??null}});return e(this,j).set(c,z),z}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const v of e(this,I).values())if(!v.cleanup())throw new Error(`startCleanup: Page ${v.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),e(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:v}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:v})}}j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakSet,oi=function(c,v=null){const z=e(this,j).get(c);if(z)return z;const u=this.messageHandler.sendWithPromise(c,v);return e(this,j).set(c,u),u};class PDFObjects{constructor(){Te(this,_);Te(this,y,Object.create(null))}get(c,v=null){if(v){const u=Z(this,_,Mi).call(this,c);return u.capability.promise.then(()=>v(u.data)),null}const z=e(this,y)[c];if(!(z!=null&&z.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return z.data}has(c){const v=e(this,y)[c];return(v==null?void 0:v.capability.settled)||!1}resolve(c,v=null){const z=Z(this,_,Mi).call(this,c);z.data=v,z.capability.resolve()}clear(){var c;for(const v in e(this,y)){const{data:z}=e(this,y)[v];(c=z==null?void 0:z.bitmap)==null||c.close()}Pe(this,y,Object.create(null))}}y=new WeakMap,_=new WeakSet,Mi=function(c){var v;return(v=e(this,y))[c]||(v[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){Te(this,S,null);Pe(this,S,c),this.onContinue=null}get promise(){return e(this,S).capability.promise}cancel(c=0){e(this,S).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=e(this,S).operatorList;if(!c)return!1;const{annotationCanvasMap:v}=e(this,S);return c.form||c.canvas&&(v==null?void 0:v.size)>0}}S=new WeakMap,exports.RenderTask=RenderTask;const i=class i{constructor({callback:c,params:v,objs:z,commonObjs:u,annotationCanvasMap:N,operatorList:re,pageIndex:Q,canvasFactory:oe,filterFactory:fe,useRequestAnimationFrame:O=!1,pdfBug:Ee=!1,pageColors:T=null}){this.callback=c,this.params=v,this.objs=z,this.commonObjs=u,this.annotationCanvasMap=N,this.operatorListIdx=null,this.operatorList=re,this._pageIndex=Q,this.canvasFactory=oe,this.filterFactory=fe,this._pdfBug=Ee,this.pageColors=T,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=O===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=v.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:v}){var Q,oe;if(this.cancelled)return;if(this._canvas){if(e(i,n).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");e(i,n).add(this._canvas)}this._pdfBug&&((Q=globalThis.StepperManager)!=null&&Q.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:z,viewport:u,transform:N,background:re}=this.params;this.gfx=new _canvas.CanvasGraphics(z,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:v},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:N,viewport:u,transparency:c,background:re}),this.operatorListIdx=0,this.graphicsReady=!0,(oe=this.graphicsReadyCallback)==null||oe.call(this)}cancel(c=null,v=0){var z;this.running=!1,this.cancelled=!0,(z=this.gfx)==null||z.endDrawing(),e(i,n).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,v))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),e(i,n).delete(this._canvas),this.callback())))}};n=new WeakMap,Te(i,n,new WeakSet);let InternalRenderTask=i;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(we,t,le)=>{var g,r,j,Nn,f;Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var p=le(1),M=le(4),Me=le(8);const J=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=J;class F{constructor(){Te(this,j);Te(this,g,!1);Te(this,r,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,E){const y=e(this,r).get(w);return y===void 0?E:Object.assign(E,y)}getRawValue(w){return e(this,r).get(w)}remove(w){if(e(this,r).delete(w),e(this,r).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const E of e(this,r).values())if(E instanceof M.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,E){const y=e(this,r).get(w);let _=!1;if(y!==void 0)for(const[x,S]of Object.entries(E))y[x]!==S&&(_=!0,y[x]=S);else _=!0,e(this,r).set(w,E);_&&Z(this,j,Nn).call(this),E instanceof M.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(E.constructor._type)}has(w){return e(this,r).has(w)}getAll(){return e(this,r).size>0?(0,p.objectFromMap)(e(this,r)):null}setAll(w){for(const[E,y]of Object.entries(w))this.setValue(E,y)}get size(){return e(this,r).size}resetModified(){e(this,g)&&(Pe(this,g,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new D(this)}get serializable(){if(e(this,r).size===0)return J;const w=new Map,E=new Me.MurmurHash3_64,y=[],_=Object.create(null);let x=!1;for(const[S,n]of e(this,r)){const i=n instanceof M.AnnotationEditor?n.serialize(!1,_):n;i&&(w.set(S,i),E.update(`${S}:${JSON.stringify(i)}`),x||(x=!!i.bitmap))}if(x)for(const S of w.values())S.bitmap&&y.push(S.bitmap);return w.size>0?{map:w,hash:E.hexdigest(),transfers:y}:J}}g=new WeakMap,r=new WeakMap,j=new WeakSet,Nn=function(){e(this,g)||(Pe(this,g,!0),typeof this.onSetModified=="function"&&this.onSetModified())},t.AnnotationStorage=F;class D extends F{constructor(E){super();Te(this,f);const{map:y,hash:_,transfers:x}=E.serializable,S=structuredClone(y,x?{transfer:x}:null);Pe(this,f,{map:S,hash:_,transfers:x})}get print(){(0,p.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return e(this,f)}}f=new WeakMap,t.PrintAnnotationStorage=D},(we,t,le)=>{var D,g,r,j,I,f,h,w,E,y,_,x,S,n,i,Li,Ri,v,ki,Ii,Bn,Vn,Un,Di,Hn;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var p=le(5),M=le(1),Me=le(6);const O=class O{constructor(T){Te(this,i);Te(this,D,"");Te(this,g,!1);Te(this,r,null);Te(this,j,null);Te(this,I,null);Te(this,f,!1);Te(this,h,null);Te(this,w,this.focusin.bind(this));Te(this,E,this.focusout.bind(this));Te(this,y,!1);Te(this,_,!1);Te(this,x,!1);at(this,"_initialOptions",Object.create(null));at(this,"_uiManager",null);at(this,"_focusEventsAllowed",!0);at(this,"_l10nPromise",null);Te(this,S,!1);Te(this,n,O._zIndex++);this.constructor===O&&(0,M.unreachable)("Cannot initialize AnnotationEditor."),this.parent=T.parent,this.id=T.id,this.width=this.height=null,this.pageIndex=T.parent.pageIndex,this.name=T.name,this.div=null,this._uiManager=T.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=T.isCentered,this._structTreeParentId=null;const{rotation:P,rawDims:{pageWidth:Ce,pageHeight:W,pageX:d,pageY:m}}=this.parent.viewport;this.rotation=P,this.pageRotation=(360+P-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Ce,W],this.pageTranslation=[d,m];const[k,ye]=this.parentDimensions;this.x=T.x/k,this.y=T.y/ye,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,M.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(T){const P=new F({id:T.parent.getNextId(),parent:T.parent,uiManager:T._uiManager});P.annotationElementId=T.annotationElementId,P.deleted=!0,P._uiManager.addToAnnotationStorage(P)}static initialize(T,P=null){if(O._l10nPromise||(O._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(W=>[W,T.get(W)]))),P!=null&&P.strings)for(const W of P.strings)O._l10nPromise.set(W,T.get(W));if(O._borderLineWidth!==-1)return;const Ce=getComputedStyle(document.documentElement);O._borderLineWidth=parseFloat(Ce.getPropertyValue("--outline-width"))||0}static updateDefaultParams(T,P){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(T){return!1}static paste(T,P){(0,M.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return e(this,S)}set _isDraggable(T){var P;Pe(this,S,T),(P=this.div)==null||P.classList.toggle("draggable",T)}center(){const[T,P]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*P/(T*2),this.y+=this.width*T/(P*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*P/(T*2),this.y-=this.width*T/(P*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(T){this._uiManager.addCommands(T)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=e(this,n)}setParent(T){T!==null&&(this.pageIndex=T.pageIndex,this.pageDimensions=T.pageDimensions),this.parent=T}focusin(T){this._focusEventsAllowed&&(e(this,y)?Pe(this,y,!1):this.parent.setSelected(this))}focusout(T){var Ce;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const P=T.relatedTarget;P!=null&&P.closest(`#${this.id}`)||(T.preventDefault(),(Ce=this.parent)!=null&&Ce.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(T,P,Ce,W){const[d,m]=this.parentDimensions;[Ce,W]=this.screenToPageTranslation(Ce,W),this.x=(T+Ce)/d,this.y=(P+W)/m,this.fixAndSetPosition()}translate(T,P){Z(this,i,Li).call(this,this.parentDimensions,T,P)}translateInPage(T,P){Z(this,i,Li).call(this,this.pageDimensions,T,P),this.div.scrollIntoView({block:"nearest"})}drag(T,P){const[Ce,W]=this.parentDimensions;if(this.x+=T/Ce,this.y+=P/W,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ve,y:X}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ve,X)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:m}=this;const[k,ye]=Z(this,i,Ri).call(this);d+=k,m+=ye,this.div.style.left=`${(100*d).toFixed(2)}%`,this.div.style.top=`${(100*m).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[T,P]=this.pageDimensions;let{x:Ce,y:W,width:d,height:m}=this;switch(d*=T,m*=P,Ce*=T,W*=P,this.rotation){case 0:Ce=Math.max(0,Math.min(T-d,Ce)),W=Math.max(0,Math.min(P-m,W));break;case 90:Ce=Math.max(0,Math.min(T-m,Ce)),W=Math.min(P,Math.max(d,W));break;case 180:Ce=Math.min(T,Math.max(d,Ce)),W=Math.min(P,Math.max(m,W));break;case 270:Ce=Math.min(T,Math.max(m,Ce)),W=Math.max(0,Math.min(P-d,W));break}this.x=Ce/=T,this.y=W/=P;const[k,ye]=Z(this,i,Ri).call(this);Ce+=k,W+=ye;const{style:ve}=this.div;ve.left=`${(100*Ce).toFixed(2)}%`,ve.top=`${(100*W).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(T,P){var Ce;return Z(Ce=O,v,ki).call(Ce,T,P,this.parentRotation)}pageTranslationToScreen(T,P){var Ce;return Z(Ce=O,v,ki).call(Ce,T,P,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:T,pageDimensions:[P,Ce]}=this,W=P*T,d=Ce*T;return M.FeatureTest.isCSSRoundSupported?[Math.round(W),Math.round(d)]:[W,d]}setDims(T,P){var d;const[Ce,W]=this.parentDimensions;this.div.style.width=`${(100*T/Ce).toFixed(2)}%`,e(this,f)||(this.div.style.height=`${(100*P/W).toFixed(2)}%`),(d=e(this,r))==null||d.classList.toggle("small",T<O.SMALL_EDITOR_SIZE||P<O.SMALL_EDITOR_SIZE)}fixDims(){const{style:T}=this.div,{height:P,width:Ce}=T,W=Ce.endsWith("%"),d=!e(this,f)&&P.endsWith("%");if(W&&d)return;const[m,k]=this.parentDimensions;W||(T.width=`${(100*parseFloat(Ce)/m).toFixed(2)}%`),!e(this,f)&&!d&&(T.height=`${(100*parseFloat(P)/k).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(e(this,r))return;const T=Pe(this,r,document.createElement("button"));T.className="altText";const P=await O._l10nPromise.get("editor_alt_text_button_label");T.textContent=P,T.setAttribute("aria-label",P),T.tabIndex="0",T.addEventListener("contextmenu",Me.noContextMenu),T.addEventListener("pointerdown",Ce=>Ce.stopPropagation()),T.addEventListener("click",Ce=>{Ce.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),T.addEventListener("keydown",Ce=>{Ce.target===T&&Ce.key==="Enter"&&(Ce.preventDefault(),this._uiManager.editAltText(this))}),Z(this,i,Di).call(this),this.div.append(T),O.SMALL_EDITOR_SIZE||(O.SMALL_EDITOR_SIZE=Math.min(128,Math.round(T.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:e(this,D),decorative:e(this,g)}}set altTextData({altText:T,decorative:P}){e(this,D)===T&&e(this,g)===P||(Pe(this,D,T),Pe(this,g,P),Z(this,i,Di).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",e(this,w)),this.div.addEventListener("focusout",e(this,E));const[T,P]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*P/T).toFixed(2)}%`,this.div.style.maxHeight=`${(100*T/P).toFixed(2)}%`);const[Ce,W]=this.getInitialTranslation();return this.translate(Ce,W),(0,p.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(T){const{isMac:P}=M.FeatureTest.platform;if(T.button!==0||T.ctrlKey&&P){T.preventDefault();return}Pe(this,y,!0),Z(this,i,Hn).call(this,T)}moveInDOM(){var T;(T=this.parent)==null||T.moveEditorInDOM(this)}_setParentAndPosition(T,P,Ce){T.changeParent(this),this.x=P,this.y=Ce,this.fixAndSetPosition()}getRect(T,P){const Ce=this.parentScale,[W,d]=this.pageDimensions,[m,k]=this.pageTranslation,ye=T/Ce,ve=P/Ce,X=this.x*W,Se=this.y*d,Re=this.width*W,Ne=this.height*d;switch(this.rotation){case 0:return[X+ye+m,d-Se-ve-Ne+k,X+ye+Re+m,d-Se-ve+k];case 90:return[X+ve+m,d-Se+ye+k,X+ve+Ne+m,d-Se+ye+Re+k];case 180:return[X-ye-Re+m,d-Se+ve+k,X-ye+m,d-Se+ve+Ne+k];case 270:return[X-ve-Ne+m,d-Se-ye-Re+k,X-ve+m,d-Se-ye+k];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(T,P){const[Ce,W,d,m]=T,k=d-Ce,ye=m-W;switch(this.rotation){case 0:return[Ce,P-m,k,ye];case 90:return[Ce,P-W,ye,k];case 180:return[d,P-W,k,ye];case 270:return[d,P-m,ye,k];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Pe(this,x,!0)}disableEditMode(){Pe(this,x,!1)}isInEditMode(){return e(this,x)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var T,P;(T=this.div)==null||T.addEventListener("focusin",e(this,w)),(P=this.div)==null||P.addEventListener("focusout",e(this,E))}serialize(T=!1,P=null){(0,M.unreachable)("An editor must be serializable")}static deserialize(T,P,Ce){const W=new this.prototype.constructor({parent:P,id:P.getNextId(),uiManager:Ce});W.rotation=T.rotation;const[d,m]=W.pageDimensions,[k,ye,ve,X]=W.getRectInCurrentCoords(T.rect,m);return W.x=k/d,W.y=ye/m,W.width=ve/d,W.height=X/m,W}remove(){var T;this.div.removeEventListener("focusin",e(this,w)),this.div.removeEventListener("focusout",e(this,E)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(T=e(this,r))==null||T.remove(),Pe(this,r,null),Pe(this,j,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Z(this,i,Bn).call(this),e(this,h).classList.remove("hidden"))}select(){var T;this.makeResizable(),(T=this.div)==null||T.classList.add("selectedEditor")}unselect(){var T,P,Ce;(T=e(this,h))==null||T.classList.add("hidden"),(P=this.div)==null||P.classList.remove("selectedEditor"),(Ce=this.div)!=null&&Ce.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(T,P){}disableEditing(){e(this,r)&&(e(this,r).hidden=!0)}enableEditing(){e(this,r)&&(e(this,r).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return e(this,_)}set isEditing(T){Pe(this,_,T),this.parent&&(T?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(T,P){Pe(this,f,!0);const Ce=T/P,{style:W}=this.div;W.aspectRatio=Ce,W.height="auto"}static get MIN_SIZE(){return 16}};D=new WeakMap,g=new WeakMap,r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakMap,_=new WeakMap,x=new WeakMap,S=new WeakMap,n=new WeakMap,i=new WeakSet,Li=function([T,P],Ce,W){[Ce,W]=this.screenToPageTranslation(Ce,W),this.x+=Ce/T,this.y+=W/P,this.fixAndSetPosition()},Ri=function(){const[T,P]=this.parentDimensions,{_borderLineWidth:Ce}=O,W=Ce/T,d=Ce/P;switch(this.rotation){case 90:return[-W,d];case 180:return[W,d];case 270:return[W,-d];default:return[-W,-d]}},v=new WeakSet,ki=function(T,P,Ce){switch(Ce){case 90:return[P,-T];case 180:return[-T,-P];case 270:return[-P,T];default:return[T,P]}},Ii=function(T){switch(T){case 90:{const[P,Ce]=this.pageDimensions;return[0,-P/Ce,Ce/P,0]}case 180:return[-1,0,0,-1];case 270:{const[P,Ce]=this.pageDimensions;return[0,P/Ce,-Ce/P,0]}default:return[1,0,0,1]}},Bn=function(){if(e(this,h))return;Pe(this,h,document.createElement("div")),e(this,h).classList.add("resizers");const T=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||T.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const P of T){const Ce=document.createElement("div");e(this,h).append(Ce),Ce.classList.add("resizer",P),Ce.addEventListener("pointerdown",Z(this,i,Vn).bind(this,P)),Ce.addEventListener("contextmenu",Me.noContextMenu)}this.div.prepend(e(this,h))},Vn=function(T,P){P.preventDefault();const{isMac:Ce}=M.FeatureTest.platform;if(P.button!==0||P.ctrlKey&&Ce)return;const W=Z(this,i,Un).bind(this,T),d=this._isDraggable;this._isDraggable=!1;const m={passive:!0,capture:!0};window.addEventListener("pointermove",W,m);const k=this.x,ye=this.y,ve=this.width,X=this.height,Se=this.parent.div.style.cursor,Re=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(P.target).cursor;const Ne=()=>{this._isDraggable=d,window.removeEventListener("pointerup",Ne),window.removeEventListener("blur",Ne),window.removeEventListener("pointermove",W,m),this.parent.div.style.cursor=Se,this.div.style.cursor=Re;const He=this.x,ze=this.y,qe=this.width,Ye=this.height;He===k&&ze===ye&&qe===ve&&Ye===X||this.addCommands({cmd:()=>{this.width=qe,this.height=Ye,this.x=He,this.y=ze;const[Oe,Fe]=this.parentDimensions;this.setDims(Oe*qe,Fe*Ye),this.fixAndSetPosition()},undo:()=>{this.width=ve,this.height=X,this.x=k,this.y=ye;const[Oe,Fe]=this.parentDimensions;this.setDims(Oe*ve,Fe*X),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Ne),window.addEventListener("blur",Ne)},Un=function(T,P){const[Ce,W]=this.parentDimensions,d=this.x,m=this.y,k=this.width,ye=this.height,ve=O.MIN_SIZE/Ce,X=O.MIN_SIZE/W,Se=Ze=>Math.round(Ze*1e4)/1e4,Re=Z(this,i,Ii).call(this,this.rotation),Ne=(Ze,it)=>[Re[0]*Ze+Re[2]*it,Re[1]*Ze+Re[3]*it],He=Z(this,i,Ii).call(this,360-this.rotation),ze=(Ze,it)=>[He[0]*Ze+He[2]*it,He[1]*Ze+He[3]*it];let qe,Ye,Oe=!1,Fe=!1;switch(T){case"topLeft":Oe=!0,qe=(Ze,it)=>[0,0],Ye=(Ze,it)=>[Ze,it];break;case"topMiddle":qe=(Ze,it)=>[Ze/2,0],Ye=(Ze,it)=>[Ze/2,it];break;case"topRight":Oe=!0,qe=(Ze,it)=>[Ze,0],Ye=(Ze,it)=>[0,it];break;case"middleRight":Fe=!0,qe=(Ze,it)=>[Ze,it/2],Ye=(Ze,it)=>[0,it/2];break;case"bottomRight":Oe=!0,qe=(Ze,it)=>[Ze,it],Ye=(Ze,it)=>[0,0];break;case"bottomMiddle":qe=(Ze,it)=>[Ze/2,it],Ye=(Ze,it)=>[Ze/2,0];break;case"bottomLeft":Oe=!0,qe=(Ze,it)=>[0,it],Ye=(Ze,it)=>[Ze,0];break;case"middleLeft":Fe=!0,qe=(Ze,it)=>[0,it/2],Ye=(Ze,it)=>[Ze,it/2];break}const Y=qe(k,ye),Ae=Ye(k,ye);let ke=Ne(...Ae);const U=Se(d+ke[0]),o=Se(m+ke[1]);let H=1,te=1,[q,Le]=this.screenToPageTranslation(P.movementX,P.movementY);if([q,Le]=ze(q/Ce,Le/W),Oe){const Ze=Math.hypot(k,ye);H=te=Math.max(Math.min(Math.hypot(Ae[0]-Y[0]-q,Ae[1]-Y[1]-Le)/Ze,1/k,1/ye),ve/k,X/ye)}else Fe?H=Math.max(ve,Math.min(1,Math.abs(Ae[0]-Y[0]-q)))/k:te=Math.max(X,Math.min(1,Math.abs(Ae[1]-Y[1]-Le)))/ye;const De=Se(k*H),Ge=Se(ye*te);ke=Ne(...Ye(De,Ge));const Ve=U-ke[0],Je=o-ke[1];this.width=De,this.height=Ge,this.x=Ve,this.y=Je,this.setDims(Ce*De,W*Ge),this.fixAndSetPosition()},Di=async function(){var Ce;const T=e(this,r);if(!T)return;if(!e(this,D)&&!e(this,g)){T.classList.remove("done"),(Ce=e(this,j))==null||Ce.remove();return}O._l10nPromise.get("editor_alt_text_edit_button_label").then(W=>{T.setAttribute("aria-label",W)});let P=e(this,j);if(!P){Pe(this,j,P=document.createElement("span")),P.className="tooltip",P.setAttribute("role","tooltip");const W=P.id=`alt-text-tooltip-${this.id}`;T.setAttribute("aria-describedby",W);const d=100;T.addEventListener("mouseenter",()=>{Pe(this,I,setTimeout(()=>{Pe(this,I,null),e(this,j).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},d))}),T.addEventListener("mouseleave",()=>{var m;clearTimeout(e(this,I)),Pe(this,I,null),(m=e(this,j))==null||m.classList.remove("show")})}T.classList.add("done"),P.innerText=e(this,g)?await O._l10nPromise.get("editor_alt_text_decorative_tooltip"):e(this,D),P.parentNode||T.append(P)},Hn=function(T){if(!this._isDraggable)return;const P=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Ce,W;P&&(Ce={passive:!0,capture:!0},W=m=>{const[k,ye]=this.screenToPageTranslation(m.movementX,m.movementY);this._uiManager.dragSelectedEditors(k,ye)},window.addEventListener("pointermove",W,Ce));const d=()=>{if(window.removeEventListener("pointerup",d),window.removeEventListener("blur",d),P&&window.removeEventListener("pointermove",W,Ce),Pe(this,y,!1),!this._uiManager.endDragSession()){const{isMac:m}=M.FeatureTest.platform;T.ctrlKey&&!m||T.shiftKey||T.metaKey&&m?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",d),window.addEventListener("blur",d)},Te(O,v),at(O,"_borderLineWidth",-1),at(O,"_colorManager",new p.ColorManager),at(O,"_zIndex",1),at(O,"SMALL_EDITOR_SIZE",0);let J=O;t.AnnotationEditor=J;class F extends J{constructor(T){super(T),this.annotationElementId=T.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(we,t,le)=>{var f,h,w,E,y,Fi,S,n,i,s,c,Wn,u,N,re,Q,oe,fe,O,Ee,T,P,Ce,W,d,m,k,ye,ve,X,Se,Re,Ne,He,ze,qe,Ye,Oe,Fe,Y,Ae,ke,U,o,H,te,q,jn,Oi,Ni,li,Bi,Vi,Tt,zt,zn,$n,Ui,$t,Hi;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=Me,t.opacityToHex=J;var p=le(1),M=le(6);function Me(ut,be,We){for(const et of We)be.addEventListener(et,ut[et].bind(ut))}function J(ut){return Math.round(Math.min(255,Math.max(1,255*ut))).toString(16).padStart(2,"0")}class F{constructor(){Te(this,f,0)}getId(){return`${p.AnnotationEditorPrefix}${Ot(this,f)._++}`}}f=new WeakMap;const x=class x{constructor(){Te(this,y);Te(this,h,(0,p.getUuid)());Te(this,w,0);Te(this,E,null)}static get _isSVGFittingCanvas(){const be='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',et=new OffscreenCanvas(1,3).getContext("2d"),rt=new Image;rt.src=be;const ot=rt.decode().then(()=>(et.drawImage(rt,0,0,1,1,0,0,1,3),new Uint32Array(et.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,p.shadow)(this,"_isSVGFittingCanvas",ot)}async getFromFile(be){const{lastModified:We,name:et,size:rt,type:ot}=be;return Z(this,y,Fi).call(this,`${We}_${et}_${rt}_${ot}`,be)}async getFromUrl(be){return Z(this,y,Fi).call(this,be,be)}async getFromId(be){e(this,E)||Pe(this,E,new Map);const We=e(this,E).get(be);return We?We.bitmap?(We.refCounter+=1,We):We.file?this.getFromFile(We.file):this.getFromUrl(We.url):null}getSvgUrl(be){const We=e(this,E).get(be);return We!=null&&We.isSvg?We.svgUrl:null}deleteId(be){e(this,E)||Pe(this,E,new Map);const We=e(this,E).get(be);We&&(We.refCounter-=1,We.refCounter===0&&(We.bitmap=null))}isValidId(be){return be.startsWith(`image_${e(this,h)}_`)}};h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakSet,Fi=async function(be,We){e(this,E)||Pe(this,E,new Map);let et=e(this,E).get(be);if(et===null)return null;if(et!=null&&et.bitmap)return et.refCounter+=1,et;try{et||(et={bitmap:null,id:`image_${e(this,h)}_${Ot(this,w)._++}`,refCounter:0,isSvg:!1});let rt;if(typeof We=="string"){et.url=We;const ot=await fetch(We);if(!ot.ok)throw new Error(ot.statusText);rt=await ot.blob()}else rt=et.file=We;if(rt.type==="image/svg+xml"){const ot=x._isSVGFittingCanvas,tt=new FileReader,_e=new Image,ne=new Promise((Ie,je)=>{_e.onload=()=>{et.bitmap=_e,et.isSvg=!0,Ie()},tt.onload=async()=>{const $e=et.svgUrl=tt.result;_e.src=await ot?`${$e}#svgView(preserveAspectRatio(none))`:$e},_e.onerror=tt.onerror=je});tt.readAsDataURL(rt),await ne}else et.bitmap=await createImageBitmap(rt);et.refCounter=1}catch(rt){console.error(rt),et=null}return e(this,E).set(be,et),et&&e(this,E).set(et.id,et),et};let D=x;class g{constructor(be=128){Te(this,S,[]);Te(this,n,!1);Te(this,i);Te(this,s,-1);Pe(this,i,be)}add({cmd:be,undo:We,mustExec:et,type:rt=NaN,overwriteIfSameType:ot=!1,keepUndo:tt=!1}){if(et&&be(),e(this,n))return;const _e={cmd:be,undo:We,type:rt};if(e(this,s)===-1){e(this,S).length>0&&(e(this,S).length=0),Pe(this,s,0),e(this,S).push(_e);return}if(ot&&e(this,S)[e(this,s)].type===rt){tt&&(_e.undo=e(this,S)[e(this,s)].undo),e(this,S)[e(this,s)]=_e;return}const ne=e(this,s)+1;ne===e(this,i)?e(this,S).splice(0,1):(Pe(this,s,ne),ne<e(this,S).length&&e(this,S).splice(ne)),e(this,S).push(_e)}undo(){e(this,s)!==-1&&(Pe(this,n,!0),e(this,S)[e(this,s)].undo(),Pe(this,n,!1),Pe(this,s,e(this,s)-1))}redo(){e(this,s)<e(this,S).length-1&&(Pe(this,s,e(this,s)+1),Pe(this,n,!0),e(this,S)[e(this,s)].cmd(),Pe(this,n,!1))}hasSomethingToUndo(){return e(this,s)!==-1}hasSomethingToRedo(){return e(this,s)<e(this,S).length-1}destroy(){Pe(this,S,null)}}S=new WeakMap,n=new WeakMap,i=new WeakMap,s=new WeakMap,t.CommandManager=g;class r{constructor(be){Te(this,c);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:We}=p.FeatureTest.platform;for(const[et,rt,ot={}]of be)for(const tt of et){const _e=tt.startsWith("mac+");We&&_e?(this.callbacks.set(tt.slice(4),{callback:rt,options:ot}),this.allKeys.add(tt.split("+").at(-1))):!We&&!_e&&(this.callbacks.set(tt,{callback:rt,options:ot}),this.allKeys.add(tt.split("+").at(-1)))}}exec(be,We){if(!this.allKeys.has(We.key))return;const et=this.callbacks.get(Z(this,c,Wn).call(this,We));if(!et)return;const{callback:rt,options:{bubbles:ot=!1,args:tt=[],checker:_e=null}}=et;_e&&!_e(be,We)||(rt.bind(be,...tt)(),ot||(We.stopPropagation(),We.preventDefault()))}}c=new WeakSet,Wn=function(be){be.altKey&&this.buffer.push("alt"),be.ctrlKey&&this.buffer.push("ctrl"),be.metaKey&&this.buffer.push("meta"),be.shiftKey&&this.buffer.push("shift"),this.buffer.push(be.key);const We=this.buffer.join("+");return this.buffer.length=0,We},t.KeyboardManager=r;const z=class z{get _colors(){const be=new Map([["CanvasText",null],["Canvas",null]]);return(0,M.getColorValues)(be),(0,p.shadow)(this,"_colors",be)}convert(be){const We=(0,M.getRGB)(be);if(!window.matchMedia("(forced-colors: active)").matches)return We;for(const[et,rt]of this._colors)if(rt.every((ot,tt)=>ot===We[tt]))return z._colorsMapping.get(et);return We}getHexCode(be){const We=this._colors.get(be);return We?p.Util.makeHexColor(...We):be}};at(z,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let j=z;t.ColorManager=j;const ft=class ft{constructor(be,We,et,rt,ot,tt){Te(this,q);Te(this,u,null);Te(this,N,new Map);Te(this,re,new Map);Te(this,Q,null);Te(this,oe,null);Te(this,fe,new g);Te(this,O,0);Te(this,Ee,new Set);Te(this,T,null);Te(this,P,null);Te(this,Ce,new Set);Te(this,W,null);Te(this,d,new F);Te(this,m,!1);Te(this,k,!1);Te(this,ye,null);Te(this,ve,p.AnnotationEditorType.NONE);Te(this,X,new Set);Te(this,Se,null);Te(this,Re,this.blur.bind(this));Te(this,Ne,this.focus.bind(this));Te(this,He,this.copy.bind(this));Te(this,ze,this.cut.bind(this));Te(this,qe,this.paste.bind(this));Te(this,Ye,this.keydown.bind(this));Te(this,Oe,this.onEditingAction.bind(this));Te(this,Fe,this.onPageChanging.bind(this));Te(this,Y,this.onScaleChanging.bind(this));Te(this,Ae,this.onRotationChanging.bind(this));Te(this,ke,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Te(this,U,[0,0]);Te(this,o,null);Te(this,H,null);Te(this,te,null);Pe(this,H,be),Pe(this,te,We),Pe(this,Q,et),this._eventBus=rt,this._eventBus._on("editingaction",e(this,Oe)),this._eventBus._on("pagechanging",e(this,Fe)),this._eventBus._on("scalechanging",e(this,Y)),this._eventBus._on("rotationchanging",e(this,Ae)),Pe(this,oe,ot.annotationStorage),Pe(this,W,ot.filterFactory),Pe(this,Se,tt),this.viewParameters={realScale:M.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const be=ft.prototype,We=ot=>{const{activeElement:tt}=document;return tt&&e(ot,H).contains(tt)&&ot.hasSomethingToControl()},et=this.TRANSLATE_SMALL,rt=this.TRANSLATE_BIG;return(0,p.shadow)(this,"_keyboardManager",new r([[["ctrl+a","mac+meta+a"],be.selectAll],[["ctrl+z","mac+meta+z"],be.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],be.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],be.delete],[["Escape","mac+Escape"],be.unselectAll],[["ArrowLeft","mac+ArrowLeft"],be.translateSelectedEditors,{args:[-et,0],checker:We}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],be.translateSelectedEditors,{args:[-rt,0],checker:We}],[["ArrowRight","mac+ArrowRight"],be.translateSelectedEditors,{args:[et,0],checker:We}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],be.translateSelectedEditors,{args:[rt,0],checker:We}],[["ArrowUp","mac+ArrowUp"],be.translateSelectedEditors,{args:[0,-et],checker:We}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],be.translateSelectedEditors,{args:[0,-rt],checker:We}],[["ArrowDown","mac+ArrowDown"],be.translateSelectedEditors,{args:[0,et],checker:We}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],be.translateSelectedEditors,{args:[0,rt],checker:We}]]))}destroy(){Z(this,q,li).call(this),Z(this,q,Oi).call(this),this._eventBus._off("editingaction",e(this,Oe)),this._eventBus._off("pagechanging",e(this,Fe)),this._eventBus._off("scalechanging",e(this,Y)),this._eventBus._off("rotationchanging",e(this,Ae));for(const be of e(this,re).values())be.destroy();e(this,re).clear(),e(this,N).clear(),e(this,Ce).clear(),Pe(this,u,null),e(this,X).clear(),e(this,fe).destroy(),e(this,Q).destroy()}get hcmFilter(){return(0,p.shadow)(this,"hcmFilter",e(this,Se)?e(this,W).addHCMFilter(e(this,Se).foreground,e(this,Se).background):"none")}get direction(){return(0,p.shadow)(this,"direction",getComputedStyle(e(this,H)).direction)}editAltText(be){var We;(We=e(this,Q))==null||We.editAltText(this,be)}onPageChanging({pageNumber:be}){Pe(this,O,be-1)}focusMainContainer(){e(this,H).focus()}findParent(be,We){for(const et of e(this,re).values()){const{x:rt,y:ot,width:tt,height:_e}=et.div.getBoundingClientRect();if(be>=rt&&be<=rt+tt&&We>=ot&&We<=ot+_e)return et}return null}disableUserSelect(be=!1){e(this,te).classList.toggle("noUserSelect",be)}addShouldRescale(be){e(this,Ce).add(be)}removeShouldRescale(be){e(this,Ce).delete(be)}onScaleChanging({scale:be}){this.commitOrRemove(),this.viewParameters.realScale=be*M.PixelsPerInch.PDF_TO_CSS_UNITS;for(const We of e(this,Ce))We.onScaleChanging()}onRotationChanging({pagesRotation:be}){this.commitOrRemove(),this.viewParameters.rotation=be}addToAnnotationStorage(be){!be.isEmpty()&&e(this,oe)&&!e(this,oe).has(be.id)&&e(this,oe).setValue(be.id,be)}blur(){if(!this.hasSelection)return;const{activeElement:be}=document;for(const We of e(this,X))if(We.div.contains(be)){Pe(this,ye,[We,be]),We._focusEventsAllowed=!1;break}}focus(){if(!e(this,ye))return;const[be,We]=e(this,ye);Pe(this,ye,null),We.addEventListener("focusin",()=>{be._focusEventsAllowed=!0},{once:!0}),We.focus()}addEditListeners(){Z(this,q,Ni).call(this),Z(this,q,Bi).call(this)}removeEditListeners(){Z(this,q,li).call(this),Z(this,q,Vi).call(this)}copy(be){var et;if(be.preventDefault(),(et=e(this,u))==null||et.commitOrRemove(),!this.hasSelection)return;const We=[];for(const rt of e(this,X)){const ot=rt.serialize(!0);ot&&We.push(ot)}We.length!==0&&be.clipboardData.setData("application/pdfjs",JSON.stringify(We))}cut(be){this.copy(be),this.delete()}paste(be){be.preventDefault();const{clipboardData:We}=be;for(const ot of We.items)for(const tt of e(this,P))if(tt.isHandlingMimeForPasting(ot.type)){tt.paste(ot,this.currentLayer);return}let et=We.getData("application/pdfjs");if(!et)return;try{et=JSON.parse(et)}catch(ot){(0,p.warn)(`paste: "${ot.message}".`);return}if(!Array.isArray(et))return;this.unselectAll();const rt=this.currentLayer;try{const ot=[];for(const ne of et){const Ie=rt.deserialize(ne);if(!Ie)return;ot.push(Ie)}const tt=()=>{for(const ne of ot)Z(this,q,Ui).call(this,ne);Z(this,q,Hi).call(this,ot)},_e=()=>{for(const ne of ot)ne.remove()};this.addCommands({cmd:tt,undo:_e,mustExec:!0})}catch(ot){(0,p.warn)(`paste: "${ot.message}".`)}}keydown(be){var We;(We=this.getActive())!=null&&We.shouldGetKeyboardEvents()||ft._keyboardManager.exec(this,be)}onEditingAction(be){["undo","redo","delete","selectAll"].includes(be.name)&&this[be.name]()}setEditingState(be){be?(Z(this,q,jn).call(this),Z(this,q,Ni).call(this),Z(this,q,Bi).call(this),Z(this,q,Tt).call(this,{isEditing:e(this,ve)!==p.AnnotationEditorType.NONE,isEmpty:Z(this,q,$t).call(this),hasSomethingToUndo:e(this,fe).hasSomethingToUndo(),hasSomethingToRedo:e(this,fe).hasSomethingToRedo(),hasSelectedEditor:!1})):(Z(this,q,Oi).call(this),Z(this,q,li).call(this),Z(this,q,Vi).call(this),Z(this,q,Tt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(be){if(!e(this,P)){Pe(this,P,be);for(const We of e(this,P))Z(this,q,zt).call(this,We.defaultPropertiesToUpdate)}}getId(){return e(this,d).getId()}get currentLayer(){return e(this,re).get(e(this,O))}getLayer(be){return e(this,re).get(be)}get currentPageIndex(){return e(this,O)}addLayer(be){e(this,re).set(be.pageIndex,be),e(this,m)?be.enable():be.disable()}removeLayer(be){e(this,re).delete(be.pageIndex)}updateMode(be,We=null){if(e(this,ve)!==be){if(Pe(this,ve,be),be===p.AnnotationEditorType.NONE){this.setEditingState(!1),Z(this,q,$n).call(this);return}this.setEditingState(!0),Z(this,q,zn).call(this),this.unselectAll();for(const et of e(this,re).values())et.updateMode(be);if(We){for(const et of e(this,N).values())if(et.annotationElementId===We){this.setSelected(et),et.enterInEditMode();break}}}}updateToolbar(be){be!==e(this,ve)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:be})}updateParams(be,We){if(e(this,P)){if(be===p.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(be);return}for(const et of e(this,X))et.updateParams(be,We);for(const et of e(this,P))et.updateDefaultParams(be,We)}}enableWaiting(be=!1){if(e(this,k)!==be){Pe(this,k,be);for(const We of e(this,re).values())be?We.disableClick():We.enableClick(),We.div.classList.toggle("waiting",be)}}getEditors(be){const We=[];for(const et of e(this,N).values())et.pageIndex===be&&We.push(et);return We}getEditor(be){return e(this,N).get(be)}addEditor(be){e(this,N).set(be.id,be)}removeEditor(be){var We;e(this,N).delete(be.id),this.unselect(be),(!be.annotationElementId||!e(this,Ee).has(be.annotationElementId))&&((We=e(this,oe))==null||We.remove(be.id))}addDeletedAnnotationElement(be){e(this,Ee).add(be.annotationElementId),be.deleted=!0}isDeletedAnnotationElement(be){return e(this,Ee).has(be)}removeDeletedAnnotationElement(be){e(this,Ee).delete(be.annotationElementId),be.deleted=!1}setActiveEditor(be){e(this,u)!==be&&(Pe(this,u,be),be&&Z(this,q,zt).call(this,be.propertiesToUpdate))}toggleSelected(be){if(e(this,X).has(be)){e(this,X).delete(be),be.unselect(),Z(this,q,Tt).call(this,{hasSelectedEditor:this.hasSelection});return}e(this,X).add(be),be.select(),Z(this,q,zt).call(this,be.propertiesToUpdate),Z(this,q,Tt).call(this,{hasSelectedEditor:!0})}setSelected(be){for(const We of e(this,X))We!==be&&We.unselect();e(this,X).clear(),e(this,X).add(be),be.select(),Z(this,q,zt).call(this,be.propertiesToUpdate),Z(this,q,Tt).call(this,{hasSelectedEditor:!0})}isSelected(be){return e(this,X).has(be)}unselect(be){be.unselect(),e(this,X).delete(be),Z(this,q,Tt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return e(this,X).size!==0}undo(){e(this,fe).undo(),Z(this,q,Tt).call(this,{hasSomethingToUndo:e(this,fe).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Z(this,q,$t).call(this)})}redo(){e(this,fe).redo(),Z(this,q,Tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:e(this,fe).hasSomethingToRedo(),isEmpty:Z(this,q,$t).call(this)})}addCommands(be){e(this,fe).add(be),Z(this,q,Tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Z(this,q,$t).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const be=[...e(this,X)],We=()=>{for(const rt of be)rt.remove()},et=()=>{for(const rt of be)Z(this,q,Ui).call(this,rt)};this.addCommands({cmd:We,undo:et,mustExec:!0})}commitOrRemove(){var be;(be=e(this,u))==null||be.commitOrRemove()}hasSomethingToControl(){return e(this,u)||this.hasSelection}selectAll(){for(const be of e(this,X))be.commit();Z(this,q,Hi).call(this,e(this,N).values())}unselectAll(){if(e(this,u)){e(this,u).commitOrRemove();return}if(this.hasSelection){for(const be of e(this,X))be.unselect();e(this,X).clear(),Z(this,q,Tt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(be,We,et=!1){if(et||this.commitOrRemove(),!this.hasSelection)return;e(this,U)[0]+=be,e(this,U)[1]+=We;const[rt,ot]=e(this,U),tt=[...e(this,X)],_e=1e3;e(this,o)&&clearTimeout(e(this,o)),Pe(this,o,setTimeout(()=>{Pe(this,o,null),e(this,U)[0]=e(this,U)[1]=0,this.addCommands({cmd:()=>{for(const ne of tt)e(this,N).has(ne.id)&&ne.translateInPage(rt,ot)},undo:()=>{for(const ne of tt)e(this,N).has(ne.id)&&ne.translateInPage(-rt,-ot)},mustExec:!1})},_e));for(const ne of tt)ne.translateInPage(be,We)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Pe(this,T,new Map);for(const be of e(this,X))e(this,T).set(be,{savedX:be.x,savedY:be.y,savedPageIndex:be.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!e(this,T))return!1;this.disableUserSelect(!1);const be=e(this,T);Pe(this,T,null);let We=!1;for(const[{x:rt,y:ot,pageIndex:tt},_e]of be)_e.newX=rt,_e.newY=ot,_e.newPageIndex=tt,We||(We=rt!==_e.savedX||ot!==_e.savedY||tt!==_e.savedPageIndex);if(!We)return!1;const et=(rt,ot,tt,_e)=>{if(e(this,N).has(rt.id)){const ne=e(this,re).get(_e);ne?rt._setParentAndPosition(ne,ot,tt):(rt.pageIndex=_e,rt.x=ot,rt.y=tt)}};return this.addCommands({cmd:()=>{for(const[rt,{newX:ot,newY:tt,newPageIndex:_e}]of be)et(rt,ot,tt,_e)},undo:()=>{for(const[rt,{savedX:ot,savedY:tt,savedPageIndex:_e}]of be)et(rt,ot,tt,_e)},mustExec:!0}),!0}dragSelectedEditors(be,We){if(e(this,T))for(const et of e(this,T).keys())et.drag(be,We)}rebuild(be){if(be.parent===null){const We=this.getLayer(be.pageIndex);We?(We.changeParent(be),We.addOrRebuild(be)):(this.addEditor(be),this.addToAnnotationStorage(be),be.rebuild())}else be.parent.addOrRebuild(be)}isActive(be){return e(this,u)===be}getActive(){return e(this,u)}getMode(){return e(this,ve)}get imageManager(){return(0,p.shadow)(this,"imageManager",new D)}};u=new WeakMap,N=new WeakMap,re=new WeakMap,Q=new WeakMap,oe=new WeakMap,fe=new WeakMap,O=new WeakMap,Ee=new WeakMap,T=new WeakMap,P=new WeakMap,Ce=new WeakMap,W=new WeakMap,d=new WeakMap,m=new WeakMap,k=new WeakMap,ye=new WeakMap,ve=new WeakMap,X=new WeakMap,Se=new WeakMap,Re=new WeakMap,Ne=new WeakMap,He=new WeakMap,ze=new WeakMap,qe=new WeakMap,Ye=new WeakMap,Oe=new WeakMap,Fe=new WeakMap,Y=new WeakMap,Ae=new WeakMap,ke=new WeakMap,U=new WeakMap,o=new WeakMap,H=new WeakMap,te=new WeakMap,q=new WeakSet,jn=function(){window.addEventListener("focus",e(this,Ne)),window.addEventListener("blur",e(this,Re))},Oi=function(){window.removeEventListener("focus",e(this,Ne)),window.removeEventListener("blur",e(this,Re))},Ni=function(){window.addEventListener("keydown",e(this,Ye),{capture:!0})},li=function(){window.removeEventListener("keydown",e(this,Ye),{capture:!0})},Bi=function(){document.addEventListener("copy",e(this,He)),document.addEventListener("cut",e(this,ze)),document.addEventListener("paste",e(this,qe))},Vi=function(){document.removeEventListener("copy",e(this,He)),document.removeEventListener("cut",e(this,ze)),document.removeEventListener("paste",e(this,qe))},Tt=function(be){Object.entries(be).some(([et,rt])=>e(this,ke)[et]!==rt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(e(this,ke),be)})},zt=function(be){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:be})},zn=function(){if(!e(this,m)){Pe(this,m,!0);for(const be of e(this,re).values())be.enable()}},$n=function(){if(this.unselectAll(),e(this,m)){Pe(this,m,!1);for(const be of e(this,re).values())be.disable()}},Ui=function(be){const We=e(this,re).get(be.pageIndex);We?We.addOrRebuild(be):this.addEditor(be)},$t=function(){if(e(this,N).size===0)return!0;if(e(this,N).size===1)for(const be of e(this,N).values())return be.isEmpty();return!1},Hi=function(be){e(this,X).clear();for(const We of be)We.isEmpty()||(e(this,X).add(We),We.select());Z(this,q,Tt).call(this,{hasSelectedEditor:!0})},at(ft,"TRANSLATE_SMALL",1),at(ft,"TRANSLATE_BIG",10);let I=ft;t.AnnotationEditorUIManager=I},(we,t,le)=>{var O,Ee,T,P,Ce,W,d,m,k,ye,ve,X,Bt,Vt,Wi,ci,hi,Gt,Xt;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=s,t.getColorValues=N,t.getCurrentTransform=re,t.getCurrentTransformInverse=Q,t.getFilenameFromUrl=y,t.getPdfFilenameFromUrl=_,t.getRGB=u,t.getXfaPageViewport=z,t.isDataScheme=w,t.isPdfFile=E,t.isValidFetchUrl=S,t.loadScript=i,t.noContextMenu=n,t.setLayerDimensions=oe;var p=le(7),M=le(1);const Me="http://www.w3.org/2000/svg",fe=class fe{};at(fe,"CSS",96),at(fe,"PDF",72),at(fe,"PDF_TO_CSS_UNITS",fe.CSS/fe.PDF);let J=fe;t.PixelsPerInch=J;class F extends p.BaseFilterFactory{constructor({docId:Y,ownerDocument:Ae=globalThis.document}={}){super();Te(this,X);Te(this,O);Te(this,Ee);Te(this,T);Te(this,P);Te(this,Ce);Te(this,W);Te(this,d);Te(this,m);Te(this,k);Te(this,ye);Te(this,ve,0);Pe(this,T,Y),Pe(this,P,Ae)}addFilter(Y){if(!Y)return"none";let Ae=e(this,X,Bt).get(Y);if(Ae)return Ae;let ke,U,o,H;if(Y.length===1){const De=Y[0],Ge=new Array(256);for(let Ve=0;Ve<256;Ve++)Ge[Ve]=De[Ve]/255;H=ke=U=o=Ge.join(",")}else{const[De,Ge,Ve]=Y,Je=new Array(256),Ze=new Array(256),it=new Array(256);for(let pt=0;pt<256;pt++)Je[pt]=De[pt]/255,Ze[pt]=Ge[pt]/255,it[pt]=Ve[pt]/255;ke=Je.join(","),U=Ze.join(","),o=it.join(","),H=`${ke}${U}${o}`}if(Ae=e(this,X,Bt).get(H),Ae)return e(this,X,Bt).set(Y,Ae),Ae;const te=`g_${e(this,T)}_transfer_map_${Ot(this,ve)._++}`,q=`url(#${te})`;e(this,X,Bt).set(Y,q),e(this,X,Bt).set(H,q);const Le=Z(this,X,ci).call(this,te);return Z(this,X,Gt).call(this,ke,U,o,Le),q}addHCMFilter(Y,Ae){var Ge;const ke=`${Y}-${Ae}`;if(e(this,W)===ke)return e(this,d);if(Pe(this,W,ke),Pe(this,d,"none"),(Ge=e(this,Ce))==null||Ge.remove(),!Y||!Ae)return e(this,d);const U=Z(this,X,Xt).call(this,Y);Y=M.Util.makeHexColor(...U);const o=Z(this,X,Xt).call(this,Ae);if(Ae=M.Util.makeHexColor(...o),e(this,X,Vt).style.color="",Y==="#000000"&&Ae==="#ffffff"||Y===Ae)return e(this,d);const H=new Array(256);for(let Ve=0;Ve<=255;Ve++){const Je=Ve/255;H[Ve]=Je<=.03928?Je/12.92:((Je+.055)/1.055)**2.4}const te=H.join(","),q=`g_${e(this,T)}_hcm_filter`,Le=Pe(this,m,Z(this,X,ci).call(this,q));Z(this,X,Gt).call(this,te,te,te,Le),Z(this,X,Wi).call(this,Le);const De=(Ve,Je)=>{const Ze=U[Ve]/255,it=o[Ve]/255,pt=new Array(Je+1);for(let mt=0;mt<=Je;mt++)pt[mt]=Ze+mt/Je*(it-Ze);return pt.join(",")};return Z(this,X,Gt).call(this,De(0,5),De(1,5),De(2,5),Le),Pe(this,d,`url(#${q})`),e(this,d)}addHighlightHCMFilter(Y,Ae,ke,U){var it;const o=`${Y}-${Ae}-${ke}-${U}`;if(e(this,k)===o)return e(this,ye);if(Pe(this,k,o),Pe(this,ye,"none"),(it=e(this,m))==null||it.remove(),!Y||!Ae)return e(this,ye);const[H,te]=[Y,Ae].map(Z(this,X,Xt).bind(this));let q=Math.round(.2126*H[0]+.7152*H[1]+.0722*H[2]),Le=Math.round(.2126*te[0]+.7152*te[1]+.0722*te[2]),[De,Ge]=[ke,U].map(Z(this,X,Xt).bind(this));Le<q&&([q,Le,De,Ge]=[Le,q,Ge,De]),e(this,X,Vt).style.color="";const Ve=(pt,mt,Xe)=>{const Be=new Array(256),Ue=(Le-q)/Xe,nt=pt/255,ft=(mt-pt)/(255*Xe);let ut=0;for(let be=0;be<=Xe;be++){const We=Math.round(q+be*Ue),et=nt+be*ft;for(let rt=ut;rt<=We;rt++)Be[rt]=et;ut=We+1}for(let be=ut;be<256;be++)Be[be]=Be[ut-1];return Be.join(",")},Je=`g_${e(this,T)}_hcm_highlight_filter`,Ze=Pe(this,m,Z(this,X,ci).call(this,Je));return Z(this,X,Wi).call(this,Ze),Z(this,X,Gt).call(this,Ve(De[0],Ge[0],5),Ve(De[1],Ge[1],5),Ve(De[2],Ge[2],5),Ze),Pe(this,ye,`url(#${Je})`),e(this,ye)}destroy(Y=!1){Y&&(e(this,d)||e(this,ye))||(e(this,Ee)&&(e(this,Ee).parentNode.parentNode.remove(),Pe(this,Ee,null)),e(this,O)&&(e(this,O).clear(),Pe(this,O,null)),Pe(this,ve,0))}}O=new WeakMap,Ee=new WeakMap,T=new WeakMap,P=new WeakMap,Ce=new WeakMap,W=new WeakMap,d=new WeakMap,m=new WeakMap,k=new WeakMap,ye=new WeakMap,ve=new WeakMap,X=new WeakSet,Bt=function(){return e(this,O)||Pe(this,O,new Map)},Vt=function(){if(!e(this,Ee)){const Y=e(this,P).createElement("div"),{style:Ae}=Y;Ae.visibility="hidden",Ae.contain="strict",Ae.width=Ae.height=0,Ae.position="absolute",Ae.top=Ae.left=0,Ae.zIndex=-1;const ke=e(this,P).createElementNS(Me,"svg");ke.setAttribute("width",0),ke.setAttribute("height",0),Pe(this,Ee,e(this,P).createElementNS(Me,"defs")),Y.append(ke),ke.append(e(this,Ee)),e(this,P).body.append(Y)}return e(this,Ee)},Wi=function(Y){const Ae=e(this,P).createElementNS(Me,"feColorMatrix");Ae.setAttribute("type","matrix"),Ae.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Y.append(Ae)},ci=function(Y){const Ae=e(this,P).createElementNS(Me,"filter");return Ae.setAttribute("color-interpolation-filters","sRGB"),Ae.setAttribute("id",Y),e(this,X,Vt).append(Ae),Ae},hi=function(Y,Ae,ke){const U=e(this,P).createElementNS(Me,Ae);U.setAttribute("type","discrete"),U.setAttribute("tableValues",ke),Y.append(U)},Gt=function(Y,Ae,ke,U){const o=e(this,P).createElementNS(Me,"feComponentTransfer");U.append(o),Z(this,X,hi).call(this,o,"feFuncR",Y),Z(this,X,hi).call(this,o,"feFuncG",Ae),Z(this,X,hi).call(this,o,"feFuncB",ke)},Xt=function(Y){return e(this,X,Vt).style.color=Y,u(getComputedStyle(e(this,X,Vt)).getPropertyValue("color"))},t.DOMFilterFactory=F;class D extends p.BaseCanvasFactory{constructor({ownerDocument:Fe=globalThis.document}={}){super(),this._document=Fe}_createCanvas(Fe,Y){const Ae=this._document.createElement("canvas");return Ae.width=Fe,Ae.height=Y,Ae}}t.DOMCanvasFactory=D;async function g(Oe,Fe=!1){if(S(Oe,document.baseURI)){const Y=await fetch(Oe);if(!Y.ok)throw new Error(Y.statusText);return Fe?new Uint8Array(await Y.arrayBuffer()):(0,M.stringToBytes)(await Y.text())}return new Promise((Y,Ae)=>{const ke=new XMLHttpRequest;ke.open("GET",Oe,!0),Fe&&(ke.responseType="arraybuffer"),ke.onreadystatechange=()=>{if(ke.readyState===XMLHttpRequest.DONE){if(ke.status===200||ke.status===0){let U;if(Fe&&ke.response?U=new Uint8Array(ke.response):!Fe&&ke.responseText&&(U=(0,M.stringToBytes)(ke.responseText)),U){Y(U);return}}Ae(new Error(ke.statusText))}},ke.send(null)})}class r extends p.BaseCMapReaderFactory{_fetchData(Fe,Y){return g(Fe,this.isCompressed).then(Ae=>({cMapData:Ae,compressionType:Y}))}}t.DOMCMapReaderFactory=r;class j extends p.BaseStandardFontDataFactory{_fetchData(Fe){return g(Fe,!0)}}t.DOMStandardFontDataFactory=j;class I extends p.BaseSVGFactory{_createSVG(Fe){return document.createElementNS(Me,Fe)}}t.DOMSVGFactory=I;class f{constructor({viewBox:Fe,scale:Y,rotation:Ae,offsetX:ke=0,offsetY:U=0,dontFlip:o=!1}){this.viewBox=Fe,this.scale=Y,this.rotation=Ae,this.offsetX=ke,this.offsetY=U;const H=(Fe[2]+Fe[0])/2,te=(Fe[3]+Fe[1])/2;let q,Le,De,Ge;switch(Ae%=360,Ae<0&&(Ae+=360),Ae){case 180:q=-1,Le=0,De=0,Ge=1;break;case 90:q=0,Le=1,De=1,Ge=0;break;case 270:q=0,Le=-1,De=-1,Ge=0;break;case 0:q=1,Le=0,De=0,Ge=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(De=-De,Ge=-Ge);let Ve,Je,Ze,it;q===0?(Ve=Math.abs(te-Fe[1])*Y+ke,Je=Math.abs(H-Fe[0])*Y+U,Ze=(Fe[3]-Fe[1])*Y,it=(Fe[2]-Fe[0])*Y):(Ve=Math.abs(H-Fe[0])*Y+ke,Je=Math.abs(te-Fe[1])*Y+U,Ze=(Fe[2]-Fe[0])*Y,it=(Fe[3]-Fe[1])*Y),this.transform=[q*Y,Le*Y,De*Y,Ge*Y,Ve-q*Y*H-De*Y*te,Je-Le*Y*H-Ge*Y*te],this.width=Ze,this.height=it}get rawDims(){const{viewBox:Fe}=this;return(0,M.shadow)(this,"rawDims",{pageWidth:Fe[2]-Fe[0],pageHeight:Fe[3]-Fe[1],pageX:Fe[0],pageY:Fe[1]})}clone({scale:Fe=this.scale,rotation:Y=this.rotation,offsetX:Ae=this.offsetX,offsetY:ke=this.offsetY,dontFlip:U=!1}={}){return new f({viewBox:this.viewBox.slice(),scale:Fe,rotation:Y,offsetX:Ae,offsetY:ke,dontFlip:U})}convertToViewportPoint(Fe,Y){return M.Util.applyTransform([Fe,Y],this.transform)}convertToViewportRectangle(Fe){const Y=M.Util.applyTransform([Fe[0],Fe[1]],this.transform),Ae=M.Util.applyTransform([Fe[2],Fe[3]],this.transform);return[Y[0],Y[1],Ae[0],Ae[1]]}convertToPdfPoint(Fe,Y){return M.Util.applyInverseTransform([Fe,Y],this.transform)}}t.PageViewport=f;class h extends M.BaseException{constructor(Fe,Y=0){super(Fe,"RenderingCancelledException"),this.extraDelay=Y}}t.RenderingCancelledException=h;function w(Oe){const Fe=Oe.length;let Y=0;for(;Y<Fe&&Oe[Y].trim()==="";)Y++;return Oe.substring(Y,Y+5).toLowerCase()==="data:"}function E(Oe){return typeof Oe=="string"&&/\.pdf$/i.test(Oe)}function y(Oe,Fe=!1){return Fe||([Oe]=Oe.split(/[#?]/,1)),Oe.substring(Oe.lastIndexOf("/")+1)}function _(Oe,Fe="document.pdf"){if(typeof Oe!="string")return Fe;if(w(Oe))return(0,M.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Fe;const Y=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Ae=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ke=Y.exec(Oe);let U=Ae.exec(ke[1])||Ae.exec(ke[2])||Ae.exec(ke[3]);if(U&&(U=U[0],U.includes("%")))try{U=Ae.exec(decodeURIComponent(U))[0]}catch{}return U||Fe}class x{constructor(){at(this,"started",Object.create(null));at(this,"times",[])}time(Fe){Fe in this.started&&(0,M.warn)(`Timer is already running for ${Fe}`),this.started[Fe]=Date.now()}timeEnd(Fe){Fe in this.started||(0,M.warn)(`Timer has not been started for ${Fe}`),this.times.push({name:Fe,start:this.started[Fe],end:Date.now()}),delete this.started[Fe]}toString(){const Fe=[];let Y=0;for(const{name:Ae}of this.times)Y=Math.max(Ae.length,Y);for(const{name:Ae,start:ke,end:U}of this.times)Fe.push(`${Ae.padEnd(Y)} ${U-ke}ms
`);return Fe.join("")}}t.StatTimer=x;function S(Oe,Fe){try{const{protocol:Y}=Fe?new URL(Oe,Fe):new URL(Oe);return Y==="http:"||Y==="https:"}catch{return!1}}function n(Oe){Oe.preventDefault()}function i(Oe,Fe=!1){return new Promise((Y,Ae)=>{const ke=document.createElement("script");ke.src=Oe,ke.onload=function(U){Fe&&ke.remove(),Y(U)},ke.onerror=function(){Ae(new Error(`Cannot load script at: ${ke.src}`))},(document.head||document.documentElement).append(ke)})}function s(Oe){console.log("Deprecated API usage: "+Oe)}let c;class v{static toDateObject(Fe){if(!Fe||typeof Fe!="string")return null;c||(c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Y=c.exec(Fe);if(!Y)return null;const Ae=parseInt(Y[1],10);let ke=parseInt(Y[2],10);ke=ke>=1&&ke<=12?ke-1:0;let U=parseInt(Y[3],10);U=U>=1&&U<=31?U:1;let o=parseInt(Y[4],10);o=o>=0&&o<=23?o:0;let H=parseInt(Y[5],10);H=H>=0&&H<=59?H:0;let te=parseInt(Y[6],10);te=te>=0&&te<=59?te:0;const q=Y[7]||"Z";let Le=parseInt(Y[8],10);Le=Le>=0&&Le<=23?Le:0;let De=parseInt(Y[9],10)||0;return De=De>=0&&De<=59?De:0,q==="-"?(o+=Le,H+=De):q==="+"&&(o-=Le,H-=De),new Date(Date.UTC(Ae,ke,U,o,H,te))}}t.PDFDateString=v;function z(Oe,{scale:Fe=1,rotation:Y=0}){const{width:Ae,height:ke}=Oe.attributes.style,U=[0,0,parseInt(Ae),parseInt(ke)];return new f({viewBox:U,scale:Fe,rotation:Y})}function u(Oe){if(Oe.startsWith("#")){const Fe=parseInt(Oe.slice(1),16);return[(Fe&16711680)>>16,(Fe&65280)>>8,Fe&255]}return Oe.startsWith("rgb(")?Oe.slice(4,-1).split(",").map(Fe=>parseInt(Fe)):Oe.startsWith("rgba(")?Oe.slice(5,-1).split(",").map(Fe=>parseInt(Fe)).slice(0,3):((0,M.warn)(`Not a valid color format: "${Oe}"`),[0,0,0])}function N(Oe){const Fe=document.createElement("span");Fe.style.visibility="hidden",document.body.append(Fe);for(const Y of Oe.keys()){Fe.style.color=Y;const Ae=window.getComputedStyle(Fe).color;Oe.set(Y,u(Ae))}Fe.remove()}function re(Oe){const{a:Fe,b:Y,c:Ae,d:ke,e:U,f:o}=Oe.getTransform();return[Fe,Y,Ae,ke,U,o]}function Q(Oe){const{a:Fe,b:Y,c:Ae,d:ke,e:U,f:o}=Oe.getTransform().invertSelf();return[Fe,Y,Ae,ke,U,o]}function oe(Oe,Fe,Y=!1,Ae=!0){if(Fe instanceof f){const{pageWidth:ke,pageHeight:U}=Fe.rawDims,{style:o}=Oe,H=M.FeatureTest.isCSSRoundSupported,te=`var(--scale-factor) * ${ke}px`,q=`var(--scale-factor) * ${U}px`,Le=H?`round(${te}, 1px)`:`calc(${te})`,De=H?`round(${q}, 1px)`:`calc(${q})`;!Y||Fe.rotation%180===0?(o.width=Le,o.height=De):(o.width=De,o.height=Le)}Ae&&Oe.setAttribute("data-main-rotation",Fe.rotation)}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var p=le(1);class M{constructor(){this.constructor===M&&(0,p.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(r){return"none"}addHCMFilter(r,j){return"none"}addHighlightHCMFilter(r,j,I,f){return"none"}destroy(r=!1){}}t.BaseFilterFactory=M;class Me{constructor(){this.constructor===Me&&(0,p.unreachable)("Cannot initialize BaseCanvasFactory.")}create(r,j){if(r<=0||j<=0)throw new Error("Invalid canvas size");const I=this._createCanvas(r,j);return{canvas:I,context:I.getContext("2d")}}reset(r,j,I){if(!r.canvas)throw new Error("Canvas is not specified");if(j<=0||I<=0)throw new Error("Invalid canvas size");r.canvas.width=j,r.canvas.height=I}destroy(r){if(!r.canvas)throw new Error("Canvas is not specified");r.canvas.width=0,r.canvas.height=0,r.canvas=null,r.context=null}_createCanvas(r,j){(0,p.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=Me;class J{constructor({baseUrl:r=null,isCompressed:j=!0}){this.constructor===J&&(0,p.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=r,this.isCompressed=j}async fetch({name:r}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!r)throw new Error("CMap name must be specified.");const j=this.baseUrl+r+(this.isCompressed?".bcmap":""),I=this.isCompressed?p.CMapCompressionType.BINARY:p.CMapCompressionType.NONE;return this._fetchData(j,I).catch(f=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(r,j){(0,p.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=J;class F{constructor({baseUrl:r=null}){this.constructor===F&&(0,p.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=r}async fetch({filename:r}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!r)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${r}`;return this._fetchData(j).catch(I=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(r){(0,p.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=F;class D{constructor(){this.constructor===D&&(0,p.unreachable)("Cannot initialize BaseSVGFactory.")}create(r,j,I=!1){if(r<=0||j<=0)throw new Error("Invalid SVG dimensions");const f=this._createSVG("svg:svg");return f.setAttribute("version","1.1"),I||(f.setAttribute("width",`${r}px`),f.setAttribute("height",`${j}px`)),f.setAttribute("preserveAspectRatio","none"),f.setAttribute("viewBox",`0 0 ${r} ${j}`),f}createElement(r){if(typeof r!="string")throw new Error("Invalid SVG element type");return this._createSVG(r)}_createSVG(r){(0,p.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=D},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var p=le(1);const M=3285377520,Me=4294901760,J=65535;class F{constructor(g){this.h1=g?g&4294967295:M,this.h2=g?g&4294967295:M}update(g){let r,j;if(typeof g=="string"){r=new Uint8Array(g.length*2),j=0;for(let s=0,c=g.length;s<c;s++){const v=g.charCodeAt(s);v<=255?r[j++]=v:(r[j++]=v>>>8,r[j++]=v&255)}}else if((0,p.isArrayBuffer)(g))r=g.slice(),j=r.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const I=j>>2,f=j-I*4,h=new Uint32Array(r.buffer,0,I);let w=0,E=0,y=this.h1,_=this.h2;const x=3432918353,S=461845907,n=x&J,i=S&J;for(let s=0;s<I;s++)s&1?(w=h[s],w=w*x&Me|w*n&J,w=w<<15|w>>>17,w=w*S&Me|w*i&J,y^=w,y=y<<13|y>>>19,y=y*5+3864292196):(E=h[s],E=E*x&Me|E*n&J,E=E<<15|E>>>17,E=E*S&Me|E*i&J,_^=E,_=_<<13|_>>>19,_=_*5+3864292196);switch(w=0,f){case 3:w^=r[I*4+2]<<16;case 2:w^=r[I*4+1]<<8;case 1:w^=r[I*4],w=w*x&Me|w*n&J,w=w<<15|w>>>17,w=w*S&Me|w*i&J,I&1?y^=w:_^=w}this.h1=y,this.h2=_}hexdigest(){let g=this.h1,r=this.h2;return g^=r>>>1,g=g*3981806797&Me|g*36045&J,r=r*4283543511&Me|((r<<16|g>>>16)*2950163797&Me)>>>16,g^=r>>>1,g=g*444984403&Me|g*60499&J,r=r*3301882366&Me|((r<<16|g>>>16)*3120437893&Me)>>>16,g^=r>>>1,(g>>>0).toString(16).padStart(8,"0")+(r>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=F},(we,t,le)=>{var J;Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var p=le(1);class M{constructor({ownerDocument:D=globalThis.document,styleElement:g=null}){Te(this,J,new Set);this._document=D,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(D){this.nativeFontFaces.add(D),this._document.fonts.add(D)}removeNativeFontFace(D){this.nativeFontFaces.delete(D),this._document.fonts.delete(D)}insertRule(D){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const g=this.styleElement.sheet;g.insertRule(D,g.cssRules.length)}clear(){for(const D of this.nativeFontFaces)this._document.fonts.delete(D);this.nativeFontFaces.clear(),e(this,J).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(D){if(!(!D||e(this,J).has(D.loadedName))){if((0,p.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:g,src:r,style:j}=D,I=new FontFace(g,r,j);this.addNativeFontFace(I);try{await I.load(),e(this,J).add(g)}catch{(0,p.warn)(`Cannot load system font: ${D.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(I)}return}(0,p.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(D){if(D.attached||D.missingFile&&!D.systemFontInfo)return;if(D.attached=!0,D.systemFontInfo){await this.loadSystemFont(D.systemFontInfo);return}if(this.isFontLoadingAPISupported){const r=D.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(j){throw(0,p.warn)(`Failed to load font '${r.family}': '${j}'.`),D.disableFontFace=!0,j}}return}const g=D.createFontFaceRule();if(g){if(this.insertRule(g),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const j=this._queueLoadingCallback(r);this._prepareFontLoadEvent(D,j)})}}get isFontLoadingAPISupported(){var g;const D=!!((g=this._document)!=null&&g.fonts);return(0,p.shadow)(this,"isFontLoadingAPISupported",D)}get isSyncFontLoadingSupported(){let D=!1;return(p.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(D=!0),(0,p.shadow)(this,"isSyncFontLoadingSupported",D)}_queueLoadingCallback(D){function g(){for((0,p.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;r.length>0&&r[0].done;){const I=r.shift();setTimeout(I.callback,0)}}const{loadingRequests:r}=this,j={done:!1,complete:g,callback:D};return r.push(j),j}get _loadTestFont(){const D=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,p.shadow)(this,"_loadTestFont",D)}_prepareFontLoadEvent(D,g){function r(u,N){return u.charCodeAt(N)<<24|u.charCodeAt(N+1)<<16|u.charCodeAt(N+2)<<8|u.charCodeAt(N+3)&255}function j(u,N,re,Q){const oe=u.substring(0,N),fe=u.substring(N+re);return oe+Q+fe}let I,f;const h=this._document.createElement("canvas");h.width=1,h.height=1;const w=h.getContext("2d");let E=0;function y(u,N){if(++E>30){(0,p.warn)("Load test font never loaded."),N();return}if(w.font="30px "+u,w.fillText(".",0,20),w.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(y.bind(null,u,N))}const _=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=j(x,976,_.length,_);const n=16,i=1482184792;let s=r(x,n);for(I=0,f=_.length-3;I<f;I+=4)s=s-i+r(_,I)|0;I<_.length&&(s=s-i+r(_+"XXX",I)|0),x=j(x,n,4,(0,p.string32)(s));const c=`url(data:font/opentype;base64,${btoa(x)});`,v=`@font-face {font-family:"${_}";src:${c}}`;this.insertRule(v);const z=this._document.createElement("div");z.style.visibility="hidden",z.style.width=z.style.height="10px",z.style.position="absolute",z.style.top=z.style.left="0px";for(const u of[D.loadedName,_]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=u,z.append(N)}this._document.body.append(z),y(_,()=>{z.remove(),g.complete()})}}J=new WeakMap,t.FontLoader=M;class Me{constructor(D,{isEvalSupported:g=!0,disableFontFace:r=!1,ignoreErrors:j=!1,inspectFont:I=null}){this.compiledGlyphs=Object.create(null);for(const f in D)this[f]=D[f];this.isEvalSupported=g!==!1,this.disableFontFace=r===!0,this.ignoreErrors=j===!0,this._inspectFont=I}createNativeFontFace(){var g;if(!this.data||this.disableFontFace)return null;let D;if(!this.cssFontInfo)D=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),D=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(g=this._inspectFont)==null||g.call(this,this),D}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const D=(0,p.bytesToString)(this.data),g=`url(data:${this.mimetype};base64,${btoa(D)});`;let r;if(!this.cssFontInfo)r=`@font-face {font-family:"${this.loadedName}";src:${g}}`;else{let I=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(I+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),r=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${I}src:${g}}`}return(j=this._inspectFont)==null||j.call(this,this,g),r}getPathGenerator(D,g){if(this.compiledGlyphs[g]!==void 0)return this.compiledGlyphs[g];let r;try{r=D.get(this.loadedName+"_path_"+g)}catch(j){if(!this.ignoreErrors)throw j;return(0,p.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[g]=function(I,f){}}if(this.isEvalSupported&&p.FeatureTest.isEvalSupported){const j=[];for(const I of r){const f=I.args!==void 0?I.args.join(","):"";j.push("c.",I.cmd,"(",f,`);
`)}return this.compiledGlyphs[g]=new Function("c","size",j.join(""))}return this.compiledGlyphs[g]=function(j,I){for(const f of r)f.cmd==="scale"&&(f.args=[I,-I]),j[f.cmd].apply(j,f.args)}}}t.FontFaceObject=Me},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var p=le(7);le(1);const M=function(g){return new Promise((r,j)=>{require$$5.readFile(g,(f,h)=>{if(f||!h){j(new Error(f));return}r(new Uint8Array(h))})})};class Me extends p.BaseFilterFactory{}t.NodeFilterFactory=Me;class J extends p.BaseCanvasFactory{_createCanvas(r,j){return require$$5.createCanvas(r,j)}}t.NodeCanvasFactory=J;class F extends p.BaseCMapReaderFactory{_fetchData(r,j){return M(r).then(I=>({cMapData:I,compressionType:j}))}}t.NodeCMapReaderFactory=F;class D extends p.BaseStandardFontDataFactory{_fetchData(r){return M(r)}}t.NodeStandardFontDataFactory=D},(we,t,le)=>{var Ee,ji,zi;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var p=le(1),M=le(6),Me=le(12),J=le(13);const F=16,D=100,g=4096,r=15,j=10,I=1e3,f=16;function h(W,d){if(W._removeMirroring)throw new Error("Context is already forwarding operations.");W.__originalSave=W.save,W.__originalRestore=W.restore,W.__originalRotate=W.rotate,W.__originalScale=W.scale,W.__originalTranslate=W.translate,W.__originalTransform=W.transform,W.__originalSetTransform=W.setTransform,W.__originalResetTransform=W.resetTransform,W.__originalClip=W.clip,W.__originalMoveTo=W.moveTo,W.__originalLineTo=W.lineTo,W.__originalBezierCurveTo=W.bezierCurveTo,W.__originalRect=W.rect,W.__originalClosePath=W.closePath,W.__originalBeginPath=W.beginPath,W._removeMirroring=()=>{W.save=W.__originalSave,W.restore=W.__originalRestore,W.rotate=W.__originalRotate,W.scale=W.__originalScale,W.translate=W.__originalTranslate,W.transform=W.__originalTransform,W.setTransform=W.__originalSetTransform,W.resetTransform=W.__originalResetTransform,W.clip=W.__originalClip,W.moveTo=W.__originalMoveTo,W.lineTo=W.__originalLineTo,W.bezierCurveTo=W.__originalBezierCurveTo,W.rect=W.__originalRect,W.closePath=W.__originalClosePath,W.beginPath=W.__originalBeginPath,delete W._removeMirroring},W.save=function(){d.save(),this.__originalSave()},W.restore=function(){d.restore(),this.__originalRestore()},W.translate=function(k,ye){d.translate(k,ye),this.__originalTranslate(k,ye)},W.scale=function(k,ye){d.scale(k,ye),this.__originalScale(k,ye)},W.transform=function(k,ye,ve,X,Se,Re){d.transform(k,ye,ve,X,Se,Re),this.__originalTransform(k,ye,ve,X,Se,Re)},W.setTransform=function(k,ye,ve,X,Se,Re){d.setTransform(k,ye,ve,X,Se,Re),this.__originalSetTransform(k,ye,ve,X,Se,Re)},W.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},W.rotate=function(k){d.rotate(k),this.__originalRotate(k)},W.clip=function(k){d.clip(k),this.__originalClip(k)},W.moveTo=function(m,k){d.moveTo(m,k),this.__originalMoveTo(m,k)},W.lineTo=function(m,k){d.lineTo(m,k),this.__originalLineTo(m,k)},W.bezierCurveTo=function(m,k,ye,ve,X,Se){d.bezierCurveTo(m,k,ye,ve,X,Se),this.__originalBezierCurveTo(m,k,ye,ve,X,Se)},W.rect=function(m,k,ye,ve){d.rect(m,k,ye,ve),this.__originalRect(m,k,ye,ve)},W.closePath=function(){d.closePath(),this.__originalClosePath()},W.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}class w{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,m,k){let ye;return this.cache[d]!==void 0?(ye=this.cache[d],this.canvasFactory.reset(ye,m,k)):(ye=this.canvasFactory.create(m,k),this.cache[d]=ye),ye}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const m=this.cache[d];this.canvasFactory.destroy(m),delete this.cache[d]}}}function E(W,d,m,k,ye,ve,X,Se,Re,Ne){const[He,ze,qe,Ye,Oe,Fe]=(0,M.getCurrentTransform)(W);if(ze===0&&qe===0){const ke=X*He+Oe,U=Math.round(ke),o=Se*Ye+Fe,H=Math.round(o),te=(X+Re)*He+Oe,q=Math.abs(Math.round(te)-U)||1,Le=(Se+Ne)*Ye+Fe,De=Math.abs(Math.round(Le)-H)||1;return W.setTransform(Math.sign(He),0,0,Math.sign(Ye),U,H),W.drawImage(d,m,k,ye,ve,0,0,q,De),W.setTransform(He,ze,qe,Ye,Oe,Fe),[q,De]}if(He===0&&Ye===0){const ke=Se*qe+Oe,U=Math.round(ke),o=X*ze+Fe,H=Math.round(o),te=(Se+Ne)*qe+Oe,q=Math.abs(Math.round(te)-U)||1,Le=(X+Re)*ze+Fe,De=Math.abs(Math.round(Le)-H)||1;return W.setTransform(0,Math.sign(ze),Math.sign(qe),0,U,H),W.drawImage(d,m,k,ye,ve,0,0,De,q),W.setTransform(He,ze,qe,Ye,Oe,Fe),[De,q]}W.drawImage(d,m,k,ye,ve,X,Se,Re,Ne);const Y=Math.hypot(He,ze),Ae=Math.hypot(qe,Ye);return[Y*Re,Ae*Ne]}function y(W){const{width:d,height:m}=W;if(d>I||m>I)return null;const k=1e3,ye=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),ve=d+1;let X=new Uint8Array(ve*(m+1)),Se,Re,Ne;const He=d+7&-8;let ze=new Uint8Array(He*m),qe=0;for(const Ae of W.data){let ke=128;for(;ke>0;)ze[qe++]=Ae&ke?0:255,ke>>=1}let Ye=0;for(qe=0,ze[qe]!==0&&(X[0]=1,++Ye),Re=1;Re<d;Re++)ze[qe]!==ze[qe+1]&&(X[Re]=ze[qe]?2:1,++Ye),qe++;for(ze[qe]!==0&&(X[Re]=2,++Ye),Se=1;Se<m;Se++){qe=Se*He,Ne=Se*ve,ze[qe-He]!==ze[qe]&&(X[Ne]=ze[qe]?1:8,++Ye);let Ae=(ze[qe]?4:0)+(ze[qe-He]?8:0);for(Re=1;Re<d;Re++)Ae=(Ae>>2)+(ze[qe+1]?4:0)+(ze[qe-He+1]?8:0),ye[Ae]&&(X[Ne+Re]=ye[Ae],++Ye),qe++;if(ze[qe-He]!==ze[qe]&&(X[Ne+Re]=ze[qe]?2:4,++Ye),Ye>k)return null}for(qe=He*(m-1),Ne=Se*ve,ze[qe]!==0&&(X[Ne]=8,++Ye),Re=1;Re<d;Re++)ze[qe]!==ze[qe+1]&&(X[Ne+Re]=ze[qe]?4:8,++Ye),qe++;if(ze[qe]!==0&&(X[Ne+Re]=4,++Ye),Ye>k)return null;const Oe=new Int32Array([0,ve,-1,0,-ve,0,0,0,1]),Fe=new Path2D;for(Se=0;Ye&&Se<=m;Se++){let Ae=Se*ve;const ke=Ae+d;for(;Ae<ke&&!X[Ae];)Ae++;if(Ae===ke)continue;Fe.moveTo(Ae%ve,Se);const U=Ae;let o=X[Ae];do{const H=Oe[o];do Ae+=H;while(!X[Ae]);const te=X[Ae];te!==5&&te!==10?(o=te,X[Ae]=0):(o=te&51*o>>4,X[Ae]&=o>>2|o<<2),Fe.lineTo(Ae%ve,Ae/ve|0),X[Ae]||--Ye}while(U!==Ae);--Se}return ze=null,X=null,function(Ae){Ae.save(),Ae.scale(1/d,-1/m),Ae.translate(0,-m),Ae.fill(Fe),Ae.beginPath(),Ae.restore()}}class _{constructor(d,m){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=p.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=p.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,d,m])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,m){this.x=d,this.y=m}updatePathMinMax(d,m,k){[m,k]=p.Util.applyTransform([m,k],d),this.minX=Math.min(this.minX,m),this.minY=Math.min(this.minY,k),this.maxX=Math.max(this.maxX,m),this.maxY=Math.max(this.maxY,k)}updateRectMinMax(d,m){const k=p.Util.applyTransform(m,d),ye=p.Util.applyTransform(m.slice(2),d);this.minX=Math.min(this.minX,k[0],ye[0]),this.minY=Math.min(this.minY,k[1],ye[1]),this.maxX=Math.max(this.maxX,k[0],ye[0]),this.maxY=Math.max(this.maxY,k[1],ye[1])}updateScalingPathMinMax(d,m){p.Util.scaleMinMax(d,m),this.minX=Math.min(this.minX,m[0]),this.maxX=Math.max(this.maxX,m[1]),this.minY=Math.min(this.minY,m[2]),this.maxY=Math.max(this.maxY,m[3])}updateCurvePathMinMax(d,m,k,ye,ve,X,Se,Re,Ne,He){const ze=p.Util.bezierBoundingBox(m,k,ye,ve,X,Se,Re,Ne);if(He){He[0]=Math.min(He[0],ze[0],ze[2]),He[1]=Math.max(He[1],ze[0],ze[2]),He[2]=Math.min(He[2],ze[1],ze[3]),He[3]=Math.max(He[3],ze[1],ze[3]);return}this.updateRectMinMax(d,ze)}getPathBoundingBox(d=Me.PathType.FILL,m=null){const k=[this.minX,this.minY,this.maxX,this.maxY];if(d===Me.PathType.STROKE){m||(0,p.unreachable)("Stroke bounding box must include transform.");const ye=p.Util.singularValueDecompose2dScale(m),ve=ye[0]*this.lineWidth/2,X=ye[1]*this.lineWidth/2;k[0]-=ve,k[1]-=X,k[2]+=ve,k[3]+=X}return k}updateClipFromPath(){const d=p.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=Me.PathType.FILL,m=null){return p.Util.intersect(this.clipBox,this.getPathBoundingBox(d,m))}}function x(W,d){if(typeof ImageData<"u"&&d instanceof ImageData){W.putImageData(d,0,0);return}const m=d.height,k=d.width,ye=m%f,ve=(m-ye)/f,X=ye===0?ve:ve+1,Se=W.createImageData(k,f);let Re=0,Ne;const He=d.data,ze=Se.data;let qe,Ye,Oe,Fe;if(d.kind===p.ImageKind.GRAYSCALE_1BPP){const Y=He.byteLength,Ae=new Uint32Array(ze.buffer,0,ze.byteLength>>2),ke=Ae.length,U=k+7>>3,o=4294967295,H=p.FeatureTest.isLittleEndian?4278190080:255;for(qe=0;qe<X;qe++){for(Oe=qe<ve?f:ye,Ne=0,Ye=0;Ye<Oe;Ye++){const te=Y-Re;let q=0;const Le=te>U?k:te*8-7,De=Le&-8;let Ge=0,Ve=0;for(;q<De;q+=8)Ve=He[Re++],Ae[Ne++]=Ve&128?o:H,Ae[Ne++]=Ve&64?o:H,Ae[Ne++]=Ve&32?o:H,Ae[Ne++]=Ve&16?o:H,Ae[Ne++]=Ve&8?o:H,Ae[Ne++]=Ve&4?o:H,Ae[Ne++]=Ve&2?o:H,Ae[Ne++]=Ve&1?o:H;for(;q<Le;q++)Ge===0&&(Ve=He[Re++],Ge=128),Ae[Ne++]=Ve&Ge?o:H,Ge>>=1}for(;Ne<ke;)Ae[Ne++]=0;W.putImageData(Se,0,qe*f)}}else if(d.kind===p.ImageKind.RGBA_32BPP){for(Ye=0,Fe=k*f*4,qe=0;qe<ve;qe++)ze.set(He.subarray(Re,Re+Fe)),Re+=Fe,W.putImageData(Se,0,Ye),Ye+=f;qe<X&&(Fe=k*ye*4,ze.set(He.subarray(Re,Re+Fe)),W.putImageData(Se,0,Ye))}else if(d.kind===p.ImageKind.RGB_24BPP)for(Oe=f,Fe=k*Oe,qe=0;qe<X;qe++){for(qe>=ve&&(Oe=ye,Fe=k*Oe),Ne=0,Ye=Fe;Ye--;)ze[Ne++]=He[Re++],ze[Ne++]=He[Re++],ze[Ne++]=He[Re++],ze[Ne++]=255;W.putImageData(Se,0,qe*f)}else throw new Error(`bad image kind: ${d.kind}`)}function S(W,d){if(d.bitmap){W.drawImage(d.bitmap,0,0);return}const m=d.height,k=d.width,ye=m%f,ve=(m-ye)/f,X=ye===0?ve:ve+1,Se=W.createImageData(k,f);let Re=0;const Ne=d.data,He=Se.data;for(let ze=0;ze<X;ze++){const qe=ze<ve?f:ye;({srcPos:Re}=(0,J.convertBlackAndWhiteToRGBA)({src:Ne,srcPos:Re,dest:He,width:k,height:qe,nonBlackColor:0})),W.putImageData(Se,0,ze*f)}}function n(W,d){const m=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const k of m)W[k]!==void 0&&(d[k]=W[k]);W.setLineDash!==void 0&&(d.setLineDash(W.getLineDash()),d.lineDashOffset=W.lineDashOffset)}function i(W){if(W.strokeStyle=W.fillStyle="#000000",W.fillRule="nonzero",W.globalAlpha=1,W.lineWidth=1,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=10,W.globalCompositeOperation="source-over",W.font="10px sans-serif",W.setLineDash!==void 0&&(W.setLineDash([]),W.lineDashOffset=0),!p.isNodeJS){const{filter:d}=W;d!=="none"&&d!==""&&(W.filter="none")}}function s(W,d,m,k){const ye=W.length;for(let ve=3;ve<ye;ve+=4){const X=W[ve];if(X===0)W[ve-3]=d,W[ve-2]=m,W[ve-1]=k;else if(X<255){const Se=255-X;W[ve-3]=W[ve-3]*X+d*Se>>8,W[ve-2]=W[ve-2]*X+m*Se>>8,W[ve-1]=W[ve-1]*X+k*Se>>8}}}function c(W,d,m){const k=W.length,ye=1/255;for(let ve=3;ve<k;ve+=4){const X=m?m[W[ve]]:W[ve];d[ve]=d[ve]*X*ye|0}}function v(W,d,m){const k=W.length;for(let ye=3;ye<k;ye+=4){const ve=W[ye-3]*77+W[ye-2]*152+W[ye-1]*28;d[ye]=m?d[ye]*m[ve>>8]>>8:d[ye]*ve>>16}}function z(W,d,m,k,ye,ve,X,Se,Re,Ne,He){const ze=!!ve,qe=ze?ve[0]:0,Ye=ze?ve[1]:0,Oe=ze?ve[2]:0,Fe=ye==="Luminosity"?v:c,Ae=Math.min(k,Math.ceil(1048576/m));for(let ke=0;ke<k;ke+=Ae){const U=Math.min(Ae,k-ke),o=W.getImageData(Se-Ne,ke+(Re-He),m,U),H=d.getImageData(Se,ke+Re,m,U);ze&&s(o.data,qe,Ye,Oe),Fe(o.data,H.data,X),d.putImageData(H,Se,ke+Re)}}function u(W,d,m,k){const ye=k[0],ve=k[1],X=k[2]-ye,Se=k[3]-ve;X===0||Se===0||(z(d.context,m,X,Se,d.subtype,d.backdrop,d.transferMap,ye,ve,d.offsetX,d.offsetY),W.save(),W.globalAlpha=1,W.globalCompositeOperation="source-over",W.setTransform(1,0,0,1,0,0),W.drawImage(m.canvas,0,0),W.restore())}function N(W,d){const m=p.Util.singularValueDecompose2dScale(W);m[0]=Math.fround(m[0]),m[1]=Math.fround(m[1]);const k=Math.fround((globalThis.devicePixelRatio||1)*M.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:m[0]<=k||m[1]<=k}const re=["butt","round","square"],Q=["miter","round","bevel"],oe={},fe={},Ce=class Ce{constructor(d,m,k,ye,ve,{optionalContentConfig:X,markedContentStack:Se=null},Re,Ne){Te(this,Ee);this.ctx=d,this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=m,this.objs=k,this.canvasFactory=ye,this.filterFactory=ve,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Se||[],this.optionalContentConfig=X,this.cachedCanvases=new w(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Re,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Ne,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,m=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):m}beginDrawing({transform:d,viewport:m,transparency:k=!1,background:ye=null}){const ve=this.ctx.canvas.width,X=this.ctx.canvas.height,Se=this.ctx.fillStyle;if(this.ctx.fillStyle=ye||"#ffffff",this.ctx.fillRect(0,0,ve,X),this.ctx.fillStyle=Se,k){const Re=this.cachedCanvases.getCanvas("transparent",ve,X);this.compositeCtx=this.ctx,this.transparentCanvas=Re.canvas,this.ctx=Re.context,this.ctx.save(),this.ctx.transform(...(0,M.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),i(this.ctx),d&&(this.ctx.transform(...d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform(...m.transform),this.viewportScale=m.scale,this.baseTransform=(0,M.getCurrentTransform)(this.ctx)}executeOperatorList(d,m,k,ye){const ve=d.argsArray,X=d.fnArray;let Se=m||0;const Re=ve.length;if(Re===Se)return Se;const Ne=Re-Se>j&&typeof k=="function",He=Ne?Date.now()+r:0;let ze=0;const qe=this.commonObjs,Ye=this.objs;let Oe;for(;;){if(ye!==void 0&&Se===ye.nextBreakPoint)return ye.breakIt(Se,k),Se;if(Oe=X[Se],Oe!==p.OPS.dependency)this[Oe].apply(this,ve[Se]);else for(const Fe of ve[Se]){const Y=Fe.startsWith("g_")?qe:Ye;if(!Y.has(Fe))return Y.get(Fe,k),Se}if(Se++,Se===Re)return Se;if(Ne&&++ze>j){if(Date.now()>He)return k(),Se;ze=0}}}endDrawing(){Z(this,Ee,ji).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const m of d.values())typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement&&(m.width=m.height=0);d.clear()}this._cachedBitmapsMap.clear(),Z(this,Ee,zi).call(this)}_scaleImage(d,m){const k=d.width,ye=d.height;let ve=Math.max(Math.hypot(m[0],m[1]),1),X=Math.max(Math.hypot(m[2],m[3]),1),Se=k,Re=ye,Ne="prescale1",He,ze;for(;ve>2&&Se>1||X>2&&Re>1;){let qe=Se,Ye=Re;ve>2&&Se>1&&(qe=Se>=16384?Math.floor(Se/2)-1||1:Math.ceil(Se/2),ve/=Se/qe),X>2&&Re>1&&(Ye=Re>=16384?Math.floor(Re/2)-1||1:Math.ceil(Re)/2,X/=Re/Ye),He=this.cachedCanvases.getCanvas(Ne,qe,Ye),ze=He.context,ze.clearRect(0,0,qe,Ye),ze.drawImage(d,0,0,Se,Re,0,0,qe,Ye),d=He.canvas,Se=qe,Re=Ye,Ne=Ne==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:Se,paintHeight:Re}}_createMaskCanvas(d){const m=this.ctx,{width:k,height:ye}=d,ve=this.current.fillColor,X=this.current.patternFill,Se=(0,M.getCurrentTransform)(m);let Re,Ne,He,ze;if((d.bitmap||d.data)&&d.count>1){const q=d.bitmap||d.data.buffer;Ne=JSON.stringify(X?Se:[Se.slice(0,4),ve]),Re=this._cachedBitmapsMap.get(q),Re||(Re=new Map,this._cachedBitmapsMap.set(q,Re));const Le=Re.get(Ne);if(Le&&!X){const De=Math.round(Math.min(Se[0],Se[2])+Se[4]),Ge=Math.round(Math.min(Se[1],Se[3])+Se[5]);return{canvas:Le,offsetX:De,offsetY:Ge}}He=Le}He||(ze=this.cachedCanvases.getCanvas("maskCanvas",k,ye),S(ze.context,d));let qe=p.Util.transform(Se,[1/k,0,0,-1/ye,0,0]);qe=p.Util.transform(qe,[1,0,0,1,0,-ye]);const Ye=p.Util.applyTransform([0,0],qe),Oe=p.Util.applyTransform([k,ye],qe),Fe=p.Util.normalizeRect([Ye[0],Ye[1],Oe[0],Oe[1]]),Y=Math.round(Fe[2]-Fe[0])||1,Ae=Math.round(Fe[3]-Fe[1])||1,ke=this.cachedCanvases.getCanvas("fillCanvas",Y,Ae),U=ke.context,o=Math.min(Ye[0],Oe[0]),H=Math.min(Ye[1],Oe[1]);U.translate(-o,-H),U.transform(...qe),He||(He=this._scaleImage(ze.canvas,(0,M.getCurrentTransformInverse)(U)),He=He.img,Re&&X&&Re.set(Ne,He)),U.imageSmoothingEnabled=N((0,M.getCurrentTransform)(U),d.interpolate),E(U,He,0,0,He.width,He.height,0,0,k,ye),U.globalCompositeOperation="source-in";const te=p.Util.transform((0,M.getCurrentTransformInverse)(U),[1,0,0,1,-o,-H]);return U.fillStyle=X?ve.getPattern(m,this,te,Me.PathType.FILL):ve,U.fillRect(0,0,k,ye),Re&&!X&&(this.cachedCanvases.delete("fillCanvas"),Re.set(Ne,ke.canvas)),{canvas:ke.canvas,offsetX:Math.round(o),offsetY:Math.round(H)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=re[d]}setLineJoin(d){this.ctx.lineJoin=Q[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,m){const k=this.ctx;k.setLineDash!==void 0&&(k.setLineDash(d),k.lineDashOffset=m)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(const[m,k]of d)switch(m){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k[0],k[1]);break;case"CA":this.current.strokeAlpha=k;break;case"ca":this.current.fillAlpha=k,this.ctx.globalAlpha=k;break;case"BM":this.ctx.globalCompositeOperation=k;break;case"SMask":this.current.activeSMask=k?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(k);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,m=this.ctx.canvas.height,k="smaskGroupAt"+this.groupLevel,ye=this.cachedCanvases.getCanvas(k,d,m);this.suspendedCtx=this.ctx,this.ctx=ye.context;const ve=this.ctx;ve.setTransform(...(0,M.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,ve),h(ve,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const m=this.current.activeSMask,k=this.suspendedCtx;u(k,m,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(d,m,k,ye,ve,X){this.ctx.transform(d,m,k,ye,ve,X),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(d,m,k){const ye=this.ctx,ve=this.current;let X=ve.x,Se=ve.y,Re,Ne;const He=(0,M.getCurrentTransform)(ye),ze=He[0]===0&&He[3]===0||He[1]===0&&He[2]===0,qe=ze?k.slice(0):null;for(let Ye=0,Oe=0,Fe=d.length;Ye<Fe;Ye++)switch(d[Ye]|0){case p.OPS.rectangle:X=m[Oe++],Se=m[Oe++];const Y=m[Oe++],Ae=m[Oe++],ke=X+Y,U=Se+Ae;ye.moveTo(X,Se),Y===0||Ae===0?ye.lineTo(ke,U):(ye.lineTo(ke,Se),ye.lineTo(ke,U),ye.lineTo(X,U)),ze||ve.updateRectMinMax(He,[X,Se,ke,U]),ye.closePath();break;case p.OPS.moveTo:X=m[Oe++],Se=m[Oe++],ye.moveTo(X,Se),ze||ve.updatePathMinMax(He,X,Se);break;case p.OPS.lineTo:X=m[Oe++],Se=m[Oe++],ye.lineTo(X,Se),ze||ve.updatePathMinMax(He,X,Se);break;case p.OPS.curveTo:Re=X,Ne=Se,X=m[Oe+4],Se=m[Oe+5],ye.bezierCurveTo(m[Oe],m[Oe+1],m[Oe+2],m[Oe+3],X,Se),ve.updateCurvePathMinMax(He,Re,Ne,m[Oe],m[Oe+1],m[Oe+2],m[Oe+3],X,Se,qe),Oe+=6;break;case p.OPS.curveTo2:Re=X,Ne=Se,ye.bezierCurveTo(X,Se,m[Oe],m[Oe+1],m[Oe+2],m[Oe+3]),ve.updateCurvePathMinMax(He,Re,Ne,X,Se,m[Oe],m[Oe+1],m[Oe+2],m[Oe+3],qe),X=m[Oe+2],Se=m[Oe+3],Oe+=4;break;case p.OPS.curveTo3:Re=X,Ne=Se,X=m[Oe+2],Se=m[Oe+3],ye.bezierCurveTo(m[Oe],m[Oe+1],X,Se,X,Se),ve.updateCurvePathMinMax(He,Re,Ne,m[Oe],m[Oe+1],X,Se,X,Se,qe),Oe+=4;break;case p.OPS.closePath:ye.closePath();break}ze&&ve.updateScalingPathMinMax(He,qe),ve.setCurrentPoint(X,Se)}closePath(){this.ctx.closePath()}stroke(d=!0){const m=this.ctx,k=this.current.strokeColor;m.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof k=="object"&&(k!=null&&k.getPattern)?(m.save(),m.strokeStyle=k.getPattern(m,this,(0,M.getCurrentTransformInverse)(m),Me.PathType.STROKE),this.rescaleAndStroke(!1),m.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),m.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d=!0){const m=this.ctx,k=this.current.fillColor,ye=this.current.patternFill;let ve=!1;ye&&(m.save(),m.fillStyle=k.getPattern(m,this,(0,M.getCurrentTransformInverse)(m),Me.PathType.FILL),ve=!0);const X=this.current.getClippedPathBoundingBox();this.contentVisible&&X!==null&&(this.pendingEOFill?(m.fill("evenodd"),this.pendingEOFill=!1):m.fill()),ve&&m.restore(),d&&this.consumePath(X)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=oe}eoClip(){this.pendingClip=fe}beginText(){this.current.textMatrix=p.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,m=this.ctx;if(d===void 0){m.beginPath();return}m.save(),m.beginPath();for(const k of d)m.setTransform(...k.transform),m.translate(k.x,k.y),k.addToPath(m,k.fontSize);m.restore(),m.clip(),m.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,m){var He;const k=this.commonObjs.get(d),ye=this.current;if(!k)throw new Error(`Can't find font for ${d}`);if(ye.fontMatrix=k.fontMatrix||p.FONT_IDENTITY_MATRIX,(ye.fontMatrix[0]===0||ye.fontMatrix[3]===0)&&(0,p.warn)("Invalid font matrix for font "+d),m<0?(m=-m,ye.fontDirection=-1):ye.fontDirection=1,this.current.font=k,this.current.fontSize=m,k.isType3Font)return;const ve=k.loadedName||"sans-serif",X=((He=k.systemFontInfo)==null?void 0:He.css)||`"${ve}", ${k.fallbackName}`;let Se="normal";k.black?Se="900":k.bold&&(Se="bold");const Re=k.italic?"italic":"normal";let Ne=m;m<F?Ne=F:m>D&&(Ne=D),this.current.fontSizeScale=m/Ne,this.ctx.font=`${Re} ${Se} ${Ne}px ${X}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,m){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=m}setLeadingMoveText(d,m){this.setLeading(-m),this.moveText(d,m)}setTextMatrix(d,m,k,ye,ve,X){this.current.textMatrix=[d,m,k,ye,ve,X],this.current.textMatrixScale=Math.hypot(d,m),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,m,k,ye){const ve=this.ctx,X=this.current,Se=X.font,Re=X.textRenderingMode,Ne=X.fontSize/X.fontSizeScale,He=Re&p.TextRenderingMode.FILL_STROKE_MASK,ze=!!(Re&p.TextRenderingMode.ADD_TO_PATH_FLAG),qe=X.patternFill&&!Se.missingFile;let Ye;(Se.disableFontFace||ze||qe)&&(Ye=Se.getPathGenerator(this.commonObjs,d)),Se.disableFontFace||qe?(ve.save(),ve.translate(m,k),ve.beginPath(),Ye(ve,Ne),ye&&ve.setTransform(...ye),(He===p.TextRenderingMode.FILL||He===p.TextRenderingMode.FILL_STROKE)&&ve.fill(),(He===p.TextRenderingMode.STROKE||He===p.TextRenderingMode.FILL_STROKE)&&ve.stroke(),ve.restore()):((He===p.TextRenderingMode.FILL||He===p.TextRenderingMode.FILL_STROKE)&&ve.fillText(d,m,k),(He===p.TextRenderingMode.STROKE||He===p.TextRenderingMode.FILL_STROKE)&&ve.strokeText(d,m,k)),ze&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,M.getCurrentTransform)(ve),x:m,y:k,fontSize:Ne,addToPath:Ye})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);d.scale(1.5,1),d.fillText("I",0,10);const m=d.getImageData(0,0,10,10).data;let k=!1;for(let ye=3;ye<m.length;ye+=4)if(m[ye]>0&&m[ye]<255){k=!0;break}return(0,p.shadow)(this,"isFontSubpixelAAEnabled",k)}showText(d){const m=this.current,k=m.font;if(k.isType3Font)return this.showType3Text(d);const ye=m.fontSize;if(ye===0)return;const ve=this.ctx,X=m.fontSizeScale,Se=m.charSpacing,Re=m.wordSpacing,Ne=m.fontDirection,He=m.textHScale*Ne,ze=d.length,qe=k.vertical,Ye=qe?1:-1,Oe=k.defaultVMetrics,Fe=ye*m.fontMatrix[0],Y=m.textRenderingMode===p.TextRenderingMode.FILL&&!k.disableFontFace&&!m.patternFill;ve.save(),ve.transform(...m.textMatrix),ve.translate(m.x,m.y+m.textRise),Ne>0?ve.scale(He,-1):ve.scale(He,1);let Ae;if(m.patternFill){ve.save();const te=m.fillColor.getPattern(ve,this,(0,M.getCurrentTransformInverse)(ve),Me.PathType.FILL);Ae=(0,M.getCurrentTransform)(ve),ve.restore(),ve.fillStyle=te}let ke=m.lineWidth;const U=m.textMatrixScale;if(U===0||ke===0){const te=m.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;(te===p.TextRenderingMode.STROKE||te===p.TextRenderingMode.FILL_STROKE)&&(ke=this.getSinglePixelWidth())}else ke/=U;if(X!==1&&(ve.scale(X,X),ke/=X),ve.lineWidth=ke,k.isInvalidPDFjsFont){const te=[];let q=0;for(const Le of d)te.push(Le.unicode),q+=Le.width;ve.fillText(te.join(""),0,0),m.x+=q*Fe*He,ve.restore(),this.compose();return}let o=0,H;for(H=0;H<ze;++H){const te=d[H];if(typeof te=="number"){o+=Ye*te*ye/1e3;continue}let q=!1;const Le=(te.isSpace?Re:0)+Se,De=te.fontChar,Ge=te.accent;let Ve,Je,Ze=te.width;if(qe){const pt=te.vmetric||Oe,mt=-(te.vmetric?pt[1]:Ze*.5)*Fe,Xe=pt[2]*Fe;Ze=pt?-pt[0]:Ze,Ve=mt/X,Je=(o+Xe)/X}else Ve=o/X,Je=0;if(k.remeasure&&Ze>0){const pt=ve.measureText(De).width*1e3/ye*X;if(Ze<pt&&this.isFontSubpixelAAEnabled){const mt=Ze/pt;q=!0,ve.save(),ve.scale(mt,1),Ve/=mt}else Ze!==pt&&(Ve+=(Ze-pt)/2e3*ye/X)}if(this.contentVisible&&(te.isInFont||k.missingFile)){if(Y&&!Ge)ve.fillText(De,Ve,Je);else if(this.paintChar(De,Ve,Je,Ae),Ge){const pt=Ve+ye*Ge.offset.x/X,mt=Je-ye*Ge.offset.y/X;this.paintChar(Ge.fontChar,pt,mt,Ae)}}const it=qe?Ze*Fe-Le*Ne:Ze*Fe+Le*Ne;o+=it,q&&ve.restore()}qe?m.y-=o:m.x+=o*He,ve.restore(),this.compose()}showType3Text(d){const m=this.ctx,k=this.current,ye=k.font,ve=k.fontSize,X=k.fontDirection,Se=ye.vertical?1:-1,Re=k.charSpacing,Ne=k.wordSpacing,He=k.textHScale*X,ze=k.fontMatrix||p.FONT_IDENTITY_MATRIX,qe=d.length,Ye=k.textRenderingMode===p.TextRenderingMode.INVISIBLE;let Oe,Fe,Y,Ae;if(!(Ye||ve===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,m.save(),m.transform(...k.textMatrix),m.translate(k.x,k.y),m.scale(He,X),Oe=0;Oe<qe;++Oe){if(Fe=d[Oe],typeof Fe=="number"){Ae=Se*Fe*ve/1e3,this.ctx.translate(Ae,0),k.x+=Ae*He;continue}const ke=(Fe.isSpace?Ne:0)+Re,U=ye.charProcOperatorList[Fe.operatorListId];if(!U){(0,p.warn)(`Type3 character "${Fe.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Fe,this.save(),m.scale(ve,ve),m.transform(...ze),this.executeOperatorList(U),this.restore()),Y=p.Util.applyTransform([Fe.width,0],ze)[0]*ve+ke,m.translate(Y,0),k.x+=Y*He}m.restore(),this.processingType3=null}}setCharWidth(d,m){}setCharWidthAndBounds(d,m,k,ye,ve,X){this.ctx.rect(k,ye,ve-k,X-ye),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let m;if(d[0]==="TilingPattern"){const k=d[1],ye=this.baseTransform||(0,M.getCurrentTransform)(this.ctx),ve={createCanvasGraphics:X=>new Ce(X,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};m=new Me.TilingPattern(d,k,this.ctx,ve,ye)}else m=this._getPattern(d[1],d[2]);return m}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,m,k){const ye=p.Util.makeHexColor(d,m,k);this.ctx.strokeStyle=ye,this.current.strokeColor=ye}setFillRGBColor(d,m,k){const ye=p.Util.makeHexColor(d,m,k);this.ctx.fillStyle=ye,this.current.fillColor=ye,this.current.patternFill=!1}_getPattern(d,m=null){let k;return this.cachedPatterns.has(d)?k=this.cachedPatterns.get(d):(k=(0,Me.getShadingPattern)(this.getObject(d)),this.cachedPatterns.set(d,k)),m&&(k.matrix=m),k}shadingFill(d){if(!this.contentVisible)return;const m=this.ctx;this.save();const k=this._getPattern(d);m.fillStyle=k.getPattern(m,this,(0,M.getCurrentTransformInverse)(m),Me.PathType.SHADING);const ye=(0,M.getCurrentTransformInverse)(m);if(ye){const{width:ve,height:X}=m.canvas,[Se,Re,Ne,He]=p.Util.getAxialAlignedBoundingBox([0,0,ve,X],ye);this.ctx.fillRect(Se,Re,Ne-Se,He-Re)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,p.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,p.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,m){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform(...d),this.baseTransform=(0,M.getCurrentTransform)(this.ctx),m)){const k=m[2]-m[0],ye=m[3]-m[1];this.ctx.rect(m[0],m[1],k,ye),this.current.updateRectMinMax((0,M.getCurrentTransform)(this.ctx),m),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const m=this.ctx;d.isolated||(0,p.info)("TODO: Support non-isolated groups."),d.knockout&&(0,p.warn)("Knockout groups not supported.");const k=(0,M.getCurrentTransform)(m);if(d.matrix&&m.transform(...d.matrix),!d.bbox)throw new Error("Bounding box is required.");let ye=p.Util.getAxialAlignedBoundingBox(d.bbox,(0,M.getCurrentTransform)(m));const ve=[0,0,m.canvas.width,m.canvas.height];ye=p.Util.intersect(ye,ve)||[0,0,0,0];const X=Math.floor(ye[0]),Se=Math.floor(ye[1]);let Re=Math.max(Math.ceil(ye[2])-X,1),Ne=Math.max(Math.ceil(ye[3])-Se,1),He=1,ze=1;Re>g&&(He=Re/g,Re=g),Ne>g&&(ze=Ne/g,Ne=g),this.current.startNewPathAndClipBox([0,0,Re,Ne]);let qe="groupAt"+this.groupLevel;d.smask&&(qe+="_smask_"+this.smaskCounter++%2);const Ye=this.cachedCanvases.getCanvas(qe,Re,Ne),Oe=Ye.context;Oe.scale(1/He,1/ze),Oe.translate(-X,-Se),Oe.transform(...k),d.smask?this.smaskStack.push({canvas:Ye.canvas,context:Oe,offsetX:X,offsetY:Se,scaleX:He,scaleY:ze,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(m.setTransform(1,0,0,1,0,0),m.translate(X,Se),m.scale(He,ze),m.save()),n(m,Oe),this.ctx=Oe,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(m),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const m=this.ctx,k=this.groupStack.pop();if(this.ctx=k,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const ye=(0,M.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...ye);const ve=p.Util.getAxialAlignedBoundingBox([0,0,m.canvas.width,m.canvas.height],ye);this.ctx.drawImage(m.canvas,0,0),this.ctx.restore(),this.compose(ve)}}beginAnnotation(d,m,k,ye,ve){if(Z(this,Ee,ji).call(this),i(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(m)&&m.length===4){const X=m[2]-m[0],Se=m[3]-m[1];if(ve&&this.annotationCanvasMap){k=k.slice(),k[4]-=m[0],k[5]-=m[1],m=m.slice(),m[0]=m[1]=0,m[2]=X,m[3]=Se;const[Re,Ne]=p.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(this.ctx)),{viewportScale:He}=this,ze=Math.ceil(X*this.outputScaleX*He),qe=Math.ceil(Se*this.outputScaleY*He);this.annotationCanvas=this.canvasFactory.create(ze,qe);const{canvas:Ye,context:Oe}=this.annotationCanvas;this.annotationCanvasMap.set(d,Ye),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Oe,this.ctx.save(),this.ctx.setTransform(Re,0,0,-Ne,0,Se*Ne),i(this.ctx)}else i(this.ctx),this.ctx.rect(m[0],m[1],X,Se),this.ctx.clip(),this.endPath()}this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...k),this.transform(...ye)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Z(this,Ee,zi).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const m=d.count;d=this.getObject(d.data,d),d.count=m;const k=this.ctx,ye=this.processingType3;if(ye&&(ye.compiled===void 0&&(ye.compiled=y(d)),ye.compiled)){ye.compiled(k);return}const ve=this._createMaskCanvas(d),X=ve.canvas;k.save(),k.setTransform(1,0,0,1,0,0),k.drawImage(X,ve.offsetX,ve.offsetY),k.restore(),this.compose()}paintImageMaskXObjectRepeat(d,m,k=0,ye=0,ve,X){if(!this.contentVisible)return;d=this.getObject(d.data,d);const Se=this.ctx;Se.save();const Re=(0,M.getCurrentTransform)(Se);Se.transform(m,k,ye,ve,0,0);const Ne=this._createMaskCanvas(d);Se.setTransform(1,0,0,1,Ne.offsetX-Re[4],Ne.offsetY-Re[5]);for(let He=0,ze=X.length;He<ze;He+=2){const qe=p.Util.transform(Re,[m,k,ye,ve,X[He],X[He+1]]),[Ye,Oe]=p.Util.applyTransform([0,0],qe);Se.drawImage(Ne.canvas,Ye,Oe)}Se.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const m=this.ctx,k=this.current.fillColor,ye=this.current.patternFill;for(const ve of d){const{data:X,width:Se,height:Re,transform:Ne}=ve,He=this.cachedCanvases.getCanvas("maskCanvas",Se,Re),ze=He.context;ze.save();const qe=this.getObject(X,ve);S(ze,qe),ze.globalCompositeOperation="source-in",ze.fillStyle=ye?k.getPattern(ze,this,(0,M.getCurrentTransformInverse)(m),Me.PathType.FILL):k,ze.fillRect(0,0,Se,Re),ze.restore(),m.save(),m.transform(...Ne),m.scale(1,-1),E(m,He.canvas,0,0,Se,Re,0,-1,1,1),m.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const m=this.getObject(d);if(!m){(0,p.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(m)}paintImageXObjectRepeat(d,m,k,ye){if(!this.contentVisible)return;const ve=this.getObject(d);if(!ve){(0,p.warn)("Dependent image isn't ready yet");return}const X=ve.width,Se=ve.height,Re=[];for(let Ne=0,He=ye.length;Ne<He;Ne+=2)Re.push({transform:[m,0,0,k,ye[Ne],ye[Ne+1]],x:0,y:0,w:X,h:Se});this.paintInlineImageXObjectGroup(ve,Re)}applyTransferMapsToCanvas(d){return this.current.transferMaps!=="none"&&(d.filter=this.current.transferMaps,d.drawImage(d.canvas,0,0),d.filter="none"),d.canvas}applyTransferMapsToBitmap(d){if(this.current.transferMaps==="none")return d.bitmap;const{bitmap:m,width:k,height:ye}=d,ve=this.cachedCanvases.getCanvas("inlineImage",k,ye),X=ve.context;return X.filter=this.current.transferMaps,X.drawImage(m,0,0),X.filter="none",ve.canvas}paintInlineImageXObject(d){if(!this.contentVisible)return;const m=d.width,k=d.height,ye=this.ctx;if(this.save(),!p.isNodeJS){const{filter:Se}=ye;Se!=="none"&&Se!==""&&(ye.filter="none")}ye.scale(1/m,-1/k);let ve;if(d.bitmap)ve=this.applyTransferMapsToBitmap(d);else if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)ve=d;else{const Re=this.cachedCanvases.getCanvas("inlineImage",m,k).context;x(Re,d),ve=this.applyTransferMapsToCanvas(Re)}const X=this._scaleImage(ve,(0,M.getCurrentTransformInverse)(ye));ye.imageSmoothingEnabled=N((0,M.getCurrentTransform)(ye),d.interpolate),E(ye,X.img,0,0,X.paintWidth,X.paintHeight,0,-k,m,k),this.compose(),this.restore()}paintInlineImageXObjectGroup(d,m){if(!this.contentVisible)return;const k=this.ctx;let ye;if(d.bitmap)ye=d.bitmap;else{const ve=d.width,X=d.height,Re=this.cachedCanvases.getCanvas("inlineImage",ve,X).context;x(Re,d),ye=this.applyTransferMapsToCanvas(Re)}for(const ve of m)k.save(),k.transform(...ve.transform),k.scale(1,-1),E(k,ye,ve.x,ve.y,ve.w,ve.h,0,-1,1,1),k.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,m){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,m){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(m)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const m=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const k=this.ctx;this.pendingClip&&(m||(this.pendingClip===fe?k.clip("evenodd"):k.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),k.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=(0,M.getCurrentTransform)(this.ctx);if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const m=Math.abs(d[0]*d[3]-d[2]*d[1]),k=Math.hypot(d[0],d[2]),ye=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(k,ye)/m}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:d}=this.current,{a:m,b:k,c:ye,d:ve}=this.ctx.getTransform();let X,Se;if(k===0&&ye===0){const Re=Math.abs(m),Ne=Math.abs(ve);if(Re===Ne)if(d===0)X=Se=1/Re;else{const He=Re*d;X=Se=He<1?1/He:1}else if(d===0)X=1/Re,Se=1/Ne;else{const He=Re*d,ze=Ne*d;X=He<1?1/He:1,Se=ze<1?1/ze:1}}else{const Re=Math.abs(m*ve-k*ye),Ne=Math.hypot(m,k),He=Math.hypot(ye,ve);if(d===0)X=He/Re,Se=Ne/Re;else{const ze=d*Re;X=He>ze?He/ze:1,Se=Ne>ze?Ne/ze:1}}this._cachedScaleForStroking[0]=X,this._cachedScaleForStroking[1]=Se}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:m}=this,{lineWidth:k}=this.current,[ye,ve]=this.getScaleForStroking();if(m.lineWidth=k||1,ye===1&&ve===1){m.stroke();return}const X=m.getLineDash();if(d&&m.save(),m.scale(ye,ve),X.length>0){const Se=Math.max(ye,ve);m.setLineDash(X.map(Re=>Re/Se)),m.lineDashOffset/=Se}m.stroke(),d&&m.restore()}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}};Ee=new WeakSet,ji=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},zi=function(){if(this.pageColors){const d=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(d!=="none"){const m=this.ctx.filter;this.ctx.filter=d,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=m}}};let O=Ce;t.CanvasGraphics=O;for(const W in p.OPS)O.prototype[W]!==void 0&&(O.prototype[p.OPS[W]]=O.prototype[W])},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=f;var p=le(1),M=le(6);const Me={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=Me;function J(y,_){if(!_)return;const x=_[2]-_[0],S=_[3]-_[1],n=new Path2D;n.rect(_[0],_[1],x,S),y.clip(n)}class F{constructor(){this.constructor===F&&(0,p.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,p.unreachable)("Abstract method `getPattern` called.")}}class D extends F{constructor(_){super(),this._type=_[1],this._bbox=_[2],this._colorStops=_[3],this._p0=_[4],this._p1=_[5],this._r0=_[6],this._r1=_[7],this.matrix=null}_createGradient(_){let x;this._type==="axial"?x=_.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(x=_.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const S of this._colorStops)x.addColorStop(S[0],S[1]);return x}getPattern(_,x,S,n){let i;if(n===Me.STROKE||n===Me.FILL){const s=x.current.getClippedPathBoundingBox(n,(0,M.getCurrentTransform)(_))||[0,0,0,0],c=Math.ceil(s[2]-s[0])||1,v=Math.ceil(s[3]-s[1])||1,z=x.cachedCanvases.getCanvas("pattern",c,v,!0),u=z.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-s[0],-s[1]),S=p.Util.transform(S,[1,0,0,1,s[0],s[1]]),u.transform(...x.baseTransform),this.matrix&&u.transform(...this.matrix),J(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),i=_.createPattern(z.canvas,"no-repeat");const N=new DOMMatrix(S);i.setTransform(N)}else J(_,this._bbox),i=this._createGradient(_);return i}}function g(y,_,x,S,n,i,s,c){const v=_.coords,z=_.colors,u=y.data,N=y.width*4;let re;v[x+1]>v[S+1]&&(re=x,x=S,S=re,re=i,i=s,s=re),v[S+1]>v[n+1]&&(re=S,S=n,n=re,re=s,s=c,c=re),v[x+1]>v[S+1]&&(re=x,x=S,S=re,re=i,i=s,s=re);const Q=(v[x]+_.offsetX)*_.scaleX,oe=(v[x+1]+_.offsetY)*_.scaleY,fe=(v[S]+_.offsetX)*_.scaleX,O=(v[S+1]+_.offsetY)*_.scaleY,Ee=(v[n]+_.offsetX)*_.scaleX,T=(v[n+1]+_.offsetY)*_.scaleY;if(oe>=T)return;const P=z[i],Ce=z[i+1],W=z[i+2],d=z[s],m=z[s+1],k=z[s+2],ye=z[c],ve=z[c+1],X=z[c+2],Se=Math.round(oe),Re=Math.round(T);let Ne,He,ze,qe,Ye,Oe,Fe,Y;for(let Ae=Se;Ae<=Re;Ae++){if(Ae<O){const te=Ae<oe?0:(oe-Ae)/(oe-O);Ne=Q-(Q-fe)*te,He=P-(P-d)*te,ze=Ce-(Ce-m)*te,qe=W-(W-k)*te}else{let te;Ae>T?te=1:O===T?te=0:te=(O-Ae)/(O-T),Ne=fe-(fe-Ee)*te,He=d-(d-ye)*te,ze=m-(m-ve)*te,qe=k-(k-X)*te}let ke;Ae<oe?ke=0:Ae>T?ke=1:ke=(oe-Ae)/(oe-T),Ye=Q-(Q-Ee)*ke,Oe=P-(P-ye)*ke,Fe=Ce-(Ce-ve)*ke,Y=W-(W-X)*ke;const U=Math.round(Math.min(Ne,Ye)),o=Math.round(Math.max(Ne,Ye));let H=N*Ae+U*4;for(let te=U;te<=o;te++)ke=(Ne-te)/(Ne-Ye),ke<0?ke=0:ke>1&&(ke=1),u[H++]=He-(He-Oe)*ke|0,u[H++]=ze-(ze-Fe)*ke|0,u[H++]=qe-(qe-Y)*ke|0,u[H++]=255}}function r(y,_,x){const S=_.coords,n=_.colors;let i,s;switch(_.type){case"lattice":const c=_.verticesPerRow,v=Math.floor(S.length/c)-1,z=c-1;for(i=0;i<v;i++){let u=i*c;for(let N=0;N<z;N++,u++)g(y,x,S[u],S[u+1],S[u+c],n[u],n[u+1],n[u+c]),g(y,x,S[u+c+1],S[u+1],S[u+c],n[u+c+1],n[u+1],n[u+c])}break;case"triangles":for(i=0,s=S.length;i<s;i+=3)g(y,x,S[i],S[i+1],S[i+2],n[i],n[i+1],n[i+2]);break;default:throw new Error("illegal figure")}}class j extends F{constructor(_){super(),this._coords=_[2],this._colors=_[3],this._figures=_[4],this._bounds=_[5],this._bbox=_[7],this._background=_[8],this.matrix=null}_createMeshCanvas(_,x,S){const c=Math.floor(this._bounds[0]),v=Math.floor(this._bounds[1]),z=Math.ceil(this._bounds[2])-c,u=Math.ceil(this._bounds[3])-v,N=Math.min(Math.ceil(Math.abs(z*_[0]*1.1)),3e3),re=Math.min(Math.ceil(Math.abs(u*_[1]*1.1)),3e3),Q=z/N,oe=u/re,fe={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-v,scaleX:1/Q,scaleY:1/oe},O=N+2*2,Ee=re+2*2,T=S.getCanvas("mesh",O,Ee,!1),P=T.context,Ce=P.createImageData(N,re);if(x){const d=Ce.data;for(let m=0,k=d.length;m<k;m+=4)d[m]=x[0],d[m+1]=x[1],d[m+2]=x[2],d[m+3]=255}for(const d of this._figures)r(Ce,d,fe);return P.putImageData(Ce,2,2),{canvas:T.canvas,offsetX:c-2*Q,offsetY:v-2*oe,scaleX:Q,scaleY:oe}}getPattern(_,x,S,n){J(_,this._bbox);let i;if(n===Me.SHADING)i=p.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(_));else if(i=p.Util.singularValueDecompose2dScale(x.baseTransform),this.matrix){const c=p.Util.singularValueDecompose2dScale(this.matrix);i=[i[0]*c[0],i[1]*c[1]]}const s=this._createMeshCanvas(i,n===Me.SHADING?null:this._background,x.cachedCanvases);return n!==Me.SHADING&&(_.setTransform(...x.baseTransform),this.matrix&&_.transform(...this.matrix)),_.translate(s.offsetX,s.offsetY),_.scale(s.scaleX,s.scaleY),_.createPattern(s.canvas,"no-repeat")}}class I extends F{getPattern(){return"hotpink"}}function f(y){switch(y[0]){case"RadialAxial":return new D(y);case"Mesh":return new j(y);case"Dummy":return new I}throw new Error(`Unknown IR type: ${y[0]}`)}const h={COLORED:1,UNCOLORED:2},E=class E{constructor(_,x,S,n,i){this.operatorList=_[2],this.matrix=_[3]||[1,0,0,1,0,0],this.bbox=_[4],this.xstep=_[5],this.ystep=_[6],this.paintType=_[7],this.tilingType=_[8],this.color=x,this.ctx=S,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(_){const x=this.operatorList,S=this.bbox,n=this.xstep,i=this.ystep,s=this.paintType,c=this.tilingType,v=this.color,z=this.canvasGraphicsFactory;(0,p.info)("TilingType: "+c);const u=S[0],N=S[1],re=S[2],Q=S[3],oe=p.Util.singularValueDecompose2dScale(this.matrix),fe=p.Util.singularValueDecompose2dScale(this.baseTransform),O=[oe[0]*fe[0],oe[1]*fe[1]],Ee=this.getSizeAndScale(n,this.ctx.canvas.width,O[0]),T=this.getSizeAndScale(i,this.ctx.canvas.height,O[1]),P=_.cachedCanvases.getCanvas("pattern",Ee.size,T.size,!0),Ce=P.context,W=z.createCanvasGraphics(Ce);W.groupLevel=_.groupLevel,this.setFillAndStrokeStyleToContext(W,s,v);let d=u,m=N,k=re,ye=Q;return u<0&&(d=0,k+=Math.abs(u)),N<0&&(m=0,ye+=Math.abs(N)),Ce.translate(-(Ee.scale*d),-(T.scale*m)),W.transform(Ee.scale,0,0,T.scale,0,0),Ce.save(),this.clipBbox(W,d,m,k,ye),W.baseTransform=(0,M.getCurrentTransform)(W.ctx),W.executeOperatorList(x),W.endDrawing(),{canvas:P.canvas,scaleX:Ee.scale,scaleY:T.scale,offsetX:d,offsetY:m}}getSizeAndScale(_,x,S){_=Math.abs(_);const n=Math.max(E.MAX_PATTERN_SIZE,x);let i=Math.ceil(_*S);return i>=n?i=n:S=i/_,{scale:S,size:i}}clipBbox(_,x,S,n,i){const s=n-x,c=i-S;_.ctx.rect(x,S,s,c),_.current.updateRectMinMax((0,M.getCurrentTransform)(_.ctx),[x,S,n,i]),_.clip(),_.endPath()}setFillAndStrokeStyleToContext(_,x,S){const n=_.ctx,i=_.current;switch(x){case h.COLORED:const s=this.ctx;n.fillStyle=s.fillStyle,n.strokeStyle=s.strokeStyle,i.fillColor=s.fillStyle,i.strokeColor=s.strokeStyle;break;case h.UNCOLORED:const c=p.Util.makeHexColor(S[0],S[1],S[2]);n.fillStyle=c,n.strokeStyle=c,i.fillColor=c,i.strokeColor=c;break;default:throw new p.FormatError(`Unsupported paint type: ${x}`)}}getPattern(_,x,S,n){let i=S;n!==Me.SHADING&&(i=p.Util.transform(i,x.baseTransform),this.matrix&&(i=p.Util.transform(i,this.matrix)));const s=this.createPatternCanvas(x);let c=new DOMMatrix(i);c=c.translate(s.offsetX,s.offsetY),c=c.scale(1/s.scaleX,1/s.scaleY);const v=_.createPattern(s.canvas,"repeat");return v.setTransform(c),v}};at(E,"MAX_PATTERN_SIZE",3e3);let w=E;t.TilingPattern=w},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=Me,t.convertToRGBA=M,t.grayToRGBA=F;var p=le(1);function M(D){switch(D.kind){case p.ImageKind.GRAYSCALE_1BPP:return Me(D);case p.ImageKind.RGB_24BPP:return J(D)}return null}function Me({src:D,srcPos:g=0,dest:r,width:j,height:I,nonBlackColor:f=4294967295,inverseDecode:h=!1}){const w=p.FeatureTest.isLittleEndian?4278190080:255,[E,y]=h?[f,w]:[w,f],_=j>>3,x=j&7,S=D.length;r=new Uint32Array(r.buffer);let n=0;for(let i=0;i<I;i++){for(const c=g+_;g<c;g++){const v=g<S?D[g]:255;r[n++]=v&128?y:E,r[n++]=v&64?y:E,r[n++]=v&32?y:E,r[n++]=v&16?y:E,r[n++]=v&8?y:E,r[n++]=v&4?y:E,r[n++]=v&2?y:E,r[n++]=v&1?y:E}if(x===0)continue;const s=g<S?D[g++]:255;for(let c=0;c<x;c++)r[n++]=s&1<<7-c?y:E}return{srcPos:g,destPos:n}}function J({src:D,srcPos:g=0,dest:r,destPos:j=0,width:I,height:f}){let h=0;const w=D.length>>2,E=new Uint32Array(D.buffer,g,w);if(p.FeatureTest.isLittleEndian){for(;h<w-2;h+=3,j+=4){const y=E[h],_=E[h+1],x=E[h+2];r[j]=y|4278190080,r[j+1]=y>>>24|_<<8|4278190080,r[j+2]=_>>>16|x<<16|4278190080,r[j+3]=x>>>8|4278190080}for(let y=h*4,_=D.length;y<_;y+=3)r[j++]=D[y]|D[y+1]<<8|D[y+2]<<16|4278190080}else{for(;h<w-2;h+=3,j+=4){const y=E[h],_=E[h+1],x=E[h+2];r[j]=y|255,r[j+1]=y<<24|_>>>8|255,r[j+2]=_<<16|x>>>16|255,r[j+3]=x<<8|255}for(let y=h*4,_=D.length;y<_;y+=3)r[j++]=D[y]<<24|D[y+1]<<16|D[y+2]<<8|255}return{srcPos:g,destPos:j}}function F(D,g){if(p.FeatureTest.isLittleEndian)for(let r=0,j=D.length;r<j;r++)g[r]=D[r]*65793|4278190080;else for(let r=0,j=D.length;r<j;r++)g[r]=D[r]*16843008|255}},(we,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const le=Object.create(null);t.GlobalWorkerOptions=le,le.workerPort=null,le.workerSrc=""},(we,t,le)=>{var D,Gn,Xn,di;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var p=le(1);const M={UNKNOWN:0,DATA:1,ERROR:2},Me={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function J(I){switch(I instanceof Error||typeof I=="object"&&I!==null||(0,p.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),I.name){case"AbortException":return new p.AbortException(I.message);case"MissingPDFException":return new p.MissingPDFException(I.message);case"PasswordException":return new p.PasswordException(I.message,I.code);case"UnexpectedResponseException":return new p.UnexpectedResponseException(I.message,I.status);case"UnknownErrorException":return new p.UnknownErrorException(I.message,I.details);default:return new p.UnknownErrorException(I.message,I.toString())}}class F{constructor(f,h,w){Te(this,D);this.sourceName=f,this.targetName=h,this.comObj=w,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const y=E.data;if(y.targetName!==this.sourceName)return;if(y.stream){Z(this,D,Xn).call(this,y);return}if(y.callback){const x=y.callbackId,S=this.callbackCapabilities[x];if(!S)throw new Error(`Cannot resolve callback ${x}`);if(delete this.callbackCapabilities[x],y.callback===M.DATA)S.resolve(y.data);else if(y.callback===M.ERROR)S.reject(J(y.reason));else throw new Error("Unexpected callback case");return}const _=this.actionHandler[y.action];if(!_)throw new Error(`Unknown action from worker: ${y.action}`);if(y.callbackId){const x=this.sourceName,S=y.sourceName;new Promise(function(n){n(_(y.data))}).then(function(n){w.postMessage({sourceName:x,targetName:S,callback:M.DATA,callbackId:y.callbackId,data:n})},function(n){w.postMessage({sourceName:x,targetName:S,callback:M.ERROR,callbackId:y.callbackId,reason:J(n)})});return}if(y.streamId){Z(this,D,Gn).call(this,y);return}_(y.data)},w.addEventListener("message",this._onComObjOnMessage)}on(f,h){const w=this.actionHandler;if(w[f])throw new Error(`There is already an actionName called "${f}"`);w[f]=h}send(f,h,w){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:h},w)}sendWithPromise(f,h,w){const E=this.callbackId++,y=new p.PromiseCapability;this.callbackCapabilities[E]=y;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:E,data:h},w)}catch(_){y.reject(_)}return y.promise}sendWithStream(f,h,w,E){const y=this.streamId++,_=this.sourceName,x=this.targetName,S=this.comObj;return new ReadableStream({start:n=>{const i=new p.PromiseCapability;return this.streamControllers[y]={controller:n,startCall:i,pullCall:null,cancelCall:null,isClosed:!1},S.postMessage({sourceName:_,targetName:x,action:f,streamId:y,data:h,desiredSize:n.desiredSize},E),i.promise},pull:n=>{const i=new p.PromiseCapability;return this.streamControllers[y].pullCall=i,S.postMessage({sourceName:_,targetName:x,stream:Me.PULL,streamId:y,desiredSize:n.desiredSize}),i.promise},cancel:n=>{(0,p.assert)(n instanceof Error,"cancel must have a valid reason");const i=new p.PromiseCapability;return this.streamControllers[y].cancelCall=i,this.streamControllers[y].isClosed=!0,S.postMessage({sourceName:_,targetName:x,stream:Me.CANCEL,streamId:y,reason:J(n)}),i.promise}},w)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}D=new WeakSet,Gn=function(f){const h=f.streamId,w=this.sourceName,E=f.sourceName,y=this.comObj,_=this,x=this.actionHandler[f.action],S={enqueue(n,i=1,s){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=i,c>0&&this.desiredSize<=0&&(this.sinkCapability=new p.PromiseCapability,this.ready=this.sinkCapability.promise),y.postMessage({sourceName:w,targetName:E,stream:Me.ENQUEUE,streamId:h,chunk:n},s)},close(){this.isCancelled||(this.isCancelled=!0,y.postMessage({sourceName:w,targetName:E,stream:Me.CLOSE,streamId:h}),delete _.streamSinks[h])},error(n){(0,p.assert)(n instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,y.postMessage({sourceName:w,targetName:E,stream:Me.ERROR,streamId:h,reason:J(n)}))},sinkCapability:new p.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};S.sinkCapability.resolve(),S.ready=S.sinkCapability.promise,this.streamSinks[h]=S,new Promise(function(n){n(x(f.data,S))}).then(function(){y.postMessage({sourceName:w,targetName:E,stream:Me.START_COMPLETE,streamId:h,success:!0})},function(n){y.postMessage({sourceName:w,targetName:E,stream:Me.START_COMPLETE,streamId:h,reason:J(n)})})},Xn=function(f){const h=f.streamId,w=this.sourceName,E=f.sourceName,y=this.comObj,_=this.streamControllers[h],x=this.streamSinks[h];switch(f.stream){case Me.START_COMPLETE:f.success?_.startCall.resolve():_.startCall.reject(J(f.reason));break;case Me.PULL_COMPLETE:f.success?_.pullCall.resolve():_.pullCall.reject(J(f.reason));break;case Me.PULL:if(!x){y.postMessage({sourceName:w,targetName:E,stream:Me.PULL_COMPLETE,streamId:h,success:!0});break}x.desiredSize<=0&&f.desiredSize>0&&x.sinkCapability.resolve(),x.desiredSize=f.desiredSize,new Promise(function(S){var n;S((n=x.onPull)==null?void 0:n.call(x))}).then(function(){y.postMessage({sourceName:w,targetName:E,stream:Me.PULL_COMPLETE,streamId:h,success:!0})},function(S){y.postMessage({sourceName:w,targetName:E,stream:Me.PULL_COMPLETE,streamId:h,reason:J(S)})});break;case Me.ENQUEUE:if((0,p.assert)(_,"enqueue should have stream controller"),_.isClosed)break;_.controller.enqueue(f.chunk);break;case Me.CLOSE:if((0,p.assert)(_,"close should have stream controller"),_.isClosed)break;_.isClosed=!0,_.controller.close(),Z(this,D,di).call(this,_,h);break;case Me.ERROR:(0,p.assert)(_,"error should have stream controller"),_.controller.error(J(f.reason)),Z(this,D,di).call(this,_,h);break;case Me.CANCEL_COMPLETE:f.success?_.cancelCall.resolve():_.cancelCall.reject(J(f.reason)),Z(this,D,di).call(this,_,h);break;case Me.CANCEL:if(!x)break;new Promise(function(S){var n;S((n=x.onCancel)==null?void 0:n.call(x,J(f.reason)))}).then(function(){y.postMessage({sourceName:w,targetName:E,stream:Me.CANCEL_COMPLETE,streamId:h,success:!0})},function(S){y.postMessage({sourceName:w,targetName:E,stream:Me.CANCEL_COMPLETE,streamId:h,reason:J(S)})}),x.sinkCapability.reject(J(f.reason)),x.isCancelled=!0,delete this.streamSinks[h];break;default:throw new Error("Unexpected stream case")}},di=async function(f,h){var w,E,y;await Promise.allSettled([(w=f.startCall)==null?void 0:w.promise,(E=f.pullCall)==null?void 0:E.promise,(y=f.cancelCall)==null?void 0:y.promise]),delete this.streamControllers[h]},t.MessageHandler=F},(we,t,le)=>{var Me,J;Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var p=le(1);class M{constructor({parsedData:D,rawData:g}){Te(this,Me);Te(this,J);Pe(this,Me,D),Pe(this,J,g)}getRaw(){return e(this,J)}get(D){return e(this,Me).get(D)??null}getAll(){return(0,p.objectFromMap)(e(this,Me))}has(D){return e(this,Me).has(D)}}Me=new WeakMap,J=new WeakMap,t.Metadata=M},(we,t,le)=>{var D,g,r,j,I,f,$i;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var p=le(1),M=le(8);const Me=Symbol("INTERNAL");class J{constructor(E,y){Te(this,D,!0);this.name=E,this.intent=y}get visible(){return e(this,D)}_setVisible(E,y){E!==Me&&(0,p.unreachable)("Internal method `_setVisible` called."),Pe(this,D,y)}}D=new WeakMap;class F{constructor(E){Te(this,f);Te(this,g,null);Te(this,r,new Map);Te(this,j,null);Te(this,I,null);if(this.name=null,this.creator=null,E!==null){this.name=E.name,this.creator=E.creator,Pe(this,I,E.order);for(const y of E.groups)e(this,r).set(y.id,new J(y.name,y.intent));if(E.baseState==="OFF")for(const y of e(this,r).values())y._setVisible(Me,!1);for(const y of E.on)e(this,r).get(y)._setVisible(Me,!0);for(const y of E.off)e(this,r).get(y)._setVisible(Me,!1);Pe(this,j,this.getHash())}}isVisible(E){if(e(this,r).size===0)return!0;if(!E)return(0,p.warn)("Optional content group not defined."),!0;if(E.type==="OCG")return e(this,r).has(E.id)?e(this,r).get(E.id).visible:((0,p.warn)(`Optional content group not found: ${E.id}`),!0);if(E.type==="OCMD"){if(E.expression)return Z(this,f,$i).call(this,E.expression);if(!E.policy||E.policy==="AnyOn"){for(const y of E.ids){if(!e(this,r).has(y))return(0,p.warn)(`Optional content group not found: ${y}`),!0;if(e(this,r).get(y).visible)return!0}return!1}else if(E.policy==="AllOn"){for(const y of E.ids){if(!e(this,r).has(y))return(0,p.warn)(`Optional content group not found: ${y}`),!0;if(!e(this,r).get(y).visible)return!1}return!0}else if(E.policy==="AnyOff"){for(const y of E.ids){if(!e(this,r).has(y))return(0,p.warn)(`Optional content group not found: ${y}`),!0;if(!e(this,r).get(y).visible)return!0}return!1}else if(E.policy==="AllOff"){for(const y of E.ids){if(!e(this,r).has(y))return(0,p.warn)(`Optional content group not found: ${y}`),!0;if(e(this,r).get(y).visible)return!1}return!0}return(0,p.warn)(`Unknown optional content policy ${E.policy}.`),!0}return(0,p.warn)(`Unknown group type ${E.type}.`),!0}setVisibility(E,y=!0){if(!e(this,r).has(E)){(0,p.warn)(`Optional content group not found: ${E}`);return}e(this,r).get(E)._setVisible(Me,!!y),Pe(this,g,null)}get hasInitialVisibility(){return e(this,j)===null||this.getHash()===e(this,j)}getOrder(){return e(this,r).size?e(this,I)?e(this,I).slice():[...e(this,r).keys()]:null}getGroups(){return e(this,r).size>0?(0,p.objectFromMap)(e(this,r)):null}getGroup(E){return e(this,r).get(E)||null}getHash(){if(e(this,g)!==null)return e(this,g);const E=new M.MurmurHash3_64;for(const[y,_]of e(this,r))E.update(`${y}:${_.visible}`);return Pe(this,g,E.hexdigest())}}g=new WeakMap,r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakSet,$i=function(E){const y=E.length;if(y<2)return!0;const _=E[0];for(let x=1;x<y;x++){const S=E[x];let n;if(Array.isArray(S))n=Z(this,f,$i).call(this,S);else if(e(this,r).has(S))n=e(this,r).get(S).visible;else return(0,p.warn)(`Optional content group not found: ${S}`),!0;switch(_){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return _==="And"},t.OptionalContentConfig=F},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var p=le(1),M=le(6);class Me{constructor({length:g,initialData:r,progressiveDone:j=!1,contentDispositionFilename:I=null,disableRange:f=!1,disableStream:h=!1},w){if((0,p.assert)(w,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=I,(r==null?void 0:r.length)>0){const E=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=w,this._isStreamingSupported=!h,this._isRangeSupported=!f,this._contentLength=g,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((E,y)=>{this._onReceiveData({begin:E,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((E,y)=>{this._onProgress({loaded:E,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:g,chunk:r}){const j=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;if(g===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const I=this._rangeReaders.some(function(f){return f._begin!==g?!1:(f._enqueue(j),!0)});(0,p.assert)(I,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}_onProgress(g){var r,j,I,f;g.total===void 0?(j=(r=this._rangeReaders[0])==null?void 0:r.onProgress)==null||j.call(r,{loaded:g.loaded}):(f=(I=this._fullRequestReader)==null?void 0:I.onProgress)==null||f.call(I,{loaded:g.loaded,total:g.total})}_onProgressiveDone(){var g;(g=this._fullRequestReader)==null||g.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(g){const r=this._rangeReaders.indexOf(g);r>=0&&this._rangeReaders.splice(r,1)}getFullReader(){(0,p.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const g=this._queuedChunks;return this._queuedChunks=null,new J(this,g,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(g,r){if(r<=this._progressiveDataLength)return null;const j=new F(this,g,r);return this._pdfDataRangeTransport.requestDataRange(g,r),this._rangeReaders.push(j),j}cancelAllRequests(g){var r;(r=this._fullRequestReader)==null||r.cancel(g);for(const j of this._rangeReaders.slice(0))j.cancel(g);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=Me;class J{constructor(g,r,j=!1,I=null){this._stream=g,this._done=j||!1,this._filename=(0,M.isPdfFile)(I)?I:null,this._queuedChunks=r||[],this._loaded=0;for(const f of this._queuedChunks)this._loaded+=f.byteLength;this._requests=[],this._headersReady=Promise.resolve(),g._fullRequestReader=this,this.onProgress=null}_enqueue(g){this._done||(this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunks.push(g),this._loaded+=g.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const g=new p.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class F{constructor(g,r,j){this._stream=g,this._begin=r,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(g){if(!this._done){if(this._requests.length===0)this._queuedChunk=g;else{this._requests.shift().resolve({value:g,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const r=this._queuedChunk;return this._queuedChunk=null,{value:r,done:!1}}if(this._done)return{value:void 0,done:!0};const g=new p.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var p=le(1),M=le(20);function Me(j,I,f){return{method:"GET",headers:j,signal:f.signal,mode:"cors",credentials:I?"include":"same-origin",redirect:"follow"}}function J(j){const I=new Headers;for(const f in j){const h=j[f];h!==void 0&&I.append(f,h)}return I}function F(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,p.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class D{constructor(I){this.source=I,this.isHttp=/^https?:/i.test(I.url),this.httpHeaders=this.isHttp&&I.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}getFullReader(){return(0,p.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new g(this),this._fullRequestReader}getRangeReader(I,f){if(f<=this._progressiveDataLength)return null;const h=new r(this,I,f);return this._rangeRequestReaders.push(h),h}cancelAllRequests(I){var f;(f=this._fullRequestReader)==null||f.cancel(I);for(const h of this._rangeRequestReaders.slice(0))h.cancel(I)}}t.PDFFetchStream=D;class g{constructor(I){this._stream=I,this._reader=null,this._loaded=0,this._filename=null;const f=I.source;this._withCredentials=f.withCredentials||!1,this._contentLength=f.length,this._headersCapability=new p.PromiseCapability,this._disableRange=f.disableRange||!1,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._headers=J(this._stream.httpHeaders);const h=f.url;fetch(h,Me(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,M.validateResponseStatus)(w.status))throw(0,M.createResponseStatusError)(w.status,h);this._reader=w.body.getReader(),this._headersCapability.resolve();const E=x=>w.headers.get(x),{allowRangeRequests:y,suggestedLength:_}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=_||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(E),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new p.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._headersCapability.promise;const{value:I,done:f}=await this._reader.read();return f?{value:I,done:f}:(this._loaded+=I.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded,total:this._contentLength}),{value:F(I),done:!1})}cancel(I){var f;(f=this._reader)==null||f.cancel(I),this._abortController.abort()}}class r{constructor(I,f,h){this._stream=I,this._reader=null,this._loaded=0;const w=I.source;this._withCredentials=w.withCredentials||!1,this._readCapability=new p.PromiseCapability,this._isStreamingSupported=!w.disableStream,this._abortController=new AbortController,this._headers=J(this._stream.httpHeaders),this._headers.append("Range",`bytes=${f}-${h-1}`);const E=w.url;fetch(E,Me(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,M.validateResponseStatus)(y.status))throw(0,M.createResponseStatusError)(y.status,E);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._readCapability.promise;const{value:I,done:f}=await this._reader.read();return f?{value:I,done:f}:(this._loaded+=I.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded}),{value:F(I),done:!1})}cancel(I){var f;(f=this._reader)==null||f.cancel(I),this._abortController.abort()}}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=D,t.extractFilenameFromHeader=F,t.validateRangeRequestCapabilities=J,t.validateResponseStatus=g;var p=le(1),M=le(21),Me=le(6);function J({getResponseHeader:r,isHttp:j,rangeChunkSize:I,disableRange:f}){const h={allowRangeRequests:!1,suggestedLength:void 0},w=parseInt(r("Content-Length"),10);return!Number.isInteger(w)||(h.suggestedLength=w,w<=2*I)||f||!j||r("Accept-Ranges")!=="bytes"||(r("Content-Encoding")||"identity")!=="identity"||(h.allowRangeRequests=!0),h}function F(r){const j=r("Content-Disposition");if(j){let I=(0,M.getFilenameFromContentDispositionHeader)(j);if(I.includes("%"))try{I=decodeURIComponent(I)}catch{}if((0,Me.isPdfFile)(I))return I}return null}function D(r,j){return r===404||r===0&&j.startsWith("file:")?new p.MissingPDFException('Missing PDF "'+j+'".'):new p.UnexpectedResponseException(`Unexpected server response (${r}) while retrieving PDF "${j}".`,r)}function g(r){return r===200||r===206}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=M;var p=le(1);function M(Me){let J=!0,F=D("filename\\*","i").exec(Me);if(F){F=F[1];let w=I(F);return w=unescape(w),w=f(w),w=h(w),r(w)}if(F=j(Me),F){const w=h(F);return r(w)}if(F=D("filename","i").exec(Me),F){F=F[1];let w=I(F);return w=h(w),r(w)}function D(w,E){return new RegExp("(?:^|;)\\s*"+w+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',E)}function g(w,E){if(w){if(!/^[\x00-\xFF]+$/.test(E))return E;try{const y=new TextDecoder(w,{fatal:!0}),_=(0,p.stringToBytes)(E);E=y.decode(_),J=!1}catch{}}return E}function r(w){return J&&/[\x80-\xff]/.test(w)&&(w=g("utf-8",w),J&&(w=g("iso-8859-1",w))),w}function j(w){const E=[];let y;const _=D("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=_.exec(w))!==null;){let[,S,n,i]=y;if(S=parseInt(S,10),S in E){if(S===0)break;continue}E[S]=[n,i]}const x=[];for(let S=0;S<E.length&&S in E;++S){let[n,i]=E[S];i=I(i),n&&(i=unescape(i),S===0&&(i=f(i))),x.push(i)}return x.join("")}function I(w){if(w.startsWith('"')){const E=w.slice(1).split('\\"');for(let y=0;y<E.length;++y){const _=E[y].indexOf('"');_!==-1&&(E[y]=E[y].slice(0,_),E.length=y+1),E[y]=E[y].replaceAll(/\\(.)/g,"$1")}w=E.join('"')}return w}function f(w){const E=w.indexOf("'");if(E===-1)return w;const y=w.slice(0,E),x=w.slice(E+1).replace(/^[^']*'/,"");return g(y,x)}function h(w){return!w.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(w)?w:w.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(E,y,_,x){if(_==="q"||_==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,n){return String.fromCharCode(parseInt(n,16))}),g(y,x);try{x=atob(x)}catch{}return g(y,x)})}return""}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var p=le(1),M=le(20);const Me=200,J=206;function F(I){const f=I.response;return typeof f!="string"?f:(0,p.stringToBytes)(f).buffer}class D{constructor(f,h={}){this.url=f,this.isHttp=/^https?:/i.test(f),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(f,h,w){const E={begin:f,end:h};for(const y in w)E[y]=w[y];return this.request(E)}requestFull(f){return this.request(f)}request(f){const h=new XMLHttpRequest,w=this.currXhrId++,E=this.pendingRequests[w]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const y in this.httpHeaders){const _=this.httpHeaders[y];_!==void 0&&h.setRequestHeader(y,_)}return this.isHttp&&"begin"in f&&"end"in f?(h.setRequestHeader("Range",`bytes=${f.begin}-${f.end-1}`),E.expectedStatus=J):E.expectedStatus=Me,h.responseType="arraybuffer",f.onError&&(h.onerror=function(y){f.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,w),h.onprogress=this.onProgress.bind(this,w),E.onHeadersReceived=f.onHeadersReceived,E.onDone=f.onDone,E.onError=f.onError,E.onProgress=f.onProgress,h.send(null),w}onProgress(f,h){var E;const w=this.pendingRequests[f];w&&((E=w.onProgress)==null||E.call(w,h))}onStateChange(f,h){var S,n,i;const w=this.pendingRequests[f];if(!w)return;const E=w.xhr;if(E.readyState>=2&&w.onHeadersReceived&&(w.onHeadersReceived(),delete w.onHeadersReceived),E.readyState!==4||!(f in this.pendingRequests))return;if(delete this.pendingRequests[f],E.status===0&&this.isHttp){(S=w.onError)==null||S.call(w,E.status);return}const y=E.status||Me;if(!(y===Me&&w.expectedStatus===J)&&y!==w.expectedStatus){(n=w.onError)==null||n.call(w,E.status);return}const x=F(E);if(y===J){const s=E.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(s);w.onDone({begin:parseInt(c[1],10),chunk:x})}else x?w.onDone({begin:0,chunk:x}):(i=w.onError)==null||i.call(w,E.status)}getRequestXhr(f){return this.pendingRequests[f].xhr}isPendingRequest(f){return f in this.pendingRequests}abortRequest(f){const h=this.pendingRequests[f].xhr;delete this.pendingRequests[f],h.abort()}}class g{constructor(f){this._source=f,this._manager=new D(f.url,{httpHeaders:f.httpHeaders,withCredentials:f.withCredentials}),this._rangeChunkSize=f.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(f){const h=this._rangeRequestReaders.indexOf(f);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,p.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new r(this._manager,this._source),this._fullRequestReader}getRangeReader(f,h){const w=new j(this._manager,f,h);return w.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(w),w}cancelAllRequests(f){var h;(h=this._fullRequestReader)==null||h.cancel(f);for(const w of this._rangeRequestReaders.slice(0))w.cancel(f)}}t.PDFNetworkStream=g;class r{constructor(f,h){this._manager=f;const w={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=f.requestFull(w),this._headersReceivedCapability=new p.PromiseCapability,this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const f=this._fullRequestId,h=this._manager.getRequestXhr(f),w=_=>h.getResponseHeader(_),{allowRangeRequests:E,suggestedLength:y}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=y||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(w),this._isRangeSupported&&this._manager.abortRequest(f),this._headersReceivedCapability.resolve()}_onDone(f){if(f&&(this._requests.length>0?this._requests.shift().resolve({value:f.chunk,done:!1}):this._cachedChunks.push(f.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(f){this._storedError=(0,M.createResponseStatusError)(f,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(f){var h;(h=this.onProgress)==null||h.call(this,{loaded:f.loaded,total:f.lengthComputable?f.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=new p.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0,this._headersReceivedCapability.reject(f);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(f,h,w){this._manager=f;const E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=f.url,this._requestId=f.requestRange(h,w,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var f;(f=this.onClosed)==null||f.call(this,this)}_onDone(f){const h=f.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(f){this._storedError=(0,M.createResponseStatusError)(f,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(f){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:f.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const f=new p.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var p=le(1),M=le(20);const Me=/^file:\/\/\/[a-zA-Z]:\//;function J(w){const E=require$$5,y=E.parse(w);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(w)?E.parse(`file:///${w}`):(y.host||(y.protocol="file:"),y)}class F{constructor(E){this.source=E,this.url=J(E.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}getFullReader(){return(0,p.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new f(this):new j(this),this._fullRequestReader}getRangeReader(E,y){if(y<=this._progressiveDataLength)return null;const _=this.isFsUrl?new h(this,E,y):new I(this,E,y);return this._rangeRequestReaders.push(_),_}cancelAllRequests(E){var y;(y=this._fullRequestReader)==null||y.cancel(E);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(E)}}t.PDFNodeStream=F;class D{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null;const y=E.source;this._contentLength=y.length,this._loaded=0,this._filename=null,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._readableStream=null,this._readCapability=new p.PromiseCapability,this._headersCapability=new p.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new p.PromiseCapability,this.read()):(this._loaded+=E.length,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",y=>{this._error(y)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new p.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class g{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new p.PromiseCapability;const y=E.source;this._isStreamingSupported=!y.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new p.PromiseCapability,this.read()):(this._loaded+=E.length,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",y=>{this._error(y)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function r(w,E){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:E}}class j extends D{constructor(E){super(E);const y=_=>{if(_.statusCode===404){const i=new p.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=i,this._headersCapability.reject(i);return}this._headersCapability.resolve(),this._setReadableStream(_);const x=i=>this._readableStream.headers[i.toLowerCase()],{allowRangeRequests:S,suggestedLength:n}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:E.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=S,this._contentLength=n||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(x)};if(this._request=null,this._url.protocol==="http:"){const _=require$$5;this._request=_.request(r(this._url,E.httpHeaders),y)}else{const _=require$$5;this._request=_.request(r(this._url,E.httpHeaders),y)}this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class I extends g{constructor(E,y,_){super(E),this._httpHeaders={};for(const S in E.httpHeaders){const n=E.httpHeaders[S];n!==void 0&&(this._httpHeaders[S]=n)}this._httpHeaders.Range=`bytes=${y}-${_-1}`;const x=S=>{if(S.statusCode===404){const n=new p.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=n;return}this._setReadableStream(S)};if(this._request=null,this._url.protocol==="http:"){const S=require$$5;this._request=S.request(r(this._url,this._httpHeaders),x)}else{const S=require$$5;this._request=S.request(r(this._url,this._httpHeaders),x)}this._request.on("error",S=>{this._storedError=S}),this._request.end()}}class f extends D{constructor(E){super(E);let y=decodeURIComponent(this._url.path);Me.test(this._url.href)&&(y=y.replace(/^\//,""));const _=require$$5;_.lstat(y,(x,S)=>{if(x){x.code==="ENOENT"&&(x=new p.MissingPDFException(`Missing PDF "${y}".`)),this._storedError=x,this._headersCapability.reject(x);return}this._contentLength=S.size,this._setReadableStream(_.createReadStream(y)),this._headersCapability.resolve()})}}class h extends g{constructor(E,y,_){super(E);let x=decodeURIComponent(this._url.path);Me.test(this._url.href)&&(x=x.replace(/^\//,""));const S=require$$5;this._setReadableStream(S.createReadStream(x,{start:y,end:_-1}))}}},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var p=le(6),M=le(1);const Me={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},J="http://www.w3.org/XML/1998/namespace",F="http://www.w3.org/1999/xlink",D=["butt","round","square"],g=["miter","round","bevel"],r=function(S,n="",i=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!i)return URL.createObjectURL(new Blob([S],{type:n}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${n};base64,`;for(let v=0,z=S.length;v<z;v+=3){const u=S[v]&255,N=S[v+1]&255,re=S[v+2]&255,Q=u>>2,oe=(u&3)<<4|N>>4,fe=v+1<z?(N&15)<<2|re>>6:64,O=v+2<z?re&63:64;c+=s[Q]+s[oe]+s[fe]+s[O]}return c},j=function(){const S=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,i=new Int32Array(256);for(let re=0;re<256;re++){let Q=re;for(let oe=0;oe<8;oe++)Q=Q&1?3988292384^Q>>1&2147483647:Q>>1&2147483647;i[re]=Q}function s(re,Q,oe){let fe=-1;for(let O=Q;O<oe;O++){const Ee=(fe^re[O])&255,T=i[Ee];fe=fe>>>8^T}return fe^-1}function c(re,Q,oe,fe){let O=fe;const Ee=Q.length;oe[O]=Ee>>24&255,oe[O+1]=Ee>>16&255,oe[O+2]=Ee>>8&255,oe[O+3]=Ee&255,O+=4,oe[O]=re.charCodeAt(0)&255,oe[O+1]=re.charCodeAt(1)&255,oe[O+2]=re.charCodeAt(2)&255,oe[O+3]=re.charCodeAt(3)&255,O+=4,oe.set(Q,O),O+=Q.length;const T=s(oe,fe+4,O);oe[O]=T>>24&255,oe[O+1]=T>>16&255,oe[O+2]=T>>8&255,oe[O+3]=T&255}function v(re,Q,oe){let fe=1,O=0;for(let Ee=Q;Ee<oe;++Ee)fe=(fe+(re[Ee]&255))%65521,O=(O+fe)%65521;return O<<16|fe}function z(re){if(!M.isNodeJS)return u(re);try{const Q=parseInt(process.versions.node)>=8?re:Buffer.from(re),oe=require$$5.deflateSync(Q,{level:9});return oe instanceof Uint8Array?oe:new Uint8Array(oe)}catch(Q){(0,M.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return u(re)}function u(re){let Q=re.length;const oe=65535,fe=Math.ceil(Q/oe),O=new Uint8Array(2+Q+fe*5+4);let Ee=0;O[Ee++]=120,O[Ee++]=156;let T=0;for(;Q>oe;)O[Ee++]=0,O[Ee++]=255,O[Ee++]=255,O[Ee++]=0,O[Ee++]=0,O.set(re.subarray(T,T+oe),Ee),Ee+=oe,T+=oe,Q-=oe;O[Ee++]=1,O[Ee++]=Q&255,O[Ee++]=Q>>8&255,O[Ee++]=~Q&65535&255,O[Ee++]=(~Q&65535)>>8&255,O.set(re.subarray(T),Ee),Ee+=re.length-T;const P=v(re,0,re.length);return O[Ee++]=P>>24&255,O[Ee++]=P>>16&255,O[Ee++]=P>>8&255,O[Ee++]=P&255,O}function N(re,Q,oe,fe){const O=re.width,Ee=re.height;let T,P,Ce;const W=re.data;switch(Q){case M.ImageKind.GRAYSCALE_1BPP:P=0,T=1,Ce=O+7>>3;break;case M.ImageKind.RGB_24BPP:P=2,T=8,Ce=O*3;break;case M.ImageKind.RGBA_32BPP:P=6,T=8,Ce=O*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+Ce)*Ee);let m=0,k=0;for(let Ne=0;Ne<Ee;++Ne)d[m++]=0,d.set(W.subarray(k,k+Ce),m),k+=Ce,m+=Ce;if(Q===M.ImageKind.GRAYSCALE_1BPP&&fe){m=0;for(let Ne=0;Ne<Ee;Ne++){m++;for(let He=0;He<Ce;He++)d[m++]^=255}}const ye=new Uint8Array([O>>24&255,O>>16&255,O>>8&255,O&255,Ee>>24&255,Ee>>16&255,Ee>>8&255,Ee&255,T,P,0,0,0]),ve=z(d),X=S.length+n*3+ye.length+ve.length,Se=new Uint8Array(X);let Re=0;return Se.set(S,Re),Re+=S.length,c("IHDR",ye,Se,Re),Re+=n+ye.length,c("IDATA",ve,Se,Re),Re+=n+ve.length,c("IEND",new Uint8Array(0),Se,Re),r(Se,"image/png",oe)}return function(Q,oe,fe){const O=Q.kind===void 0?M.ImageKind.GRAYSCALE_1BPP:Q.kind;return N(Q,O,oe,fe)}}();class I{constructor(){this.fontSizeScale=1,this.fontWeight=Me.fontWeight,this.fontSize=0,this.textMatrix=M.IDENTITY_MATRIX,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=M.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Me.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,i){this.x=n,this.y=i}}function f(S){let n=[];const i=[];for(const s of S){if(s.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),i.push(n),n=n.at(-1).items;continue}s.fn==="restore"?n=i.pop():n.push(s)}return n}function h(S){if(Number.isInteger(S))return S.toString();const n=S.toFixed(10);let i=n.length-1;if(n[i]!=="0")return n;do i--;while(n[i]==="0");return n.substring(0,n[i]==="."?i:i+1)}function w(S){if(S[4]===0&&S[5]===0){if(S[1]===0&&S[2]===0)return S[0]===1&&S[3]===1?"":`scale(${h(S[0])} ${h(S[3])})`;if(S[0]===S[3]&&S[1]===-S[2]){const n=Math.acos(S[0])*180/Math.PI;return`rotate(${h(n)})`}}else if(S[0]===1&&S[1]===0&&S[2]===0&&S[3]===1)return`translate(${h(S[4])} ${h(S[5])})`;return`matrix(${h(S[0])} ${h(S[1])} ${h(S[2])} ${h(S[3])} ${h(S[4])} ${h(S[5])})`}let E=0,y=0,_=0;class x{constructor(n,i,s=!1){(0,p.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new p.DOMSVGFactory,this.current=new I,this.transformMatrix=M.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=n,this.objs=i,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!s,this._operatorIdMapping=[];for(const c in M.OPS)this._operatorIdMapping[M.OPS[c]]=c}getObject(n,i=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):i}save(){this.transformStack.push(this.transformMatrix);const n=this.current;this.extraStack.push(n),this.current=n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(n){this.save(),this.executeOpTree(n),this.restore()}loadDependencies(n){const i=n.fnArray,s=n.argsArray;for(let c=0,v=i.length;c<v;c++)if(i[c]===M.OPS.dependency)for(const z of s[c]){const u=z.startsWith("g_")?this.commonObjs:this.objs,N=new Promise(re=>{u.get(z,re)});this.current.dependencies.push(N)}return Promise.all(this.current.dependencies)}transform(n,i,s,c,v,z){const u=[n,i,s,c,v,z];this.transformMatrix=M.Util.transform(this.transformMatrix,u),this.tgrp=null}getSVG(n,i){this.viewport=i;const s=this._initialize(i);return this.loadDependencies(n).then(()=>(this.transformMatrix=M.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(n)),s))}convertOpList(n){const i=this._operatorIdMapping,s=n.argsArray,c=n.fnArray,v=[];for(let z=0,u=c.length;z<u;z++){const N=c[z];v.push({fnId:N,fn:i[N],args:s[z]})}return f(v)}executeOpTree(n){for(const i of n){const s=i.fn,c=i.fnId,v=i.args;switch(c|0){case M.OPS.beginText:this.beginText();break;case M.OPS.dependency:break;case M.OPS.setLeading:this.setLeading(v);break;case M.OPS.setLeadingMoveText:this.setLeadingMoveText(v[0],v[1]);break;case M.OPS.setFont:this.setFont(v);break;case M.OPS.showText:this.showText(v[0]);break;case M.OPS.showSpacedText:this.showText(v[0]);break;case M.OPS.endText:this.endText();break;case M.OPS.moveText:this.moveText(v[0],v[1]);break;case M.OPS.setCharSpacing:this.setCharSpacing(v[0]);break;case M.OPS.setWordSpacing:this.setWordSpacing(v[0]);break;case M.OPS.setHScale:this.setHScale(v[0]);break;case M.OPS.setTextMatrix:this.setTextMatrix(v[0],v[1],v[2],v[3],v[4],v[5]);break;case M.OPS.setTextRise:this.setTextRise(v[0]);break;case M.OPS.setTextRenderingMode:this.setTextRenderingMode(v[0]);break;case M.OPS.setLineWidth:this.setLineWidth(v[0]);break;case M.OPS.setLineJoin:this.setLineJoin(v[0]);break;case M.OPS.setLineCap:this.setLineCap(v[0]);break;case M.OPS.setMiterLimit:this.setMiterLimit(v[0]);break;case M.OPS.setFillRGBColor:this.setFillRGBColor(v[0],v[1],v[2]);break;case M.OPS.setStrokeRGBColor:this.setStrokeRGBColor(v[0],v[1],v[2]);break;case M.OPS.setStrokeColorN:this.setStrokeColorN(v);break;case M.OPS.setFillColorN:this.setFillColorN(v);break;case M.OPS.shadingFill:this.shadingFill(v[0]);break;case M.OPS.setDash:this.setDash(v[0],v[1]);break;case M.OPS.setRenderingIntent:this.setRenderingIntent(v[0]);break;case M.OPS.setFlatness:this.setFlatness(v[0]);break;case M.OPS.setGState:this.setGState(v[0]);break;case M.OPS.fill:this.fill();break;case M.OPS.eoFill:this.eoFill();break;case M.OPS.stroke:this.stroke();break;case M.OPS.fillStroke:this.fillStroke();break;case M.OPS.eoFillStroke:this.eoFillStroke();break;case M.OPS.clip:this.clip("nonzero");break;case M.OPS.eoClip:this.clip("evenodd");break;case M.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case M.OPS.paintImageXObject:this.paintImageXObject(v[0]);break;case M.OPS.paintInlineImageXObject:this.paintInlineImageXObject(v[0]);break;case M.OPS.paintImageMaskXObject:this.paintImageMaskXObject(v[0]);break;case M.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(v[0],v[1]);break;case M.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case M.OPS.closePath:this.closePath();break;case M.OPS.closeStroke:this.closeStroke();break;case M.OPS.closeFillStroke:this.closeFillStroke();break;case M.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case M.OPS.nextLine:this.nextLine();break;case M.OPS.transform:this.transform(v[0],v[1],v[2],v[3],v[4],v[5]);break;case M.OPS.constructPath:this.constructPath(v[0],v[1]);break;case M.OPS.endPath:this.endPath();break;case 92:this.group(i.items);break;default:(0,M.warn)(`Unimplemented operator ${s}`);break}}}setWordSpacing(n){this.current.wordSpacing=n}setCharSpacing(n){this.current.charSpacing=n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(n,i,s,c,v,z){const u=this.current;u.textMatrix=u.lineMatrix=[n,i,s,c,v,z],u.textMatrixScale=Math.hypot(n,i),u.x=u.lineX=0,u.y=u.lineY=0,u.xcoords=[],u.ycoords=[],u.tspan=this.svgFactory.createElement("svg:tspan"),u.tspan.setAttributeNS(null,"font-family",u.fontFamily),u.tspan.setAttributeNS(null,"font-size",`${h(u.fontSize)}px`),u.tspan.setAttributeNS(null,"y",h(-u.y)),u.txtElement=this.svgFactory.createElement("svg:text"),u.txtElement.append(u.tspan)}beginText(){const n=this.current;n.x=n.lineX=0,n.y=n.lineY=0,n.textMatrix=M.IDENTITY_MATRIX,n.lineMatrix=M.IDENTITY_MATRIX,n.textMatrixScale=1,n.tspan=this.svgFactory.createElement("svg:tspan"),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtgrp=this.svgFactory.createElement("svg:g"),n.xcoords=[],n.ycoords=[]}moveText(n,i){const s=this.current;s.x=s.lineX+=n,s.y=s.lineY+=i,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${h(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",h(-s.y))}showText(n){const i=this.current,s=i.font,c=i.fontSize;if(c===0)return;const v=i.fontSizeScale,z=i.charSpacing,u=i.wordSpacing,N=i.fontDirection,re=i.textHScale*N,Q=s.vertical,oe=Q?1:-1,fe=s.defaultVMetrics,O=c*i.fontMatrix[0];let Ee=0;for(const Ce of n){if(Ce===null){Ee+=N*u;continue}else if(typeof Ce=="number"){Ee+=oe*Ce*c/1e3;continue}const W=(Ce.isSpace?u:0)+z,d=Ce.fontChar;let m,k,ye=Ce.width;if(Q){let X;const Se=Ce.vmetric||fe;X=Ce.vmetric?Se[1]:ye*.5,X=-X*O;const Re=Se[2]*O;ye=Se?-Se[0]:ye,m=X/v,k=(Ee+Re)/v}else m=Ee/v,k=0;(Ce.isInFont||s.missingFile)&&(i.xcoords.push(i.x+m),Q&&i.ycoords.push(-i.y+k),i.tspan.textContent+=d);const ve=Q?ye*O-W*N:ye*O+W*N;Ee+=ve}i.tspan.setAttributeNS(null,"x",i.xcoords.map(h).join(" ")),Q?i.tspan.setAttributeNS(null,"y",i.ycoords.map(h).join(" ")):i.tspan.setAttributeNS(null,"y",h(-i.y)),Q?i.y-=Ee:i.x+=Ee*re,i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${h(i.fontSize)}px`),i.fontStyle!==Me.fontStyle&&i.tspan.setAttributeNS(null,"font-style",i.fontStyle),i.fontWeight!==Me.fontWeight&&i.tspan.setAttributeNS(null,"font-weight",i.fontWeight);const T=i.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;if(T===M.TextRenderingMode.FILL||T===M.TextRenderingMode.FILL_STROKE?(i.fillColor!==Me.fillColor&&i.tspan.setAttributeNS(null,"fill",i.fillColor),i.fillAlpha<1&&i.tspan.setAttributeNS(null,"fill-opacity",i.fillAlpha)):i.textRenderingMode===M.TextRenderingMode.ADD_TO_PATH?i.tspan.setAttributeNS(null,"fill","transparent"):i.tspan.setAttributeNS(null,"fill","none"),T===M.TextRenderingMode.STROKE||T===M.TextRenderingMode.FILL_STROKE){const Ce=1/(i.textMatrixScale||1);this._setStrokeAttributes(i.tspan,Ce)}let P=i.textMatrix;i.textRise!==0&&(P=P.slice(),P[5]+=i.textRise),i.txtElement.setAttributeNS(null,"transform",`${w(P)} scale(${h(re)}, -1)`),i.txtElement.setAttributeNS(J,"xml:space","preserve"),i.txtElement.append(i.tspan),i.txtgrp.append(i.txtElement),this._ensureTransformGroup().append(i.txtElement)}setLeadingMoveText(n,i){this.setLeading(-i),this.moveText(n,i)}addFontStyle(n){if(!n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const i=r(n.data,n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${n.loadedName}"; src: url(${i}); }
`}setFont(n){const i=this.current,s=this.commonObjs.get(n[0]);let c=n[1];i.font=s,this.embedFonts&&!s.missingFile&&!this.embeddedFonts[s.loadedName]&&(this.addFontStyle(s),this.embeddedFonts[s.loadedName]=s),i.fontMatrix=s.fontMatrix||M.FONT_IDENTITY_MATRIX;let v="normal";s.black?v="900":s.bold&&(v="bold");const z=s.italic?"italic":"normal";c<0?(c=-c,i.fontDirection=-1):i.fontDirection=1,i.fontSize=c,i.fontFamily=s.loadedName,i.fontWeight=v,i.fontStyle=z,i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"y",h(-i.y)),i.xcoords=[],i.ycoords=[]}endText(){var i;const n=this.current;n.textRenderingMode&M.TextRenderingMode.ADD_TO_PATH_FLAG&&((i=n.txtElement)!=null&&i.hasChildNodes())&&(n.element=n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(n){n>0&&(this.current.lineWidth=n)}setLineCap(n){this.current.lineCap=D[n]}setLineJoin(n){this.current.lineJoin=g[n]}setMiterLimit(n){this.current.miterLimit=n}setStrokeAlpha(n){this.current.strokeAlpha=n}setStrokeRGBColor(n,i,s){this.current.strokeColor=M.Util.makeHexColor(n,i,s)}setFillAlpha(n){this.current.fillAlpha=n}setFillRGBColor(n,i,s){this.current.fillColor=M.Util.makeHexColor(n,i,s),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(n){this.current.strokeColor=this._makeColorN_Pattern(n)}setFillColorN(n){this.current.fillColor=this._makeColorN_Pattern(n)}shadingFill(n){const{width:i,height:s}=this.viewport,c=M.Util.inverseTransform(this.transformMatrix),[v,z,u,N]=M.Util.getAxialAlignedBoundingBox([0,0,i,s],c),re=this.svgFactory.createElement("svg:rect");re.setAttributeNS(null,"x",v),re.setAttributeNS(null,"y",z),re.setAttributeNS(null,"width",u-v),re.setAttributeNS(null,"height",N-z),re.setAttributeNS(null,"fill",this._makeShadingPattern(n)),this.current.fillAlpha<1&&re.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(re)}_makeColorN_Pattern(n){return n[0]==="TilingPattern"?this._makeTilingPattern(n):this._makeShadingPattern(n)}_makeTilingPattern(n){const i=n[1],s=n[2],c=n[3]||M.IDENTITY_MATRIX,[v,z,u,N]=n[4],re=n[5],Q=n[6],oe=n[7],fe=`shading${_++}`,[O,Ee,T,P]=M.Util.normalizeRect([...M.Util.applyTransform([v,z],c),...M.Util.applyTransform([u,N],c)]),[Ce,W]=M.Util.singularValueDecompose2dScale(c),d=re*Ce,m=Q*W,k=this.svgFactory.createElement("svg:pattern");k.setAttributeNS(null,"id",fe),k.setAttributeNS(null,"patternUnits","userSpaceOnUse"),k.setAttributeNS(null,"width",d),k.setAttributeNS(null,"height",m),k.setAttributeNS(null,"x",`${O}`),k.setAttributeNS(null,"y",`${Ee}`);const ye=this.svg,ve=this.transformMatrix,X=this.current.fillColor,Se=this.current.strokeColor,Re=this.svgFactory.create(T-O,P-Ee);if(this.svg=Re,this.transformMatrix=c,oe===2){const Ne=M.Util.makeHexColor(...i);this.current.fillColor=Ne,this.current.strokeColor=Ne}return this.executeOpTree(this.convertOpList(s)),this.svg=ye,this.transformMatrix=ve,this.current.fillColor=X,this.current.strokeColor=Se,k.append(Re.childNodes[0]),this.defs.append(k),`url(#${fe})`}_makeShadingPattern(n){switch(typeof n=="string"&&(n=this.objs.get(n)),n[0]){case"RadialAxial":const i=`shading${_++}`,s=n[3];let c;switch(n[1]){case"axial":const v=n[4],z=n[5];c=this.svgFactory.createElement("svg:linearGradient"),c.setAttributeNS(null,"id",i),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"x1",v[0]),c.setAttributeNS(null,"y1",v[1]),c.setAttributeNS(null,"x2",z[0]),c.setAttributeNS(null,"y2",z[1]);break;case"radial":const u=n[4],N=n[5],re=n[6],Q=n[7];c=this.svgFactory.createElement("svg:radialGradient"),c.setAttributeNS(null,"id",i),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"cx",N[0]),c.setAttributeNS(null,"cy",N[1]),c.setAttributeNS(null,"r",Q),c.setAttributeNS(null,"fx",u[0]),c.setAttributeNS(null,"fy",u[1]),c.setAttributeNS(null,"fr",re);break;default:throw new Error(`Unknown RadialAxial type: ${n[1]}`)}for(const v of s){const z=this.svgFactory.createElement("svg:stop");z.setAttributeNS(null,"offset",v[0]),z.setAttributeNS(null,"stop-color",v[1]),c.append(z)}return this.defs.append(c),`url(#${i})`;case"Mesh":return(0,M.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${n[0]}`)}}setDash(n,i){this.current.dashArray=n,this.current.dashPhase=i}constructPath(n,i){const s=this.current;let c=s.x,v=s.y,z=[],u=0;for(const N of n)switch(N|0){case M.OPS.rectangle:c=i[u++],v=i[u++];const re=i[u++],Q=i[u++],oe=c+re,fe=v+Q;z.push("M",h(c),h(v),"L",h(oe),h(v),"L",h(oe),h(fe),"L",h(c),h(fe),"Z");break;case M.OPS.moveTo:c=i[u++],v=i[u++],z.push("M",h(c),h(v));break;case M.OPS.lineTo:c=i[u++],v=i[u++],z.push("L",h(c),h(v));break;case M.OPS.curveTo:c=i[u+4],v=i[u+5],z.push("C",h(i[u]),h(i[u+1]),h(i[u+2]),h(i[u+3]),h(c),h(v)),u+=6;break;case M.OPS.curveTo2:z.push("C",h(c),h(v),h(i[u]),h(i[u+1]),h(i[u+2]),h(i[u+3])),c=i[u+2],v=i[u+3],u+=4;break;case M.OPS.curveTo3:c=i[u+2],v=i[u+3],z.push("C",h(i[u]),h(i[u+1]),h(c),h(v),h(c),h(v)),u+=4;break;case M.OPS.closePath:z.push("Z");break}z=z.join(" "),s.path&&n.length>0&&n[0]!==M.OPS.rectangle&&n[0]!==M.OPS.moveTo?z=s.path.getAttributeNS(null,"d")+z:(s.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(s.path)),s.path.setAttributeNS(null,"d",z),s.path.setAttributeNS(null,"fill","none"),s.element=s.path,s.setCurrentPoint(c,v)}endPath(){const n=this.current;if(n.path=null,!this.pendingClip)return;if(!n.element){this.pendingClip=null;return}const i=`clippath${E++}`,s=this.svgFactory.createElement("svg:clipPath");s.setAttributeNS(null,"id",i),s.setAttributeNS(null,"transform",w(this.transformMatrix));const c=n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?c.setAttributeNS(null,"clip-rule","evenodd"):c.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,s.append(c),this.defs.append(s),n.activeClipUrl){n.clipGroup=null;for(const v of this.extraStack)v.clipGroup=null;s.setAttributeNS(null,"clip-path",n.activeClipUrl)}n.activeClipUrl=`url(#${i})`,this.tgrp=null}clip(n){this.pendingClip=n}closePath(){const n=this.current;if(n.path){const i=`${n.path.getAttributeNS(null,"d")}Z`;n.path.setAttributeNS(null,"d",i)}}setLeading(n){this.current.leading=-n}setTextRise(n){this.current.textRise=n}setTextRenderingMode(n){this.current.textRenderingMode=n}setHScale(n){this.current.textHScale=n/100}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[i,s]of n)switch(i){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,M.warn)(`Unimplemented graphic state operator ${i}`);break}}fill(){const n=this.current;n.element&&(n.element.setAttributeNS(null,"fill",n.fillColor),n.element.setAttributeNS(null,"fill-opacity",n.fillAlpha),this.endPath())}stroke(){const n=this.current;n.element&&(this._setStrokeAttributes(n.element),n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(n,i=1){const s=this.current;let c=s.dashArray;i!==1&&c.length>0&&(c=c.map(function(v){return i*v})),n.setAttributeNS(null,"stroke",s.strokeColor),n.setAttributeNS(null,"stroke-opacity",s.strokeAlpha),n.setAttributeNS(null,"stroke-miterlimit",h(s.miterLimit)),n.setAttributeNS(null,"stroke-linecap",s.lineCap),n.setAttributeNS(null,"stroke-linejoin",s.lineJoin),n.setAttributeNS(null,"stroke-width",h(i*s.lineWidth)+"px"),n.setAttributeNS(null,"stroke-dasharray",c.map(h).join(" ")),n.setAttributeNS(null,"stroke-dashoffset",h(i*s.dashPhase)+"px")}eoFill(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(n)}paintImageXObject(n){const i=this.getObject(n);if(!i){(0,M.warn)(`Dependent image with object ID ${n} is not ready yet`);return}this.paintInlineImageXObject(i)}paintInlineImageXObject(n,i){const s=n.width,c=n.height,v=j(n,this.forceDataSchema,!!i),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",h(s)),z.setAttributeNS(null,"height",h(c)),this.current.element=z,this.clip("nonzero");const u=this.svgFactory.createElement("svg:image");u.setAttributeNS(F,"xlink:href",v),u.setAttributeNS(null,"x","0"),u.setAttributeNS(null,"y",h(-c)),u.setAttributeNS(null,"width",h(s)+"px"),u.setAttributeNS(null,"height",h(c)+"px"),u.setAttributeNS(null,"transform",`scale(${h(1/s)} ${h(-1/c)})`),i?i.append(u):this._ensureTransformGroup().append(u)}paintImageMaskXObject(n){const i=this.getObject(n.data,n);if(i.bitmap){(0,M.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const s=this.current,c=i.width,v=i.height,z=s.fillColor;s.maskId=`mask${y++}`;const u=this.svgFactory.createElement("svg:mask");u.setAttributeNS(null,"id",s.maskId);const N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",h(c)),N.setAttributeNS(null,"height",h(v)),N.setAttributeNS(null,"fill",z),N.setAttributeNS(null,"mask",`url(#${s.maskId})`),this.defs.append(u),this._ensureTransformGroup().append(N),this.paintInlineImageXObject(i,u)}paintFormXObjectBegin(n,i){if(Array.isArray(n)&&n.length===6&&this.transform(n[0],n[1],n[2],n[3],n[4],n[5]),i){const s=i[2]-i[0],c=i[3]-i[1],v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x",i[0]),v.setAttributeNS(null,"y",i[1]),v.setAttributeNS(null,"width",h(s)),v.setAttributeNS(null,"height",h(c)),this.current.element=v,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(n){const i=this.svgFactory.create(n.width,n.height),s=this.svgFactory.createElement("svg:defs");i.append(s),this.defs=s;const c=this.svgFactory.createElement("svg:g");return c.setAttributeNS(null,"transform",w(n.transform)),i.append(c),this.svg=c,i}_ensureClipGroup(){if(!this.current.clipGroup){const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(n),this.current.clipGroup=n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",w(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=x},(we,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class le{static textContent(M){const Me=[],J={items:Me,styles:Object.create(null)};function F(D){var j;if(!D)return;let g=null;const r=D.name;if(r==="#text")g=D.value;else if(le.shouldBuildText(r))(j=D==null?void 0:D.attributes)!=null&&j.textContent?g=D.attributes.textContent:D.value&&(g=D.value);else return;if(g!==null&&Me.push({str:g}),!!D.children)for(const I of D.children)F(I)}return F(M),J}static shouldBuildText(M){return!(M==="textarea"||M==="input"||M==="option"||M==="select")}}t.XfaText=le},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=w,t.updateTextLayer=E;var p=le(1),M=le(6);const Me=1e5,J=30,F=.8,D=new Map;function g(y,_){let x;if(_&&p.FeatureTest.isOffscreenCanvasSupported)x=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{const S=document.createElement("canvas");S.width=S.height=y,x=S.getContext("2d",{alpha:!1})}return x}function r(y,_){const x=D.get(y);if(x)return x;const S=g(J,_);S.font=`${J}px ${y}`;const n=S.measureText("");let i=n.fontBoundingBoxAscent,s=Math.abs(n.fontBoundingBoxDescent);if(i){const v=i/(i+s);return D.set(y,v),S.canvas.width=S.canvas.height=0,v}S.strokeStyle="red",S.clearRect(0,0,J,J),S.strokeText("g",0,0);let c=S.getImageData(0,0,J,J).data;s=0;for(let v=c.length-1-3;v>=0;v-=4)if(c[v]>0){s=Math.ceil(v/4/J);break}S.clearRect(0,0,J,J),S.strokeText("A",0,J),c=S.getImageData(0,0,J,J).data,i=0;for(let v=0,z=c.length;v<z;v+=4)if(c[v]>0){i=J-Math.floor(v/4/J);break}if(S.canvas.width=S.canvas.height=0,i){const v=i/(i+s);return D.set(y,v),v}return D.set(y,F),F}function j(y,_,x){const S=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:_.str!=="",hasEOL:_.hasEOL,fontSize:0};y._textDivs.push(S);const i=p.Util.transform(y._transform,_.transform);let s=Math.atan2(i[1],i[0]);const c=x[_.fontName];c.vertical&&(s+=Math.PI/2);const v=Math.hypot(i[2],i[3]),z=v*r(c.fontFamily,y._isOffscreenCanvasSupported);let u,N;s===0?(u=i[4],N=i[5]-z):(u=i[4]+z*Math.sin(s),N=i[5]-z*Math.cos(s));const re="calc(var(--scale-factor)*",Q=S.style;y._container===y._rootContainer?(Q.left=`${(100*u/y._pageWidth).toFixed(2)}%`,Q.top=`${(100*N/y._pageHeight).toFixed(2)}%`):(Q.left=`${re}${u.toFixed(2)}px)`,Q.top=`${re}${N.toFixed(2)}px)`),Q.fontSize=`${re}${v.toFixed(2)}px)`,Q.fontFamily=c.fontFamily,n.fontSize=v,S.setAttribute("role","presentation"),S.textContent=_.str,S.dir=_.dir,y._fontInspectorEnabled&&(S.dataset.fontName=_.fontName),s!==0&&(n.angle=s*(180/Math.PI));let oe=!1;if(_.str.length>1)oe=!0;else if(_.str!==" "&&_.transform[0]!==_.transform[3]){const fe=Math.abs(_.transform[0]),O=Math.abs(_.transform[3]);fe!==O&&Math.max(fe,O)/Math.min(fe,O)>1.5&&(oe=!0)}oe&&(n.canvasWidth=c.vertical?_.height:_.width),y._textDivProperties.set(S,n),y._isReadableStream&&y._layoutText(S)}function I(y){const{div:_,scale:x,properties:S,ctx:n,prevFontSize:i,prevFontFamily:s}=y,{style:c}=_;let v="";if(S.canvasWidth!==0&&S.hasText){const{fontFamily:z}=c,{canvasWidth:u,fontSize:N}=S;(i!==N||s!==z)&&(n.font=`${N*x}px ${z}`,y.prevFontSize=N,y.prevFontFamily=z);const{width:re}=n.measureText(_.textContent);re>0&&(v=`scaleX(${u*x/re})`)}S.angle!==0&&(v=`rotate(${S.angle}deg) ${v}`),v.length>0&&(c.transform=v)}function f(y){if(y._canceled)return;const _=y._textDivs,x=y._capability;if(_.length>Me){x.resolve();return}if(!y._isReadableStream)for(const n of _)y._layoutText(n);x.resolve()}class h{constructor({textContentSource:_,container:x,viewport:S,textDivs:n,textDivProperties:i,textContentItemsStr:s,isOffscreenCanvasSupported:c}){var re;this._textContentSource=_,this._isReadableStream=_ instanceof ReadableStream,this._container=this._rootContainer=x,this._textDivs=n||[],this._textContentItemsStr=s||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!((re=globalThis.FontInspector)!=null&&re.enabled),this._reader=null,this._textDivProperties=i||new WeakMap,this._canceled=!1,this._capability=new p.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:g(0,c)};const{pageWidth:v,pageHeight:z,pageX:u,pageY:N}=S.rawDims;this._transform=[1,0,0,-1,-u,N+z],this._pageWidth=v,this._pageHeight=z,(0,M.setLayerDimensions)(x,S),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new p.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new p.AbortException("TextLayer task cancelled."))}_processItems(_,x){for(const S of _){if(S.str===void 0){if(S.type==="beginMarkedContentProps"||S.type==="beginMarkedContent"){const n=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),S.id!==null&&this._container.setAttribute("id",`${S.id}`),n.append(this._container)}else S.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(S.str),j(this,S,x)}}_layoutText(_){const x=this._layoutTextParams.properties=this._textDivProperties.get(_);if(this._layoutTextParams.div=_,I(this._layoutTextParams),x.hasText&&this._container.append(_),x.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this._container.append(S)}}_render(){const _=new p.PromiseCapability;let x=Object.create(null);if(this._isReadableStream){const S=()=>{this._reader.read().then(({value:n,done:i})=>{if(i){_.resolve();return}Object.assign(x,n.styles),this._processItems(n.items,x),S()},_.reject)};this._reader=this._textContentSource.getReader(),S()}else if(this._textContentSource){const{items:S,styles:n}=this._textContentSource;this._processItems(S,n),_.resolve()}else throw new Error('No "textContentSource" parameter specified.');_.promise.then(()=>{x=null,f(this)},this._capability.reject)}}t.TextLayerRenderTask=h;function w(y){!y.textContentSource&&(y.textContent||y.textContentStream)&&((0,M.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),y.textContentSource=y.textContent||y.textContentStream);const{container:_,viewport:x}=y,S=getComputedStyle(_),n=S.getPropertyValue("visibility"),i=parseFloat(S.getPropertyValue("--scale-factor"));n==="visible"&&(!i||Math.abs(i-x.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const s=new h(y);return s._render(),s}function E({container:y,viewport:_,textDivs:x,textDivProperties:S,isOffscreenCanvasSupported:n,mustRotate:i=!0,mustRescale:s=!0}){if(i&&(0,M.setLayerDimensions)(y,{rotation:_.rotation}),s){const c=g(0,n),z={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:c};for(const u of x)z.properties=S.get(u),z.div=u,I(z)}}},(we,t,le)=>{var r,j,I,f,h,w,E,y,_,x,S,Gi,ui,Xi,qi;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var p=le(1),M=le(4),Me=le(28),J=le(33),F=le(6),D=le(34);const v=class v{constructor({uiManager:u,pageIndex:N,div:re,accessibilityManager:Q,annotationLayer:oe,viewport:fe,l10n:O}){Te(this,S);Te(this,r);Te(this,j,!1);Te(this,I,null);Te(this,f,this.pointerup.bind(this));Te(this,h,this.pointerdown.bind(this));Te(this,w,new Map);Te(this,E,!1);Te(this,y,!1);Te(this,_,!1);Te(this,x);const Ee=[Me.FreeTextEditor,J.InkEditor,D.StampEditor];if(!v._initialized){v._initialized=!0;for(const T of Ee)T.initialize(O)}u.registerEditorTypes(Ee),Pe(this,x,u),this.pageIndex=N,this.div=re,Pe(this,r,Q),Pe(this,I,oe),this.viewport=fe,e(this,x).addLayer(this)}get isEmpty(){return e(this,w).size===0}updateToolbar(u){e(this,x).updateToolbar(u)}updateMode(u=e(this,x).getMode()){Z(this,S,qi).call(this),u===p.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),u!==p.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",u===p.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",u===p.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",u===p.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(u){if(!u&&e(this,x).getMode()!==p.AnnotationEditorType.INK)return;if(!u){for(const re of e(this,w).values())if(re.isEmpty()){re.setInBackground();return}}Z(this,S,ui).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(u){e(this,x).setEditingState(u)}addCommands(u){e(this,x).addCommands(u)}enable(){this.div.style.pointerEvents="auto";const u=new Set;for(const re of e(this,w).values())re.enableEditing(),re.annotationElementId&&u.add(re.annotationElementId);if(!e(this,I))return;const N=e(this,I).getEditableAnnotations();for(const re of N){if(re.hide(),e(this,x).isDeletedAnnotationElement(re.data.id)||u.has(re.data.id))continue;const Q=this.deserialize(re);Q&&(this.addOrRebuild(Q),Q.enableEditing())}}disable(){var N;Pe(this,_,!0),this.div.style.pointerEvents="none";const u=new Set;for(const re of e(this,w).values()){if(re.disableEditing(),!re.annotationElementId||re.serialize()!==null){u.add(re.annotationElementId);continue}(N=this.getEditableAnnotation(re.annotationElementId))==null||N.show(),re.remove()}if(e(this,I)){const re=e(this,I).getEditableAnnotations();for(const Q of re){const{id:oe}=Q.data;u.has(oe)||e(this,x).isDeletedAnnotationElement(oe)||Q.show()}}Z(this,S,qi).call(this),this.isEmpty&&(this.div.hidden=!0),Pe(this,_,!1)}getEditableAnnotation(u){var N;return((N=e(this,I))==null?void 0:N.getEditableAnnotation(u))||null}setActiveEditor(u){e(this,x).getActive()!==u&&e(this,x).setActiveEditor(u)}enableClick(){this.div.addEventListener("pointerdown",e(this,h)),this.div.addEventListener("pointerup",e(this,f))}disableClick(){this.div.removeEventListener("pointerdown",e(this,h)),this.div.removeEventListener("pointerup",e(this,f))}attach(u){e(this,w).set(u.id,u);const{annotationElementId:N}=u;N&&e(this,x).isDeletedAnnotationElement(N)&&e(this,x).removeDeletedAnnotationElement(u)}detach(u){var N;e(this,w).delete(u.id),(N=e(this,r))==null||N.removePointerInTextLayer(u.contentDiv),!e(this,_)&&u.annotationElementId&&e(this,x).addDeletedAnnotationElement(u)}remove(u){this.detach(u),e(this,x).removeEditor(u),u.div.contains(document.activeElement)&&setTimeout(()=>{e(this,x).focusMainContainer()},0),u.div.remove(),u.isAttachedToDOM=!1,e(this,y)||this.addInkEditorIfNeeded(!1)}changeParent(u){var N;u.parent!==this&&(u.annotationElementId&&(e(this,x).addDeletedAnnotationElement(u.annotationElementId),M.AnnotationEditor.deleteAnnotationElement(u),u.annotationElementId=null),this.attach(u),(N=u.parent)==null||N.detach(u),u.setParent(this),u.div&&u.isAttachedToDOM&&(u.div.remove(),this.div.append(u.div)))}add(u){if(this.changeParent(u),e(this,x).addEditor(u),this.attach(u),!u.isAttachedToDOM){const N=u.render();this.div.append(N),u.isAttachedToDOM=!0}u.fixAndSetPosition(),u.onceAdded(),e(this,x).addToAnnotationStorage(u)}moveEditorInDOM(u){var re;if(!u.isAttachedToDOM)return;const{activeElement:N}=document;u.div.contains(N)&&(u._focusEventsAllowed=!1,setTimeout(()=>{u.div.contains(document.activeElement)?u._focusEventsAllowed=!0:(u.div.addEventListener("focusin",()=>{u._focusEventsAllowed=!0},{once:!0}),N.focus())},0)),u._structTreeParentId=(re=e(this,r))==null?void 0:re.moveElementInDOM(this.div,u.div,u.contentDiv,!0)}addOrRebuild(u){u.needsToBeRebuilt()?u.rebuild():this.add(u)}addUndoableEditor(u){const N=()=>u._uiManager.rebuild(u),re=()=>{u.remove()};this.addCommands({cmd:N,undo:re,mustExec:!1})}getNextId(){return e(this,x).getId()}pasteEditor(u,N){e(this,x).updateToolbar(u),e(this,x).updateMode(u);const{offsetX:re,offsetY:Q}=Z(this,S,Xi).call(this),oe=this.getNextId(),fe=Z(this,S,Gi).call(this,{parent:this,id:oe,x:re,y:Q,uiManager:e(this,x),isCentered:!0,...N});fe&&this.add(fe)}deserialize(u){switch(u.annotationType??u.annotationEditorType){case p.AnnotationEditorType.FREETEXT:return Me.FreeTextEditor.deserialize(u,this,e(this,x));case p.AnnotationEditorType.INK:return J.InkEditor.deserialize(u,this,e(this,x));case p.AnnotationEditorType.STAMP:return D.StampEditor.deserialize(u,this,e(this,x))}return null}addNewEditor(){Z(this,S,ui).call(this,Z(this,S,Xi).call(this),!0)}setSelected(u){e(this,x).setSelected(u)}toggleSelected(u){e(this,x).toggleSelected(u)}isSelected(u){return e(this,x).isSelected(u)}unselect(u){e(this,x).unselect(u)}pointerup(u){const{isMac:N}=p.FeatureTest.platform;if(!(u.button!==0||u.ctrlKey&&N)&&u.target===this.div&&e(this,E)){if(Pe(this,E,!1),!e(this,j)){Pe(this,j,!0);return}if(e(this,x).getMode()===p.AnnotationEditorType.STAMP){e(this,x).unselectAll();return}Z(this,S,ui).call(this,u,!1)}}pointerdown(u){if(e(this,E)){Pe(this,E,!1);return}const{isMac:N}=p.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&N||u.target!==this.div)return;Pe(this,E,!0);const re=e(this,x).getActive();Pe(this,j,!re||re.isEmpty())}findNewParent(u,N,re){const Q=e(this,x).findParent(N,re);return Q===null||Q===this?!1:(Q.changeParent(u),!0)}destroy(){var u,N;((u=e(this,x).getActive())==null?void 0:u.parent)===this&&(e(this,x).commitOrRemove(),e(this,x).setActiveEditor(null));for(const re of e(this,w).values())(N=e(this,r))==null||N.removePointerInTextLayer(re.contentDiv),re.setParent(null),re.isAttachedToDOM=!1,re.div.remove();this.div=null,e(this,w).clear(),e(this,x).removeLayer(this)}render({viewport:u}){this.viewport=u,(0,F.setLayerDimensions)(this.div,u);for(const N of e(this,x).getEditors(this.pageIndex))this.add(N);this.updateMode()}update({viewport:u}){e(this,x).commitOrRemove(),this.viewport=u,(0,F.setLayerDimensions)(this.div,{rotation:u.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:u,pageHeight:N}=this.viewport.rawDims;return[u,N]}};r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakMap,_=new WeakMap,x=new WeakMap,S=new WeakSet,Gi=function(u){switch(e(this,x).getMode()){case p.AnnotationEditorType.FREETEXT:return new Me.FreeTextEditor(u);case p.AnnotationEditorType.INK:return new J.InkEditor(u);case p.AnnotationEditorType.STAMP:return new D.StampEditor(u)}return null},ui=function(u,N){const re=this.getNextId(),Q=Z(this,S,Gi).call(this,{parent:this,id:re,x:u.offsetX,y:u.offsetY,uiManager:e(this,x),isCentered:N});return Q&&this.add(Q),Q},Xi=function(){const{x:u,y:N,width:re,height:Q}=this.div.getBoundingClientRect(),oe=Math.max(0,u),fe=Math.max(0,N),O=Math.min(window.innerWidth,u+re),Ee=Math.min(window.innerHeight,N+Q),T=(oe+O)/2-u,P=(fe+Ee)/2-N,[Ce,W]=this.viewport.rotation%180===0?[T,P]:[P,T];return{offsetX:Ce,offsetY:W}},qi=function(){Pe(this,y,!0);for(const u of e(this,w).values())u.isEmpty()&&u.remove();Pe(this,y,!1)},at(v,"_initialized",!1);let g=v;t.AnnotationEditorLayer=g},(we,t,le)=>{var D,g,r,j,I,f,h,w,E,y,qn,Yn,Kn,qt,Yi,Qn,Ki;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var p=le(1),M=le(5),Me=le(4),J=le(29);const v=class v extends Me.AnnotationEditor{constructor(N){super({...N,name:"freeTextEditor"});Te(this,y);Te(this,D,this.editorDivBlur.bind(this));Te(this,g,this.editorDivFocus.bind(this));Te(this,r,this.editorDivInput.bind(this));Te(this,j,this.editorDivKeydown.bind(this));Te(this,I);Te(this,f,"");Te(this,h,`${this.id}-editor`);Te(this,w);Te(this,E,null);Pe(this,I,N.color||v._defaultColor||Me.AnnotationEditor._defaultLineColor),Pe(this,w,N.fontSize||v._defaultFontSize)}static get _keyboardManager(){const N=v.prototype,re=fe=>fe.isEmpty(),Q=M.AnnotationEditorUIManager.TRANSLATE_SMALL,oe=M.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,p.shadow)(this,"_keyboardManager",new M.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],N.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],N.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],N._translateEmpty,{args:[-Q,0],checker:re}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],N._translateEmpty,{args:[-oe,0],checker:re}],[["ArrowRight","mac+ArrowRight"],N._translateEmpty,{args:[Q,0],checker:re}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],N._translateEmpty,{args:[oe,0],checker:re}],[["ArrowUp","mac+ArrowUp"],N._translateEmpty,{args:[0,-Q],checker:re}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],N._translateEmpty,{args:[0,-oe],checker:re}],[["ArrowDown","mac+ArrowDown"],N._translateEmpty,{args:[0,Q],checker:re}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],N._translateEmpty,{args:[0,oe],checker:re}]]))}static initialize(N){Me.AnnotationEditor.initialize(N,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const re=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(re.getPropertyValue("--freetext-padding"))}static updateDefaultParams(N,re){switch(N){case p.AnnotationEditorParamsType.FREETEXT_SIZE:v._defaultFontSize=re;break;case p.AnnotationEditorParamsType.FREETEXT_COLOR:v._defaultColor=re;break}}updateParams(N,re){switch(N){case p.AnnotationEditorParamsType.FREETEXT_SIZE:Z(this,y,qn).call(this,re);break;case p.AnnotationEditorParamsType.FREETEXT_COLOR:Z(this,y,Yn).call(this,re);break}}static get defaultPropertiesToUpdate(){return[[p.AnnotationEditorParamsType.FREETEXT_SIZE,v._defaultFontSize],[p.AnnotationEditorParamsType.FREETEXT_COLOR,v._defaultColor||Me.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[p.AnnotationEditorParamsType.FREETEXT_SIZE,e(this,w)],[p.AnnotationEditorParamsType.FREETEXT_COLOR,e(this,I)]]}_translateEmpty(N,re){this._uiManager.translateSelectedEditors(N,re,!0)}getInitialTranslation(){const N=this.parentScale;return[-v._internalPadding*N,-(v._internalPadding+e(this,w))*N]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(p.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",e(this,j)),this.editorDiv.addEventListener("focus",e(this,g)),this.editorDiv.addEventListener("blur",e(this,D)),this.editorDiv.addEventListener("input",e(this,r)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",e(this,h)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",e(this,j)),this.editorDiv.removeEventListener("focus",e(this,g)),this.editorDiv.removeEventListener("blur",e(this,D)),this.editorDiv.removeEventListener("input",e(this,r)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(N){this._focusEventsAllowed&&(super.focusin(N),N.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var N;if(this.width){Z(this,y,Ki).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(N=this._initialOptions)!=null&&N.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const N=e(this,f),re=Pe(this,f,Z(this,y,Kn).call(this).trimEnd());if(N===re)return;const Q=oe=>{if(Pe(this,f,oe),!oe){this.remove();return}Z(this,y,Yi).call(this),this._uiManager.rebuild(this),Z(this,y,qt).call(this)};this.addCommands({cmd:()=>{Q(re)},undo:()=>{Q(N)},mustExec:!1}),Z(this,y,qt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(N){this.enterInEditMode()}keydown(N){N.target===this.div&&N.key==="Enter"&&(this.enterInEditMode(),N.preventDefault())}editorDivKeydown(N){v._keyboardManager.exec(this,N)}editorDivFocus(N){this.isEditing=!0}editorDivBlur(N){this.isEditing=!1}editorDivInput(N){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let N,re;this.width&&(N=this.x,re=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",e(this,h)),this.enableEditing(),Me.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(oe=>{var fe;return(fe=this.editorDiv)==null?void 0:fe.setAttribute("aria-label",oe)}),Me.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(oe=>{var fe;return(fe=this.editorDiv)==null?void 0:fe.setAttribute("default-content",oe)}),this.editorDiv.contentEditable=!0;const{style:Q}=this.editorDiv;if(Q.fontSize=`calc(${e(this,w)}px * var(--scale-factor))`,Q.color=e(this,I),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,M.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[oe,fe]=this.parentDimensions;if(this.annotationElementId){const{position:O}=e(this,E);let[Ee,T]=this.getInitialTranslation();[Ee,T]=this.pageTranslationToScreen(Ee,T);const[P,Ce]=this.pageDimensions,[W,d]=this.pageTranslation;let m,k;switch(this.rotation){case 0:m=N+(O[0]-W)/P,k=re+this.height-(O[1]-d)/Ce;break;case 90:m=N+(O[0]-W)/P,k=re-(O[1]-d)/Ce,[Ee,T]=[T,-Ee];break;case 180:m=N-this.width+(O[0]-W)/P,k=re-(O[1]-d)/Ce,[Ee,T]=[-Ee,-T];break;case 270:m=N+(O[0]-W-this.height*Ce)/P,k=re+(O[1]-d-this.width*P)/Ce,[Ee,T]=[-T,Ee];break}this.setAt(m*oe,k*fe,Ee,T)}else this.setAt(N*oe,re*fe,this.width*oe,this.height*fe);Z(this,y,Yi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(N,re,Q){let oe=null;if(N instanceof J.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:O,fontColor:Ee},rect:T,rotation:P,id:Ce},textContent:W,textPosition:d,parent:{page:{pageNumber:m}}}=N;if(!W||W.length===0)return null;oe=N={annotationType:p.AnnotationEditorType.FREETEXT,color:Array.from(Ee),fontSize:O,value:W.join(`
`),position:d,pageIndex:m-1,rect:T,rotation:P,id:Ce,deleted:!1}}const fe=super.deserialize(N,re,Q);return Pe(fe,w,N.fontSize),Pe(fe,I,p.Util.makeHexColor(...N.color)),Pe(fe,f,N.value),fe.annotationElementId=N.id||null,Pe(fe,E,oe),fe}serialize(N=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const re=v._internalPadding*this.parentScale,Q=this.getRect(re,re),oe=Me.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:e(this,I)),fe={annotationType:p.AnnotationEditorType.FREETEXT,color:oe,fontSize:e(this,w),value:e(this,f),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return N?fe:this.annotationElementId&&!Z(this,y,Qn).call(this,fe)?null:(fe.id=this.annotationElementId,fe)}};D=new WeakMap,g=new WeakMap,r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakSet,qn=function(N){const re=oe=>{this.editorDiv.style.fontSize=`calc(${oe}px * var(--scale-factor))`,this.translate(0,-(oe-e(this,w))*this.parentScale),Pe(this,w,oe),Z(this,y,qt).call(this)},Q=e(this,w);this.addCommands({cmd:()=>{re(N)},undo:()=>{re(Q)},mustExec:!0,type:p.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Yn=function(N){const re=e(this,I);this.addCommands({cmd:()=>{Pe(this,I,this.editorDiv.style.color=N)},undo:()=>{Pe(this,I,this.editorDiv.style.color=re)},mustExec:!0,type:p.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Kn=function(){const N=this.editorDiv.getElementsByTagName("div");if(N.length===0)return this.editorDiv.innerText;const re=[];for(const Q of N)re.push(Q.innerText.replace(/\r\n?|\n/,""));return re.join(`
`)},qt=function(){const[N,re]=this.parentDimensions;let Q;if(this.isAttachedToDOM)Q=this.div.getBoundingClientRect();else{const{currentLayer:oe,div:fe}=this,O=fe.style.display;fe.style.display="hidden",oe.div.append(this.div),Q=fe.getBoundingClientRect(),fe.remove(),fe.style.display=O}this.rotation%180===this.parentRotation%180?(this.width=Q.width/N,this.height=Q.height/re):(this.width=Q.height/N,this.height=Q.width/re),this.fixAndSetPosition()},Yi=function(){if(this.editorDiv.replaceChildren(),!!e(this,f))for(const N of e(this,f).split(`
`)){const re=document.createElement("div");re.append(N?document.createTextNode(N):document.createElement("br")),this.editorDiv.append(re)}},Qn=function(N){const{value:re,fontSize:Q,color:oe,rect:fe,pageIndex:O}=e(this,E);return N.value!==re||N.fontSize!==Q||N.rect.some((Ee,T)=>Math.abs(Ee-fe[T])>=1)||N.color.some((Ee,T)=>Ee!==oe[T])||N.pageIndex!==O},Ki=function(N=!1){if(!this.annotationElementId)return;if(Z(this,y,qt).call(this),!N&&(this.width===0||this.height===0)){setTimeout(()=>Z(this,y,Ki).call(this,!0),0);return}const re=v._internalPadding*this.parentScale;e(this,E).rect=this.getRect(re,re)},at(v,"_freeTextDefaultContent",""),at(v,"_internalPadding",0),at(v,"_defaultColor",null),at(v,"_defaultFontSize",10),at(v,"_type","freetext");let F=v;t.FreeTextEditor=F},(we,t,le)=>{var k,ve,Dt,Zn,Re,Ne,He,ze,qe,Ye,Oe,Fe,Y,Ae,ke,U,o,H,te,q,Le,De,Jn,fi,Qi,Zi,it,pt,mt,Xe,Be,Ue,nt,Ji,ut,be,We,et,es,en;Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var p=le(1),M=le(6),Me=le(3),J=le(30),F=le(31),D=le(32);const g=1e3,r=9,j=new WeakSet;function I(tt){return{width:tt[2]-tt[0],height:tt[3]-tt[1]}}class f{static create(_e){switch(_e.data.annotationType){case p.AnnotationType.LINK:return new w(_e);case p.AnnotationType.TEXT:return new E(_e);case p.AnnotationType.WIDGET:switch(_e.data.fieldType){case"Tx":return new _(_e);case"Btn":return _e.data.radioButton?new n(_e):_e.data.checkBox?new S(_e):new i(_e);case"Ch":return new s(_e);case"Sig":return new x(_e)}return new y(_e);case p.AnnotationType.POPUP:return new c(_e);case p.AnnotationType.FREETEXT:return new z(_e);case p.AnnotationType.LINE:return new u(_e);case p.AnnotationType.SQUARE:return new N(_e);case p.AnnotationType.CIRCLE:return new re(_e);case p.AnnotationType.POLYLINE:return new Q(_e);case p.AnnotationType.CARET:return new fe(_e);case p.AnnotationType.INK:return new O(_e);case p.AnnotationType.POLYGON:return new oe(_e);case p.AnnotationType.HIGHLIGHT:return new Ee(_e);case p.AnnotationType.UNDERLINE:return new T(_e);case p.AnnotationType.SQUIGGLY:return new P(_e);case p.AnnotationType.STRIKEOUT:return new Ce(_e);case p.AnnotationType.STAMP:return new W(_e);case p.AnnotationType.FILEATTACHMENT:return new d(_e);default:return new h(_e)}}}const ye=class ye{constructor(_e,{isRenderable:ne=!1,ignoreBorder:Ie=!1,createQuadrilaterals:je=!1}={}){Te(this,k,!1);this.isRenderable=ne,this.data=_e.data,this.layer=_e.layer,this.linkService=_e.linkService,this.downloadManager=_e.downloadManager,this.imageResourcesPath=_e.imageResourcesPath,this.renderForms=_e.renderForms,this.svgFactory=_e.svgFactory,this.annotationStorage=_e.annotationStorage,this.enableScripting=_e.enableScripting,this.hasJSActions=_e.hasJSActions,this._fieldObjects=_e.fieldObjects,this.parent=_e.parent,ne&&(this.container=this._createContainer(Ie)),je&&this._createQuadrilaterals()}static _hasPopupData({titleObj:_e,contentsObj:ne,richText:Ie}){return!!(_e!=null&&_e.str||ne!=null&&ne.str||Ie!=null&&Ie.str)}get hasPopupData(){return ye._hasPopupData(this.data)}_createContainer(_e){const{data:ne,parent:{page:Ie,viewport:je}}=this,$e=document.createElement("section");$e.setAttribute("data-annotation-id",ne.id),this instanceof y||($e.tabIndex=g),$e.style.zIndex=this.parent.zIndex++,this.data.popupRef&&$e.setAttribute("aria-haspopup","dialog"),ne.noRotate&&$e.classList.add("norotate");const{pageWidth:Ke,pageHeight:Qe,pageX:ht,pageY:lt}=je.rawDims;if(!ne.rect||this instanceof c){const{rotation:gt}=ne;return!ne.hasOwnCanvas&&gt!==0&&this.setRotation(gt,$e),$e}const{width:st,height:_t}=I(ne.rect),ct=p.Util.normalizeRect([ne.rect[0],Ie.view[3]-ne.rect[1]+Ie.view[1],ne.rect[2],Ie.view[3]-ne.rect[3]+Ie.view[1]]);if(!_e&&ne.borderStyle.width>0){$e.style.borderWidth=`${ne.borderStyle.width}px`;const gt=ne.borderStyle.horizontalCornerRadius,vt=ne.borderStyle.verticalCornerRadius;if(gt>0||vt>0){const At=`calc(${gt}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;$e.style.borderRadius=At}else if(this instanceof n){const At=`calc(${st}px * var(--scale-factor)) / calc(${_t}px * var(--scale-factor))`;$e.style.borderRadius=At}switch(ne.borderStyle.style){case p.AnnotationBorderStyleType.SOLID:$e.style.borderStyle="solid";break;case p.AnnotationBorderStyleType.DASHED:$e.style.borderStyle="dashed";break;case p.AnnotationBorderStyleType.BEVELED:(0,p.warn)("Unimplemented border style: beveled");break;case p.AnnotationBorderStyleType.INSET:(0,p.warn)("Unimplemented border style: inset");break;case p.AnnotationBorderStyleType.UNDERLINE:$e.style.borderBottomStyle="solid";break}const yt=ne.borderColor||null;yt?(Pe(this,k,!0),$e.style.borderColor=p.Util.makeHexColor(yt[0]|0,yt[1]|0,yt[2]|0)):$e.style.borderWidth=0}$e.style.left=`${100*(ct[0]-ht)/Ke}%`,$e.style.top=`${100*(ct[1]-lt)/Qe}%`;const{rotation:dt}=ne;return ne.hasOwnCanvas||dt===0?($e.style.width=`${100*st/Ke}%`,$e.style.height=`${100*_t/Qe}%`):this.setRotation(dt,$e),$e}setRotation(_e,ne=this.container){if(!this.data.rect)return;const{pageWidth:Ie,pageHeight:je}=this.parent.viewport.rawDims,{width:$e,height:Ke}=I(this.data.rect);let Qe,ht;_e%180===0?(Qe=100*$e/Ie,ht=100*Ke/je):(Qe=100*Ke/Ie,ht=100*$e/je),ne.style.width=`${Qe}%`,ne.style.height=`${ht}%`,ne.setAttribute("data-main-rotation",(360-_e)%360)}get _commonActions(){const _e=(ne,Ie,je)=>{const $e=je.detail[ne],Ke=$e[0],Qe=$e.slice(1);je.target.style[Ie]=J.ColorConverters[`${Ke}_HTML`](Qe),this.annotationStorage.setValue(this.data.id,{[Ie]:J.ColorConverters[`${Ke}_rgb`](Qe)})};return(0,p.shadow)(this,"_commonActions",{display:ne=>{const{display:Ie}=ne.detail,je=Ie%2===1;this.container.style.visibility=je?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:je,noPrint:Ie===1||Ie===2})},print:ne=>{this.annotationStorage.setValue(this.data.id,{noPrint:!ne.detail.print})},hidden:ne=>{const{hidden:Ie}=ne.detail;this.container.style.visibility=Ie?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Ie,noView:Ie})},focus:ne=>{setTimeout(()=>ne.target.focus({preventScroll:!1}),0)},userName:ne=>{ne.target.title=ne.detail.userName},readonly:ne=>{ne.target.disabled=ne.detail.readonly},required:ne=>{this._setRequired(ne.target,ne.detail.required)},bgColor:ne=>{_e("bgColor","backgroundColor",ne)},fillColor:ne=>{_e("fillColor","backgroundColor",ne)},fgColor:ne=>{_e("fgColor","color",ne)},textColor:ne=>{_e("textColor","color",ne)},borderColor:ne=>{_e("borderColor","borderColor",ne)},strokeColor:ne=>{_e("strokeColor","borderColor",ne)},rotation:ne=>{const Ie=ne.detail.rotation;this.setRotation(Ie),this.annotationStorage.setValue(this.data.id,{rotation:Ie})}})}_dispatchEventFromSandbox(_e,ne){const Ie=this._commonActions;for(const je of Object.keys(ne.detail)){const $e=_e[je]||Ie[je];$e==null||$e(ne)}}_setDefaultPropertiesFromJS(_e){if(!this.enableScripting)return;const ne=this.annotationStorage.getRawValue(this.data.id);if(!ne)return;const Ie=this._commonActions;for(const[je,$e]of Object.entries(ne)){const Ke=Ie[je];if(Ke){const Qe={detail:{[je]:$e},target:_e};Ke(Qe),delete ne[je]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:_e}=this.data;if(!_e)return;const[ne,Ie,je,$e]=this.data.rect;if(_e.length===1){const[,{x:vt,y:yt},{x:At,y:wt}]=_e[0];if(je===vt&&$e===yt&&ne===At&&Ie===wt)return}const{style:Ke}=this.container;let Qe;if(e(this,k)){const{borderColor:vt,borderWidth:yt}=Ke;Ke.borderWidth=0,Qe=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${vt}" stroke-width="${yt}">`],this.container.classList.add("hasBorder")}const ht=je-ne,lt=$e-Ie,{svgFactory:st}=this,_t=st.createElement("svg");_t.classList.add("quadrilateralsContainer"),_t.setAttribute("width",0),_t.setAttribute("height",0);const ct=st.createElement("defs");_t.append(ct);const dt=st.createElement("clipPath"),gt=`clippath_${this.data.id}`;dt.setAttribute("id",gt),dt.setAttribute("clipPathUnits","objectBoundingBox"),ct.append(dt);for(const[,{x:vt,y:yt},{x:At,y:wt}]of _e){const Et=st.createElement("rect"),Mt=(At-ne)/ht,kt=($e-yt)/lt,It=(vt-At)/ht,Fn=(yt-wt)/lt;Et.setAttribute("x",Mt),Et.setAttribute("y",kt),Et.setAttribute("width",It),Et.setAttribute("height",Fn),dt.append(Et),Qe==null||Qe.push(`<rect vector-effect="non-scaling-stroke" x="${Mt}" y="${kt}" width="${It}" height="${Fn}"/>`)}e(this,k)&&(Qe.push("</g></svg>')"),Ke.backgroundImage=Qe.join("")),this.container.append(_t),this.container.style.clipPath=`url(#${gt})`}_createPopup(){const{container:_e,data:ne}=this;_e.setAttribute("aria-haspopup","dialog");const Ie=new c({data:{color:ne.color,titleObj:ne.titleObj,modificationDate:ne.modificationDate,contentsObj:ne.contentsObj,richText:ne.richText,parentRect:ne.rect,borderStyle:0,id:`popup_${ne.id}`,rotation:ne.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Ie.render())}render(){(0,p.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(_e,ne=null){const Ie=[];if(this._fieldObjects){const je=this._fieldObjects[_e];if(je)for(const{page:$e,id:Ke,exportValues:Qe}of je){if($e===-1||Ke===ne)continue;const ht=typeof Qe=="string"?Qe:null,lt=document.querySelector(`[data-element-id="${Ke}"]`);if(lt&&!j.has(lt)){(0,p.warn)(`_getElementsByName - element not allowed: ${Ke}`);continue}Ie.push({id:Ke,exportValue:ht,domElement:lt})}return Ie}for(const je of document.getElementsByName(_e)){const{exportValue:$e}=je,Ke=je.getAttribute("data-element-id");Ke!==ne&&j.has(je)&&Ie.push({id:Ke,exportValue:$e,domElement:je})}return Ie}show(){var _e;this.container&&(this.container.hidden=!1),(_e=this.popup)==null||_e.maybeShow()}hide(){var _e;this.container&&(this.container.hidden=!0),(_e=this.popup)==null||_e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const _e=this.getElementsToTriggerPopup();if(Array.isArray(_e))for(const ne of _e)ne.classList.add("highlightArea");else _e.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:_e,data:{id:ne}}=this;this.container.addEventListener("dblclick",()=>{var Ie;(Ie=this.linkService.eventBus)==null||Ie.dispatch("switchannotationeditormode",{source:this,mode:_e,editId:ne})})}};k=new WeakMap;let h=ye;class w extends h{constructor(ne,Ie=null){super(ne,{isRenderable:!0,ignoreBorder:!!(Ie!=null&&Ie.ignoreBorder),createQuadrilaterals:!0});Te(this,ve);this.isTooltipOnly=ne.data.isTooltipOnly}render(){const{data:ne,linkService:Ie}=this,je=document.createElement("a");je.setAttribute("data-element-id",ne.id);let $e=!1;return ne.url?(Ie.addLinkAttributes(je,ne.url,ne.newWindow),$e=!0):ne.action?(this._bindNamedAction(je,ne.action),$e=!0):ne.attachment?(this._bindAttachment(je,ne.attachment),$e=!0):ne.setOCGState?(Z(this,ve,Zn).call(this,je,ne.setOCGState),$e=!0):ne.dest?(this._bindLink(je,ne.dest),$e=!0):(ne.actions&&(ne.actions.Action||ne.actions["Mouse Up"]||ne.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(je,ne),$e=!0),ne.resetForm?(this._bindResetFormAction(je,ne.resetForm),$e=!0):this.isTooltipOnly&&!$e&&(this._bindLink(je,""),$e=!0)),this.container.classList.add("linkAnnotation"),$e&&this.container.append(je),this.container}_bindLink(ne,Ie){ne.href=this.linkService.getDestinationHash(Ie),ne.onclick=()=>(Ie&&this.linkService.goToDestination(Ie),!1),(Ie||Ie==="")&&Z(this,ve,Dt).call(this)}_bindNamedAction(ne,Ie){ne.href=this.linkService.getAnchorUrl(""),ne.onclick=()=>(this.linkService.executeNamedAction(Ie),!1),Z(this,ve,Dt).call(this)}_bindAttachment(ne,Ie){ne.href=this.linkService.getAnchorUrl(""),ne.onclick=()=>{var je;return(je=this.downloadManager)==null||je.openOrDownloadData(this.container,Ie.content,Ie.filename),!1},Z(this,ve,Dt).call(this)}_bindJSAction(ne,Ie){ne.href=this.linkService.getAnchorUrl("");const je=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const $e of Object.keys(Ie.actions)){const Ke=je.get($e);Ke&&(ne[Ke]=()=>{var Qe;return(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Ie.id,name:$e}}),!1})}ne.onclick||(ne.onclick=()=>!1),Z(this,ve,Dt).call(this)}_bindResetFormAction(ne,Ie){const je=ne.onclick;if(je||(ne.href=this.linkService.getAnchorUrl("")),Z(this,ve,Dt).call(this),!this._fieldObjects){(0,p.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),je||(ne.onclick=()=>!1);return}ne.onclick=()=>{var _t;je==null||je();const{fields:$e,refs:Ke,include:Qe}=Ie,ht=[];if($e.length!==0||Ke.length!==0){const ct=new Set(Ke);for(const dt of $e){const gt=this._fieldObjects[dt]||[];for(const{id:vt}of gt)ct.add(vt)}for(const dt of Object.values(this._fieldObjects))for(const gt of dt)ct.has(gt.id)===Qe&&ht.push(gt)}else for(const ct of Object.values(this._fieldObjects))ht.push(...ct);const lt=this.annotationStorage,st=[];for(const ct of ht){const{id:dt}=ct;switch(st.push(dt),ct.type){case"text":{const vt=ct.defaultValue||"";lt.setValue(dt,{value:vt});break}case"checkbox":case"radiobutton":{const vt=ct.defaultValue===ct.exportValues;lt.setValue(dt,{value:vt});break}case"combobox":case"listbox":{const vt=ct.defaultValue||"";lt.setValue(dt,{value:vt});break}default:continue}const gt=document.querySelector(`[data-element-id="${dt}"]`);if(gt){if(!j.has(gt)){(0,p.warn)(`_bindResetFormAction - element not allowed: ${dt}`);continue}}else continue;gt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}})),!1}}}ve=new WeakSet,Dt=function(){this.container.setAttribute("data-internal-link","")},Zn=function(ne,Ie){ne.href=this.linkService.getAnchorUrl(""),ne.onclick=()=>(this.linkService.executeSetOCGState(Ie),!1),Z(this,ve,Dt).call(this)};class E extends h{constructor(_e){super(_e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const _e=document.createElement("img");return _e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",_e.alt="[{{type}} Annotation]",_e.dataset.l10nId="text_annotation_type",_e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(_e),this.container}}class y extends h{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(_e){var ne;this.data.hasOwnCanvas&&(((ne=_e.previousSibling)==null?void 0:ne.nodeName)==="CANVAS"&&(_e.previousSibling.hidden=!0),_e.hidden=!1)}_getKeyModifier(_e){const{isWin:ne,isMac:Ie}=p.FeatureTest.platform;return ne&&_e.ctrlKey||Ie&&_e.metaKey}_setEventListener(_e,ne,Ie,je,$e){Ie.includes("mouse")?_e.addEventListener(Ie,Ke=>{var Qe;(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:je,value:$e(Ke),shift:Ke.shiftKey,modifier:this._getKeyModifier(Ke)}})}):_e.addEventListener(Ie,Ke=>{var Qe;if(Ie==="blur"){if(!ne.focused||!Ke.relatedTarget)return;ne.focused=!1}else if(Ie==="focus"){if(ne.focused)return;ne.focused=!0}$e&&((Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:je,value:$e(Ke)}}))})}_setEventListeners(_e,ne,Ie,je){var $e,Ke,Qe;for(const[ht,lt]of Ie)(lt==="Action"||($e=this.data.actions)!=null&&$e[lt])&&((lt==="Focus"||lt==="Blur")&&(ne||(ne={focused:!1})),this._setEventListener(_e,ne,ht,lt,je),lt==="Focus"&&!((Ke=this.data.actions)!=null&&Ke.Blur)?this._setEventListener(_e,ne,"blur","Blur",null):lt==="Blur"&&!((Qe=this.data.actions)!=null&&Qe.Focus)&&this._setEventListener(_e,ne,"focus","Focus",null))}_setBackgroundColor(_e){const ne=this.data.backgroundColor||null;_e.style.backgroundColor=ne===null?"transparent":p.Util.makeHexColor(ne[0],ne[1],ne[2])}_setTextStyle(_e){const ne=["left","center","right"],{fontColor:Ie}=this.data.defaultAppearanceData,je=this.data.defaultAppearanceData.fontSize||r,$e=_e.style;let Ke;const Qe=2,ht=lt=>Math.round(10*lt)/10;if(this.data.multiLine){const lt=Math.abs(this.data.rect[3]-this.data.rect[1]-Qe),st=Math.round(lt/(p.LINE_FACTOR*je))||1,_t=lt/st;Ke=Math.min(je,ht(_t/p.LINE_FACTOR))}else{const lt=Math.abs(this.data.rect[3]-this.data.rect[1]-Qe);Ke=Math.min(je,ht(lt/p.LINE_FACTOR))}$e.fontSize=`calc(${Ke}px * var(--scale-factor))`,$e.color=p.Util.makeHexColor(Ie[0],Ie[1],Ie[2]),this.data.textAlignment!==null&&($e.textAlign=ne[this.data.textAlignment])}_setRequired(_e,ne){ne?_e.setAttribute("required",!0):_e.removeAttribute("required"),_e.setAttribute("aria-required",ne)}}class _ extends y{constructor(_e){const ne=_e.renderForms||!_e.data.hasAppearance&&!!_e.data.fieldValue;super(_e,{isRenderable:ne})}setPropertyOnSiblings(_e,ne,Ie,je){const $e=this.annotationStorage;for(const Ke of this._getElementsByName(_e.name,_e.id))Ke.domElement&&(Ke.domElement[ne]=Ie),$e.setValue(Ke.id,{[je]:Ie})}render(){var je,$e;const _e=this.annotationStorage,ne=this.data.id;this.container.classList.add("textWidgetAnnotation");let Ie=null;if(this.renderForms){const Ke=_e.getValue(ne,{value:this.data.fieldValue});let Qe=Ke.value||"";const ht=_e.getValue(ne,{charLimit:this.data.maxLen}).charLimit;ht&&Qe.length>ht&&(Qe=Qe.slice(0,ht));let lt=Ke.formattedValue||((je=this.data.textContent)==null?void 0:je.join(`
`))||null;lt&&this.data.comb&&(lt=lt.replaceAll(/\s+/g,""));const st={userValue:Qe,formattedValue:lt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Ie=document.createElement("textarea"),Ie.textContent=lt??Qe,this.data.doNotScroll&&(Ie.style.overflowY="hidden")):(Ie=document.createElement("input"),Ie.type="text",Ie.setAttribute("value",lt??Qe),this.data.doNotScroll&&(Ie.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Ie.hidden=!0),j.add(Ie),Ie.setAttribute("data-element-id",ne),Ie.disabled=this.data.readOnly,Ie.name=this.data.fieldName,Ie.tabIndex=g,this._setRequired(Ie,this.data.required),ht&&(Ie.maxLength=ht),Ie.addEventListener("input",ct=>{_e.setValue(ne,{value:ct.target.value}),this.setPropertyOnSiblings(Ie,"value",ct.target.value,"value"),st.formattedValue=null}),Ie.addEventListener("resetform",ct=>{const dt=this.data.defaultFieldValue??"";Ie.value=st.userValue=dt,st.formattedValue=null});let _t=ct=>{const{formattedValue:dt}=st;dt!=null&&(ct.target.value=dt),ct.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Ie.addEventListener("focus",dt=>{if(st.focused)return;const{target:gt}=dt;st.userValue&&(gt.value=st.userValue),st.lastCommittedValue=gt.value,st.commitKey=1,st.focused=!0}),Ie.addEventListener("updatefromsandbox",dt=>{this.showElementAndHideCanvas(dt.target);const gt={value(vt){st.userValue=vt.detail.value??"",_e.setValue(ne,{value:st.userValue.toString()}),vt.target.value=st.userValue},formattedValue(vt){const{formattedValue:yt}=vt.detail;st.formattedValue=yt,yt!=null&&vt.target!==document.activeElement&&(vt.target.value=yt),_e.setValue(ne,{formattedValue:yt})},selRange(vt){vt.target.setSelectionRange(...vt.detail.selRange)},charLimit:vt=>{var Et;const{charLimit:yt}=vt.detail,{target:At}=vt;if(yt===0){At.removeAttribute("maxLength");return}At.setAttribute("maxLength",yt);let wt=st.userValue;!wt||wt.length<=yt||(wt=wt.slice(0,yt),At.value=st.userValue=wt,_e.setValue(ne,{value:wt}),(Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne,name:"Keystroke",value:wt,willCommit:!0,commitKey:1,selStart:At.selectionStart,selEnd:At.selectionEnd}}))}};this._dispatchEventFromSandbox(gt,dt)}),Ie.addEventListener("keydown",dt=>{var yt;st.commitKey=1;let gt=-1;if(dt.key==="Escape"?gt=0:dt.key==="Enter"&&!this.data.multiLine?gt=2:dt.key==="Tab"&&(st.commitKey=3),gt===-1)return;const{value:vt}=dt.target;st.lastCommittedValue!==vt&&(st.lastCommittedValue=vt,st.userValue=vt,(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne,name:"Keystroke",value:vt,willCommit:!0,commitKey:gt,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}}))});const ct=_t;_t=null,Ie.addEventListener("blur",dt=>{var vt;if(!st.focused||!dt.relatedTarget)return;st.focused=!1;const{value:gt}=dt.target;st.userValue=gt,st.lastCommittedValue!==gt&&((vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne,name:"Keystroke",value:gt,willCommit:!0,commitKey:st.commitKey,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}})),ct(dt)}),($e=this.data.actions)!=null&&$e.Keystroke&&Ie.addEventListener("beforeinput",dt=>{var kt;st.lastCommittedValue=null;const{data:gt,target:vt}=dt,{value:yt,selectionStart:At,selectionEnd:wt}=vt;let Et=At,Mt=wt;switch(dt.inputType){case"deleteWordBackward":{const It=yt.substring(0,At).match(/\w*[^\w]*$/);It&&(Et-=It[0].length);break}case"deleteWordForward":{const It=yt.substring(At).match(/^[^\w]*\w*/);It&&(Mt+=It[0].length);break}case"deleteContentBackward":At===wt&&(Et-=1);break;case"deleteContentForward":At===wt&&(Mt+=1);break}dt.preventDefault(),(kt=this.linkService.eventBus)==null||kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne,name:"Keystroke",value:yt,change:gt||"",willCommit:!1,selStart:Et,selEnd:Mt}})}),this._setEventListeners(Ie,st,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.value)}if(_t&&Ie.addEventListener("blur",_t),this.data.comb){const dt=(this.data.rect[2]-this.data.rect[0])/ht;Ie.classList.add("comb"),Ie.style.letterSpacing=`calc(${dt}px * var(--scale-factor) - 1ch)`}}else Ie=document.createElement("div"),Ie.textContent=this.data.fieldValue,Ie.style.verticalAlign="middle",Ie.style.display="table-cell";return this._setTextStyle(Ie),this._setBackgroundColor(Ie),this._setDefaultPropertiesFromJS(Ie),this.container.append(Ie),this.container}}class x extends y{constructor(_e){super(_e,{isRenderable:!!_e.data.hasOwnCanvas})}}class S extends y{constructor(_e){super(_e,{isRenderable:_e.renderForms})}render(){const _e=this.annotationStorage,ne=this.data,Ie=ne.id;let je=_e.getValue(Ie,{value:ne.exportValue===ne.fieldValue}).value;typeof je=="string"&&(je=je!=="Off",_e.setValue(Ie,{value:je})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const $e=document.createElement("input");return j.add($e),$e.setAttribute("data-element-id",Ie),$e.disabled=ne.readOnly,this._setRequired($e,this.data.required),$e.type="checkbox",$e.name=ne.fieldName,je&&$e.setAttribute("checked",!0),$e.setAttribute("exportValue",ne.exportValue),$e.tabIndex=g,$e.addEventListener("change",Ke=>{const{name:Qe,checked:ht}=Ke.target;for(const lt of this._getElementsByName(Qe,Ie)){const st=ht&&lt.exportValue===ne.exportValue;lt.domElement&&(lt.domElement.checked=st),_e.setValue(lt.id,{value:st})}_e.setValue(Ie,{value:ht})}),$e.addEventListener("resetform",Ke=>{const Qe=ne.defaultFieldValue||"Off";Ke.target.checked=Qe===ne.exportValue}),this.enableScripting&&this.hasJSActions&&($e.addEventListener("updatefromsandbox",Ke=>{const Qe={value(ht){ht.target.checked=ht.detail.value!=="Off",_e.setValue(Ie,{value:ht.target.checked})}};this._dispatchEventFromSandbox(Qe,Ke)}),this._setEventListeners($e,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ke=>Ke.target.checked)),this._setBackgroundColor($e),this._setDefaultPropertiesFromJS($e),this.container.append($e),this.container}}class n extends y{constructor(_e){super(_e,{isRenderable:_e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const _e=this.annotationStorage,ne=this.data,Ie=ne.id;let je=_e.getValue(Ie,{value:ne.fieldValue===ne.buttonValue}).value;typeof je=="string"&&(je=je!==ne.buttonValue,_e.setValue(Ie,{value:je}));const $e=document.createElement("input");if(j.add($e),$e.setAttribute("data-element-id",Ie),$e.disabled=ne.readOnly,this._setRequired($e,this.data.required),$e.type="radio",$e.name=ne.fieldName,je&&$e.setAttribute("checked",!0),$e.tabIndex=g,$e.addEventListener("change",Ke=>{const{name:Qe,checked:ht}=Ke.target;for(const lt of this._getElementsByName(Qe,Ie))_e.setValue(lt.id,{value:!1});_e.setValue(Ie,{value:ht})}),$e.addEventListener("resetform",Ke=>{const Qe=ne.defaultFieldValue;Ke.target.checked=Qe!=null&&Qe===ne.buttonValue}),this.enableScripting&&this.hasJSActions){const Ke=ne.buttonValue;$e.addEventListener("updatefromsandbox",Qe=>{const ht={value:lt=>{const st=Ke===lt.detail.value;for(const _t of this._getElementsByName(lt.target.name)){const ct=st&&_t.id===Ie;_t.domElement&&(_t.domElement.checked=ct),_e.setValue(_t.id,{value:ct})}}};this._dispatchEventFromSandbox(ht,Qe)}),this._setEventListeners($e,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Qe=>Qe.target.checked)}return this._setBackgroundColor($e),this._setDefaultPropertiesFromJS($e),this.container.append($e),this.container}}class i extends w{constructor(_e){super(_e,{ignoreBorder:_e.data.hasAppearance})}render(){const _e=super.render();_e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(_e.title=this.data.alternativeText);const ne=_e.lastChild;return this.enableScripting&&this.hasJSActions&&ne&&(this._setDefaultPropertiesFromJS(ne),ne.addEventListener("updatefromsandbox",Ie=>{this._dispatchEventFromSandbox({},Ie)})),_e}}class s extends y{constructor(_e){super(_e,{isRenderable:_e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const _e=this.annotationStorage,ne=this.data.id,Ie=_e.getValue(ne,{value:this.data.fieldValue}),je=document.createElement("select");j.add(je),je.setAttribute("data-element-id",ne),je.disabled=this.data.readOnly,this._setRequired(je,this.data.required),je.name=this.data.fieldName,je.tabIndex=g;let $e=this.data.combo&&this.data.options.length>0;this.data.combo||(je.size=this.data.options.length,this.data.multiSelect&&(je.multiple=!0)),je.addEventListener("resetform",st=>{const _t=this.data.defaultFieldValue;for(const ct of je.options)ct.selected=ct.value===_t});for(const st of this.data.options){const _t=document.createElement("option");_t.textContent=st.displayValue,_t.value=st.exportValue,Ie.value.includes(st.exportValue)&&(_t.setAttribute("selected",!0),$e=!1),je.append(_t)}let Ke=null;if($e){const st=document.createElement("option");st.value=" ",st.setAttribute("hidden",!0),st.setAttribute("selected",!0),je.prepend(st),Ke=()=>{st.remove(),je.removeEventListener("input",Ke),Ke=null},je.addEventListener("input",Ke)}const Qe=st=>{const _t=st?"value":"textContent",{options:ct,multiple:dt}=je;return dt?Array.prototype.filter.call(ct,gt=>gt.selected).map(gt=>gt[_t]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][_t]};let ht=Qe(!1);const lt=st=>{const _t=st.target.options;return Array.prototype.map.call(_t,ct=>({displayValue:ct.textContent,exportValue:ct.value}))};return this.enableScripting&&this.hasJSActions?(je.addEventListener("updatefromsandbox",st=>{const _t={value(ct){Ke==null||Ke();const dt=ct.detail.value,gt=new Set(Array.isArray(dt)?dt:[dt]);for(const vt of je.options)vt.selected=gt.has(vt.value);_e.setValue(ne,{value:Qe(!0)}),ht=Qe(!1)},multipleSelection(ct){je.multiple=!0},remove(ct){const dt=je.options,gt=ct.detail.remove;dt[gt].selected=!1,je.remove(gt),dt.length>0&&Array.prototype.findIndex.call(dt,yt=>yt.selected)===-1&&(dt[0].selected=!0),_e.setValue(ne,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},clear(ct){for(;je.length!==0;)je.remove(0);_e.setValue(ne,{value:null,items:[]}),ht=Qe(!1)},insert(ct){const{index:dt,displayValue:gt,exportValue:vt}=ct.detail.insert,yt=je.children[dt],At=document.createElement("option");At.textContent=gt,At.value=vt,yt?yt.before(At):je.append(At),_e.setValue(ne,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},items(ct){const{items:dt}=ct.detail;for(;je.length!==0;)je.remove(0);for(const gt of dt){const{displayValue:vt,exportValue:yt}=gt,At=document.createElement("option");At.textContent=vt,At.value=yt,je.append(At)}je.options.length>0&&(je.options[0].selected=!0),_e.setValue(ne,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},indices(ct){const dt=new Set(ct.detail.indices);for(const gt of ct.target.options)gt.selected=dt.has(gt.index);_e.setValue(ne,{value:Qe(!0)}),ht=Qe(!1)},editable(ct){ct.target.disabled=!ct.detail.editable}};this._dispatchEventFromSandbox(_t,st)}),je.addEventListener("input",st=>{var ct;const _t=Qe(!0);_e.setValue(ne,{value:_t}),st.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne,name:"Keystroke",value:ht,changeEx:_t,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(je,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],st=>st.target.value)):je.addEventListener("input",function(st){_e.setValue(ne,{value:Qe(!0)})}),this.data.combo&&this._setTextStyle(je),this._setBackgroundColor(je),this._setDefaultPropertiesFromJS(je),this.container.append(je),this.container}}class c extends h{constructor(_e){const{data:ne,elements:Ie}=_e;super(_e,{isRenderable:h._hasPopupData(ne)}),this.elements=Ie}render(){this.container.classList.add("popupAnnotation");const _e=new v({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),ne=[];for(const Ie of this.elements)Ie.popup=_e,ne.push(Ie.data.id),Ie.addHighlightArea();return this.container.setAttribute("aria-controls",ne.map(Ie=>`${p.AnnotationPrefix}${Ie}`).join(",")),this.container}}class v{constructor({container:_e,color:ne,elements:Ie,titleObj:je,modificationDate:$e,contentsObj:Ke,richText:Qe,parent:ht,rect:lt,parentRect:st,open:_t}){Te(this,De);Te(this,Re,null);Te(this,Ne,Z(this,De,Jn).bind(this));Te(this,He,Z(this,De,Zi).bind(this));Te(this,ze,Z(this,De,Qi).bind(this));Te(this,qe,Z(this,De,fi).bind(this));Te(this,Ye,null);Te(this,Oe,null);Te(this,Fe,null);Te(this,Y,null);Te(this,Ae,null);Te(this,ke,null);Te(this,U,!1);Te(this,o,null);Te(this,H,null);Te(this,te,null);Te(this,q,null);Te(this,Le,!1);var dt;Pe(this,Oe,_e),Pe(this,q,je),Pe(this,Fe,Ke),Pe(this,te,Qe),Pe(this,Ae,ht),Pe(this,Ye,ne),Pe(this,H,lt),Pe(this,ke,st),Pe(this,Y,Ie);const ct=M.PDFDateString.toDateObject($e);ct&&Pe(this,Re,ht.l10n.get("annotation_date_string",{date:ct.toLocaleDateString(),time:ct.toLocaleTimeString()})),this.trigger=Ie.flatMap(gt=>gt.getElementsToTriggerPopup());for(const gt of this.trigger)gt.addEventListener("click",e(this,qe)),gt.addEventListener("mouseenter",e(this,ze)),gt.addEventListener("mouseleave",e(this,He)),gt.classList.add("popupTriggerArea");for(const gt of Ie)(dt=gt.container)==null||dt.addEventListener("keydown",e(this,Ne));e(this,Oe).hidden=!0,_t&&Z(this,De,fi).call(this)}render(){if(e(this,o))return;const{page:{view:_e},viewport:{rawDims:{pageWidth:ne,pageHeight:Ie,pageX:je,pageY:$e}}}=e(this,Ae),Ke=Pe(this,o,document.createElement("div"));if(Ke.className="popup",e(this,Ye)){const Et=Ke.style.outlineColor=p.Util.makeHexColor(...e(this,Ye));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Ke.style.backgroundColor=`color-mix(in srgb, ${Et} 30%, white)`:Ke.style.backgroundColor=p.Util.makeHexColor(...e(this,Ye).map(kt=>Math.floor(.7*(255-kt)+kt)))}const Qe=document.createElement("span");Qe.className="header";const ht=document.createElement("h1");if(Qe.append(ht),{dir:ht.dir,str:ht.textContent}=e(this,q),Ke.append(Qe),e(this,Re)){const Et=document.createElement("span");Et.classList.add("popupDate"),e(this,Re).then(Mt=>{Et.textContent=Mt}),Qe.append(Et)}const lt=e(this,Fe),st=e(this,te);if(st!=null&&st.str&&(!(lt!=null&&lt.str)||lt.str===st.str))D.XfaLayer.render({xfaHtml:st.html,intent:"richText",div:Ke}),Ke.lastChild.classList.add("richText","popupContent");else{const Et=this._formatContents(lt);Ke.append(Et)}let _t=!!e(this,ke),ct=_t?e(this,ke):e(this,H);for(const Et of e(this,Y))if(!ct||p.Util.intersect(Et.data.rect,ct)!==null){ct=Et.data.rect,_t=!0;break}const dt=p.Util.normalizeRect([ct[0],_e[3]-ct[1]+_e[1],ct[2],_e[3]-ct[3]+_e[1]]),vt=_t?ct[2]-ct[0]+5:0,yt=dt[0]+vt,At=dt[1],{style:wt}=e(this,Oe);wt.left=`${100*(yt-je)/ne}%`,wt.top=`${100*(At-$e)/Ie}%`,e(this,Oe).append(Ke)}_formatContents({str:_e,dir:ne}){const Ie=document.createElement("p");Ie.classList.add("popupContent"),Ie.dir=ne;const je=_e.split(/(?:\r\n?|\n)/);for(let $e=0,Ke=je.length;$e<Ke;++$e){const Qe=je[$e];Ie.append(document.createTextNode(Qe)),$e<Ke-1&&Ie.append(document.createElement("br"))}return Ie}forceHide(){Pe(this,Le,this.isVisible),e(this,Le)&&(e(this,Oe).hidden=!0)}maybeShow(){e(this,Le)&&(Pe(this,Le,!1),e(this,Oe).hidden=!1)}get isVisible(){return e(this,Oe).hidden===!1}}Re=new WeakMap,Ne=new WeakMap,He=new WeakMap,ze=new WeakMap,qe=new WeakMap,Ye=new WeakMap,Oe=new WeakMap,Fe=new WeakMap,Y=new WeakMap,Ae=new WeakMap,ke=new WeakMap,U=new WeakMap,o=new WeakMap,H=new WeakMap,te=new WeakMap,q=new WeakMap,Le=new WeakMap,De=new WeakSet,Jn=function(_e){_e.altKey||_e.shiftKey||_e.ctrlKey||_e.metaKey||(_e.key==="Enter"||_e.key==="Escape"&&e(this,U))&&Z(this,De,fi).call(this)},fi=function(){Pe(this,U,!e(this,U)),e(this,U)?(Z(this,De,Qi).call(this),e(this,Oe).addEventListener("click",e(this,qe)),e(this,Oe).addEventListener("keydown",e(this,Ne))):(Z(this,De,Zi).call(this),e(this,Oe).removeEventListener("click",e(this,qe)),e(this,Oe).removeEventListener("keydown",e(this,Ne)))},Qi=function(){e(this,o)||this.render(),this.isVisible?e(this,U)&&e(this,Oe).classList.add("focused"):(e(this,Oe).hidden=!1,e(this,Oe).style.zIndex=parseInt(e(this,Oe).style.zIndex)+1e3)},Zi=function(){e(this,Oe).classList.remove("focused"),!(e(this,U)||!this.isVisible)&&(e(this,Oe).hidden=!0,e(this,Oe).style.zIndex=parseInt(e(this,Oe).style.zIndex)-1e3)};class z extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=_e.data.textContent,this.textPosition=_e.data.textPosition,this.annotationEditorType=p.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const _e=document.createElement("div");_e.classList.add("annotationTextContent"),_e.setAttribute("role","comment");for(const ne of this.textContent){const Ie=document.createElement("span");Ie.textContent=ne,_e.append(Ie)}this.container.append(_e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=z;class u extends h{constructor(ne){super(ne,{isRenderable:!0,ignoreBorder:!0});Te(this,it,null)}render(){this.container.classList.add("lineAnnotation");const ne=this.data,{width:Ie,height:je}=I(ne.rect),$e=this.svgFactory.create(Ie,je,!0),Ke=Pe(this,it,this.svgFactory.createElement("svg:line"));return Ke.setAttribute("x1",ne.rect[2]-ne.lineCoordinates[0]),Ke.setAttribute("y1",ne.rect[3]-ne.lineCoordinates[1]),Ke.setAttribute("x2",ne.rect[2]-ne.lineCoordinates[2]),Ke.setAttribute("y2",ne.rect[3]-ne.lineCoordinates[3]),Ke.setAttribute("stroke-width",ne.borderStyle.width||1),Ke.setAttribute("stroke","transparent"),Ke.setAttribute("fill","transparent"),$e.append(Ke),this.container.append($e),!ne.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return e(this,it)}addHighlightArea(){this.container.classList.add("highlightArea")}}it=new WeakMap;class N extends h{constructor(ne){super(ne,{isRenderable:!0,ignoreBorder:!0});Te(this,pt,null)}render(){this.container.classList.add("squareAnnotation");const ne=this.data,{width:Ie,height:je}=I(ne.rect),$e=this.svgFactory.create(Ie,je,!0),Ke=ne.borderStyle.width,Qe=Pe(this,pt,this.svgFactory.createElement("svg:rect"));return Qe.setAttribute("x",Ke/2),Qe.setAttribute("y",Ke/2),Qe.setAttribute("width",Ie-Ke),Qe.setAttribute("height",je-Ke),Qe.setAttribute("stroke-width",Ke||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),$e.append(Qe),this.container.append($e),!ne.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return e(this,pt)}addHighlightArea(){this.container.classList.add("highlightArea")}}pt=new WeakMap;class re extends h{constructor(ne){super(ne,{isRenderable:!0,ignoreBorder:!0});Te(this,mt,null)}render(){this.container.classList.add("circleAnnotation");const ne=this.data,{width:Ie,height:je}=I(ne.rect),$e=this.svgFactory.create(Ie,je,!0),Ke=ne.borderStyle.width,Qe=Pe(this,mt,this.svgFactory.createElement("svg:ellipse"));return Qe.setAttribute("cx",Ie/2),Qe.setAttribute("cy",je/2),Qe.setAttribute("rx",Ie/2-Ke/2),Qe.setAttribute("ry",je/2-Ke/2),Qe.setAttribute("stroke-width",Ke||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),$e.append(Qe),this.container.append($e),!ne.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return e(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap;class Q extends h{constructor(ne){super(ne,{isRenderable:!0,ignoreBorder:!0});Te(this,Xe,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const ne=this.data,{width:Ie,height:je}=I(ne.rect),$e=this.svgFactory.create(Ie,je,!0);let Ke=[];for(const ht of ne.vertices){const lt=ht.x-ne.rect[0],st=ne.rect[3]-ht.y;Ke.push(lt+","+st)}Ke=Ke.join(" ");const Qe=Pe(this,Xe,this.svgFactory.createElement(this.svgElementName));return Qe.setAttribute("points",Ke),Qe.setAttribute("stroke-width",ne.borderStyle.width||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),$e.append(Qe),this.container.append($e),!ne.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return e(this,Xe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xe=new WeakMap;class oe extends Q{constructor(_e){super(_e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class fe extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class O extends h{constructor(ne){super(ne,{isRenderable:!0,ignoreBorder:!0});Te(this,Be,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=p.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const ne=this.data,{width:Ie,height:je}=I(ne.rect),$e=this.svgFactory.create(Ie,je,!0);for(const Ke of ne.inkLists){let Qe=[];for(const lt of Ke){const st=lt.x-ne.rect[0],_t=ne.rect[3]-lt.y;Qe.push(`${st},${_t}`)}Qe=Qe.join(" ");const ht=this.svgFactory.createElement(this.svgElementName);e(this,Be).push(ht),ht.setAttribute("points",Qe),ht.setAttribute("stroke-width",ne.borderStyle.width||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),!ne.popupRef&&this.hasPopupData&&this._createPopup(),$e.append(ht)}return this.container.append($e),this.container}getElementsToTriggerPopup(){return e(this,Be)}addHighlightArea(){this.container.classList.add("highlightArea")}}Be=new WeakMap,t.InkAnnotationElement=O;class Ee extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class T extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class P extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Ce extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class W extends h{constructor(_e){super(_e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=W;class d extends h{constructor(ne){var $e;super(ne,{isRenderable:!0});Te(this,nt);Te(this,Ue,null);const{filename:Ie,content:je}=this.data.file;this.filename=(0,M.getFilenameFromUrl)(Ie,!0),this.content=je,($e=this.linkService.eventBus)==null||$e.dispatch("fileattachmentannotation",{source:this,filename:Ie,content:je})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:ne,data:Ie}=this;let je;Ie.hasAppearance||Ie.fillAlpha===0?je=document.createElement("div"):(je=document.createElement("img"),je.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Ie.name)?"paperclip":"pushpin"}.svg`,Ie.fillAlpha&&Ie.fillAlpha<1&&(je.style=`filter: opacity(${Math.round(Ie.fillAlpha*100)}%);`)),je.addEventListener("dblclick",Z(this,nt,Ji).bind(this)),Pe(this,Ue,je);const{isMac:$e}=p.FeatureTest.platform;return ne.addEventListener("keydown",Ke=>{Ke.key==="Enter"&&($e?Ke.metaKey:Ke.ctrlKey)&&Z(this,nt,Ji).call(this)}),!Ie.popupRef&&this.hasPopupData?this._createPopup():je.classList.add("popupTriggerArea"),ne.append(je),ne}getElementsToTriggerPopup(){return e(this,Ue)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ue=new WeakMap,nt=new WeakSet,Ji=function(){var ne;(ne=this.downloadManager)==null||ne.openOrDownloadData(this.container,this.content,this.filename)};class m{constructor({div:_e,accessibilityManager:ne,annotationCanvasMap:Ie,l10n:je,page:$e,viewport:Ke}){Te(this,et);Te(this,ut,null);Te(this,be,null);Te(this,We,new Map);this.div=_e,Pe(this,ut,ne),Pe(this,be,Ie),this.l10n=je,this.page=$e,this.viewport=Ke,this.zIndex=0,this.l10n||(this.l10n=F.NullL10n)}async render(_e){const{annotations:ne}=_e,Ie=this.div;(0,M.setLayerDimensions)(Ie,this.viewport);const je=new Map,$e={data:null,layer:Ie,linkService:_e.linkService,downloadManager:_e.downloadManager,imageResourcesPath:_e.imageResourcesPath||"",renderForms:_e.renderForms!==!1,svgFactory:new M.DOMSVGFactory,annotationStorage:_e.annotationStorage||new Me.AnnotationStorage,enableScripting:_e.enableScripting===!0,hasJSActions:_e.hasJSActions,fieldObjects:_e.fieldObjects,parent:this,elements:null};for(const Ke of ne){if(Ke.noHTML)continue;const Qe=Ke.annotationType===p.AnnotationType.POPUP;if(Qe){const st=je.get(Ke.id);if(!st)continue;$e.elements=st}else{const{width:st,height:_t}=I(Ke.rect);if(st<=0||_t<=0)continue}$e.data=Ke;const ht=f.create($e);if(!ht.isRenderable)continue;if(!Qe&&Ke.popupRef){const st=je.get(Ke.popupRef);st?st.push(ht):je.set(Ke.popupRef,[ht])}ht.annotationEditorType>0&&e(this,We).set(ht.data.id,ht);const lt=ht.render();Ke.hidden&&(lt.style.visibility="hidden"),Z(this,et,es).call(this,lt,Ke.id)}Z(this,et,en).call(this),await this.l10n.translate(Ie)}update({viewport:_e}){const ne=this.div;this.viewport=_e,(0,M.setLayerDimensions)(ne,{rotation:_e.rotation}),Z(this,et,en).call(this),ne.hidden=!1}getEditableAnnotations(){return Array.from(e(this,We).values())}getEditableAnnotation(_e){return e(this,We).get(_e)}}ut=new WeakMap,be=new WeakMap,We=new WeakMap,et=new WeakSet,es=function(_e,ne){var je;const Ie=_e.firstChild||_e;Ie.id=`${p.AnnotationPrefix}${ne}`,this.div.append(_e),(je=e(this,ut))==null||je.moveElementInDOM(this.div,_e,Ie,!1)},en=function(){if(!e(this,be))return;const _e=this.div;for(const[ne,Ie]of e(this,be)){const je=_e.querySelector(`[data-annotation-id="${ne}"]`);if(!je)continue;const{firstChild:$e}=je;$e?$e.nodeName==="CANVAS"?$e.replaceWith(Ie):$e.before(Ie):je.append(Ie)}e(this,be).clear()},t.AnnotationLayer=m},(we,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function le(Me){return Math.floor(Math.max(0,Math.min(1,Me))*255).toString(16).padStart(2,"0")}function p(Me){return Math.max(0,Math.min(255,255*Me))}class M{static CMYK_G([J,F,D,g]){return["G",1-Math.min(1,.3*J+.59*D+.11*F+g)]}static G_CMYK([J]){return["CMYK",0,0,0,1-J]}static G_RGB([J]){return["RGB",J,J,J]}static G_rgb([J]){return J=p(J),[J,J,J]}static G_HTML([J]){const F=le(J);return`#${F}${F}${F}`}static RGB_G([J,F,D]){return["G",.3*J+.59*F+.11*D]}static RGB_rgb(J){return J.map(p)}static RGB_HTML(J){return`#${J.map(le).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([J,F,D,g]){return["RGB",1-Math.min(1,J+g),1-Math.min(1,D+g),1-Math.min(1,F+g)]}static CMYK_rgb([J,F,D,g]){return[p(1-Math.min(1,J+g)),p(1-Math.min(1,D+g)),p(1-Math.min(1,F+g))]}static CMYK_HTML(J){const F=this.CMYK_RGB(J).slice(1);return this.RGB_HTML(F)}static RGB_CMYK([J,F,D]){const g=1-J,r=1-F,j=1-D,I=Math.min(g,r,j);return["CMYK",g,r,j,I]}}t.ColorConverters=M},(we,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=p;const le={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};le.print_progress_percent="{{progress}}%";function p(J,F){switch(J){case"find_match_count":J=`find_match_count[${F.total===1?"one":"other"}]`;break;case"find_match_count_limit":J=`find_match_count_limit[${F.limit===1?"one":"other"}]`;break}return le[J]||""}function M(J,F){return F?J.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(D,g)=>g in F?F[g]:"{{"+g+"}}"):J}const Me={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(J,F=null,D=p(J,F)){return M(D,F)},async translate(J){}};t.NullL10n=Me},(we,t,le)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var p=le(25);class M{static setupStorage(J,F,D,g,r){const j=g.getValue(F,{value:null});switch(D.name){case"textarea":if(j.value!==null&&(J.textContent=j.value),r==="print")break;J.addEventListener("input",I=>{g.setValue(F,{value:I.target.value})});break;case"input":if(D.attributes.type==="radio"||D.attributes.type==="checkbox"){if(j.value===D.attributes.xfaOn?J.setAttribute("checked",!0):j.value===D.attributes.xfaOff&&J.removeAttribute("checked"),r==="print")break;J.addEventListener("change",I=>{g.setValue(F,{value:I.target.checked?I.target.getAttribute("xfaOn"):I.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&J.setAttribute("value",j.value),r==="print")break;J.addEventListener("input",I=>{g.setValue(F,{value:I.target.value})})}break;case"select":if(j.value!==null){J.setAttribute("value",j.value);for(const I of D.children)I.attributes.value===j.value?I.attributes.selected=!0:I.attributes.hasOwnProperty("selected")&&delete I.attributes.selected}J.addEventListener("input",I=>{const f=I.target.options,h=f.selectedIndex===-1?"":f[f.selectedIndex].value;g.setValue(F,{value:h})});break}}static setAttributes({html:J,element:F,storage:D=null,intent:g,linkService:r}){const{attributes:j}=F,I=J instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${g}`);for(const[f,h]of Object.entries(j))if(h!=null)switch(f){case"class":h.length&&J.setAttribute(f,h.join(" "));break;case"dataId":break;case"id":J.setAttribute("data-element-id",h);break;case"style":Object.assign(J.style,h);break;case"textContent":J.textContent=h;break;default:(!I||f!=="href"&&f!=="newWindow")&&J.setAttribute(f,h)}I&&r.addLinkAttributes(J,j.href,j.newWindow),D&&j.dataId&&this.setupStorage(J,j.dataId,F,D)}static render(J){var w;const F=J.annotationStorage,D=J.linkService,g=J.xfaHtml,r=J.intent||"display",j=document.createElement(g.name);g.attributes&&this.setAttributes({html:j,element:g,intent:r,linkService:D});const I=[[g,-1,j]],f=J.div;if(f.append(j),J.viewport){const E=`matrix(${J.viewport.transform.join(",")})`;f.style.transform=E}r!=="richText"&&f.setAttribute("class","xfaLayer xfaFont");const h=[];for(;I.length>0;){const[E,y,_]=I.at(-1);if(y+1===E.children.length){I.pop();continue}const x=E.children[++I.at(-1)[1]];if(x===null)continue;const{name:S}=x;if(S==="#text"){const i=document.createTextNode(x.value);h.push(i),_.append(i);continue}const n=(w=x==null?void 0:x.attributes)!=null&&w.xmlns?document.createElementNS(x.attributes.xmlns,S):document.createElement(S);if(_.append(n),x.attributes&&this.setAttributes({html:n,element:x,storage:F,intent:r,linkService:D}),x.children&&x.children.length>0)I.push([x,-1,n]);else if(x.value){const i=document.createTextNode(x.value);p.XfaText.shouldBuildText(S)&&h.push(i),n.append(i)}}for(const E of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))E.setAttribute("readOnly",!0);return{textDivs:h}}static update(J){const F=`matrix(${J.viewport.transform.join(",")})`;J.div.style.transform=F,J.div.hidden=!1}}t.XfaLayer=M},(we,t,le)=>{var g,r,j,I,f,h,w,E,y,_,x,S,n,i,s,ts,is,ns,ss,tn,rs,nn,as,os,ls,cs,hs,Lt,sn,pi,gi,Ut,rn,mi,ve,ds,an,us,fs,on,_i,Ht;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var p=le(1),M=le(4),Me=le(29),J=le(6),F=le(5);const Ye=class Ye extends M.AnnotationEditor{constructor(Y){super({...Y,name:"inkEditor"});Te(this,s);Te(this,g,0);Te(this,r,0);Te(this,j,this.canvasPointermove.bind(this));Te(this,I,this.canvasPointerleave.bind(this));Te(this,f,this.canvasPointerup.bind(this));Te(this,h,this.canvasPointerdown.bind(this));Te(this,w,new Path2D);Te(this,E,!1);Te(this,y,!1);Te(this,_,!1);Te(this,x,null);Te(this,S,0);Te(this,n,0);Te(this,i,null);this.color=Y.color||null,this.thickness=Y.thickness||null,this.opacity=Y.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Y){M.AnnotationEditor.initialize(Y,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Y,Ae){switch(Y){case p.AnnotationEditorParamsType.INK_THICKNESS:Ye._defaultThickness=Ae;break;case p.AnnotationEditorParamsType.INK_COLOR:Ye._defaultColor=Ae;break;case p.AnnotationEditorParamsType.INK_OPACITY:Ye._defaultOpacity=Ae/100;break}}updateParams(Y,Ae){switch(Y){case p.AnnotationEditorParamsType.INK_THICKNESS:Z(this,s,ts).call(this,Ae);break;case p.AnnotationEditorParamsType.INK_COLOR:Z(this,s,is).call(this,Ae);break;case p.AnnotationEditorParamsType.INK_OPACITY:Z(this,s,ns).call(this,Ae);break}}static get defaultPropertiesToUpdate(){return[[p.AnnotationEditorParamsType.INK_THICKNESS,Ye._defaultThickness],[p.AnnotationEditorParamsType.INK_COLOR,Ye._defaultColor||M.AnnotationEditor._defaultLineColor],[p.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ye._defaultOpacity*100)]]}get propertiesToUpdate(){return[[p.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ye._defaultThickness],[p.AnnotationEditorParamsType.INK_COLOR,this.color||Ye._defaultColor||M.AnnotationEditor._defaultLineColor],[p.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ye._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Z(this,s,pi).call(this),Z(this,s,gi).call(this)),this.isAttachedToDOM||(this.parent.add(this),Z(this,s,Ut).call(this)),Z(this,s,Ht).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,e(this,x).disconnect(),Pe(this,x,null),super.remove())}setParent(Y){!this.parent&&Y?this._uiManager.removeShouldRescale(this):this.parent&&Y===null&&this._uiManager.addShouldRescale(this),super.setParent(Y)}onScaleChanging(){const[Y,Ae]=this.parentDimensions,ke=this.width*Y,U=this.height*Ae;this.setDimensions(ke,U)}enableEditMode(){e(this,E)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",e(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",e(this,h)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){e(this,E)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Pe(this,E,!0),this.div.classList.add("disabled"),Z(this,s,Ht).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Y){this._focusEventsAllowed&&(super.focusin(Y),this.enableEditMode())}canvasPointerdown(Y){Y.button!==0||!this.isInEditMode()||e(this,E)||(this.setInForeground(),Y.preventDefault(),Y.type!=="mouse"&&this.div.focus(),Z(this,s,rs).call(this,Y.offsetX,Y.offsetY))}canvasPointermove(Y){Y.preventDefault(),Z(this,s,nn).call(this,Y.offsetX,Y.offsetY)}canvasPointerup(Y){Y.preventDefault(),Z(this,s,sn).call(this,Y)}canvasPointerleave(Y){Z(this,s,sn).call(this,Y)}get isResizable(){return!this.isEmpty()&&e(this,E)}render(){if(this.div)return this.div;let Y,Ae;this.width&&(Y=this.x,Ae=this.y),super.render(),M.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(te=>{var q;return(q=this.div)==null?void 0:q.setAttribute("aria-label",te)});const[ke,U,o,H]=Z(this,s,ss).call(this);if(this.setAt(ke,U,0,0),this.setDims(o,H),Z(this,s,pi).call(this),this.width){const[te,q]=this.parentDimensions;this.setAspectRatio(this.width*te,this.height*q),this.setAt(Y*te,Ae*q,this.width*te,this.height*q),Pe(this,_,!0),Z(this,s,Ut).call(this),this.setDims(this.width*te,this.height*q),Z(this,s,Lt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Z(this,s,gi).call(this),this.div}setDimensions(Y,Ae){const ke=Math.round(Y),U=Math.round(Ae);if(e(this,S)===ke&&e(this,n)===U)return;Pe(this,S,ke),Pe(this,n,U),this.canvas.style.visibility="hidden";const[o,H]=this.parentDimensions;this.width=Y/o,this.height=Ae/H,this.fixAndSetPosition(),e(this,E)&&Z(this,s,rn).call(this,Y,Ae),Z(this,s,Ut).call(this),Z(this,s,Lt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Y,Ae,ke){var it,pt,mt;if(Y instanceof Me.InkAnnotationElement)return null;const U=super.deserialize(Y,Ae,ke);U.thickness=Y.thickness,U.color=p.Util.makeHexColor(...Y.color),U.opacity=Y.opacity;const[o,H]=U.pageDimensions,te=U.width*o,q=U.height*H,Le=U.parentScale,De=Y.thickness/2;Pe(U,E,!0),Pe(U,S,Math.round(te)),Pe(U,n,Math.round(q));const{paths:Ge,rect:Ve,rotation:Je}=Y;for(let{bezier:Xe}of Ge){Xe=Z(it=Ye,ve,us).call(it,Xe,Ve,Je);const Be=[];U.paths.push(Be);let Ue=Le*(Xe[0]-De),nt=Le*(Xe[1]-De);for(let ut=2,be=Xe.length;ut<be;ut+=6){const We=Le*(Xe[ut]-De),et=Le*(Xe[ut+1]-De),rt=Le*(Xe[ut+2]-De),ot=Le*(Xe[ut+3]-De),tt=Le*(Xe[ut+4]-De),_e=Le*(Xe[ut+5]-De);Be.push([[Ue,nt],[We,et],[rt,ot],[tt,_e]]),Ue=tt,nt=_e}const ft=Z(this,ve,ds).call(this,Be);U.bezierPath2D.push(ft)}const Ze=Z(pt=U,s,on).call(pt);return Pe(U,r,Math.max(M.AnnotationEditor.MIN_SIZE,Ze[2]-Ze[0])),Pe(U,g,Math.max(M.AnnotationEditor.MIN_SIZE,Ze[3]-Ze[1])),Z(mt=U,s,rn).call(mt,te,q),U}serialize(){if(this.isEmpty())return null;const Y=this.getRect(0,0),Ae=M.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:p.AnnotationEditorType.INK,color:Ae,thickness:this.thickness,opacity:this.opacity,paths:Z(this,s,fs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Y),pageIndex:this.pageIndex,rect:Y,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};g=new WeakMap,r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakMap,_=new WeakMap,x=new WeakMap,S=new WeakMap,n=new WeakMap,i=new WeakMap,s=new WeakSet,ts=function(Y){const Ae=this.thickness;this.addCommands({cmd:()=>{this.thickness=Y,Z(this,s,Ht).call(this)},undo:()=>{this.thickness=Ae,Z(this,s,Ht).call(this)},mustExec:!0,type:p.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},is=function(Y){const Ae=this.color;this.addCommands({cmd:()=>{this.color=Y,Z(this,s,Lt).call(this)},undo:()=>{this.color=Ae,Z(this,s,Lt).call(this)},mustExec:!0,type:p.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ns=function(Y){Y/=100;const Ae=this.opacity;this.addCommands({cmd:()=>{this.opacity=Y,Z(this,s,Lt).call(this)},undo:()=>{this.opacity=Ae,Z(this,s,Lt).call(this)},mustExec:!0,type:p.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ss=function(){const{parentRotation:Y,parentDimensions:[Ae,ke]}=this;switch(Y){case 90:return[0,ke,ke,Ae];case 180:return[Ae,ke,Ae,ke];case 270:return[Ae,0,ke,Ae];default:return[0,0,Ae,ke]}},tn=function(){const{ctx:Y,color:Ae,opacity:ke,thickness:U,parentScale:o,scaleFactor:H}=this;Y.lineWidth=U*o/H,Y.lineCap="round",Y.lineJoin="round",Y.miterLimit=10,Y.strokeStyle=`${Ae}${(0,F.opacityToHex)(ke)}`},rs=function(Y,Ae){this.canvas.addEventListener("contextmenu",J.noContextMenu),this.canvas.addEventListener("pointerleave",e(this,I)),this.canvas.addEventListener("pointermove",e(this,j)),this.canvas.addEventListener("pointerup",e(this,f)),this.canvas.removeEventListener("pointerdown",e(this,h)),this.isEditing=!0,e(this,_)||(Pe(this,_,!0),Z(this,s,Ut).call(this),this.thickness||(this.thickness=Ye._defaultThickness),this.color||(this.color=Ye._defaultColor||M.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ye._defaultOpacity)),this.currentPath.push([Y,Ae]),Pe(this,y,!1),Z(this,s,tn).call(this),Pe(this,i,()=>{Z(this,s,ls).call(this),e(this,i)&&window.requestAnimationFrame(e(this,i))}),window.requestAnimationFrame(e(this,i))},nn=function(Y,Ae){const[ke,U]=this.currentPath.at(-1);if(this.currentPath.length>1&&Y===ke&&Ae===U)return;const o=this.currentPath;let H=e(this,w);if(o.push([Y,Ae]),Pe(this,y,!0),o.length<=2){H.moveTo(...o[0]),H.lineTo(Y,Ae);return}o.length===3&&(Pe(this,w,H=new Path2D),H.moveTo(...o[0])),Z(this,s,cs).call(this,H,...o.at(-3),...o.at(-2),Y,Ae)},as=function(){if(this.currentPath.length===0)return;const Y=this.currentPath.at(-1);e(this,w).lineTo(...Y)},os=function(Y,Ae){Pe(this,i,null),Y=Math.min(Math.max(Y,0),this.canvas.width),Ae=Math.min(Math.max(Ae,0),this.canvas.height),Z(this,s,nn).call(this,Y,Ae),Z(this,s,as).call(this);let ke;if(this.currentPath.length!==1)ke=Z(this,s,hs).call(this);else{const q=[Y,Ae];ke=[[q,q.slice(),q.slice(),q]]}const U=e(this,w),o=this.currentPath;this.currentPath=[],Pe(this,w,new Path2D);const H=()=>{this.allRawPaths.push(o),this.paths.push(ke),this.bezierPath2D.push(U),this.rebuild()},te=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Z(this,s,pi).call(this),Z(this,s,gi).call(this)),Z(this,s,Ht).call(this))};this.addCommands({cmd:H,undo:te,mustExec:!0})},ls=function(){if(!e(this,y))return;Pe(this,y,!1);const Y=Math.ceil(this.thickness*this.parentScale),Ae=this.currentPath.slice(-3),ke=Ae.map(H=>H[0]),U=Ae.map(H=>H[1]);Math.min(...ke)-Y,Math.max(...ke)+Y,Math.min(...U)-Y,Math.max(...U)+Y;const{ctx:o}=this;o.save(),o.clearRect(0,0,this.canvas.width,this.canvas.height);for(const H of this.bezierPath2D)o.stroke(H);o.stroke(e(this,w)),o.restore()},cs=function(Y,Ae,ke,U,o,H,te){const q=(Ae+U)/2,Le=(ke+o)/2,De=(U+H)/2,Ge=(o+te)/2;Y.bezierCurveTo(q+2*(U-q)/3,Le+2*(o-Le)/3,De+2*(U-De)/3,Ge+2*(o-Ge)/3,De,Ge)},hs=function(){const Y=this.currentPath;if(Y.length<=2)return[[Y[0],Y[0],Y.at(-1),Y.at(-1)]];const Ae=[];let ke,[U,o]=Y[0];for(ke=1;ke<Y.length-2;ke++){const[Ve,Je]=Y[ke],[Ze,it]=Y[ke+1],pt=(Ve+Ze)/2,mt=(Je+it)/2,Xe=[U+2*(Ve-U)/3,o+2*(Je-o)/3],Be=[pt+2*(Ve-pt)/3,mt+2*(Je-mt)/3];Ae.push([[U,o],Xe,Be,[pt,mt]]),[U,o]=[pt,mt]}const[H,te]=Y[ke],[q,Le]=Y[ke+1],De=[U+2*(H-U)/3,o+2*(te-o)/3],Ge=[q+2*(H-q)/3,Le+2*(te-Le)/3];return Ae.push([[U,o],De,Ge,[q,Le]]),Ae},Lt=function(){if(this.isEmpty()){Z(this,s,mi).call(this);return}Z(this,s,tn).call(this);const{canvas:Y,ctx:Ae}=this;Ae.setTransform(1,0,0,1,0,0),Ae.clearRect(0,0,Y.width,Y.height),Z(this,s,mi).call(this);for(const ke of this.bezierPath2D)Ae.stroke(ke)},sn=function(Y){this.canvas.removeEventListener("pointerleave",e(this,I)),this.canvas.removeEventListener("pointermove",e(this,j)),this.canvas.removeEventListener("pointerup",e(this,f)),this.canvas.addEventListener("pointerdown",e(this,h)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",J.noContextMenu)},10),Z(this,s,os).call(this,Y.offsetX,Y.offsetY),this.addToAnnotationStorage(),this.setInBackground()},pi=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",M.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Y=>{var Ae;return(Ae=this.canvas)==null?void 0:Ae.setAttribute("aria-label",Y)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},gi=function(){Pe(this,x,new ResizeObserver(Y=>{const Ae=Y[0].contentRect;Ae.width&&Ae.height&&this.setDimensions(Ae.width,Ae.height)})),e(this,x).observe(this.div)},Ut=function(){if(!e(this,_))return;const[Y,Ae]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Y),this.canvas.height=Math.ceil(this.height*Ae),Z(this,s,mi).call(this)},rn=function(Y,Ae){const ke=Z(this,s,_i).call(this),U=(Y-ke)/e(this,r),o=(Ae-ke)/e(this,g);this.scaleFactor=Math.min(U,o)},mi=function(){const Y=Z(this,s,_i).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Y,this.translationY*this.scaleFactor+Y)},ve=new WeakSet,ds=function(Y){const Ae=new Path2D;for(let ke=0,U=Y.length;ke<U;ke++){const[o,H,te,q]=Y[ke];ke===0&&Ae.moveTo(...o),Ae.bezierCurveTo(H[0],H[1],te[0],te[1],q[0],q[1])}return Ae},an=function(Y,Ae,ke){const[U,o,H,te]=Ae;switch(ke){case 0:for(let q=0,Le=Y.length;q<Le;q+=2)Y[q]+=U,Y[q+1]=te-Y[q+1];break;case 90:for(let q=0,Le=Y.length;q<Le;q+=2){const De=Y[q];Y[q]=Y[q+1]+U,Y[q+1]=De+o}break;case 180:for(let q=0,Le=Y.length;q<Le;q+=2)Y[q]=H-Y[q],Y[q+1]+=o;break;case 270:for(let q=0,Le=Y.length;q<Le;q+=2){const De=Y[q];Y[q]=H-Y[q+1],Y[q+1]=te-De}break;default:throw new Error("Invalid rotation")}return Y},us=function(Y,Ae,ke){const[U,o,H,te]=Ae;switch(ke){case 0:for(let q=0,Le=Y.length;q<Le;q+=2)Y[q]-=U,Y[q+1]=te-Y[q+1];break;case 90:for(let q=0,Le=Y.length;q<Le;q+=2){const De=Y[q];Y[q]=Y[q+1]-o,Y[q+1]=De-U}break;case 180:for(let q=0,Le=Y.length;q<Le;q+=2)Y[q]=H-Y[q],Y[q+1]-=o;break;case 270:for(let q=0,Le=Y.length;q<Le;q+=2){const De=Y[q];Y[q]=te-Y[q+1],Y[q+1]=H-De}break;default:throw new Error("Invalid rotation")}return Y},fs=function(Y,Ae,ke,U){var Le,De;const o=[],H=this.thickness/2,te=Y*Ae+H,q=Y*ke+H;for(const Ge of this.paths){const Ve=[],Je=[];for(let Ze=0,it=Ge.length;Ze<it;Ze++){const[pt,mt,Xe,Be]=Ge[Ze],Ue=Y*pt[0]+te,nt=Y*pt[1]+q,ft=Y*mt[0]+te,ut=Y*mt[1]+q,be=Y*Xe[0]+te,We=Y*Xe[1]+q,et=Y*Be[0]+te,rt=Y*Be[1]+q;Ze===0&&(Ve.push(Ue,nt),Je.push(Ue,nt)),Ve.push(ft,ut,be,We,et,rt),Je.push(ft,ut),Ze===it-1&&Je.push(et,rt)}o.push({bezier:Z(Le=Ye,ve,an).call(Le,Ve,U,this.rotation),points:Z(De=Ye,ve,an).call(De,Je,U,this.rotation)})}return o},on=function(){let Y=1/0,Ae=-1/0,ke=1/0,U=-1/0;for(const o of this.paths)for(const[H,te,q,Le]of o){const De=p.Util.bezierBoundingBox(...H,...te,...q,...Le);Y=Math.min(Y,De[0]),ke=Math.min(ke,De[1]),Ae=Math.max(Ae,De[2]),U=Math.max(U,De[3])}return[Y,ke,Ae,U]},_i=function(){return e(this,E)?Math.ceil(this.thickness*this.parentScale):0},Ht=function(Y=!1){if(this.isEmpty())return;if(!e(this,E)){Z(this,s,Lt).call(this);return}const Ae=Z(this,s,on).call(this),ke=Z(this,s,_i).call(this);Pe(this,r,Math.max(M.AnnotationEditor.MIN_SIZE,Ae[2]-Ae[0])),Pe(this,g,Math.max(M.AnnotationEditor.MIN_SIZE,Ae[3]-Ae[1]));const U=Math.ceil(ke+e(this,r)*this.scaleFactor),o=Math.ceil(ke+e(this,g)*this.scaleFactor),[H,te]=this.parentDimensions;this.width=U/H,this.height=o/te,this.setAspectRatio(U,o);const q=this.translationX,Le=this.translationY;this.translationX=-Ae[0],this.translationY=-Ae[1],Z(this,s,Ut).call(this),Z(this,s,Lt).call(this),Pe(this,S,U),Pe(this,n,o),this.setDims(U,o);const De=Y?ke/this.scaleFactor/2:0;this.translate(q-this.translationX-De,Le-this.translationY-De)},Te(Ye,ve),at(Ye,"_defaultColor",null),at(Ye,"_defaultOpacity",1),at(Ye,"_defaultThickness",1),at(Ye,"_type","ink");let D=Ye;t.InkEditor=D},(we,t,le)=>{var D,g,r,j,I,f,h,w,E,y,_,Yt,Kt,vi,ln,ps,gs,hn,bi,ms;Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var p=le(1),M=le(4),Me=le(6),J=le(29);const N=class N extends M.AnnotationEditor{constructor(oe){super({...oe,name:"stampEditor"});Te(this,_);Te(this,D,null);Te(this,g,null);Te(this,r,null);Te(this,j,null);Te(this,I,null);Te(this,f,null);Te(this,h,null);Te(this,w,null);Te(this,E,!1);Te(this,y,!1);Pe(this,j,oe.bitmapUrl),Pe(this,I,oe.bitmapFile)}static initialize(oe){M.AnnotationEditor.initialize(oe)}static get supportedTypes(){const oe=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,p.shadow)(this,"supportedTypes",oe.map(fe=>`image/${fe}`))}static get supportedTypesStr(){return(0,p.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(oe){return this.supportedTypes.includes(oe)}static paste(oe,fe){fe.pasteEditor(p.AnnotationEditorType.STAMP,{bitmapFile:oe.getAsFile()})}remove(){var oe,fe;e(this,g)&&(Pe(this,D,null),this._uiManager.imageManager.deleteId(e(this,g)),(oe=e(this,f))==null||oe.remove(),Pe(this,f,null),(fe=e(this,h))==null||fe.disconnect(),Pe(this,h,null)),super.remove()}rebuild(){if(!this.parent){e(this,g)&&Z(this,_,vi).call(this);return}super.rebuild(),this.div!==null&&(e(this,g)&&Z(this,_,vi).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(e(this,r)||e(this,D)||e(this,j)||e(this,I))}get isResizable(){return!0}render(){if(this.div)return this.div;let oe,fe;if(this.width&&(oe=this.x,fe=this.y),super.render(),this.div.hidden=!0,e(this,D)?Z(this,_,ln).call(this):Z(this,_,vi).call(this),this.width){const[O,Ee]=this.parentDimensions;this.setAt(oe*O,fe*Ee,this.width*O,this.height*Ee)}return this.div}static deserialize(oe,fe,O){if(oe instanceof J.StampAnnotationElement)return null;const Ee=super.deserialize(oe,fe,O),{rect:T,bitmapUrl:P,bitmapId:Ce,isSvg:W,accessibilityData:d}=oe;Ce&&O.imageManager.isValidId(Ce)?Pe(Ee,g,Ce):Pe(Ee,j,P),Pe(Ee,E,W);const[m,k]=Ee.pageDimensions;return Ee.width=(T[2]-T[0])/m,Ee.height=(T[3]-T[1])/k,d&&(Ee.altTextData=d),Ee}serialize(oe=!1,fe=null){if(this.isEmpty())return null;const O={annotationType:p.AnnotationEditorType.STAMP,bitmapId:e(this,g),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:e(this,E),structTreeParentId:this._structTreeParentId};if(oe)return O.bitmapUrl=Z(this,_,bi).call(this,!0),O.accessibilityData=this.altTextData,O;const{decorative:Ee,altText:T}=this.altTextData;if(!Ee&&T&&(O.accessibilityData={type:"Figure",alt:T}),fe===null)return O;fe.stamps||(fe.stamps=new Map);const P=e(this,E)?(O.rect[2]-O.rect[0])*(O.rect[3]-O.rect[1]):null;if(!fe.stamps.has(e(this,g)))fe.stamps.set(e(this,g),{area:P,serialized:O}),O.bitmap=Z(this,_,bi).call(this,!1);else if(e(this,E)){const Ce=fe.stamps.get(e(this,g));P>Ce.area&&(Ce.area=P,Ce.serialized.bitmap.close(),Ce.serialized.bitmap=Z(this,_,bi).call(this,!1))}return O}};D=new WeakMap,g=new WeakMap,r=new WeakMap,j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakMap,_=new WeakSet,Yt=function(oe,fe=!1){if(!oe){this.remove();return}Pe(this,D,oe.bitmap),fe||(Pe(this,g,oe.id),Pe(this,E,oe.isSvg)),Z(this,_,ln).call(this)},Kt=function(){Pe(this,r,null),this._uiManager.enableWaiting(!1),e(this,f)&&this.div.focus()},vi=function(){if(e(this,g)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(e(this,g)).then(fe=>Z(this,_,Yt).call(this,fe,!0)).finally(()=>Z(this,_,Kt).call(this));return}if(e(this,j)){const fe=e(this,j);Pe(this,j,null),this._uiManager.enableWaiting(!0),Pe(this,r,this._uiManager.imageManager.getFromUrl(fe).then(O=>Z(this,_,Yt).call(this,O)).finally(()=>Z(this,_,Kt).call(this)));return}if(e(this,I)){const fe=e(this,I);Pe(this,I,null),this._uiManager.enableWaiting(!0),Pe(this,r,this._uiManager.imageManager.getFromFile(fe).then(O=>Z(this,_,Yt).call(this,O)).finally(()=>Z(this,_,Kt).call(this)));return}const oe=document.createElement("input");oe.type="file",oe.accept=N.supportedTypesStr,Pe(this,r,new Promise(fe=>{oe.addEventListener("change",async()=>{if(!oe.files||oe.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const O=await this._uiManager.imageManager.getFromFile(oe.files[0]);Z(this,_,Yt).call(this,O)}fe()}),oe.addEventListener("cancel",()=>{this.remove(),fe()})}).finally(()=>Z(this,_,Kt).call(this))),oe.click()},ln=function(){const{div:oe}=this;let{width:fe,height:O}=e(this,D);const[Ee,T]=this.pageDimensions,P=.75;if(this.width)fe=this.width*Ee,O=this.height*T;else if(fe>P*Ee||O>P*T){const m=Math.min(P*Ee/fe,P*T/O);fe*=m,O*=m}const[Ce,W]=this.parentDimensions;this.setDims(fe*Ce/Ee,O*W/T),this._uiManager.enableWaiting(!1);const d=Pe(this,f,document.createElement("canvas"));oe.append(d),oe.hidden=!1,Z(this,_,hn).call(this,fe,O),Z(this,_,ms).call(this),e(this,y)||(this.parent.addUndoableEditor(this),Pe(this,y,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},ps=function(oe,fe){var P;const[O,Ee]=this.parentDimensions;this.width=oe/O,this.height=fe/Ee,this.setDims(oe,fe),(P=this._initialOptions)!=null&&P.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,e(this,w)!==null&&clearTimeout(e(this,w)),Pe(this,w,setTimeout(()=>{Pe(this,w,null),Z(this,_,hn).call(this,oe,fe)},200))},gs=function(oe,fe){const{width:O,height:Ee}=e(this,D);let T=O,P=Ee,Ce=e(this,D);for(;T>2*oe||P>2*fe;){const W=T,d=P;T>2*oe&&(T=T>=16384?Math.floor(T/2)-1:Math.ceil(T/2)),P>2*fe&&(P=P>=16384?Math.floor(P/2)-1:Math.ceil(P/2));const m=new OffscreenCanvas(T,P);m.getContext("2d").drawImage(Ce,0,0,W,d,0,0,T,P),Ce=m.transferToImageBitmap()}return Ce},hn=function(oe,fe){oe=Math.ceil(oe),fe=Math.ceil(fe);const O=e(this,f);if(!O||O.width===oe&&O.height===fe)return;O.width=oe,O.height=fe;const Ee=e(this,E)?e(this,D):Z(this,_,gs).call(this,oe,fe),T=O.getContext("2d");T.filter=this._uiManager.hcmFilter,T.drawImage(Ee,0,0,Ee.width,Ee.height,0,0,oe,fe)},bi=function(oe){if(oe){if(e(this,E)){const Ee=this._uiManager.imageManager.getSvgUrl(e(this,g));if(Ee)return Ee}const fe=document.createElement("canvas");return{width:fe.width,height:fe.height}=e(this,D),fe.getContext("2d").drawImage(e(this,D),0,0),fe.toDataURL()}if(e(this,E)){const[fe,O]=this.pageDimensions,Ee=Math.round(this.width*fe*Me.PixelsPerInch.PDF_TO_CSS_UNITS),T=Math.round(this.height*O*Me.PixelsPerInch.PDF_TO_CSS_UNITS),P=new OffscreenCanvas(Ee,T);return P.getContext("2d").drawImage(e(this,D),0,0,e(this,D).width,e(this,D).height,0,0,Ee,T),P.transferToImageBitmap()}return structuredClone(e(this,D))},ms=function(){Pe(this,h,new ResizeObserver(oe=>{const fe=oe[0].contentRect;fe.width&&fe.height&&Z(this,_,ps).call(this,fe.width,fe.height)})),e(this,h).observe(this.div)},at(N,"_type","stamp");let F=N;t.StampEditor=F}],__webpack_module_cache__={};function __w_pdfjs_require__(we){var t=__webpack_module_cache__[we];if(t!==void 0)return t.exports;var le=__webpack_module_cache__[we]={exports:{}};return __webpack_modules__[we](le,le.exports,__w_pdfjs_require__),le.exports}var __webpack_exports__={};return(()=>{var we=__webpack_exports__;Object.defineProperty(we,"__esModule",{value:!0}),Object.defineProperty(we,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(we,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Me.AnnotationEditorLayer}}),Object.defineProperty(we,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(we,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(we,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return J.AnnotationEditorUIManager}}),Object.defineProperty(we,"AnnotationLayer",{enumerable:!0,get:function(){return F.AnnotationLayer}}),Object.defineProperty(we,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(we,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(we,"DOMSVGFactory",{enumerable:!0,get:function(){return p.DOMSVGFactory}}),Object.defineProperty(we,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(we,"GlobalWorkerOptions",{enumerable:!0,get:function(){return D.GlobalWorkerOptions}}),Object.defineProperty(we,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(we,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(we,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(we,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(we,"PDFDataRangeTransport",{enumerable:!0,get:function(){return le.PDFDataRangeTransport}}),Object.defineProperty(we,"PDFDateString",{enumerable:!0,get:function(){return p.PDFDateString}}),Object.defineProperty(we,"PDFWorker",{enumerable:!0,get:function(){return le.PDFWorker}}),Object.defineProperty(we,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(we,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(we,"PixelsPerInch",{enumerable:!0,get:function(){return p.PixelsPerInch}}),Object.defineProperty(we,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(we,"RenderingCancelledException",{enumerable:!0,get:function(){return p.RenderingCancelledException}}),Object.defineProperty(we,"SVGGraphics",{enumerable:!0,get:function(){return le.SVGGraphics}}),Object.defineProperty(we,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(we,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(we,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(we,"XfaLayer",{enumerable:!0,get:function(){return g.XfaLayer}}),Object.defineProperty(we,"build",{enumerable:!0,get:function(){return le.build}}),Object.defineProperty(we,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(we,"getDocument",{enumerable:!0,get:function(){return le.getDocument}}),Object.defineProperty(we,"getFilenameFromUrl",{enumerable:!0,get:function(){return p.getFilenameFromUrl}}),Object.defineProperty(we,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return p.getPdfFilenameFromUrl}}),Object.defineProperty(we,"getXfaPageViewport",{enumerable:!0,get:function(){return p.getXfaPageViewport}}),Object.defineProperty(we,"isDataScheme",{enumerable:!0,get:function(){return p.isDataScheme}}),Object.defineProperty(we,"isPdfFile",{enumerable:!0,get:function(){return p.isPdfFile}}),Object.defineProperty(we,"loadScript",{enumerable:!0,get:function(){return p.loadScript}}),Object.defineProperty(we,"noContextMenu",{enumerable:!0,get:function(){return p.noContextMenu}}),Object.defineProperty(we,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(we,"renderTextLayer",{enumerable:!0,get:function(){return M.renderTextLayer}}),Object.defineProperty(we,"setLayerDimensions",{enumerable:!0,get:function(){return p.setLayerDimensions}}),Object.defineProperty(we,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(we,"updateTextLayer",{enumerable:!0,get:function(){return M.updateTextLayer}}),Object.defineProperty(we,"version",{enumerable:!0,get:function(){return le.version}});var t=__w_pdfjs_require__(1),le=__w_pdfjs_require__(2),p=__w_pdfjs_require__(6),M=__w_pdfjs_require__(26),Me=__w_pdfjs_require__(27),J=__w_pdfjs_require__(5),F=__w_pdfjs_require__(29),D=__w_pdfjs_require__(14),g=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,pdf_viewer={exports:{}};(function(we,t){(function(p,M){we.exports=p.pdfjsViewer=M()})(globalThis,()=>(()=>{var le=[,(J,F,D)=>{var fe,O,Ee,T,_s,dn,un,vs,bs,ys,fn,As,Ss,yi,Qt,Wt,Es,pn,gn,Ai,ws,mn,_n,Zt;Object.defineProperty(F,"__esModule",{value:!0}),F.PDFFindController=F.FindState=void 0;var g=D(2),r=D(3),j=D(4);const I={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};F.FindState=I;const f=250,h=-50,w=-400,E={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},y=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let _;const x=new RegExp("\\p{M}+","gu"),S=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),n=new RegExp("([^\\p{M}])\\p{M}*$","u"),i=new RegExp("^\\p{M}*([^\\p{M}])","u"),s=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,c=new Map,v="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",z=new Map;let u=null,N=null;function re(ke){const U=[];let o;for(;(o=s.exec(ke))!==null;){let{index:pt}=o;for(const mt of o[0]){let Xe=c.get(mt);Xe||(Xe=mt.normalize("NFD").length,c.set(mt,Xe)),U.push([Xe,pt++])}}let H;if(U.length===0&&u)H=u;else if(U.length>0&&N)H=N;else{const pt=Object.keys(E).join(""),mt=(0,r.getNormalizeWithNFKC)(),Ue=`([${pt}])|([${mt}])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;U.length===0?H=u=new RegExp(Ue+"|(\\u0000)","gum"):H=N=new RegExp(Ue+`|(${v})`,"gum")}const te=[];for(;(o=x.exec(ke))!==null;)te.push([o[0].length,o.index]);let q=ke.normalize("NFD");const Le=[[0,0]];let De=0,Ge=0,Ve=0,Je=0,Ze=0,it=!1;return q=q.replace(H,(pt,mt,Xe,Be,Ue,nt,ft,ut,be,We)=>{var et,rt,ot;if(We-=Je,mt){const tt=E[mt],_e=tt.length;for(let ne=1;ne<_e;ne++)Le.push([We-Ve+ne,Ve-ne]);return Ve-=_e-1,tt}if(Xe){let tt=z.get(Xe);tt||(tt=Xe.normalize("NFKC"),z.set(Xe,tt));const _e=tt.length;for(let ne=1;ne<_e;ne++)Le.push([We-Ve+ne,Ve-ne]);return Ve-=_e-1,tt}if(Be)return it=!0,We+Ze===((et=te[De])==null?void 0:et[1])?++De:(Le.push([We-1-Ve+1,Ve-1]),Ve-=1,Je+=1),Le.push([We-Ve+1,Ve]),Je+=1,Ze+=1,Be.charAt(0);if(Ue){const tt=Ue.endsWith(`
`),_e=tt?Ue.length-2:Ue.length;it=!0;let ne=_e;We+Ze===((rt=te[De])==null?void 0:rt[1])&&(ne-=te[De][0],++De);for(let Ie=1;Ie<=ne;Ie++)Le.push([We-1-Ve+Ie,Ve-Ie]);return Ve-=ne,Je+=ne,tt?(We+=_e-1,Le.push([We-Ve+1,1+Ve]),Ve+=1,Je+=1,Ze+=1,Ue.slice(0,_e)):Ue}if(nt){const tt=nt.length-2;return Le.push([We-Ve+tt,1+Ve]),Ve+=1,Je+=1,Ze+=1,nt.slice(0,-2)}if(ft){const tt=ft.length-1;return Le.push([We-Ve+tt,Ve]),Je+=1,Ze+=1,ft.slice(0,-1)}if(ut)return Le.push([We-Ve+1,Ve-1]),Ve-=1,Je+=1,Ze+=1," ";if(We+Ze===((ot=U[Ge])==null?void 0:ot[1])){const tt=U[Ge][0]-1;++Ge;for(let _e=1;_e<=tt;_e++)Le.push([We-(Ve-_e),Ve-_e]);Ve-=tt,Je+=tt}return be}),Le.push([q.length,Ve]),[q,Le,it]}function Q(ke,U,o){if(!ke)return[U,o];const H=U,te=U+o-1;let q=(0,g.binarySearchFirstItem)(ke,Je=>Je[0]>=H);ke[q][0]>H&&--q;let Le=(0,g.binarySearchFirstItem)(ke,Je=>Je[0]>=te,q);ke[Le][0]>te&&--Le;const De=H+ke[q][1],Ve=te+ke[Le][1]+1-De;return[De,Ve]}class oe{constructor({linkService:U,eventBus:o,updateMatchesCountOnProgress:H=!0}){Te(this,T);Te(this,fe,null);Te(this,O,!0);Te(this,Ee,0);this._linkService=U,this._eventBus=o,Pe(this,O,H),this.onIsPageVisible=null,Z(this,T,dn).call(this),o._on("find",Z(this,T,_s).bind(this)),o._on("findbarclose",Z(this,T,ws).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return e(this,fe)}setDocument(U){this._pdfDocument&&Z(this,T,dn).call(this),U&&(this._pdfDocument=U,this._firstPageCapability.resolve())}scrollMatchIntoView({element:U=null,selectedLeft:o=0,pageIndex:H=-1,matchIndex:te=-1}){if(!this._scrollMatches||!U)return;if(te===-1||te!==this._selected.matchIdx)return;if(H===-1||H!==this._selected.pageIdx)return;this._scrollMatches=!1;const q={top:h,left:o+w};(0,g.scrollIntoView)(U,q,!0)}}fe=new WeakMap,O=new WeakMap,Ee=new WeakMap,T=new WeakSet,_s=function(U){if(!U)return;U.phraseSearch===!1&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),typeof U.query=="string"&&(U.query=U.query.match(/\S+/g)));const o=this._pdfDocument,{type:H}=U;(e(this,fe)===null||Z(this,T,vs).call(this,U))&&(this._dirtyMatch=!0),Pe(this,fe,U),H!=="highlightallchange"&&Z(this,T,Zt).call(this,I.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||o&&this._pdfDocument!==o)return;Z(this,T,Ss).call(this);const te=!this._highlightMatches,q=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),H?this._dirtyMatch?Z(this,T,Wt).call(this):H==="again"?(Z(this,T,Wt).call(this),te&&e(this,fe).highlightAll&&Z(this,T,Qt).call(this)):H==="highlightallchange"?(q?Z(this,T,Wt).call(this):this._highlightMatches=!0,Z(this,T,Qt).call(this)):Z(this,T,Wt).call(this):this._findTimeout=setTimeout(()=>{Z(this,T,Wt).call(this),this._findTimeout=null},f)})},dn=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],Pe(this,Ee,0),Pe(this,fe,null),this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new j.PromiseCapability},un=function(){const{query:U}=e(this,fe);return typeof U=="string"?(U!==this._rawQuery&&(this._rawQuery=U,[this._normalizedQuery]=re(U)),this._normalizedQuery):(U||[]).filter(o=>!!o).map(o=>re(o)[0])},vs=function(U){var Le;const o=U.query,H=e(this,fe).query,te=typeof o;if(te!==typeof H)return!0;if(te==="string"){if(o!==H)return!0}else if(JSON.stringify(o)!==JSON.stringify(H))return!0;switch(U.type){case"again":const De=this._selected.pageIdx+1,Ge=this._linkService;return De>=1&&De<=Ge.pagesCount&&De!==Ge.page&&!(((Le=this.onIsPageVisible)==null?void 0:Le.call(this,De))??!0);case"highlightallchange":return!1}return!0},bs=function(U,o,H){let te=U.slice(0,o).match(n);if(te){const q=U.charCodeAt(o),Le=te[1].charCodeAt(0);if((0,r.getCharacterType)(q)===(0,r.getCharacterType)(Le))return!1}if(te=U.slice(o+H).match(i),te){const q=U.charCodeAt(o+H-1),Le=te[1].charCodeAt(0);if((0,r.getCharacterType)(q)===(0,r.getCharacterType)(Le))return!1}return!0},ys=function(U,o,H,te){const q=this._pageMatches[H]=[],Le=this._pageMatchesLength[H]=[];if(!U)return;const De=this._pageDiffs[H];let Ge;for(;(Ge=U.exec(te))!==null;){if(o&&!Z(this,T,bs).call(this,te,Ge.index,Ge[0].length))continue;const[Ve,Je]=Q(De,Ge.index,Ge[0].length);Je&&(q.push(Ve),Le.push(Je))}},fn=function(U,o){const{matchDiacritics:H}=e(this,fe);let te=!1;U=U.replaceAll(S,(Le,De,Ge,Ve,Je,Ze)=>De?`[ ]*\\${De}[ ]*`:Ge?`[ ]*${Ge}[ ]*`:Ve?"[ ]+":H?Je||Ze:Je?y.has(Je.charCodeAt(0))?Je:"":o?(te=!0,`${Ze}\\p{M}*`):Ze);const q="[ ]*";return U.endsWith(q)&&(U=U.slice(0,U.length-q.length)),H&&o&&(_||(_=String.fromCharCode(...y)),te=!0,U=`${U}(?=[${_}]|[^\\p{M}]|$)`),[te,U]},As=function(U){let o=e(this,T,un);if(o.length===0)return;const{caseSensitive:H,entireWord:te}=e(this,fe),q=this._pageContents[U],Le=this._hasDiacritics[U];let De=!1;typeof o=="string"?[De,o]=Z(this,T,fn).call(this,o,Le):o=o.sort().reverse().map(Je=>{const[Ze,it]=Z(this,T,fn).call(this,Je,Le);return De||(De=Ze),`(${it})`}).join("|");const Ge=`g${De?"u":""}${H?"":"i"}`;o=o?new RegExp(o,Ge):null,Z(this,T,ys).call(this,o,te,U,q),e(this,fe).highlightAll&&Z(this,T,yi).call(this,U),this._resumePageIdx===U&&(this._resumePageIdx=null,Z(this,T,pn).call(this));const Ve=this._pageMatches[U].length;this._matchesCountTotal+=Ve,e(this,O)?Ve>0&&Z(this,T,_n).call(this):++Ot(this,Ee)._===this._linkService.pagesCount&&Z(this,T,_n).call(this)},Ss=function(){if(this._extractTextPromises.length>0)return;let U=Promise.resolve();const o={disableNormalization:!0};for(let H=0,te=this._linkService.pagesCount;H<te;H++){const q=new j.PromiseCapability;this._extractTextPromises[H]=q.promise,U=U.then(()=>this._pdfDocument.getPage(H+1).then(Le=>Le.getTextContent(o)).then(Le=>{const De=[];for(const Ge of Le.items)De.push(Ge.str),Ge.hasEOL&&De.push(`
`);[this._pageContents[H],this._pageDiffs[H],this._hasDiacritics[H]]=re(De.join("")),q.resolve()},Le=>{console.error(`Unable to get text content for page ${H+1}`,Le),this._pageContents[H]="",this._pageDiffs[H]=null,this._hasDiacritics[H]=!1,q.resolve()}))}},yi=function(U){this._scrollMatches&&this._selected.pageIdx===U&&(this._linkService.page=U+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:U})},Qt=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},Wt=function(){const U=e(this,fe).findPrevious,o=this._linkService.page-1,H=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=o,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,Pe(this,Ee,0),this._matchesCountTotal=0,Z(this,T,Qt).call(this);for(let Le=0;Le<H;Le++)this._pendingFindMatches.has(Le)||(this._pendingFindMatches.add(Le),this._extractTextPromises[Le].then(()=>{this._pendingFindMatches.delete(Le),Z(this,T,As).call(this,Le)}))}if(e(this,T,un).length===0){Z(this,T,Zt).call(this,I.FOUND);return}if(this._resumePageIdx)return;const q=this._offset;if(this._pagesToSearch=H,q.matchIdx!==null){const Le=this._pageMatches[q.pageIdx].length;if(!U&&q.matchIdx+1<Le||U&&q.matchIdx>0){q.matchIdx=U?q.matchIdx-1:q.matchIdx+1,Z(this,T,Ai).call(this,!0);return}Z(this,T,gn).call(this,U)}Z(this,T,pn).call(this)},Es=function(U){const o=this._offset,H=U.length,te=e(this,fe).findPrevious;return H?(o.matchIdx=te?H-1:0,Z(this,T,Ai).call(this,!0),!0):(Z(this,T,gn).call(this,te),o.wrapped&&(o.matchIdx=null,this._pagesToSearch<0)?(Z(this,T,Ai).call(this,!1),!0):!1)},pn=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let U=null;do{const o=this._offset.pageIdx;if(U=this._pageMatches[o],!U){this._resumePageIdx=o;break}}while(!Z(this,T,Es).call(this,U))},gn=function(U){const o=this._offset,H=this._linkService.pagesCount;o.pageIdx=U?o.pageIdx-1:o.pageIdx+1,o.matchIdx=null,this._pagesToSearch--,(o.pageIdx>=H||o.pageIdx<0)&&(o.pageIdx=U?H-1:0,o.wrapped=!0)},Ai=function(U=!1){let o=I.NOT_FOUND;const H=this._offset.wrapped;if(this._offset.wrapped=!1,U){const te=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,o=H?I.WRAPPED:I.FOUND,te!==-1&&te!==this._selected.pageIdx&&Z(this,T,yi).call(this,te)}Z(this,T,Zt).call(this,o,e(this,fe).findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,Z(this,T,yi).call(this,this._selected.pageIdx))},ws=function(U){const o=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||o&&this._pdfDocument!==o||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),Z(this,T,Zt).call(this,I.FOUND),this._highlightMatches=!1,Z(this,T,Qt).call(this))})},mn=function(){var q;const{pageIdx:U,matchIdx:o}=this._selected;let H=0,te=this._matchesCountTotal;if(o!==-1){for(let Le=0;Le<U;Le++)H+=((q=this._pageMatches[Le])==null?void 0:q.length)||0;H+=o+1}return(H<1||H>te)&&(H=te=0),{current:H,total:te}},_n=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:Z(this,T,mn).call(this)})},Zt=function(U,o=!1){var H;!e(this,O)&&(e(this,Ee)!==this._linkService.pagesCount||U===I.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:U,previous:o,matchesCount:Z(this,T,mn).call(this),rawQuery:((H=e(this,fe))==null?void 0:H.query)??null})},F.PDFFindController=oe},(J,F)=>{var Oe,Fe,Y,Ae,ke;Object.defineProperty(F,"__esModule",{value:!0}),F.animationStarted=F.VERTICAL_PADDING=F.UNKNOWN_SCALE=F.TextLayerMode=F.SpreadMode=F.SidebarView=F.ScrollMode=F.SCROLLBAR_PADDING=F.RenderingStates=F.ProgressBar=F.PresentationModeState=F.OutputScale=F.MIN_SCALE=F.MAX_SCALE=F.MAX_AUTO_SCALE=F.DEFAULT_SCALE_VALUE=F.DEFAULT_SCALE_DELTA=F.DEFAULT_SCALE=F.CursorTool=F.AutoPrintRegExp=void 0,F.apiPageLayoutToViewerModes=He,F.apiPageModeToSidebarView=ze,F.approximateFraction=fe,F.backtrackBeforeAllVisibleElements=T,F.binarySearchFirstItem=oe,F.docStyle=void 0,F.getActiveOrFocusedElement=Ne,F.getPageSizeInches=Ee,F.getVisibleElements=P,F.isPortraitOrientation=ye,F.isValidRotation=d,F.isValidScrollMode=m,F.isValidSpreadMode=k,F.normalizeWheelEventDelta=W,F.normalizeWheelEventDirection=Ce,F.parseQueryString=N,F.removeNullCharacters=Q,F.roundToDivide=O,F.scrollIntoView=z,F.toggleCheckedBtn=qe,F.toggleExpandedBtn=Ye,F.watchScroll=u;const D="auto";F.DEFAULT_SCALE_VALUE=D;const g=1;F.DEFAULT_SCALE=g;const r=1.1;F.DEFAULT_SCALE_DELTA=r;const j=.1;F.MIN_SCALE=j;const I=10;F.MAX_SCALE=I;const f=0;F.UNKNOWN_SCALE=f;const h=1.25;F.MAX_AUTO_SCALE=h;const w=40;F.SCROLLBAR_PADDING=w;const E=5;F.VERTICAL_PADDING=E;const y={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};F.RenderingStates=y;const _={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};F.PresentationModeState=_;const x={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};F.SidebarView=x;const S={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};F.TextLayerMode=S;const n={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};F.ScrollMode=n;const i={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};F.SpreadMode=i;const s={SELECT:0,HAND:1,ZOOM:2};F.CursorTool=s;const c=/\bprint\s*\(/;F.AutoPrintRegExp=c;class v{constructor(){const o=window.devicePixelRatio||1;this.sx=o,this.sy=o}get scaled(){return this.sx!==1||this.sy!==1}}F.OutputScale=v;function z(U,o,H=!1){let te=U.offsetParent;if(!te){console.error("offsetParent is not set -- cannot scroll");return}let q=U.offsetTop+U.clientTop,Le=U.offsetLeft+U.clientLeft;for(;te.clientHeight===te.scrollHeight&&te.clientWidth===te.scrollWidth||H&&(te.classList.contains("markedContent")||getComputedStyle(te).overflow==="hidden");)if(q+=te.offsetTop,Le+=te.offsetLeft,te=te.offsetParent,!te)return;o&&(o.top!==void 0&&(q+=o.top),o.left!==void 0&&(Le+=o.left,te.scrollLeft=Le)),te.scrollTop=q}function u(U,o){const H=function(Le){q||(q=window.requestAnimationFrame(function(){q=null;const Ge=U.scrollLeft,Ve=te.lastX;Ge!==Ve&&(te.right=Ge>Ve),te.lastX=Ge;const Je=U.scrollTop,Ze=te.lastY;Je!==Ze&&(te.down=Je>Ze),te.lastY=Je,o(te)}))},te={right:!0,down:!0,lastX:U.scrollLeft,lastY:U.scrollTop,_eventHandler:H};let q=null;return U.addEventListener("scroll",H,!0),te}function N(U){const o=new Map;for(const[H,te]of new URLSearchParams(U))o.set(H.toLowerCase(),te);return o}const re=/[\x01-\x1F]/g;function Q(U,o=!1){return typeof U!="string"?(console.error("The argument must be a string."),U):(o&&(U=U.replaceAll(re," ")),U.replaceAll("\0",""))}function oe(U,o,H=0){let te=H,q=U.length-1;if(q<0||!o(U[q]))return U.length;if(o(U[te]))return te;for(;te<q;){const Le=te+q>>1,De=U[Le];o(De)?q=Le:te=Le+1}return te}function fe(U){if(Math.floor(U)===U)return[U,1];const o=1/U,H=8;if(o>H)return[1,H];if(Math.floor(o)===o)return[1,o];const te=U>1?o:U;let q=0,Le=1,De=1,Ge=1;for(;;){const Je=q+De,Ze=Le+Ge;if(Ze>H)break;te<=Je/Ze?(De=Je,Ge=Ze):(q=Je,Le=Ze)}let Ve;return te-q/Le<De/Ge-te?Ve=te===U?[q,Le]:[Le,q]:Ve=te===U?[De,Ge]:[Ge,De],Ve}function O(U,o){const H=U%o;return H===0?U:Math.round(U-H+o)}function Ee({view:U,userUnit:o,rotate:H}){const[te,q,Le,De]=U,Ge=H%180!==0,Ve=(Le-te)/72*o,Je=(De-q)/72*o;return{width:Ge?Je:Ve,height:Ge?Ve:Je}}function T(U,o,H){if(U<2)return U;let te=o[U].div,q=te.offsetTop+te.clientTop;q>=H&&(te=o[U-1].div,q=te.offsetTop+te.clientTop);for(let Le=U-2;Le>=0&&(te=o[Le].div,!(te.offsetTop+te.clientTop+te.clientHeight<=q));--Le)U=Le;return U}function P({scrollEl:U,views:o,sortByVisibility:H=!1,horizontal:te=!1,rtl:q=!1}){const Le=U.scrollTop,De=Le+U.clientHeight,Ge=U.scrollLeft,Ve=Ge+U.clientWidth;function Je(ft){const ut=ft.div;return ut.offsetTop+ut.clientTop+ut.clientHeight>Le}function Ze(ft){const ut=ft.div,be=ut.offsetLeft+ut.clientLeft,We=be+ut.clientWidth;return q?be<Ve:We>Ge}const it=[],pt=new Set,mt=o.length;let Xe=oe(o,te?Ze:Je);Xe>0&&Xe<mt&&!te&&(Xe=T(Xe,o,Le));let Be=te?Ve:-1;for(let ft=Xe;ft<mt;ft++){const ut=o[ft],be=ut.div,We=be.offsetLeft+be.clientLeft,et=be.offsetTop+be.clientTop,rt=be.clientWidth,ot=be.clientHeight,tt=We+rt,_e=et+ot;if(Be===-1)_e>=De&&(Be=_e);else if((te?We:et)>Be)break;if(_e<=Le||et>=De||tt<=Ge||We>=Ve)continue;const ne=Math.max(0,Le-et)+Math.max(0,_e-De),Ie=Math.max(0,Ge-We)+Math.max(0,tt-Ve),je=(ot-ne)/ot,$e=(rt-Ie)/rt,Ke=je*$e*100|0;it.push({id:ut.id,x:We,y:et,view:ut,percent:Ke,widthPercent:$e*100|0}),pt.add(ut.id)}const Ue=it[0],nt=it.at(-1);return H&&it.sort(function(ft,ut){const be=ft.percent-ut.percent;return Math.abs(be)>.001?-be:ft.id-ut.id}),{first:Ue,last:nt,views:it,ids:pt}}function Ce(U){let o=Math.hypot(U.deltaX,U.deltaY);const H=Math.atan2(U.deltaY,U.deltaX);return-.25*Math.PI<H&&H<.75*Math.PI&&(o=-o),o}function W(U){const o=U.deltaMode;let H=Ce(U);const te=30,q=30;return o===WheelEvent.DOM_DELTA_PIXEL?H/=te*q:o===WheelEvent.DOM_DELTA_LINE&&(H/=q),H}function d(U){return Number.isInteger(U)&&U%90===0}function m(U){return Number.isInteger(U)&&Object.values(n).includes(U)&&U!==n.UNKNOWN}function k(U){return Number.isInteger(U)&&Object.values(i).includes(U)&&U!==i.UNKNOWN}function ye(U){return U.width<=U.height}const ve=new Promise(function(U){window.requestAnimationFrame(U)});F.animationStarted=ve;const X=document.documentElement.style;F.docStyle=X;function Se(U,o,H){return Math.min(Math.max(U,o),H)}class Re{constructor(o){Te(this,Oe,null);Te(this,Fe,null);Te(this,Y,0);Te(this,Ae,null);Te(this,ke,!0);Pe(this,Oe,o.classList),Pe(this,Ae,o.style)}get percent(){return e(this,Y)}set percent(o){if(Pe(this,Y,Se(o,0,100)),isNaN(o)){e(this,Oe).add("indeterminate");return}e(this,Oe).remove("indeterminate"),e(this,Ae).setProperty("--progressBar-percent",`${e(this,Y)}%`)}setWidth(o){if(!o)return;const te=o.parentNode.offsetWidth-o.offsetWidth;te>0&&e(this,Ae).setProperty("--progressBar-end-offset",`${te}px`)}setDisableAutoFetch(o=5e3){isNaN(e(this,Y))||(e(this,Fe)&&clearTimeout(e(this,Fe)),this.show(),Pe(this,Fe,setTimeout(()=>{Pe(this,Fe,null),this.hide()},o)))}hide(){e(this,ke)&&(Pe(this,ke,!1),e(this,Oe).add("hidden"))}show(){e(this,ke)||(Pe(this,ke,!0),e(this,Oe).remove("hidden"))}}Oe=new WeakMap,Fe=new WeakMap,Y=new WeakMap,Ae=new WeakMap,ke=new WeakMap,F.ProgressBar=Re;function Ne(){let U=document,o=U.activeElement||U.querySelector(":focus");for(;o!=null&&o.shadowRoot;)U=o.shadowRoot,o=U.activeElement||U.querySelector(":focus");return o}function He(U){let o=n.VERTICAL,H=i.NONE;switch(U){case"SinglePage":o=n.PAGE;break;case"OneColumn":break;case"TwoPageLeft":o=n.PAGE;case"TwoColumnLeft":H=i.ODD;break;case"TwoPageRight":o=n.PAGE;case"TwoColumnRight":H=i.EVEN;break}return{scrollMode:o,spreadMode:H}}function ze(U){switch(U){case"UseNone":return x.NONE;case"UseThumbs":return x.THUMBS;case"UseOutlines":return x.OUTLINE;case"UseAttachments":return x.ATTACHMENTS;case"UseOC":return x.LAYERS}return x.NONE}function qe(U,o,H=null){U.classList.toggle("toggled",o),U.setAttribute("aria-checked",o),H==null||H.classList.toggle("hidden",!o)}function Ye(U,o,H=null){U.classList.toggle("toggled",o),U.setAttribute("aria-expanded",o),H==null||H.classList.toggle("hidden",!o)}},(J,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.CharacterType=void 0,F.getCharacterType=x,F.getNormalizeWithNFKC=n;const D={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};F.CharacterType=D;function g(i){return i<11904}function r(i){return(i&65408)===0}function j(i){return i>=97&&i<=122||i>=65&&i<=90}function I(i){return i>=48&&i<=57}function f(i){return i===32||i===9||i===13||i===10}function h(i){return i>=13312&&i<=40959||i>=63744&&i<=64255}function w(i){return i>=12448&&i<=12543}function E(i){return i>=12352&&i<=12447}function y(i){return i>=65376&&i<=65439}function _(i){return(i&65408)===3584}function x(i){return g(i)?r(i)?f(i)?D.SPACE:j(i)||I(i)||i===95?D.ALPHA_LETTER:D.PUNCT:_(i)?D.THAI_LETTER:i===160?D.SPACE:D.ALPHA_LETTER:h(i)?D.HAN_LETTER:w(i)?D.KATAKANA_LETTER:E(i)?D.HIRAGANA_LETTER:y(i)?D.HALFWIDTH_KATAKANA_LETTER:D.ALPHA_LETTER}let S;function n(){return S||(S=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦"),S}},J=>{J.exports=globalThis.pdfjsLib},(J,F,D)=>{var w,E,vn,_,Ps;Object.defineProperty(F,"__esModule",{value:!0}),F.SimpleLinkService=F.PDFLinkService=F.LinkTarget=void 0;var g=D(2);const r="noopener noreferrer nofollow",j={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};F.LinkTarget=j;function I(n,{url:i,target:s,rel:c,enabled:v=!0}={}){if(!i||typeof i!="string")throw new Error('A valid "url" parameter must provided.');v?n.href=n.title=i:(n.href="",n.title=`Disabled: ${i}`,n.onclick=()=>!1);let z="";switch(s){case j.NONE:break;case j.SELF:z="_self";break;case j.BLANK:z="_blank";break;case j.PARENT:z="_parent";break;case j.TOP:z="_top";break}n.target=z,n.rel=typeof c=="string"?c:r}const S=class S{constructor({eventBus:i,externalLinkTarget:s=null,externalLinkRel:c=null,ignoreDestinationZoom:v=!1}={}){Te(this,E);Te(this,w,new Map);this.eventBus=i,this.externalLinkTarget=s,this.externalLinkRel=c,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=v,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(i,s=null){this.baseUrl=s,this.pdfDocument=i,e(this,w).clear()}setViewer(i){this.pdfViewer=i}setHistory(i){this.pdfHistory=i}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(i){this.pdfViewer.currentPageNumber=i}get rotation(){return this.pdfViewer.pagesRotation}set rotation(i){this.pdfViewer.pagesRotation=i}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}async goToDestination(i){if(!this.pdfDocument)return;let s,c;if(typeof i=="string"?(s=i,c=await this.pdfDocument.getDestination(i)):(s=null,c=await i),!Array.isArray(c)){console.error(`PDFLinkService.goToDestination: "${c}" is not a valid destination array, for dest="${i}".`);return}Z(this,E,vn).call(this,i,s,c)}goToPage(i){if(!this.pdfDocument)return;const s=typeof i=="string"&&this.pdfViewer.pageLabelToPageNumber(i)||i|0;if(!(Number.isInteger(s)&&s>0&&s<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${i}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(s)),this.pdfViewer.scrollPageIntoView({pageNumber:s})}addLinkAttributes(i,s,c=!1){I(i,{url:s,target:c?j.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(i){if(typeof i=="string"){if(i.length>0)return this.getAnchorUrl("#"+escape(i))}else if(Array.isArray(i)){const s=JSON.stringify(i);if(s.length>0)return this.getAnchorUrl("#"+escape(s))}return this.getAnchorUrl("")}getAnchorUrl(i){return this.baseUrl?this.baseUrl+i:i}setHash(i){var v;if(!this.pdfDocument)return;let s,c;if(i.includes("=")){const z=(0,g.parseQueryString)(i);if(z.has("search")){const u=z.get("search").replaceAll('"',""),N=z.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:N?u:u.match(/\S+/g)})}if(z.has("page")&&(s=z.get("page")|0||1),z.has("zoom")){const u=z.get("zoom").split(","),N=u[0],re=parseFloat(N);N.includes("Fit")?N==="Fit"||N==="FitB"?c=[null,{name:N}]:N==="FitH"||N==="FitBH"||N==="FitV"||N==="FitBV"?c=[null,{name:N},u.length>1?u[1]|0:null]:N==="FitR"?u.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):c=[null,{name:N},u[1]|0,u[2]|0,u[3]|0,u[4]|0]:console.error(`PDFLinkService.setHash: "${N}" is not a valid zoom value.`):c=[null,{name:"XYZ"},u.length>1?u[1]|0:null,u.length>2?u[2]|0:null,re?re/100:N]}c?this.pdfViewer.scrollPageIntoView({pageNumber:s||this.page,destArray:c,allowNegativeOffset:!0}):s&&(this.page=s),z.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:z.get("pagemode")}),z.has("nameddest")&&this.goToDestination(z.get("nameddest"))}else{c=unescape(i);try{c=JSON.parse(c),Array.isArray(c)||(c=c.toString())}catch{}if(typeof c=="string"||Z(v=S,_,Ps).call(v,c)){this.goToDestination(c);return}console.error(`PDFLinkService.setHash: "${unescape(i)}" is not a valid destination.`)}}executeNamedAction(i){var s,c;switch(i){case"GoBack":(s=this.pdfHistory)==null||s.back();break;case"GoForward":(c=this.pdfHistory)==null||c.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:i})}async executeSetOCGState(i){const s=this.pdfDocument,c=await this.pdfViewer.optionalContentConfigPromise;if(s!==this.pdfDocument)return;let v;for(const z of i.state){switch(z){case"ON":case"OFF":case"Toggle":v=z;continue}switch(v){case"ON":c.setVisibility(z,!0);break;case"OFF":c.setVisibility(z,!1);break;case"Toggle":const u=c.getGroup(z);u&&c.setVisibility(z,!u.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(c)}cachePageRef(i,s){if(!s)return;const c=s.gen===0?`${s.num}R`:`${s.num}R${s.gen}`;e(this,w).set(c,i)}_cachedPageNumber(i){if(!i)return null;const s=i.gen===0?`${i.num}R`:`${i.num}R${i.gen}`;return e(this,w).get(s)||null}};w=new WeakMap,E=new WeakSet,vn=function(i,s=null,c){const v=c[0];let z;if(typeof v=="object"&&v!==null){if(z=this._cachedPageNumber(v),!z){this.pdfDocument.getPageIndex(v).then(u=>{this.cachePageRef(u+1,v),Z(this,E,vn).call(this,i,s,c)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${v}" is not a valid page reference, for dest="${i}".`)});return}}else if(Number.isInteger(v))z=v+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${v}" is not a valid destination reference, for dest="${i}".`);return}if(!z||z<1||z>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${z}" is not a valid page number, for dest="${i}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:s,explicitDest:c,pageNumber:z})),this.pdfViewer.scrollPageIntoView({pageNumber:z,destArray:c,ignoreDestinationZoom:this._ignoreDestinationZoom})},_=new WeakSet,Ps=function(i){if(!Array.isArray(i))return!1;const s=i.length;if(s<2)return!1;const c=i[0];if(!(typeof c=="object"&&Number.isInteger(c.num)&&Number.isInteger(c.gen))&&!(Number.isInteger(c)&&c>=0))return!1;const v=i[1];if(!(typeof v=="object"&&typeof v.name=="string"))return!1;let z=!0;switch(v.name){case"XYZ":if(s!==5)return!1;break;case"Fit":case"FitB":return s===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s!==3)return!1;break;case"FitR":if(s!==6)return!1;z=!1;break;default:return!1}for(let u=2;u<s;u++){const N=i[u];if(!(typeof N=="number"||z&&N===null))return!1}return!0},Te(S,_);let f=S;F.PDFLinkService=f;class h{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(i){}get rotation(){return 0}set rotation(i){}get isInPresentationMode(){return!1}async goToDestination(i){}goToPage(i){}addLinkAttributes(i,s,c=!1){I(i,{url:s,enabled:this.externalLinkEnabled})}getDestinationHash(i){return"#"}getAnchorUrl(i){return"#"}setHash(i){}executeNamedAction(i){}executeSetOCGState(i){}cachePageRef(i,s){}}F.SimpleLinkService=h},(J,F,D)=>{var f,h,bn;Object.defineProperty(F,"__esModule",{value:!0}),F.AnnotationLayerBuilder=void 0;var g=D(4),r=D(7),j=D(2);class I{constructor({pageDiv:y,pdfPage:_,linkService:x,downloadManager:S,annotationStorage:n=null,imageResourcesPath:i="",renderForms:s=!0,l10n:c=r.NullL10n,enableScripting:v=!1,hasJSActionsPromise:z=null,fieldObjectsPromise:u=null,annotationCanvasMap:N=null,accessibilityManager:re=null}){Te(this,h);Te(this,f,null);this.pageDiv=y,this.pdfPage=_,this.linkService=x,this.downloadManager=S,this.imageResourcesPath=i,this.renderForms=s,this.l10n=c,this.annotationStorage=n,this.enableScripting=v,this._hasJSActionsPromise=z||Promise.resolve(!1),this._fieldObjectsPromise=u||Promise.resolve(null),this._annotationCanvasMap=N,this._accessibilityManager=re,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=x.eventBus}async render(y,_="display"){var s;if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:y.clone({dontFlip:!0})});return}const[x,S,n]=await Promise.all([this.pdfPage.getAnnotations({intent:_}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const i=this.div=document.createElement("div");if(i.className="annotationLayer",this.pageDiv.append(i),x.length===0){this.hide();return}this.annotationLayer=new g.AnnotationLayer({div:i,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,l10n:this.l10n,page:this.pdfPage,viewport:y.clone({dontFlip:!0})}),await this.annotationLayer.render({annotations:x,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:S,fieldObjects:n}),this.linkService.isInPresentationMode&&Z(this,h,bn).call(this,j.PresentationModeState.FULLSCREEN),e(this,f)||(Pe(this,f,c=>{Z(this,h,bn).call(this,c.state)}),(s=this._eventBus)==null||s._on("presentationmodechanged",e(this,f)))}cancel(){var y;this._cancelled=!0,e(this,f)&&((y=this._eventBus)==null||y._off("presentationmodechanged",e(this,f)),Pe(this,f,null))}hide(){this.div&&(this.div.hidden=!0)}}f=new WeakMap,h=new WeakSet,bn=function(y){if(!this.div)return;let _=!1;switch(y){case j.PresentationModeState.FULLSCREEN:_=!0;break;case j.PresentationModeState.NORMAL:break;default:return}for(const x of this.div.childNodes)x.hasAttribute("data-internal-link")||(x.inert=_)},F.AnnotationLayerBuilder=I},(J,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.NullL10n=void 0,F.getL10nFallback=g;const D={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};D.print_progress_percent="{{progress}}%";function g(I,f){switch(I){case"find_match_count":I=`find_match_count[${f.total===1?"one":"other"}]`;break;case"find_match_count_limit":I=`find_match_count_limit[${f.limit===1?"one":"other"}]`;break}return D[I]||""}function r(I,f){return f?I.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,w)=>w in f?f[w]:"{{"+w+"}}"):I}const j={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(I,f=null,h=g(I,f)){return r(h,f)},async translate(I){}};F.NullL10n=j},(J,F,D)=>{var I;Object.defineProperty(F,"__esModule",{value:!0}),F.DownloadManager=void 0;var g=D(4);function r(f,h){const w=document.createElement("a");if(!w.click)throw new Error('DownloadManager: "a.click()" is not supported.');w.href=f,w.target="_parent","download"in w&&(w.download=h),(document.body||document.documentElement).append(w),w.click(),w.remove()}class j{constructor(){Te(this,I,new WeakMap)}downloadUrl(h,w,E){if(!(0,g.createValidAbsoluteUrl)(h,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${h}`);return}r(h+"#pdfjs.action=download",w)}downloadData(h,w,E){const y=URL.createObjectURL(new Blob([h],{type:E}));r(y,w)}openOrDownloadData(h,w,E){const _=(0,g.isPdfFile)(E)?"application/pdf":"";return this.downloadData(w,E,_),!1}download(h,w,E,y){const _=URL.createObjectURL(h);r(_,E)}}I=new WeakMap,F.DownloadManager=j},(J,F)=>{var I;Object.defineProperty(F,"__esModule",{value:!0}),F.WaitOnType=F.EventBus=F.AutomationEventBus=void 0,F.waitOnEventOrTimeout=g;const D={EVENT:"event",TIMEOUT:"timeout"};F.WaitOnType=D;function g({target:f,name:h,delay:w=0}){return new Promise(function(E,y){if(typeof f!="object"||!(h&&typeof h=="string")||!(Number.isInteger(w)&&w>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function _(i){f instanceof r?f._off(h,x):f.removeEventListener(h,x),n&&clearTimeout(n),E(i)}const x=_.bind(null,D.EVENT);f instanceof r?f._on(h,x):f.addEventListener(h,x);const S=_.bind(null,D.TIMEOUT),n=setTimeout(S,w)})}class r{constructor(){Te(this,I,Object.create(null))}on(h,w,E=null){this._on(h,w,{external:!0,once:E==null?void 0:E.once})}off(h,w,E=null){this._off(h,w,{external:!0,once:E==null?void 0:E.once})}dispatch(h,w){const E=e(this,I)[h];if(!E||E.length===0)return;let y;for(const{listener:_,external:x,once:S}of E.slice(0)){if(S&&this._off(h,_),x){(y||(y=[])).push(_);continue}_(w)}if(y){for(const _ of y)_(w);y=null}}_on(h,w,E=null){var _;((_=e(this,I))[h]||(_[h]=[])).push({listener:w,external:(E==null?void 0:E.external)===!0,once:(E==null?void 0:E.once)===!0})}_off(h,w,E=null){const y=e(this,I)[h];if(y){for(let _=0,x=y.length;_<x;_++)if(y[_].listener===w){y.splice(_,1);return}}}}I=new WeakMap,F.EventBus=r;class j extends r{dispatch(h,w){throw new Error("Not implemented: AutomationEventBus.dispatch")}}F.AutomationEventBus=j},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.GenericL10n=void 0,D(11);var g=D(7);const r={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function j(f){return r[f==null?void 0:f.toLowerCase()]||f}class I{constructor(h){const{webL10n:w}=document;this._lang=h,this._ready=new Promise((E,y)=>{w.setLanguage(j(h),()=>{E(w)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(h,w=null,E=(0,g.getL10nFallback)(h,w)){return(await this._ready).get(h,w,E)}async translate(h){return(await this._ready).translate(h)}}F.GenericL10n=I},()=>{document.webL10n=function(J,F){var D={},g="",r="textContent",j="",I={},f="loading",h=!0;function w(){return F.querySelectorAll('link[type="application/l10n"]')}function E(){var Q=F.querySelector('script[type="application/l10n"]');return Q?JSON.parse(Q.innerHTML):null}function y(Q){return Q?Q.querySelectorAll("*[data-l10n-id]"):[]}function _(Q){if(!Q)return{};var oe=Q.getAttribute("data-l10n-id"),fe=Q.getAttribute("data-l10n-args"),O={};if(fe)try{O=JSON.parse(fe)}catch{console.warn("could not parse arguments for #"+oe)}return{id:oe,args:O}}function x(Q,oe,fe){oe=oe||function(T){},fe=fe||function(){};var O=new XMLHttpRequest;O.open("GET",Q,h),O.overrideMimeType&&O.overrideMimeType("text/plain; charset=utf-8"),O.onreadystatechange=function(){O.readyState==4&&(O.status==200||O.status===0?oe(O.responseText):fe())},O.onerror=fe,O.ontimeout=fe;try{O.send(null)}catch{fe()}}function S(Q,oe,fe,O){var Ee=Q.replace(/[^\/]*$/,"")||"./";function T(Ce){return Ce.lastIndexOf("\\")<0?Ce:Ce.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function P(Ce,W){var d={},m=/^\s*|\s*$/,k=/^\s*#|^\s*$/,ye=/^\s*\[(.*)\]\s*$/,ve=/^\s*@import\s+url\((.*)\)\s*$/i,X=/^([^=\s]*)\s*=\s*(.+)$/;function Se(Ne,He,ze){var qe=Ne.replace(m,"").split(/[\r\n]+/),Ye="*",Oe=oe.split("-",1)[0],Fe=!1,Y="";function Ae(){for(;;){if(!qe.length){ze();return}var ke=qe.shift();if(!k.test(ke)){if(He){if(Y=ye.exec(ke),Y){Ye=Y[1].toLowerCase(),Fe=Ye!=="*"&&Ye!==oe&&Ye!==Oe;continue}else if(Fe)continue;if(Y=ve.exec(ke),Y){Re(Ee+Y[1],Ae);return}}var U=ke.match(X);U&&U.length==3&&(d[U[1]]=T(U[2]))}}}Ae()}function Re(Ne,He){x(Ne,function(ze){Se(ze,!1,He)},function(){console.warn(Ne+" not found."),He()})}Se(Ce,!0,function(){W(d)})}x(Q,function(Ce){g+=Ce,P(Ce,function(W){for(var d in W){var m,k,ye=d.lastIndexOf(".");ye>0?(m=d.substring(0,ye),k=d.substring(ye+1)):(m=d,k=r),D[m]||(D[m]={}),D[m][k]=W[d]}fe&&fe()})},O)}function n(Q,oe){Q&&(Q=Q.toLowerCase()),oe=oe||function(){},i(),j=Q;var fe=w(),O=fe.length;if(O===0){var Ee=E();if(Ee&&Ee.locales&&Ee.default_locale){if(console.log("using the embedded JSON directory, early way out"),D=Ee.locales[Q],!D){var T=Ee.default_locale.toLowerCase();for(var P in Ee.locales)if(P=P.toLowerCase(),P===Q){D=Ee.locales[Q];break}else P===T&&(D=Ee.locales[T])}oe()}else console.log("no resource to load, early way out");f="complete";return}var Ce=null,W=0;Ce=function(){W++,W>=O&&(oe(),f="complete")};function d(ye){var ve=ye.href;this.load=function(X,Se){S(ve,X,Se,function(){console.warn(ve+" not found."),console.warn('"'+X+'" resource not found'),j="",Se()})}}for(var m=0;m<O;m++){var k=new d(fe[m]);k.load(Q,Ce)}}function i(){D={},g="",j=""}function s(Q){var oe={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function fe(P,Ce){return Ce.indexOf(P)!==-1}function O(P,Ce,W){return Ce<=P&&P<=W}var Ee={0:function(P){return"other"},1:function(P){return O(P%100,3,10)?"few":P===0?"zero":O(P%100,11,99)?"many":P==2?"two":P==1?"one":"other"},2:function(P){return P!==0&&P%10===0?"many":P==2?"two":P==1?"one":"other"},3:function(P){return P==1?"one":"other"},4:function(P){return O(P,0,1)?"one":"other"},5:function(P){return O(P,0,2)&&P!=2?"one":"other"},6:function(P){return P===0?"zero":P%10==1&&P%100!=11?"one":"other"},7:function(P){return P==2?"two":P==1?"one":"other"},8:function(P){return O(P,3,6)?"few":O(P,7,10)?"many":P==2?"two":P==1?"one":"other"},9:function(P){return P===0||P!=1&&O(P%100,1,19)?"few":P==1?"one":"other"},10:function(P){return O(P%10,2,9)&&!O(P%100,11,19)?"few":P%10==1&&!O(P%100,11,19)?"one":"other"},11:function(P){return O(P%10,2,4)&&!O(P%100,12,14)?"few":P%10===0||O(P%10,5,9)||O(P%100,11,14)?"many":P%10==1&&P%100!=11?"one":"other"},12:function(P){return O(P,2,4)?"few":P==1?"one":"other"},13:function(P){return O(P%10,2,4)&&!O(P%100,12,14)?"few":P!=1&&O(P%10,0,1)||O(P%10,5,9)||O(P%100,12,14)?"many":P==1?"one":"other"},14:function(P){return O(P%100,3,4)?"few":P%100==2?"two":P%100==1?"one":"other"},15:function(P){return P===0||O(P%100,2,10)?"few":O(P%100,11,19)?"many":P==1?"one":"other"},16:function(P){return P%10==1&&P!=11?"one":"other"},17:function(P){return P==3?"few":P===0?"zero":P==6?"many":P==2?"two":P==1?"one":"other"},18:function(P){return P===0?"zero":O(P,0,2)&&P!==0&&P!=2?"one":"other"},19:function(P){return O(P,2,10)?"few":O(P,0,1)?"one":"other"},20:function(P){return(O(P%10,3,4)||P%10==9)&&!(O(P%100,10,19)||O(P%100,70,79)||O(P%100,90,99))?"few":P%1e6===0&&P!==0?"many":P%10==2&&!fe(P%100,[12,72,92])?"two":P%10==1&&!fe(P%100,[11,71,91])?"one":"other"},21:function(P){return P===0?"zero":P==1?"one":"other"},22:function(P){return O(P,0,1)||O(P,11,99)?"one":"other"},23:function(P){return O(P%10,1,2)||P%20===0?"one":"other"},24:function(P){return O(P,3,10)||O(P,13,19)?"few":fe(P,[2,12])?"two":fe(P,[1,11])?"one":"other"}},T=oe[Q.replace(/-.*$/,"")];return T in Ee?Ee[T]:(console.warn("plural form unknown for ["+Q+"]"),function(){return"other"})}I.plural=function(Q,oe,fe,O){var Ee=parseFloat(oe);if(isNaN(Ee)||O!=r)return Q;I._pluralRules||(I._pluralRules=s(j));var T="["+I._pluralRules(Ee)+"]";return Ee===0&&fe+"[zero]"in D?Q=D[fe+"[zero]"][O]:Ee==1&&fe+"[one]"in D?Q=D[fe+"[one]"][O]:Ee==2&&fe+"[two]"in D?Q=D[fe+"[two]"][O]:fe+T in D?Q=D[fe+T][O]:fe+"[other]"in D&&(Q=D[fe+"[other]"][O]),Q};function c(Q,oe,fe){var O=D[Q];if(!O){if(console.warn("#"+Q+" is undefined."),!fe)return null;O=fe}var Ee={};for(var T in O){var P=O[T];P=v(P,oe,Q,T),P=z(P,oe,Q),Ee[T]=P}return Ee}function v(Q,oe,fe,O){var Ee=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,T=Ee.exec(Q);if(!T||!T.length)return Q;var P=T[1],Ce=T[2],W;if(oe&&Ce in oe?W=oe[Ce]:Ce in D&&(W=D[Ce]),P in I){var d=I[P];Q=d(Q,W,fe,O)}return Q}function z(Q,oe,fe){var O=/\{\{\s*(.+?)\s*\}\}/g;return Q.replace(O,function(Ee,T){return oe&&T in oe?oe[T]:T in D?D[T]:(console.log("argument {{"+T+"}} for #"+fe+" is undefined."),Ee)})}function u(Q){var oe=_(Q);if(oe.id){var fe=c(oe.id,oe.args);if(!fe){console.warn("#"+oe.id+" is undefined.");return}if(fe[r]){if(N(Q)===0)Q[r]=fe[r];else{for(var O=Q.childNodes,Ee=!1,T=0,P=O.length;T<P;T++)O[T].nodeType===3&&/\S/.test(O[T].nodeValue)&&(Ee?O[T].nodeValue="":(O[T].nodeValue=fe[r],Ee=!0));if(!Ee){var Ce=F.createTextNode(fe[r]);Q.prepend(Ce)}}delete fe[r]}for(var W in fe)Q[W]=fe[W]}}function N(Q){if(Q.children)return Q.children.length;if(typeof Q.childElementCount<"u")return Q.childElementCount;for(var oe=0,fe=0;fe<Q.childNodes.length;fe++)oe+=Q.nodeType===1?1:0;return oe}function re(Q){Q=Q||F.documentElement;for(var oe=y(Q),fe=oe.length,O=0;O<fe;O++)u(oe[O]);u(Q)}return{get:function(Q,oe,fe){var O=Q.lastIndexOf("."),Ee=r;O>0&&(Ee=Q.substring(O+1),Q=Q.substring(0,O));var T;fe&&(T={},T[Ee]=fe);var P=c(Q,oe,T);return P&&Ee in P?P[Ee]:"{{"+Q+"}}"},getData:function(){return D},getText:function(){return g},getLanguage:function(){return j},setLanguage:function(Q,oe){n(Q,function(){oe&&oe()})},getDirection:function(){var Q=["ar","he","fa","ps","ur"],oe=j.split("-",1)[0];return Q.indexOf(oe)>=0?"rtl":"ltr"},translate:re,getReadyState:function(){return f},ready:function(Q){if(Q)f=="complete"||f=="interactive"?J.setTimeout(function(){Q()}):F.addEventListener&&F.addEventListener("localized",function oe(){F.removeEventListener("localized",oe),Q()});else return}}}(window,document)},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFHistory=void 0,F.isDestArraysEqual=y,F.isDestHashesEqual=E;var g=D(2),r=D(9);const j=1e3,I=50,f=1e3;function h(){return document.location.hash}class w{constructor({linkService:x,eventBus:S}){this.linkService=x,this.eventBus=S,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",n=>{this._isPagesLoaded=!!n.pagesCount},{once:!0})})}initialize({fingerprint:x,resetHistory:S=!1,updateUrl:n=!1}){if(!x||typeof x!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const i=this._fingerprint!==""&&this._fingerprint!==x;this._fingerprint=x,this._updateUrl=n===!0,this._initialized=!0,this._bindEvents();const s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=h(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(s,!0)||S){const{hash:v,page:z,rotation:u}=this._parseCurrentHash(!0);if(!v||i||S){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:v,page:z,rotation:u},!0);return}const c=s.destination;this._updateInternalState(c,s.uid,!0),c.rotation!==void 0&&(this._initialRotation=c.rotation),c.dest?(this._initialBookmark=JSON.stringify(c.dest),this._destination.page=null):c.hash?this._initialBookmark=c.hash:c.page&&(this._initialBookmark=`page=${c.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:x=null,explicitDest:S,pageNumber:n}){if(!this._initialized)return;if(x&&typeof x!="string"){console.error(`PDFHistory.push: "${x}" is not a valid namedDest parameter.`);return}else if(Array.isArray(S)){if(!this._isValidPage(n)&&(n!==null||this._destination)){console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${S}" is not a valid explicitDest parameter.`);return}const i=x||JSON.stringify(S);if(!i)return;let s=!1;if(this._destination&&(E(this._destination.hash,i)||y(this._destination.dest,S))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this._pushOrReplaceState({dest:S,hash:i,page:n,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(x){var S;if(this._initialized){if(!this._isValidPage(x)){console.error(`PDFHistory.pushPage: "${x}" is not a valid page number.`);return}((S=this._destination)==null?void 0:S.page)!==x&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${x}`,page:x,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const x=window.history.state;this._isValidState(x)&&x.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const x=window.history.state;this._isValidState(x)&&x.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(x,S=!1){const n=S||!this._destination,i={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:x};this._updateInternalState(x,i.uid);let s;if(this._updateUrl&&(x!=null&&x.hash)){const c=document.location.href.split("#")[0];c.startsWith("file://")||(s=`${c}#${x.hash}`)}n?window.history.replaceState(i,"",s):window.history.pushState(i,"",s)}_tryPushCurrentPosition(x=!1){if(!this._position)return;let S=this._position;if(x&&(S=Object.assign(Object.create(null),this._position),S.temporary=!0),!this._destination){this._pushOrReplaceState(S);return}if(this._destination.temporary){this._pushOrReplaceState(S,!0);return}if(this._destination.hash===S.hash||!this._destination.page&&this._numPositionUpdates<=I)return;let n=!1;if(this._destination.page>=S.first&&this._destination.page<=S.page){if(this._destination.dest!==void 0||!this._destination.first)return;n=!0}this._pushOrReplaceState(S,n)}_isValidPage(x){return Number.isInteger(x)&&x>0&&x<=this.linkService.pagesCount}_isValidState(x,S=!1){if(!x)return!1;if(x.fingerprint!==this._fingerprint)if(S){if(typeof x.fingerprint!="string"||x.fingerprint.length!==this._fingerprint.length)return!1;const[n]=performance.getEntriesByType("navigation");if((n==null?void 0:n.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(x.uid)||x.uid<0||x.destination===null||typeof x.destination!="object")}_updateInternalState(x,S,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&(x!=null&&x.temporary)&&delete x.temporary,this._destination=x,this._uid=S,this._maxUid=Math.max(this._maxUid,S),this._numPositionUpdates=0}_parseCurrentHash(x=!1){const S=unescape(h()).substring(1),n=(0,g.parseQueryString)(S),i=n.get("nameddest")||"";let s=n.get("page")|0;return(!this._isValidPage(s)||x&&i.length>0)&&(s=null),{hash:S,page:s,rotation:this.linkService.rotation}}_updateViewarea({location:x}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:x.pdfOpenParams.substring(1),page:this.linkService.page,first:x.pageNumber,rotation:x.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},f))}_popState({state:x}){const S=h(),n=this._currentHash!==S;if(this._currentHash=S,!x){this._uid++;const{hash:s,page:c,rotation:v}=this._parseCurrentHash();this._pushOrReplaceState({hash:s,page:c,rotation:v},!0);return}if(!this._isValidState(x))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,(0,r.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:j}).then(()=>{this._blockHashChange--}));const i=x.destination;this._updateInternalState(i,x.uid,!0),(0,g.isValidRotation)(i.rotation)&&(this.linkService.rotation=i.rotation),i.dest?this.linkService.goToDestination(i.dest):i.hash?this.linkService.setHash(i.hash):i.page&&(this.linkService.page=i.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}F.PDFHistory=w;function E(_,x){return typeof _!="string"||typeof x!="string"?!1:_===x||(0,g.parseQueryString)(_).get("nameddest")===x}function y(_,x){function S(n,i){if(typeof n!=typeof i||Array.isArray(n)||Array.isArray(i))return!1;if(n!==null&&typeof n=="object"&&i!==null){if(Object.keys(n).length!==Object.keys(i).length)return!1;for(const s in n)if(!S(n[s],i[s]))return!1;return!0}return n===i||Number.isNaN(n)&&Number.isNaN(i)}if(!(Array.isArray(_)&&Array.isArray(x))||_.length!==x.length)return!1;for(let n=0,i=_.length;n<i;n++)if(!S(_[n],x[n]))return!1;return!0}},(J,F,D)=>{var c,v,z,u,N,re,Q,oe,fe,O,Ee,Si,yn,An,Sn,En,Cs,Ts,wn;Object.defineProperty(F,"__esModule",{value:!0}),F.PDFPageView=void 0;var g=D(4),r=D(2),j=D(14),I=D(6),f=D(15),h=D(7),w=D(5),E=D(16),y=D(17),_=D(18),x=D(19),S=D(20);const n=f.compatibilityParams.maxCanvasPixels||16777216,i=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new w.SimpleLinkService}});class s{constructor(X){Te(this,Ee);Te(this,c,g.AnnotationMode.ENABLE_FORMS);Te(this,v,!1);Te(this,z,null);Te(this,u,null);Te(this,N,null);Te(this,re,null);Te(this,Q,r.RenderingStates.INITIAL);Te(this,oe,r.TextLayerMode.ENABLE);Te(this,fe,{directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0});Te(this,O,new WeakMap);var He;const Se=X.container,Re=X.defaultViewport;this.id=X.id,this.renderingId="page"+this.id,Pe(this,z,X.layerProperties||i),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=X.scale||r.DEFAULT_SCALE,this.viewport=Re,this.pdfPageRotate=Re.rotation,this._optionalContentConfigPromise=X.optionalContentConfigPromise||null,Pe(this,oe,X.textLayerMode??r.TextLayerMode.ENABLE),Pe(this,c,X.annotationMode??g.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=X.imageResourcesPath||"",this.isOffscreenCanvasSupported=X.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=X.maxCanvasPixels??n,this.pageColors=X.pageColors||null,this.eventBus=X.eventBus,this.renderingQueue=X.renderingQueue,this.l10n=X.l10n||h.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!((He=this.renderingQueue)!=null&&He.hasViewer()),this._container=Se,X.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),this.maxCanvasPixels=0),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const Ne=document.createElement("div");if(Ne.className="page",Ne.setAttribute("data-page-number",this.id),Ne.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(ze=>{Ne.setAttribute("aria-label",ze)}),this.div=Ne,Z(this,Ee,Si).call(this),Se==null||Se.append(Ne),this._isStandalone){Se==null||Se.style.setProperty("--scale-factor",this.scale*g.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:ze}=X;ze&&ze.then(qe=>{ze===this._optionalContentConfigPromise&&(e(this,fe).initialOptionalContent=qe.hasInitialVisibility)})}}get renderingState(){return e(this,Q)}set renderingState(X){if(X!==e(this,Q))switch(Pe(this,Q,X),e(this,u)&&(clearTimeout(e(this,u)),Pe(this,u,null)),X){case r.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case r.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),Pe(this,u,setTimeout(()=>{this.div.classList.add("loading"),Pe(this,u,null)},0));break;case r.RenderingStates.INITIAL:case r.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}setPdfPage(X){var Re,Ne,He;this._isStandalone&&(((Re=this.pageColors)==null?void 0:Re.foreground)==="CanvasText"||((Ne=this.pageColors)==null?void 0:Ne.background)==="Canvas")&&((He=this._container)==null||He.style.setProperty("--hcm-highligh-filter",X.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=X,this.pdfPageRotate=X.rotate;const Se=(this.rotation+this.pdfPageRotate)%360;this.viewport=X.getViewport({scale:this.scale*g.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:Se}),Z(this,Ee,Si).call(this),this.reset()}destroy(){var X;this.reset(),(X=this.pdfPage)==null||X.cleanup()}get _textHighlighter(){return(0,g.shadow)(this,"_textHighlighter",new _.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:e(this,z).call(this).findController}))}_resetZoomLayer(X=!1){if(!this.zoomLayer)return;const Se=this.zoomLayer.firstChild;e(this,O).delete(Se),Se.width=0,Se.height=0,X&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:X=!1,keepAnnotationLayer:Se=!1,keepAnnotationEditorLayer:Re=!1,keepXfaLayer:Ne=!1,keepTextLayer:He=!1}={}){var ke,U,o,H,te;this.cancelRendering({keepAnnotationLayer:Se,keepAnnotationEditorLayer:Re,keepXfaLayer:Ne,keepTextLayer:He}),this.renderingState=r.RenderingStates.INITIAL;const ze=this.div,qe=ze.childNodes,Ye=X&&this.zoomLayer||null,Oe=Se&&((ke=this.annotationLayer)==null?void 0:ke.div)||null,Fe=Re&&((U=this.annotationEditorLayer)==null?void 0:U.div)||null,Y=Ne&&((o=this.xfaLayer)==null?void 0:o.div)||null,Ae=He&&((H=this.textLayer)==null?void 0:H.div)||null;for(let q=qe.length-1;q>=0;q--){const Le=qe[q];switch(Le){case Ye:case Oe:case Fe:case Y:case Ae:continue}Le.remove()}ze.removeAttribute("data-loaded"),Oe&&this.annotationLayer.hide(),Fe&&this.annotationEditorLayer.hide(),Y&&this.xfaLayer.hide(),Ae&&this.textLayer.hide(),(te=this.structTreeLayer)==null||te.hide(),Ye||(this.canvas&&(e(this,O).delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:X=0,rotation:Se=null,optionalContentConfigPromise:Re=null,drawingDelay:Ne=-1}){var ze;this.scale=X||this.scale,typeof Se=="number"&&(this.rotation=Se),Re instanceof Promise&&(this._optionalContentConfigPromise=Re,Re.then(qe=>{Re===this._optionalContentConfigPromise&&(e(this,fe).initialOptionalContent=qe.hasInitialVisibility)})),e(this,fe).directDrawing=!0;const He=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*g.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:He}),Z(this,Ee,Si).call(this),this._isStandalone&&((ze=this._container)==null||ze.style.setProperty("--scale-factor",this.viewport.scale)),this.canvas){let qe=!1;if(e(this,v)){if(this.maxCanvasPixels===0)qe=!0;else if(this.maxCanvasPixels>0){const{width:Oe,height:Fe}=this.viewport,{sx:Y,sy:Ae}=this.outputScale;qe=(Math.floor(Oe)*Y|0)*(Math.floor(Fe)*Ae|0)>this.maxCanvasPixels}}const Ye=!qe&&Ne>=0&&Ne<1e3;if(Ye||qe){if(Ye&&this.renderingState!==r.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:Ne}),this.renderingState=r.RenderingStates.FINISHED,e(this,fe).directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!Ye,hideTextLayer:Ye}),Ye)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:e(this,re)});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:X=!1,keepAnnotationEditorLayer:Se=!1,keepXfaLayer:Re=!1,keepTextLayer:Ne=!1,cancelExtraDelay:He=0}={}){var ze;this.renderTask&&(this.renderTask.cancel(He),this.renderTask=null),this.resume=null,this.textLayer&&(!Ne||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!X||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!Se||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!Re||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(ze=this._textHighlighter)==null||ze.disable())}cssTransform({target:X,redrawAnnotationLayer:Se=!1,redrawAnnotationEditorLayer:Re=!1,redrawXfaLayer:Ne=!1,redrawTextLayer:He=!1,hideTextLayer:ze=!1}){var Ye;if(!X.hasAttribute("zooming")){X.setAttribute("zooming",!0);const{style:Oe}=X;Oe.width=Oe.height=""}const qe=e(this,O).get(X);if(this.viewport!==qe){const Oe=this.viewport.rotation-qe.rotation,Fe=Math.abs(Oe);let Y=1,Ae=1;if(Fe===90||Fe===270){const{width:ke,height:U}=this.viewport;Y=U/ke,Ae=ke/U}X.style.transform=`rotate(${Oe}deg) scale(${Y}, ${Ae})`}Se&&this.annotationLayer&&Z(this,Ee,yn).call(this),Re&&this.annotationEditorLayer&&Z(this,Ee,An).call(this),Ne&&this.xfaLayer&&Z(this,Ee,Sn).call(this),this.textLayer&&(ze?(this.textLayer.hide(),(Ye=this.structTreeLayer)==null||Ye.hide()):He&&Z(this,Ee,En).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(X,Se){return this.viewport.convertToPdfPoint(X,Se)}async draw(){this.renderingState!==r.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:X,l10n:Se,pageColors:Re,pdfPage:Ne,viewport:He}=this;if(!Ne)throw this.renderingState=r.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=r.RenderingStates.RUNNING;const ze=document.createElement("div");if(ze.classList.add("canvasWrapper"),X.append(ze),!this.textLayer&&e(this,oe)!==r.TextLayerMode.DISABLE&&!Ne.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new y.TextAccessibilityManager),this.textLayer=new x.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:e(this,oe)===r.TextLayerMode.ENABLE_PERMISSIONS}),X.append(this.textLayer.div)),!this.annotationLayer&&e(this,c)!==g.AnnotationMode.DISABLE){const{annotationStorage:Ve,downloadManager:Je,enableScripting:Ze,fieldObjectsPromise:it,hasJSActionsPromise:pt,linkService:mt}=e(this,z).call(this);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new I.AnnotationLayerBuilder({pageDiv:X,pdfPage:Ne,annotationStorage:Ve,imageResourcesPath:this.imageResourcesPath,renderForms:e(this,c)===g.AnnotationMode.ENABLE_FORMS,linkService:mt,downloadManager:Je,l10n:Se,enableScripting:Ze,hasJSActionsPromise:pt,fieldObjectsPromise:it,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const qe=Ve=>{if(Ae==null||Ae(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=r.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=r.RenderingStates.RUNNING,Ve()};return}Ve()},{width:Ye,height:Oe}=He,Fe=document.createElement("canvas");Fe.setAttribute("role","presentation"),Fe.hidden=!0;const Y=!!(Re!=null&&Re.background&&(Re!=null&&Re.foreground));let Ae=Ve=>{(!Y||Ve)&&(Fe.hidden=!1,Ae=null)};ze.append(Fe),this.canvas=Fe;const ke=Fe.getContext("2d",{alpha:!1}),U=this.outputScale=new r.OutputScale;if(this.maxCanvasPixels===0){const Ve=1/this.scale;U.sx*=Ve,U.sy*=Ve,Pe(this,v,!0)}else if(this.maxCanvasPixels>0){const Ve=Ye*Oe,Je=Math.sqrt(this.maxCanvasPixels/Ve);U.sx>Je||U.sy>Je?(U.sx=Je,U.sy=Je,Pe(this,v,!0)):Pe(this,v,!1)}const o=(0,r.approximateFraction)(U.sx),H=(0,r.approximateFraction)(U.sy);Fe.width=(0,r.roundToDivide)(Ye*U.sx,o[0]),Fe.height=(0,r.roundToDivide)(Oe*U.sy,H[0]);const{style:te}=Fe;te.width=(0,r.roundToDivide)(Ye,o[1])+"px",te.height=(0,r.roundToDivide)(Oe,H[1])+"px",e(this,O).set(Fe,He);const q=U.scaled?[U.sx,0,0,U.sy,0,0]:null,Le={canvasContext:ke,transform:q,viewport:He,annotationMode:e(this,c),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:Re},De=this.renderTask=this.pdfPage.render(Le);De.onContinue=qe;const Ge=De.promise.then(async()=>{var Ve;if(Ae==null||Ae(!0),await Z(this,Ee,wn).call(this,De),Z(this,Ee,En).call(this),this.annotationLayer&&await Z(this,Ee,yn).call(this),!this.annotationEditorLayer){const{annotationEditorUIManager:Je}=e(this,z).call(this);if(!Je)return;this.annotationEditorLayer=new j.AnnotationEditorLayerBuilder({uiManager:Je,pageDiv:X,pdfPage:Ne,l10n:Se,accessibilityManager:this._accessibilityManager,annotationLayer:(Ve=this.annotationLayer)==null?void 0:Ve.annotationLayer})}Z(this,Ee,An).call(this)},Ve=>(Ve instanceof g.RenderingCancelledException||Ae==null||Ae(!0),Z(this,Ee,wn).call(this,De,Ve)));if(Ne.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&X.append(this.xfaLayer.div);else{const{annotationStorage:Ve,linkService:Je}=e(this,z).call(this);this.xfaLayer=new S.XfaLayerBuilder({pageDiv:X,pdfPage:Ne,annotationStorage:Ve,linkService:Je})}Z(this,Ee,Sn).call(this)}return X.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),Ge}setPageLabel(X){this.pageLabel=typeof X=="string"?X:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:X,initialOptionalContent:Se,regularAnnotations:Re}=e(this,fe);return X&&Se&&Re?this.canvas:null}}c=new WeakMap,v=new WeakMap,z=new WeakMap,u=new WeakMap,N=new WeakMap,re=new WeakMap,Q=new WeakMap,oe=new WeakMap,fe=new WeakMap,O=new WeakMap,Ee=new WeakSet,Si=function(){const{viewport:X}=this;if(this.pdfPage){if(e(this,N)===X.rotation)return;Pe(this,N,X.rotation)}(0,g.setLayerDimensions)(this.div,X,!0,!1)},yn=async function(){let X=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(Se){console.error(`#renderAnnotationLayer: "${Se}".`),X=Se}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:X})}},An=async function(){let X=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(Se){console.error(`#renderAnnotationEditorLayer: "${Se}".`),X=Se}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:X})}},Sn=async function(){let X=null;try{const Se=await this.xfaLayer.render(this.viewport,"display");Se!=null&&Se.textDivs&&this._textHighlighter&&Z(this,Ee,Ts).call(this,Se.textDivs)}catch(Se){console.error(`#renderXfaLayer: "${Se}".`),X=Se}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:X})}},En=async function(){const{pdfPage:X,textLayer:Se,viewport:Re}=this;if(!Se)return;let Ne=null;try{if(!Se.renderingDone){const He=X.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});Se.setTextContentSource(He)}await Se.render(Re)}catch(He){if(He instanceof g.AbortException)return;console.error(`#renderTextLayer: "${He}".`),Ne=He}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:Se.numTextDivs,error:Ne}),Z(this,Ee,Cs).call(this)},Cs=async function(){var Re,Ne,He;if(!this.textLayer)return;this.structTreeLayer||(this.structTreeLayer=new E.StructTreeLayerBuilder);const X=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),Se=(Re=this.structTreeLayer)==null?void 0:Re.render(X);Se&&((Ne=this.canvas)==null||Ne.append(Se)),(He=this.structTreeLayer)==null||He.show()},Ts=async function(X){const Se=await this.pdfPage.getTextContent(),Re=[];for(const Ne of Se.items)Re.push(Ne.str);this._textHighlighter.setTextMapping(X,Re),this._textHighlighter.enable()},wn=async function(X,Se=null){if(X===this.renderTask&&(this.renderTask=null),Se instanceof g.RenderingCancelledException){Pe(this,re,null);return}if(Pe(this,re,Se),this.renderingState=r.RenderingStates.FINISHED,this._resetZoomLayer(!0),e(this,fe).regularAnnotations=!X.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:e(this,re)}),Se)throw Se},F.PDFPageView=s},(J,F,D)=>{var I,f;Object.defineProperty(F,"__esModule",{value:!0}),F.AnnotationEditorLayerBuilder=void 0;var g=D(4),r=D(7);class j{constructor(w){Te(this,I,null);Te(this,f);this.pageDiv=w.pageDiv,this.pdfPage=w.pdfPage,this.accessibilityManager=w.accessibilityManager,this.l10n=w.l10n||r.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,Pe(this,f,w.uiManager),Pe(this,I,w.annotationLayer||null)}async render(w,E="display"){if(E!=="display"||this._cancelled)return;const y=w.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:y}),this.show();return}const _=this.div=document.createElement("div");_.className="annotationEditorLayer",_.tabIndex=0,_.hidden=!0,_.dir=e(this,f).direction,this.pageDiv.append(_),this.annotationEditorLayer=new g.AnnotationEditorLayer({uiManager:e(this,f),div:_,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:y,annotationLayer:e(this,I)});const x={viewport:y,div:_,annotations:null,intent:E};this.annotationEditorLayer.render(x),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}I=new WeakMap,f=new WeakMap,F.AnnotationEditorLayerBuilder=j},(J,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.compatibilityParams=F.OptionKind=F.AppOptions=void 0;const D=Object.create(null);F.compatibilityParams=D;{const f=navigator.userAgent||"",h=navigator.platform||"",w=navigator.maxTouchPoints||1,E=/Android/.test(f),y=/\b(iPad|iPhone|iPod)(?=;)/.test(f)||h==="MacIntel"&&w>1;(function(){(y||E)&&(D.maxCanvasPixels=5242880)})()}const g={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};F.OptionKind=g;const r={annotationEditorMode:{value:0,kind:g.VIEWER+g.PREFERENCE},annotationMode:{value:2,kind:g.VIEWER+g.PREFERENCE},cursorToolOnLoad:{value:0,kind:g.VIEWER+g.PREFERENCE},defaultZoomDelay:{value:400,kind:g.VIEWER+g.PREFERENCE},defaultZoomValue:{value:"",kind:g.VIEWER+g.PREFERENCE},disableHistory:{value:!1,kind:g.VIEWER},disablePageLabels:{value:!1,kind:g.VIEWER+g.PREFERENCE},enablePermissions:{value:!1,kind:g.VIEWER+g.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:g.VIEWER+g.PREFERENCE},enableScripting:{value:!0,kind:g.VIEWER+g.PREFERENCE},enableStampEditor:{value:!0,kind:g.VIEWER+g.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:g.VIEWER},externalLinkTarget:{value:0,kind:g.VIEWER+g.PREFERENCE},historyUpdateUrl:{value:!1,kind:g.VIEWER+g.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:g.VIEWER+g.PREFERENCE},imageResourcesPath:{value:"./images/",kind:g.VIEWER},maxCanvasPixels:{value:16777216,kind:g.VIEWER},forcePageColors:{value:!1,kind:g.VIEWER+g.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:g.VIEWER+g.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:g.VIEWER+g.PREFERENCE},pdfBugEnabled:{value:!1,kind:g.VIEWER+g.PREFERENCE},printResolution:{value:150,kind:g.VIEWER},sidebarViewOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},scrollModeOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},spreadModeOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},textLayerMode:{value:1,kind:g.VIEWER+g.PREFERENCE},viewerCssTheme:{value:0,kind:g.VIEWER+g.PREFERENCE},viewOnLoad:{value:0,kind:g.VIEWER+g.PREFERENCE},cMapPacked:{value:!0,kind:g.API},cMapUrl:{value:"../web/cmaps/",kind:g.API},disableAutoFetch:{value:!1,kind:g.API+g.PREFERENCE},disableFontFace:{value:!1,kind:g.API+g.PREFERENCE},disableRange:{value:!1,kind:g.API+g.PREFERENCE},disableStream:{value:!1,kind:g.API+g.PREFERENCE},docBaseUrl:{value:"",kind:g.API},enableXfa:{value:!0,kind:g.API+g.PREFERENCE},fontExtraProperties:{value:!1,kind:g.API},isEvalSupported:{value:!0,kind:g.API},isOffscreenCanvasSupported:{value:!0,kind:g.API},maxImageSize:{value:-1,kind:g.API},pdfBug:{value:!1,kind:g.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:g.API},verbosity:{value:1,kind:g.API},workerPort:{value:null,kind:g.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:g.WORKER}};r.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:g.VIEWER},r.disablePreferences={value:!1,kind:g.VIEWER},r.locale={value:navigator.language||"en-US",kind:g.VIEWER},r.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:g.VIEWER};const j=Object.create(null);class I{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(h){const w=j[h];if(w!==void 0)return w;const E=r[h];if(E!==void 0)return D[h]??E.value}static getAll(h=null){const w=Object.create(null);for(const E in r){const y=r[E];if(h){if(!(h&y.kind))continue;if(h===g.PREFERENCE){const x=y.value,S=typeof x;if(S==="boolean"||S==="string"||S==="number"&&Number.isInteger(x)){w[E]=x;continue}throw new Error(`Invalid type for preference: ${E}`)}}const _=j[E];w[E]=_!==void 0?_:D[E]??y.value}return w}static set(h,w){j[h]=w}static setAll(h){for(const w in h)j[w]=h[w]}static remove(h){delete j[h]}}F.AppOptions=I,I._hasUserOptions=function(){return Object.keys(j).length>0}},(J,F,D)=>{var f,h,Pn,Cn;Object.defineProperty(F,"__esModule",{value:!0}),F.StructTreeLayerBuilder=void 0;var g=D(2);const r={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},j=/^H(\d+)$/;class I{constructor(){Te(this,h);Te(this,f)}get renderingDone(){return e(this,f)!==void 0}render(_){if(e(this,f)!==void 0)return e(this,f);const x=Z(this,h,Cn).call(this,_);return x==null||x.classList.add("structTree"),Pe(this,f,x)}hide(){e(this,f)&&!e(this,f).hidden&&(e(this,f).hidden=!0)}show(){var _;(_=e(this,f))!=null&&_.hidden&&(e(this,f).hidden=!1)}}f=new WeakMap,h=new WeakSet,Pn=function(_,x){const{alt:S,id:n,lang:i}=_;S!==void 0&&x.setAttribute("aria-label",(0,g.removeNullCharacters)(S)),n!==void 0&&x.setAttribute("aria-owns",n),i!==void 0&&x.setAttribute("lang",(0,g.removeNullCharacters)(i,!0))},Cn=function(_){if(!_)return null;const x=document.createElement("span");if("role"in _){const{role:S}=_,n=S.match(j);n?(x.setAttribute("role","heading"),x.setAttribute("aria-level",n[1])):r[S]&&x.setAttribute("role",r[S])}if(Z(this,h,Pn).call(this,_,x),_.children)if(_.children.length===1&&"id"in _.children[0])Z(this,h,Pn).call(this,_.children[0],x);else for(const S of _.children)x.append(Z(this,h,Cn).call(this,S));return x},F.StructTreeLayerBuilder=I},(J,F,D)=>{var j,I,f,h,w,Ei,y,Tn;Object.defineProperty(F,"__esModule",{value:!0}),F.TextAccessibilityManager=void 0;var g=D(2);const x=class x{constructor(){Te(this,y);Te(this,j,!1);Te(this,I,null);Te(this,f,new Map);Te(this,h,new Map)}setTextMapping(n){Pe(this,I,n)}enable(){if(e(this,j))throw new Error("TextAccessibilityManager is already enabled.");if(!e(this,I))throw new Error("Text divs and strings have not been set.");if(Pe(this,j,!0),Pe(this,I,e(this,I).slice()),e(this,I).sort(Z(x,w,Ei)),e(this,f).size>0){const n=e(this,I);for(const[i,s]of e(this,f)){if(!document.getElementById(i)){e(this,f).delete(i);continue}Z(this,y,Tn).call(this,i,n[s])}}for(const[n,i]of e(this,h))this.addPointerInTextLayer(n,i);e(this,h).clear()}disable(){e(this,j)&&(e(this,h).clear(),Pe(this,I,null),Pe(this,j,!1))}removePointerInTextLayer(n){if(!e(this,j)){e(this,h).delete(n);return}const i=e(this,I);if(!i||i.length===0)return;const{id:s}=n,c=e(this,f).get(s);if(c===void 0)return;const v=i[c];e(this,f).delete(s);let z=v.getAttribute("aria-owns");z!=null&&z.includes(s)&&(z=z.split(" ").filter(u=>u!==s).join(" "),z?v.setAttribute("aria-owns",z):(v.removeAttribute("aria-owns"),v.setAttribute("role","presentation")))}addPointerInTextLayer(n,i){const{id:s}=n;if(!s)return null;if(!e(this,j))return e(this,h).set(n,i),null;i&&this.removePointerInTextLayer(n);const c=e(this,I);if(!c||c.length===0)return null;const v=(0,g.binarySearchFirstItem)(c,re=>{var Q;return Z(Q=x,w,Ei).call(Q,n,re)<0}),z=Math.max(0,v-1),u=c[z];Z(this,y,Tn).call(this,s,u),e(this,f).set(s,z);const N=u.parentNode;return N!=null&&N.classList.contains("markedContent")?N.id:null}moveElementInDOM(n,i,s,c){const v=this.addPointerInTextLayer(s,c);if(!n.hasChildNodes())return n.append(i),v;const z=Array.from(n.childNodes).filter(re=>re!==i);if(z.length===0)return v;const u=s||i,N=(0,g.binarySearchFirstItem)(z,re=>{var Q;return Z(Q=x,w,Ei).call(Q,u,re)<0});return N===0?z[0].before(i):z[N-1].after(i),v}};j=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakSet,Ei=function(n,i){const s=n.getBoundingClientRect(),c=i.getBoundingClientRect();if(s.width===0&&s.height===0)return 1;if(c.width===0&&c.height===0)return-1;const v=s.y,z=s.y+s.height,u=s.y+s.height/2,N=c.y,re=c.y+c.height,Q=c.y+c.height/2;if(u<=N&&Q>=z)return-1;if(Q<=v&&u>=re)return 1;const oe=s.x+s.width/2,fe=c.x+c.width/2;return oe-fe},y=new WeakSet,Tn=function(n,i){const s=i.getAttribute("aria-owns");s!=null&&s.includes(n)||i.setAttribute("aria-owns",s?`${s} ${n}`:n),i.removeAttribute("role")},Te(x,w);let r=x;F.TextAccessibilityManager=r},(J,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.TextHighlighter=void 0;class D{constructor({findController:r,eventBus:j,pageIndex:I}){this.findController=r,this.matches=[],this.eventBus=j,this.pageIdx=I,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(r,j){this.textDivs=r,this.textContentItemsStr=j}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=r=>{(r.pageIndex===this.pageIdx||r.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(r,j){if(!r)return[];const{textContentItemsStr:I}=this;let f=0,h=0;const w=I.length-1,E=[];for(let y=0,_=r.length;y<_;y++){let x=r[y];for(;f!==w&&x>=h+I[f].length;)h+=I[f].length,f++;f===I.length&&console.error("Could not find a matching mapping");const S={begin:{divIdx:f,offset:x-h}};for(x+=j[y];f!==w&&x>h+I[f].length;)h+=I[f].length,f++;S.end={divIdx:f,offset:x-h},E.push(S)}return E}_renderMatches(r){if(r.length===0)return;const{findController:j,pageIdx:I}=this,{textContentItemsStr:f,textDivs:h}=this,w=I===j.selected.pageIdx,E=j.selected.matchIdx,y=j.state.highlightAll;let _=null;const x={divIdx:-1,offset:void 0};function S(z,u){const N=z.divIdx;return h[N].textContent="",n(N,0,z.offset,u)}function n(z,u,N,re){let Q=h[z];if(Q.nodeType===Node.TEXT_NODE){const O=document.createElement("span");Q.before(O),O.append(Q),h[z]=O,Q=O}const oe=f[z].substring(u,N),fe=document.createTextNode(oe);if(re){const O=document.createElement("span");return O.className=`${re} appended`,O.append(fe),Q.append(O),re.includes("selected")?O.offsetLeft:0}return Q.append(fe),0}let i=E,s=i+1;if(y)i=0,s=r.length;else if(!w)return;let c=-1,v=-1;for(let z=i;z<s;z++){const u=r[z],N=u.begin;if(N.divIdx===c&&N.offset===v)continue;c=N.divIdx,v=N.offset;const re=u.end,Q=w&&z===E,oe=Q?" selected":"";let fe=0;if(!_||N.divIdx!==_.divIdx?(_!==null&&n(_.divIdx,_.offset,x.offset),S(N)):n(_.divIdx,_.offset,N.offset),N.divIdx===re.divIdx)fe=n(N.divIdx,N.offset,re.offset,"highlight"+oe);else{fe=n(N.divIdx,N.offset,x.offset,"highlight begin"+oe);for(let O=N.divIdx+1,Ee=re.divIdx;O<Ee;O++)h[O].className="highlight middle"+oe;S(re,"highlight end"+oe)}_=re,Q&&j.scrollMatchIntoView({element:h[N.divIdx],selectedLeft:fe,pageIndex:I,matchIndex:E})}_&&n(_.divIdx,_.offset,x.offset)}_updateMatches(r=!1){if(!this.enabled&&!r)return;const{findController:j,matches:I,pageIdx:f}=this,{textContentItemsStr:h,textDivs:w}=this;let E=-1;for(const x of I){const S=Math.max(E,x.begin.divIdx);for(let n=S,i=x.end.divIdx;n<=i;n++){const s=w[n];s.textContent=h[n],s.className=""}E=x.end.divIdx+1}if(!(j!=null&&j.highlightMatches)||r)return;const y=j.pageMatches[f]||null,_=j.pageMatchesLength[f]||null;this.matches=this._convertMatches(y,_),this._renderMatches(this.matches)}}F.TextHighlighter=D},(J,F,D)=>{var I,f,h,w,E,xs,Ms;Object.defineProperty(F,"__esModule",{value:!0}),F.TextLayerBuilder=void 0;var g=D(4),r=D(2);class j{constructor({highlighter:S=null,accessibilityManager:n=null,isOffscreenCanvasSupported:i=!0,enablePermissions:s=!1}){Te(this,E);Te(this,I,!1);Te(this,f,0);Te(this,h,0);Te(this,w,null);this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=S,this.accessibilityManager=n,this.isOffscreenCanvasSupported=i,Pe(this,I,s===!0),this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}get numTextDivs(){return this.textDivs.length}async render(S){var s,c,v;if(!e(this,w))throw new Error('No "textContentSource" parameter specified.');const n=S.scale*(globalThis.devicePixelRatio||1),{rotation:i}=S;if(this.renderingDone){const z=i!==e(this,f),u=n!==e(this,h);(z||u)&&(this.hide(),(0,g.updateTextLayer)({container:this.div,viewport:S,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:u,mustRotate:z}),Pe(this,h,n),Pe(this,f,i)),this.show();return}this.cancel(),(s=this.highlighter)==null||s.setTextMapping(this.textDivs,this.textContentItemsStr),(c=this.accessibilityManager)==null||c.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,g.renderTextLayer)({textContentSource:e(this,w),container:this.div,viewport:S,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,Z(this,E,xs).call(this),Pe(this,h,n),Pe(this,f,i),this.show(),(v=this.accessibilityManager)==null||v.enable()}hide(){var S;this.div.hidden||((S=this.highlighter)==null||S.disable(),this.div.hidden=!0)}show(){var S;this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,(S=this.highlighter)==null||S.enable())}cancel(){var S,n;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(S=this.highlighter)==null||S.disable(),(n=this.accessibilityManager)==null||n.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(S){this.cancel(),Pe(this,w,S)}}I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakSet,xs=function(){this.renderingDone=!0;const S=document.createElement("div");S.className="endOfContent",this.div.append(S),Z(this,E,Ms).call(this)},Ms=function(){const{div:S}=this;S.addEventListener("mousedown",n=>{const i=S.querySelector(".endOfContent");if(!i)return;let s=n.target!==S;if(s&&(s=getComputedStyle(i).getPropertyValue("-moz-user-select")!=="none"),s){const c=S.getBoundingClientRect(),v=Math.max(0,(n.pageY-c.top)/c.height);i.style.top=(v*100).toFixed(2)+"%"}i.classList.add("active")}),S.addEventListener("mouseup",()=>{const n=S.querySelector(".endOfContent");n&&(n.style.top="",n.classList.remove("active"))}),S.addEventListener("copy",n=>{if(!e(this,I)){const i=document.getSelection();n.clipboardData.setData("text/plain",(0,r.removeNullCharacters)((0,g.normalizeUnicode)(i.toString())))}n.preventDefault(),n.stopPropagation()})},F.TextLayerBuilder=j},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.XfaLayerBuilder=void 0;var g=D(4);class r{constructor({pageDiv:I,pdfPage:f,annotationStorage:h=null,linkService:w,xfaHtml:E=null}){this.pageDiv=I,this.pdfPage=f,this.annotationStorage=h,this.linkService=w,this.xfaHtml=E,this.div=null,this._cancelled=!1}async render(I,f="display"){if(f==="print"){const E={viewport:I.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:f},y=document.createElement("div");return this.pageDiv.append(y),E.div=y,g.XfaLayer.render(E)}const h=await this.pdfPage.getXfa();if(this._cancelled||!h)return{textDivs:[]};const w={viewport:I.clone({dontFlip:!0}),div:this.div,xfaHtml:h,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:f};return this.div?g.XfaLayer.update(w):(this.div=document.createElement("div"),this.pageDiv.append(this.div),w.div=this.div,g.XfaLayer.render(w))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}F.XfaLayerBuilder=r},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFScriptingManager=void 0;var g=D(22),r=D(23);class j extends r.PDFScriptingManager{constructor(f){f.externalServices||window.addEventListener("updatefromsandbox",h=>{f.eventBus.dispatch("updatefromsandbox",{source:window,detail:h.detail})}),f.externalServices||(f.externalServices={createScripting:({sandboxBundleSrc:h})=>new g.GenericScripting(h)}),f.docProperties||(f.docProperties=h=>(0,g.docProperties)(h)),super(f)}}F.PDFScriptingManager=j},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.GenericScripting=void 0,F.docProperties=r;var g=D(4);async function r(I){const f="",h=f.split("#")[0];let{info:w,metadata:E,contentDispositionFilename:y,contentLength:_}=await I.getMetadata();if(!_){const{length:x}=await I.getDownloadInfo();_=x}return{...w,baseURL:h,filesize:_,filename:y||(0,g.getPdfFilenameFromUrl)(f),metadata:E==null?void 0:E.getRaw(),authors:E==null?void 0:E.get("dc:creator"),numPages:I.numPages,URL:f}}class j{constructor(f){this._ready=(0,g.loadScript)(f,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(f){(await this._ready).create(f)}async dispatchEventInSandbox(f){const h=await this._ready;setTimeout(()=>h.dispatchEvent(f),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}F.GenericScripting=j},(J,F,D)=>{var I,f,h,w,E,y,_,x,S,n,i,s,Ls,wi,xn,Rs,Jt;Object.defineProperty(F,"__esModule",{value:!0}),F.PDFScriptingManager=void 0;var g=D(2),r=D(4);class j{constructor({eventBus:Q,sandboxBundleSrc:oe=null,externalServices:fe=null,docProperties:O=null}){Te(this,s);Te(this,I,null);Te(this,f,null);Te(this,h,null);Te(this,w,null);Te(this,E,null);Te(this,y,null);Te(this,_,null);Te(this,x,!1);Te(this,S,null);Te(this,n,null);Te(this,i,null);Pe(this,w,Q),Pe(this,S,oe),Pe(this,E,fe),Pe(this,h,O)}setViewer(Q){Pe(this,_,Q)}async setDocument(Q){var Ee;if(e(this,y)&&await Z(this,s,Jt).call(this),Pe(this,y,Q),!Q)return;const[oe,fe,O]=await Promise.all([Q.getFieldObjects(),Q.getCalculationOrderIds(),Q.getJSActions()]);if(!oe&&!O){await Z(this,s,Jt).call(this);return}if(Q===e(this,y)){try{Pe(this,n,Z(this,s,Rs).call(this))}catch(T){console.error(`setDocument: "${T.message}".`),await Z(this,s,Jt).call(this);return}this._internalEvents.set("updatefromsandbox",T=>{(T==null?void 0:T.source)===window&&Z(this,s,Ls).call(this,T.detail)}),this._internalEvents.set("dispatcheventinsandbox",T=>{var P;(P=e(this,n))==null||P.dispatchEventInSandbox(T.detail)}),this._internalEvents.set("pagechanging",({pageNumber:T,previous:P})=>{T!==P&&(Z(this,s,xn).call(this,P),Z(this,s,wi).call(this,T))}),this._internalEvents.set("pagerendered",({pageNumber:T})=>{this._pageOpenPending.has(T)&&T===e(this,_).currentPageNumber&&Z(this,s,wi).call(this,T)}),this._internalEvents.set("pagesdestroy",async()=>{var T,P;await Z(this,s,xn).call(this,e(this,_).currentPageNumber),await((T=e(this,n))==null?void 0:T.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(P=e(this,I))==null||P.resolve()});for(const[T,P]of this._internalEvents)e(this,w)._on(T,P);try{const T=await e(this,h).call(this,Q);if(Q!==e(this,y))return;await e(this,n).createSandbox({objects:oe,calculationOrder:fe,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...T,actions:O}}),e(this,w).dispatch("sandboxcreated",{source:this})}catch(T){console.error(`setDocument: "${T.message}".`),await Z(this,s,Jt).call(this);return}await((Ee=e(this,n))==null?void 0:Ee.dispatchEventInSandbox({id:"doc",name:"Open"})),await Z(this,s,wi).call(this,e(this,_).currentPageNumber,!0),Promise.resolve().then(()=>{Q===e(this,y)&&Pe(this,x,!0)})}}async dispatchWillSave(){var Q;return(Q=e(this,n))==null?void 0:Q.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){var Q;return(Q=e(this,n))==null?void 0:Q.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){var Q;if(e(this,n)){await((Q=e(this,i))==null?void 0:Q.promise),Pe(this,i,new r.PromiseCapability);try{await e(this,n).dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(oe){throw e(this,i).resolve(),Pe(this,i,null),oe}await e(this,i).promise}}async dispatchDidPrint(){var Q;return(Q=e(this,n))==null?void 0:Q.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var Q;return((Q=e(this,f))==null?void 0:Q.promise)||null}get ready(){return e(this,x)}get _internalEvents(){return(0,r.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,r.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,r.shadow)(this,"_visitedPages",new Map)}}I=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,E=new WeakMap,y=new WeakMap,_=new WeakMap,x=new WeakMap,S=new WeakMap,n=new WeakMap,i=new WeakMap,s=new WeakSet,Ls=async function(Q){var W,d;const oe=e(this,_),fe=oe.isInPresentationMode||oe.isChangingPresentationMode,{id:O,siblings:Ee,command:T,value:P}=Q;if(!O){switch(T){case"clear":console.clear();break;case"error":console.error(P);break;case"layout":if(!fe){const m=(0,g.apiPageLayoutToViewerModes)(P);oe.spreadMode=m.spreadMode}break;case"page-num":oe.currentPageNumber=P+1;break;case"print":await oe.pagesPromise,e(this,w).dispatch("print",{source:this});break;case"println":console.log(P);break;case"zoom":fe||(oe.currentScaleValue=P);break;case"SaveAs":e(this,w).dispatch("download",{source:this});break;case"FirstPage":oe.currentPageNumber=1;break;case"LastPage":oe.currentPageNumber=oe.pagesCount;break;case"NextPage":oe.nextPage();break;case"PrevPage":oe.previousPage();break;case"ZoomViewIn":fe||oe.increaseScale();break;case"ZoomViewOut":fe||oe.decreaseScale();break;case"WillPrintFinished":(W=e(this,i))==null||W.resolve(),Pe(this,i,null);break}return}if(fe&&Q.focus)return;delete Q.id,delete Q.siblings;const Ce=Ee?[O,...Ee]:[O];for(const m of Ce){const k=document.querySelector(`[data-element-id="${m}"]`);k?k.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:Q})):(d=e(this,y))==null||d.annotationStorage.setValue(m,Q)}},wi=async function(Q,oe=!1){const fe=e(this,y),O=this._visitedPages;if(oe&&Pe(this,I,new r.PromiseCapability),!e(this,I))return;const Ee=e(this,_).getPageView(Q-1);if((Ee==null?void 0:Ee.renderingState)!==g.RenderingStates.FINISHED){this._pageOpenPending.add(Q);return}this._pageOpenPending.delete(Q);const T=(async()=>{var Ce,W;const P=await(O.has(Q)?null:(Ce=Ee.pdfPage)==null?void 0:Ce.getJSActions());fe===e(this,y)&&await((W=e(this,n))==null?void 0:W.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:Q,actions:P}))})();O.set(Q,T)},xn=async function(Q){var Ee;const oe=e(this,y),fe=this._visitedPages;if(!e(this,I)||this._pageOpenPending.has(Q))return;const O=fe.get(Q);O&&(fe.set(Q,null),await O,oe===e(this,y)&&await((Ee=e(this,n))==null?void 0:Ee.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:Q})))},Rs=function(){if(Pe(this,f,new r.PromiseCapability),e(this,n))throw new Error("#initScripting: Scripting already exists.");return e(this,E).createScripting({sandboxBundleSrc:e(this,S)})},Jt=async function(){var Q,oe,fe;if(!e(this,n)){Pe(this,y,null),(Q=e(this,f))==null||Q.resolve();return}e(this,I)&&(await Promise.race([e(this,I).promise,new Promise(O=>{setTimeout(O,1e3)})]).catch(()=>{}),Pe(this,I,null)),Pe(this,y,null);try{await e(this,n).destroySandbox()}catch{}(oe=e(this,i))==null||oe.reject(new Error("Scripting destroyed.")),Pe(this,i,null);for(const[O,Ee]of this._internalEvents)e(this,w)._off(O,Ee);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),Pe(this,n,null),Pe(this,x,!1),(fe=e(this,f))==null||fe.resolve()},F.PDFScriptingManager=j},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFSinglePageViewer=void 0;var g=D(2),r=D(25);class j extends r.PDFViewer{_resetView(){super._resetView(),this._scrollMode=g.ScrollMode.PAGE,this._spreadMode=g.SpreadMode.NONE}set scrollMode(f){}_updateScrollMode(){}set spreadMode(f){}_updateSpreadMode(){}}F.PDFSinglePageViewer=j},(J,F,D)=>{var S,n,i,Mn,c,v,z,u,N,re,Q,oe,fe,O,Ee,T,P,Ce,W,d,m,k,ks,Is,Ds,Fs,ei,Pi,Os,Ln,Ns,Rt,Rn,Bs,Vs,kn,Us;Object.defineProperty(F,"__esModule",{value:!0}),F.PagesCountLimit=F.PDFViewer=F.PDFPageViewBuffer=void 0;var g=D(4),r=D(2),j=D(7),I=D(13),f=D(26),h=D(5);const w=10,E={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};F.PagesCountLimit=E;function y(U){return Object.values(g.AnnotationEditorType).includes(U)&&U!==g.AnnotationEditorType.DISABLE}class _{constructor(o){Te(this,i);Te(this,S,new Set);Te(this,n,0);Pe(this,n,o)}push(o){const H=e(this,S);H.has(o)&&H.delete(o),H.add(o),H.size>e(this,n)&&Z(this,i,Mn).call(this)}resize(o,H=null){Pe(this,n,o);const te=e(this,S);if(H){const q=te.size;let Le=1;for(const De of te)if(H.has(De.id)&&(te.delete(De),te.add(De)),++Le>q)break}for(;te.size>e(this,n);)Z(this,i,Mn).call(this)}has(o){return e(this,S).has(o)}[Symbol.iterator](){return e(this,S).keys()}}S=new WeakMap,n=new WeakMap,i=new WeakSet,Mn=function(){const o=e(this,S).keys().next().value;o==null||o.destroy(),e(this,S).delete(o)},F.PDFPageViewBuffer=_;class x{constructor(o){Te(this,k);Te(this,c,null);Te(this,v,null);Te(this,z,g.AnnotationEditorType.NONE);Te(this,u,null);Te(this,N,g.AnnotationMode.ENABLE_FORMS);Te(this,re,null);Te(this,Q,null);Te(this,oe,!1);Te(this,fe,!1);Te(this,O,null);Te(this,Ee,!1);Te(this,T,0);Te(this,P,new ResizeObserver(Z(this,k,Us).bind(this)));Te(this,Ce,null);Te(this,W,null);Te(this,d,null);Te(this,m,r.TextLayerMode.ENABLE);var te,q;const H="3.11.174";if(g.version!==H)throw new Error(`The API version "${g.version}" does not match the Viewer version "${H}".`);if(this.container=o.container,this.viewer=o.viewer||o.container.firstElementChild,((te=this.container)==null?void 0:te.tagName)!=="DIV"||((q=this.viewer)==null?void 0:q.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");e(this,P).observe(this.container),this.eventBus=o.eventBus,this.linkService=o.linkService||new h.SimpleLinkService,this.downloadManager=o.downloadManager||null,this.findController=o.findController||null,Pe(this,v,o.altTextManager||null),this.findController&&(this.findController.onIsPageVisible=Le=>this._getVisiblePages().ids.has(Le)),this._scriptingManager=o.scriptingManager||null,Pe(this,m,o.textLayerMode??r.TextLayerMode.ENABLE),Pe(this,N,o.annotationMode??g.AnnotationMode.ENABLE_FORMS),Pe(this,z,o.annotationEditorMode??g.AnnotationEditorType.NONE),this.imageResourcesPath=o.imageResourcesPath||"",this.enablePrintAutoRotate=o.enablePrintAutoRotate||!1,this.removePageBorders=o.removePageBorders||!1,o.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),o.maxCanvasPixels=0),this.isOffscreenCanvasSupported=o.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=o.maxCanvasPixels,this.l10n=o.l10n||j.NullL10n,Pe(this,oe,o.enablePermissions||!1),this.pageColors=o.pageColors||null,this.defaultRenderingQueue=!o.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new f.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=o.renderingQueue,this.scroll=(0,r.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=r.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),Z(this,k,kn).call(this),this.eventBus._on("thumbnailrendered",({pageNumber:Le,pdfPage:De})=>{const Ge=this._pages[Le-1];e(this,c).has(Ge)||De==null||De.cleanup()})}get pagesCount(){return this._pages.length}getPageView(o){return this._pages[o]}getCachedPageViews(){return new Set(e(this,c))}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(o=>o==null?void 0:o.pdfPage)}get renderForms(){return e(this,N)===g.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(o){if(!Number.isInteger(o))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(o,!0)||console.error(`currentPageNumber: "${o}" is not a valid page.`))}_setCurrentPageNumber(o,H=!1){var q;if(this._currentPageNumber===o)return H&&Z(this,k,Rn).call(this),!0;if(!(0<o&&o<=this.pagesCount))return!1;const te=this._currentPageNumber;return this._currentPageNumber=o,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:o,pageLabel:((q=this._pageLabels)==null?void 0:q[o-1])??null,previous:te}),H&&Z(this,k,Rn).call(this),!0}get currentPageLabel(){var o;return((o=this._pageLabels)==null?void 0:o[this._currentPageNumber-1])??null}set currentPageLabel(o){if(!this.pdfDocument)return;let H=o|0;if(this._pageLabels){const te=this._pageLabels.indexOf(o);te>=0&&(H=te+1)}this._setCurrentPageNumber(H,!0)||console.error(`currentPageLabel: "${o}" is not a valid page.`)}get currentScale(){return this._currentScale!==r.UNKNOWN_SCALE?this._currentScale:r.DEFAULT_SCALE}set currentScale(o){if(isNaN(o))throw new Error("Invalid numeric scale.");this.pdfDocument&&Z(this,k,Rt).call(this,o,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(o){this.pdfDocument&&Z(this,k,Rt).call(this,o,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(o){if(!(0,r.isValidRotation)(o))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(o%=360,o<0&&(o+=360),this._pagesRotation===o))return;this._pagesRotation=o;const H=this._currentPageNumber;this.refresh(!0,{rotation:o}),this._currentScaleValue&&Z(this,k,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:o,pageNumber:H}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}async getAllText(){const o=[],H=[];for(let te=1,q=this.pdfDocument.numPages;te<=q;++te){if(e(this,Ee))return null;H.length=0;const Le=await this.pdfDocument.getPage(te),{items:De}=await Le.getTextContent();for(const Ge of De)Ge.str&&H.push(Ge.str),Ge.hasEOL&&H.push(`
`);o.push((0,r.removeNullCharacters)(H.join("")))}return o.join(`
`)}setDocument(o){var De,Ge;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(De=this.findController)==null||De.setDocument(null),(Ge=this._scriptingManager)==null||Ge.setDocument(null),e(this,u)&&(e(this,u).destroy(),Pe(this,u,null))),this.pdfDocument=o,!o)return;const H=o.numPages,te=o.getPage(1),q=o.getOptionalContentConfig(),Le=e(this,oe)?o.getPermissions():Promise.resolve();if(H>E.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const Ve=this._scrollMode=r.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:Ve})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:H})},()=>{}),this._onBeforeDraw=Ve=>{const Je=this._pages[Ve.pageNumber-1];Je&&e(this,c).push(Je)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=Ve=>{Ve.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:Ve.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,e(this,W)&&(document.removeEventListener("visibilitychange",e(this,W)),Pe(this,W,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([te,Le]).then(([Ve,Je])=>{var ft,ut;if(o!==this.pdfDocument)return;this._firstPageCapability.resolve(Ve),this._optionalContentConfigPromise=q;const{annotationEditorMode:Ze,annotationMode:it,textLayerMode:pt}=Z(this,k,Is).call(this,Je);if(pt!==r.TextLayerMode.DISABLE){const be=Pe(this,O,document.createElement("div"));be.id="hiddenCopyElement",this.viewer.before(be)}if(Ze!==g.AnnotationEditorType.DISABLE){const be=Ze;o.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):y(be)?(Pe(this,u,new g.AnnotationEditorUIManager(this.container,this.viewer,e(this,v),this.eventBus,o,this.pageColors)),be!==g.AnnotationEditorType.NONE&&e(this,u).updateMode(be)):console.error(`Invalid AnnotationEditor mode: ${be}`)}const mt=Z(this,k,ks).bind(this),Xe=this._scrollMode===r.ScrollMode.PAGE?null:this.viewer,Be=this.currentScale,Ue=Ve.getViewport({scale:Be*g.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",Ue.scale),(((ft=this.pageColors)==null?void 0:ft.foreground)==="CanvasText"||((ut=this.pageColors)==null?void 0:ut.background)==="Canvas")&&this.viewer.style.setProperty("--hcm-highligh-filter",o.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"));for(let be=1;be<=H;++be){const We=new I.PDFPageView({container:Xe,eventBus:this.eventBus,id:be,scale:Be,defaultViewport:Ue.clone(),optionalContentConfigPromise:q,renderingQueue:this.renderingQueue,textLayerMode:pt,annotationMode:it,imageResourcesPath:this.imageResourcesPath,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:mt});this._pages.push(We)}const nt=this._pages[0];nt&&(nt.setPdfPage(Ve),this.linkService.cachePageRef(1,Ve.ref)),this._scrollMode===r.ScrollMode.PAGE?Z(this,k,ei).call(this):this._spreadMode!==r.SpreadMode.NONE&&this._updateSpreadMode(),Z(this,k,Ds).call(this).then(async()=>{var We,et;if((We=this.findController)==null||We.setDocument(o),(et=this._scriptingManager)==null||et.setDocument(o),e(this,O)&&(Pe(this,Q,Z(this,k,Fs).bind(this,pt)),document.addEventListener("copy",e(this,Q))),e(this,u)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:e(this,z)}),o.loadingParams.disableAutoFetch||H>E.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let be=H-1;if(be<=0){this._pagesCapability.resolve();return}for(let rt=2;rt<=H;++rt){const ot=o.getPage(rt).then(tt=>{const _e=this._pages[rt-1];_e.pdfPage||_e.setPdfPage(tt),this.linkService.cachePageRef(rt,tt.ref),--be===0&&this._pagesCapability.resolve()},tt=>{console.error(`Unable to get page ${rt} to initialize viewer`,tt),--be===0&&this._pagesCapability.resolve()});rt%E.PAUSE_EAGER_PAGE_INIT===0&&await ot}}),this.eventBus.dispatch("pagesinit",{source:this}),o.getMetadata().then(({info:be})=>{o===this.pdfDocument&&be.Language&&(this.viewer.lang=be.Language)}),this.defaultRenderingQueue&&this.update()}).catch(Ve=>{console.error("Unable to initialize viewer",Ve),this._pagesCapability.reject(Ve)})}setPageLabels(o){var H;if(this.pdfDocument){o?Array.isArray(o)&&this.pdfDocument.numPages===o.length?this._pageLabels=o:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let te=0,q=this._pages.length;te<q;te++)this._pages[te].setPageLabel(((H=this._pageLabels)==null?void 0:H[te])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=r.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,Pe(this,c,new _(w)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new g.PromiseCapability,this._onePageRenderedCapability=new g.PromiseCapability,this._pagesCapability=new g.PromiseCapability,this._scrollMode=r.ScrollMode.VERTICAL,this._previousScrollMode=r.ScrollMode.UNKNOWN,this._spreadMode=r.SpreadMode.NONE,Pe(this,Ce,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),e(this,W)&&(document.removeEventListener("visibilitychange",e(this,W)),Pe(this,W,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),e(this,O)&&(document.removeEventListener("copy",e(this,Q)),Pe(this,Q,null),e(this,O).remove(),Pe(this,O,null))}_scrollUpdate(){this.pagesCount!==0&&this.update()}pageLabelToPageNumber(o){if(!this._pageLabels)return null;const H=this._pageLabels.indexOf(o);return H<0?null:H+1}scrollPageIntoView({pageNumber:o,destArray:H=null,allowNegativeOffset:te=!1,ignoreDestinationZoom:q=!1}){if(!this.pdfDocument)return;const Le=Number.isInteger(o)&&this._pages[o-1];if(!Le){console.error(`scrollPageIntoView: "${o}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!H){this._setCurrentPageNumber(o,!0);return}let De=0,Ge=0,Ve=0,Je=0,Ze,it;const pt=Le.rotation%180!==0,mt=(pt?Le.height:Le.width)/Le.scale/g.PixelsPerInch.PDF_TO_CSS_UNITS,Xe=(pt?Le.width:Le.height)/Le.scale/g.PixelsPerInch.PDF_TO_CSS_UNITS;let Be=0;switch(H[1].name){case"XYZ":De=H[2],Ge=H[3],Be=H[4],De=De!==null?De:0,Ge=Ge!==null?Ge:Xe;break;case"Fit":case"FitB":Be="page-fit";break;case"FitH":case"FitBH":Ge=H[2],Be="page-width",Ge===null&&this._location?(De=this._location.left,Ge=this._location.top):(typeof Ge!="number"||Ge<0)&&(Ge=Xe);break;case"FitV":case"FitBV":De=H[2],Ve=mt,Je=Xe,Be="page-height";break;case"FitR":De=H[2],Ge=H[3],Ve=H[4]-De,Je=H[5]-Ge;let ut=r.SCROLLBAR_PADDING,be=r.VERTICAL_PADDING;this.removePageBorders&&(ut=be=0),Ze=(this.container.clientWidth-ut)/Ve/g.PixelsPerInch.PDF_TO_CSS_UNITS,it=(this.container.clientHeight-be)/Je/g.PixelsPerInch.PDF_TO_CSS_UNITS,Be=Math.min(Math.abs(Ze),Math.abs(it));break;default:console.error(`scrollPageIntoView: "${H[1].name}" is not a valid destination type.`);return}if(q||(Be&&Be!==this._currentScale?this.currentScaleValue=Be:this._currentScale===r.UNKNOWN_SCALE&&(this.currentScaleValue=r.DEFAULT_SCALE_VALUE)),Be==="page-fit"&&!H[4]){Z(this,k,Pi).call(this,Le);return}const Ue=[Le.viewport.convertToViewportPoint(De,Ge),Le.viewport.convertToViewportPoint(De+Ve,Ge+Je)];let nt=Math.min(Ue[0][0],Ue[1][0]),ft=Math.min(Ue[0][1],Ue[1][1]);te||(nt=Math.max(nt,0),ft=Math.max(ft,0)),Z(this,k,Pi).call(this,Le,{left:nt,top:ft})}_updateLocation(o){const H=this._currentScale,te=this._currentScaleValue,q=parseFloat(te)===H?Math.round(H*1e4)/100:te,Le=o.id,De=this._pages[Le-1],Ge=this.container,Ve=De.getPagePoint(Ge.scrollLeft-o.x,Ge.scrollTop-o.y),Je=Math.round(Ve[0]),Ze=Math.round(Ve[1]);let it=`#page=${Le}`;this.isInPresentationMode||(it+=`&zoom=${q},${Je},${Ze}`),this._location={pageNumber:Le,scale:q,top:Ze,left:Je,rotation:this._pagesRotation,pdfOpenParams:it}}update(){const o=this._getVisiblePages(),H=o.views,te=H.length;if(te===0)return;const q=Math.max(w,2*te+1);e(this,c).resize(q,o.ids),this.renderingQueue.renderHighestPriority(o);const Le=this._spreadMode===r.SpreadMode.NONE&&(this._scrollMode===r.ScrollMode.PAGE||this._scrollMode===r.ScrollMode.VERTICAL),De=this._currentPageNumber;let Ge=!1;for(const Ve of H){if(Ve.percent<100)break;if(Ve.id===De&&Le){Ge=!0;break}}this._setCurrentPageNumber(Ge?De:H[0].id),this._updateLocation(o.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(o){return this.container.contains(o)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===r.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===r.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const o=this._scrollMode===r.ScrollMode.PAGE?e(this,Ce).pages:this._pages,H=this._scrollMode===r.ScrollMode.HORIZONTAL,te=H&&this._isContainerRtl;return(0,r.getVisibleElements)({scrollEl:this.container,views:o,sortByVisibility:!0,horizontal:H,rtl:te})}cleanup(){for(const o of this._pages)o.renderingState!==r.RenderingStates.FINISHED&&o.reset()}_cancelRendering(){for(const o of this._pages)o.cancelRendering()}forceRendering(o){const H=o||this._getVisiblePages(),te=Z(this,k,Vs).call(this,H),q=this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL,Le=this.renderingQueue.getHighestPriority(H,this._pages,te,q);return Le?(Z(this,k,Bs).call(this,Le).then(()=>{this.renderingQueue.renderView(Le)}),!0):!1}get hasEqualPageSizes(){const o=this._pages[0];for(let H=1,te=this._pages.length;H<te;++H){const q=this._pages[H];if(q.width!==o.width||q.height!==o.height)return!1}return!0}getPagesOverview(){let o;return this._pages.map(H=>{const te=H.pdfPage.getViewport({scale:1}),q=(0,r.isPortraitOrientation)(te);if(o===void 0)o=q;else if(this.enablePrintAutoRotate&&q!==o)return{width:te.height,height:te.width,rotation:(te.rotation-90)%360};return{width:te.width,height:te.height,rotation:te.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(o){if(!(o instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${o}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=o,this.refresh(!1,{optionalContentConfigPromise:o}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:o}))}get scrollMode(){return this._scrollMode}set scrollMode(o){if(this._scrollMode!==o){if(!(0,r.isValidScrollMode)(o))throw new Error(`Invalid scroll mode: ${o}`);this.pagesCount>E.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=o,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:o}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(o=null){const H=this._scrollMode,te=this.viewer;te.classList.toggle("scrollHorizontal",H===r.ScrollMode.HORIZONTAL),te.classList.toggle("scrollWrapped",H===r.ScrollMode.WRAPPED),!(!this.pdfDocument||!o)&&(H===r.ScrollMode.PAGE?Z(this,k,ei).call(this):this._previousScrollMode===r.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&Z(this,k,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(o,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(o){if(this._spreadMode!==o){if(!(0,r.isValidSpreadMode)(o))throw new Error(`Invalid spread mode: ${o}`);this._spreadMode=o,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:o}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(o=null){if(!this.pdfDocument)return;const H=this.viewer,te=this._pages;if(this._scrollMode===r.ScrollMode.PAGE)Z(this,k,ei).call(this);else if(H.textContent="",this._spreadMode===r.SpreadMode.NONE)for(const q of this._pages)H.append(q.div);else{const q=this._spreadMode-1;let Le=null;for(let De=0,Ge=te.length;De<Ge;++De)Le===null?(Le=document.createElement("div"),Le.className="spread",H.append(Le)):De%2===q&&(Le=Le.cloneNode(!1),H.append(Le)),Le.append(te[De].div)}o&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&Z(this,k,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(o,!0),this.update())}_getPageAdvance(o,H=!1){switch(this._scrollMode){case r.ScrollMode.WRAPPED:{const{views:te}=this._getVisiblePages(),q=new Map;for(const{id:Le,y:De,percent:Ge,widthPercent:Ve}of te){if(Ge===0||Ve<100)continue;let Je=q.get(De);Je||q.set(De,Je||(Je=[])),Je.push(Le)}for(const Le of q.values()){const De=Le.indexOf(o);if(De===-1)continue;const Ge=Le.length;if(Ge===1)break;if(H)for(let Ve=De-1,Je=0;Ve>=Je;Ve--){const Ze=Le[Ve],it=Le[Ve+1]-1;if(Ze<it)return o-it}else for(let Ve=De+1,Je=Ge;Ve<Je;Ve++){const Ze=Le[Ve],it=Le[Ve-1]+1;if(Ze>it)return it-o}if(H){const Ve=Le[0];if(Ve<o)return o-Ve+1}else{const Ve=Le[Ge-1];if(Ve>o)return Ve-o+1}break}break}case r.ScrollMode.HORIZONTAL:break;case r.ScrollMode.PAGE:case r.ScrollMode.VERTICAL:{if(this._spreadMode===r.SpreadMode.NONE)break;const te=this._spreadMode-1;if(H&&o%2!==te)break;if(!H&&o%2===te)break;const{views:q}=this._getVisiblePages(),Le=H?o-1:o+1;for(const{id:De,percent:Ge,widthPercent:Ve}of q)if(De===Le){if(Ge>0&&Ve===100)return 2;break}break}}return 1}nextPage(){const o=this._currentPageNumber,H=this.pagesCount;if(o>=H)return!1;const te=this._getPageAdvance(o,!1)||1;return this.currentPageNumber=Math.min(o+te,H),!0}previousPage(){const o=this._currentPageNumber;if(o<=1)return!1;const H=this._getPageAdvance(o,!0)||1;return this.currentPageNumber=Math.max(o-H,1),!0}increaseScale({drawingDelay:o,scaleFactor:H,steps:te}={}){if(!this.pdfDocument)return;let q=this._currentScale;if(H>1)q=Math.round(q*H*100)/100;else{te??(te=1);do q=Math.ceil((q*r.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--te>0&&q<r.MAX_SCALE)}Z(this,k,Rt).call(this,Math.min(r.MAX_SCALE,q),{noScroll:!1,drawingDelay:o})}decreaseScale({drawingDelay:o,scaleFactor:H,steps:te}={}){if(!this.pdfDocument)return;let q=this._currentScale;if(H>0&&H<1)q=Math.round(q*H*100)/100;else{te??(te=1);do q=Math.floor((q/r.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--te>0&&q>r.MIN_SCALE)}Z(this,k,Rt).call(this,Math.max(r.MIN_SCALE,q),{noScroll:!1,drawingDelay:o})}get containerTopLeft(){return e(this,re)||Pe(this,re,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return e(this,u)?e(this,z):g.AnnotationEditorType.DISABLE}set annotationEditorMode({mode:o,editId:H=null}){if(!e(this,u))throw new Error("The AnnotationEditor is not enabled.");if(e(this,z)!==o){if(!y(o))throw new Error(`Invalid AnnotationEditor mode: ${o}`);this.pdfDocument&&(Pe(this,z,o),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:o}),e(this,u).updateMode(o,H))}}set annotationEditorParams({type:o,value:H}){if(!e(this,u))throw new Error("The AnnotationEditor is not enabled.");e(this,u).updateParams(o,H)}refresh(o=!1,H=Object.create(null)){if(this.pdfDocument){for(const te of this._pages)te.update(H);e(this,d)!==null&&(clearTimeout(e(this,d)),Pe(this,d,null)),o||this.update()}}}c=new WeakMap,v=new WeakMap,z=new WeakMap,u=new WeakMap,N=new WeakMap,re=new WeakMap,Q=new WeakMap,oe=new WeakMap,fe=new WeakMap,O=new WeakMap,Ee=new WeakMap,T=new WeakMap,P=new WeakMap,Ce=new WeakMap,W=new WeakMap,d=new WeakMap,m=new WeakMap,k=new WeakSet,ks=function(){const o=this;return{get annotationEditorUIManager(){return e(o,u)},get annotationStorage(){var H;return(H=o.pdfDocument)==null?void 0:H.annotationStorage},get downloadManager(){return o.downloadManager},get enableScripting(){return!!o._scriptingManager},get fieldObjectsPromise(){var H;return(H=o.pdfDocument)==null?void 0:H.getFieldObjects()},get findController(){return o.findController},get hasJSActionsPromise(){var H;return(H=o.pdfDocument)==null?void 0:H.hasJSActions()},get linkService(){return o.linkService}}},Is=function(o){const H={annotationEditorMode:e(this,z),annotationMode:e(this,N),textLayerMode:e(this,m)};return o&&(!o.includes(g.PermissionFlag.COPY)&&e(this,m)===r.TextLayerMode.ENABLE&&(H.textLayerMode=r.TextLayerMode.ENABLE_PERMISSIONS),o.includes(g.PermissionFlag.MODIFY_CONTENTS)||(H.annotationEditorMode=g.AnnotationEditorType.DISABLE),!o.includes(g.PermissionFlag.MODIFY_ANNOTATIONS)&&!o.includes(g.PermissionFlag.FILL_INTERACTIVE_FORMS)&&e(this,N)===g.AnnotationMode.ENABLE_FORMS&&(H.annotationMode=g.AnnotationMode.ENABLE)),H},Ds=function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const o=new Promise(H=>{Pe(this,W,()=>{document.visibilityState==="hidden"&&(H(),document.removeEventListener("visibilitychange",e(this,W)),Pe(this,W,null))}),document.addEventListener("visibilitychange",e(this,W))});return Promise.race([this._onePageRenderedCapability.promise,o])},Fs=function(o,H){const te=document.getSelection(),{focusNode:q,anchorNode:Le}=te;if(Le&&q&&te.containsNode(e(this,O))){if(e(this,fe)||o===r.TextLayerMode.ENABLE_PERMISSIONS){H.preventDefault(),H.stopPropagation();return}Pe(this,fe,!0);const De=this.container.style.cursor;this.container.style.cursor="wait";const Ge=Ve=>Pe(this,Ee,Ve.key==="Escape");window.addEventListener("keydown",Ge),this.getAllText().then(async Ve=>{Ve!==null&&await navigator.clipboard.writeText(Ve)}).catch(Ve=>{console.warn(`Something goes wrong when extracting the text: ${Ve.message}`)}).finally(()=>{Pe(this,fe,!1),Pe(this,Ee,!1),window.removeEventListener("keydown",Ge),this.container.style.cursor=De}),H.preventDefault(),H.stopPropagation()}},ei=function(){if(this._scrollMode!==r.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const o=this._currentPageNumber,H=e(this,Ce),te=this.viewer;if(te.textContent="",H.pages.length=0,this._spreadMode===r.SpreadMode.NONE&&!this.isInPresentationMode){const q=this._pages[o-1];te.append(q.div),H.pages.push(q)}else{const q=new Set,Le=this._spreadMode-1;Le===-1?q.add(o-1):o%2!==Le?(q.add(o-1),q.add(o)):(q.add(o-2),q.add(o-1));const De=document.createElement("div");if(De.className="spread",this.isInPresentationMode){const Ge=document.createElement("div");Ge.className="dummyPage",De.append(Ge)}for(const Ge of q){const Ve=this._pages[Ge];Ve&&(De.append(Ve.div),H.pages.push(Ve))}te.append(De)}H.scrollDown=o>=H.previousPageNumber,H.previousPageNumber=o},Pi=function(o,H=null){const{div:te,id:q}=o;if(this._currentPageNumber!==q&&this._setCurrentPageNumber(q),this._scrollMode===r.ScrollMode.PAGE&&(Z(this,k,ei).call(this),this.update()),!H&&!this.isInPresentationMode){const Le=te.offsetLeft+te.clientLeft,De=Le+te.clientWidth,{scrollLeft:Ge,clientWidth:Ve}=this.container;(this._scrollMode===r.ScrollMode.HORIZONTAL||Le<Ge||De>Ge+Ve)&&(H={left:0,top:0})}(0,r.scrollIntoView)(te,H),!this._currentScaleValue&&this._location&&(this._location=null)},Os=function(o){return o===this._currentScale||Math.abs(o-this._currentScale)<1e-15},Ln=function(o,H,{noScroll:te=!1,preset:q=!1,drawingDelay:Le=-1}){if(this._currentScaleValue=H.toString(),Z(this,k,Os).call(this,o)){q&&this.eventBus.dispatch("scalechanging",{source:this,scale:o,presetValue:H});return}this.viewer.style.setProperty("--scale-factor",o*g.PixelsPerInch.PDF_TO_CSS_UNITS);const De=Le>=0&&Le<1e3;if(this.refresh(!0,{scale:o,drawingDelay:De?Le:-1}),De&&Pe(this,d,setTimeout(()=>{Pe(this,d,null),this.refresh()},Le)),this._currentScale=o,!te){let Ge=this._currentPageNumber,Ve;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(Ge=this._location.pageNumber,Ve=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:Ge,destArray:Ve,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:o,presetValue:q?H:void 0}),this.defaultRenderingQueue&&this.update()},Ns=function(){return this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL?2:1},Rt=function(o,H){let te=parseFloat(o);if(te>0)H.preset=!1,Z(this,k,Ln).call(this,te,o,H);else{const q=this._pages[this._currentPageNumber-1];if(!q)return;let Le=r.SCROLLBAR_PADDING,De=r.VERTICAL_PADDING;this.isInPresentationMode?(Le=De=4,this._spreadMode!==r.SpreadMode.NONE&&(Le*=2)):this.removePageBorders?Le=De=0:this._scrollMode===r.ScrollMode.HORIZONTAL&&([Le,De]=[De,Le]);const Ge=(this.container.clientWidth-Le)/q.width*q.scale/e(this,k,Ns),Ve=(this.container.clientHeight-De)/q.height*q.scale;switch(o){case"page-actual":te=1;break;case"page-width":te=Ge;break;case"page-height":te=Ve;break;case"page-fit":te=Math.min(Ge,Ve);break;case"auto":const Je=(0,r.isPortraitOrientation)(q)?Ge:Math.min(Ve,Ge);te=Math.min(r.MAX_AUTO_SCALE,Je);break;default:console.error(`#setScale: "${o}" is an unknown zoom value.`);return}H.preset=!0,Z(this,k,Ln).call(this,te,o,H)}},Rn=function(){const o=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&Z(this,k,Rt).call(this,this._currentScaleValue,{noScroll:!0}),Z(this,k,Pi).call(this,o)},Bs=async function(o){var H,te;if(o.pdfPage)return o.pdfPage;try{const q=await this.pdfDocument.getPage(o.id);return o.pdfPage||o.setPdfPage(q),(te=(H=this.linkService)._cachedPageNumber)!=null&&te.call(H,q.ref)||this.linkService.cachePageRef(o.id,q.ref),q}catch(q){return console.error("Unable to get page for page view",q),null}},Vs=function(o){var H,te;if(((H=o.first)==null?void 0:H.id)===1)return!0;if(((te=o.last)==null?void 0:te.id)===this.pagesCount)return!1;switch(this._scrollMode){case r.ScrollMode.PAGE:return e(this,Ce).scrollDown;case r.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},kn=function(o=this.container.clientHeight){o!==e(this,T)&&(Pe(this,T,o),r.docStyle.setProperty("--viewer-container-height",`${o}px`))},Us=function(o){for(const H of o)if(H.target===this.container){Z(this,k,kn).call(this,Math.floor(H.borderBoxSize[0].blockSize)),Pe(this,re,null);break}},F.PDFViewer=x},(J,F,D)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFRenderingQueue=void 0;var g=D(4),r=D(2);const j=3e4;class I{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(h){this.pdfViewer=h}setThumbnailViewer(h){this.pdfThumbnailViewer=h}isHighestPriority(h){return this.highestPriorityPage===h.renderingId}renderHighestPriority(h){var w;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(h)&&(this.isThumbnailViewEnabled&&((w=this.pdfThumbnailViewer)!=null&&w.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),j)))}getHighestPriority(h,w,E,y=!1){const _=h.views,x=_.length;if(x===0)return null;for(let c=0;c<x;c++){const v=_[c].view;if(!this.isViewFinished(v))return v}const S=h.first.id,n=h.last.id;if(n-S+1>x){const c=h.ids;for(let v=1,z=n-S;v<z;v++){const u=E?S+v:n-v;if(c.has(u))continue;const N=w[u-1];if(!this.isViewFinished(N))return N}}let i=E?n:S-2,s=w[i];return s&&!this.isViewFinished(s)||y&&(i+=E?1:-1,s=w[i],s&&!this.isViewFinished(s))?s:null}isViewFinished(h){return h.renderingState===r.RenderingStates.FINISHED}renderView(h){switch(h.renderingState){case r.RenderingStates.FINISHED:return!1;case r.RenderingStates.PAUSED:this.highestPriorityPage=h.renderingId,h.resume();break;case r.RenderingStates.RUNNING:this.highestPriorityPage=h.renderingId;break;case r.RenderingStates.INITIAL:this.highestPriorityPage=h.renderingId,h.draw().finally(()=>{this.renderHighestPriority()}).catch(w=>{w instanceof g.RenderingCancelledException||console.error(`renderView: "${w}"`)});break}return!0}}F.PDFRenderingQueue=I}],p={};function M(J){var F=p[J];if(F!==void 0)return F.exports;var D=p[J]={exports:{}};return le[J](D,D.exports,M),D.exports}var Me={};return(()=>{var J=Me;Object.defineProperty(J,"__esModule",{value:!0}),Object.defineProperty(J,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return r.AnnotationLayerBuilder}}),Object.defineProperty(J,"DownloadManager",{enumerable:!0,get:function(){return j.DownloadManager}}),Object.defineProperty(J,"EventBus",{enumerable:!0,get:function(){return I.EventBus}}),Object.defineProperty(J,"FindState",{enumerable:!0,get:function(){return F.FindState}}),Object.defineProperty(J,"GenericL10n",{enumerable:!0,get:function(){return f.GenericL10n}}),Object.defineProperty(J,"LinkTarget",{enumerable:!0,get:function(){return D.LinkTarget}}),Object.defineProperty(J,"NullL10n",{enumerable:!0,get:function(){return h.NullL10n}}),Object.defineProperty(J,"PDFFindController",{enumerable:!0,get:function(){return F.PDFFindController}}),Object.defineProperty(J,"PDFHistory",{enumerable:!0,get:function(){return w.PDFHistory}}),Object.defineProperty(J,"PDFLinkService",{enumerable:!0,get:function(){return D.PDFLinkService}}),Object.defineProperty(J,"PDFPageView",{enumerable:!0,get:function(){return E.PDFPageView}}),Object.defineProperty(J,"PDFScriptingManager",{enumerable:!0,get:function(){return y.PDFScriptingManager}}),Object.defineProperty(J,"PDFSinglePageViewer",{enumerable:!0,get:function(){return _.PDFSinglePageViewer}}),Object.defineProperty(J,"PDFViewer",{enumerable:!0,get:function(){return x.PDFViewer}}),Object.defineProperty(J,"ProgressBar",{enumerable:!0,get:function(){return g.ProgressBar}}),Object.defineProperty(J,"RenderingStates",{enumerable:!0,get:function(){return g.RenderingStates}}),Object.defineProperty(J,"ScrollMode",{enumerable:!0,get:function(){return g.ScrollMode}}),Object.defineProperty(J,"SimpleLinkService",{enumerable:!0,get:function(){return D.SimpleLinkService}}),Object.defineProperty(J,"SpreadMode",{enumerable:!0,get:function(){return g.SpreadMode}}),Object.defineProperty(J,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return S.StructTreeLayerBuilder}}),Object.defineProperty(J,"TextLayerBuilder",{enumerable:!0,get:function(){return n.TextLayerBuilder}}),Object.defineProperty(J,"XfaLayerBuilder",{enumerable:!0,get:function(){return i.XfaLayerBuilder}}),Object.defineProperty(J,"parseQueryString",{enumerable:!0,get:function(){return g.parseQueryString}});var F=M(1),D=M(5),g=M(2),r=M(6),j=M(8),I=M(9),f=M(10),h=M(7),w=M(12),E=M(13),y=M(21),_=M(24),x=M(25),S=M(16),n=M(19),i=M(20)})(),Me})())})(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;const DELAY_BEFORE_HIDING_CONTROLS=3e3,ACTIVE_SELECTOR="pdfPresentationMode",CONTROLS_SELECTOR="pdfPresentationModeControls",MOUSE_SCROLL_COOLDOWN_TIME=50,PAGE_SWITCH_THRESHOLD=.1,SWIPE_MIN_DISTANCE_THRESHOLD=50,SWIPE_ANGLE_THRESHOLD=Math.PI/6;var jt,Pt,bt,Hs,ti,Ws,js,zs,$s,In,Gs,ii,Xs,qs,Ys,Ks,Qs,Dn;class PDFPresentationMode{constructor({container:t,pdfViewer:le,eventBus:p}){Te(this,bt);at(this,"container");at(this,"pdfViewer");at(this,"eventBus");at(this,"contextMenuOpen");at(this,"mouseScrollTimeStamp");at(this,"mouseScrollDelta");at(this,"touchSwipeState");at(this,"controlsTimeout");at(this,"showControlsBind");at(this,"mouseDownBind");at(this,"mouseWheelBind");at(this,"resetMouseScrollStateBind");at(this,"contextMenuBind");at(this,"touchSwipeBind");at(this,"fullscreenChangeBind");Te(this,jt,PresentationModeState.UNKNOWN);Te(this,Pt,null);this.container=t,this.pdfViewer=le,this.eventBus=p,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}async request(){const{container:t,pdfViewer:le}=this;if(this.active||!le.pagesCount||!t.requestFullscreen)return!1;Z(this,bt,Qs).call(this),Z(this,bt,ti).call(this,PresentationModeState.CHANGING);const p=t.requestFullscreen();Pe(this,Pt,{pageNumber:le.currentPageNumber,scaleValue:le.currentScaleValue,scrollMode:le.scrollMode,spreadMode:null,annotationEditorMode:null}),le.spreadMode!==SpreadMode.NONE&&!(le.pageViewsReady&&le.hasEqualPageSizes)&&(console.warn("Ignoring Spread modes when entering PresentationMode, since the document may contain varying page sizes."),e(this,Pt).spreadMode=le.spreadMode),le.annotationEditorMode!==pdfExports.AnnotationEditorType.DISABLE&&(e(this,Pt).annotationEditorMode=le.annotationEditorMode);try{return await p,le.focus(),!0}catch{Z(this,bt,Dn).call(this),Z(this,bt,ti).call(this,PresentationModeState.NORMAL)}return!1}get active(){return e(this,jt)===PresentationModeState.CHANGING||e(this,jt)===PresentationModeState.FULLSCREEN}}jt=new WeakMap,Pt=new WeakMap,bt=new WeakSet,Hs=function(t){if(!this.active)return;t.preventDefault();const le=normalizeWheelEventDelta(t),p=Date.now(),M=this.mouseScrollTimeStamp;if(!(p>M&&p-M<MOUSE_SCROLL_COOLDOWN_TIME)&&((this.mouseScrollDelta>0&&le<0||this.mouseScrollDelta<0&&le>0)&&Z(this,bt,ii).call(this),this.mouseScrollDelta+=le,Math.abs(this.mouseScrollDelta)>=PAGE_SWITCH_THRESHOLD)){const Me=this.mouseScrollDelta;Z(this,bt,ii).call(this),(Me>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=p)}},ti=function(t){Pe(this,jt,t),this.eventBus.dispatch("presentationmodechanged",{source:this,state:t})},Ws=function(){var t;Z(this,bt,ti).call(this,PresentationModeState.FULLSCREEN),this.container.classList.add(ACTIVE_SELECTOR),setTimeout(()=>{this.pdfViewer.scrollMode=ScrollMode.PAGE,e(this,Pt).spreadMode!==null&&(this.pdfViewer.spreadMode=SpreadMode.NONE),this.pdfViewer.currentPageNumber=e(this,Pt).pageNumber,this.pdfViewer.currentScaleValue="page-fit",e(this,Pt).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},0),Z(this,bt,qs).call(this),Z(this,bt,In).call(this),this.contextMenuOpen=!1,(t=window.getSelection())==null||t.removeAllRanges()},js=function(){const t=this.pdfViewer.currentPageNumber;this.container.classList.remove(ACTIVE_SELECTOR),setTimeout(()=>{var le;Z(this,bt,Dn).call(this),Z(this,bt,ti).call(this,PresentationModeState.NORMAL),this.pdfViewer.scrollMode=e(this,Pt).scrollMode,((le=e(this,Pt))==null?void 0:le.spreadMode)!==null&&(this.pdfViewer.spreadMode=e(this,Pt).spreadMode),this.pdfViewer.currentScaleValue=e(this,Pt).scaleValue,this.pdfViewer.currentPageNumber=t,e(this,Pt).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode=e(this,Pt).annotationEditorMode),Pe(this,Pt,null)},0),Z(this,bt,Ys).call(this),Z(this,bt,Gs).call(this),Z(this,bt,ii).call(this),this.contextMenuOpen=!1},zs=function(t){var le;if(this.contextMenuOpen){this.contextMenuOpen=!1,t.preventDefault();return}t.button===0&&(t.target.href&&((le=t.target.parentNode)!=null&&le.hasAttribute("data-internal-link"))||(t.preventDefault(),t.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))},$s=function(){this.contextMenuOpen=!0},In=function(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(CONTROLS_SELECTOR),this.controlsTimeout=setTimeout(()=>{this.container.classList.remove(CONTROLS_SELECTOR),delete this.controlsTimeout},DELAY_BEFORE_HIDING_CONTROLS)},Gs=function(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(CONTROLS_SELECTOR),delete this.controlsTimeout)},ii=function(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0},Xs=function(t){if(this.active){if(t.touches.length>1){this.touchSwipeState=null;return}switch(t.type){case"touchstart":this.touchSwipeState={startX:t.touches[0].pageX,startY:t.touches[0].pageY,endX:t.touches[0].pageX,endY:t.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null)return;this.touchSwipeState.endX=t.touches[0].pageX,this.touchSwipeState.endY=t.touches[0].pageY,t.preventDefault();break;case"touchend":if(this.touchSwipeState===null)return;let le=0;const p=this.touchSwipeState.endX-this.touchSwipeState.startX,M=this.touchSwipeState.endY-this.touchSwipeState.startY,Me=Math.abs(Math.atan2(M,p));Math.abs(p)>SWIPE_MIN_DISTANCE_THRESHOLD&&(Me<=SWIPE_ANGLE_THRESHOLD||Me>=Math.PI-SWIPE_ANGLE_THRESHOLD)?le=p:Math.abs(M)>SWIPE_MIN_DISTANCE_THRESHOLD&&Math.abs(Me-Math.PI/2)<=SWIPE_ANGLE_THRESHOLD&&(le=M),le>0?this.pdfViewer.previousPage():le<0&&this.pdfViewer.nextPage();break}}},qs=function(){this.showControlsBind=Z(this,bt,In).bind(this),this.mouseDownBind=Z(this,bt,zs).bind(this),this.mouseWheelBind=Z(this,bt,Hs).bind(this),this.resetMouseScrollStateBind=Z(this,bt,ii).bind(this),this.contextMenuBind=Z(this,bt,$s).bind(this),this.touchSwipeBind=Z(this,bt,Xs).bind(this),window.addEventListener("mousemove",this.showControlsBind),window.addEventListener("mousedown",this.mouseDownBind),window.addEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.addEventListener("keydown",this.resetMouseScrollStateBind),window.addEventListener("contextmenu",this.contextMenuBind),window.addEventListener("touchstart",this.touchSwipeBind),window.addEventListener("touchmove",this.touchSwipeBind),window.addEventListener("touchend",this.touchSwipeBind)},Ys=function(){window.removeEventListener("mousemove",this.showControlsBind),window.removeEventListener("mousedown",this.mouseDownBind),window.removeEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.removeEventListener("keydown",this.resetMouseScrollStateBind),window.removeEventListener("contextmenu",this.contextMenuBind),window.removeEventListener("touchstart",this.touchSwipeBind),window.removeEventListener("touchmove",this.touchSwipeBind),window.removeEventListener("touchend",this.touchSwipeBind),delete this.showControlsBind,delete this.mouseDownBind,delete this.mouseWheelBind,delete this.resetMouseScrollStateBind,delete this.contextMenuBind,delete this.touchSwipeBind},Ks=function(){document.fullscreenElement?Z(this,bt,Ws).call(this):Z(this,bt,js).call(this)},Qs=function(){this.fullscreenChangeBind=Z(this,bt,Ks).bind(this),window.addEventListener("fullscreenchange",this.fullscreenChangeBind)},Dn=function(){window.removeEventListener("fullscreenchange",this.fullscreenChangeBind),delete this.fullscreenChangeBind};const CLEANUP_TIMEOUT=3e4;class PDFRenderingQueue{constructor(){at(this,"pdfViewer");at(this,"pdfThumbnailViewer");at(this,"onIdle");at(this,"highestPriorityPage");at(this,"idleTimeout");at(this,"printing");at(this,"isThumbnailViewEnabled");this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(t){var le,p;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!((le=this.pdfViewer)!=null&&le.forceRendering(t))&&(this.isThumbnailViewEnabled&&((p=this.pdfThumbnailViewer)!=null&&p.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),CLEANUP_TIMEOUT)))}getHighestPriority(t,le,p,M=!1){const Me=t.views,J=Me.length;if(J===0)return null;for(let j=0;j<J;j++){const I=Me[j].view;if(!this.isViewFinished(I))return I}const F=t.first.id,D=t.last.id;if(D-F+1>J){const j=t.ids;for(let I=1,f=D-F;I<f;I++){const h=p?F+I:D-I;if(j.has(h))continue;const w=le[h-1];if(!this.isViewFinished(w))return w}}let g=p?D:F-2,r=le[g];return r&&!this.isViewFinished(r)||M&&(g+=p?1:-1,r=le[g],r&&!this.isViewFinished(r))?r:null}isViewFinished(t){return t.renderingState===RenderingStates.FINISHED}renderView(t){switch(t.renderingState){case RenderingStates.FINISHED:return!1;case RenderingStates.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case RenderingStates.RUNNING:this.highestPriorityPage=t.renderingId;break;case RenderingStates.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally(()=>{this.renderHighestPriority()}).catch(le=>{le instanceof pdfExports.RenderingCancelledException||console.error(`renderView: "${le}"`)});break}return!0}}var xt,Ct;class OverlayManager{constructor(){Te(this,xt,new WeakMap);Te(this,Ct,null)}get active(){return e(this,Ct)}async register(t,le=!1){if(typeof t!="object")throw new Error("Not enough parameters.");if(e(this,xt).has(t))throw new Error("The overlay is already registered.");e(this,xt).set(t,{canForceClose:le}),t.addEventListener("cancel",()=>{Pe(this,Ct,null)})}async unregister(t){if(e(this,xt).has(t)){if(e(this,Ct)===t)throw new Error("The overlay cannot be removed while it is active.")}else throw new Error("The overlay does not exist.");e(this,xt).delete(t)}async open(t){if(e(this,xt).has(t)){if(e(this,Ct)){if(e(this,Ct)===t)throw new Error("The overlay is already active.");if(e(this,xt).get(t).canForceClose)await this.close();else throw new Error("Another overlay is currently active.")}}else throw new Error("The overlay does not exist.");Pe(this,Ct,t),t.showModal()}async close(t=e(this,Ct)){if(!t||!e(this,xt).has(t))throw new Error("The overlay does not exist.");if(e(this,Ct)){if(e(this,Ct)!==t)throw new Error("Another overlay is currently active.")}else throw new Error("The overlay is currently not active.");t.close(),Pe(this,Ct,null)}}xt=new WeakMap,Ct=new WeakMap;function getXfaHtmlForPrinting(we,t){const le=t.allXfaHtml,p=new pdf_viewerExports.SimpleLinkService,M=Math.round(pdfExports.PixelsPerInch.PDF_TO_CSS_UNITS*100)/100;for(const Me of le==null?void 0:le.children){const J=document.createElement("div");J.className="xfaPrintedPage",we.append(J);const F=new pdf_viewerExports.XfaLayerBuilder({pageDiv:J,pdfPage:null,annotationStorage:t.annotationStorage,linkService:p,xfaHtml:Me}),D=pdfExports.getXfaPageViewport(Me,{scale:M});F.render(D,"print")}}let activeService=null,dialog=null,overlayManager=new OverlayManager;function renderPage(we,t,le,p,M,Me,J){const F=activeService.scratchCanvas,D=M/pdfExports.PixelsPerInch.PDF;F.width=Math.floor(p.width*D),F.height=Math.floor(p.height*D);const g=F.getContext("2d");return g.save(),g.fillStyle="rgb(255, 255, 255)",g.fillRect(0,0,F.width,F.height),g.restore(),Promise.all([t.getPage(le),J]).then(function([r,j]){const I={canvasContext:g,transform:[D,0,0,D,0,0],viewport:r.getViewport({scale:1,rotation:p.rotation}),intent:"print",annotationMode:pdfExports.AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:Me,printAnnotationStorage:j};return r.render(I).promise})}class PDFPrintService{constructor(t,le,p,M,Me=null,J=null,F){at(this,"pdfDocument");at(this,"pagesOverview");at(this,"printContainer");at(this,"_printResolution");at(this,"_optionalContentConfigPromise");at(this,"_printAnnotationStoragePromise");at(this,"l10n");at(this,"currentPage");at(this,"scratchCanvas");at(this,"pageStyleSheet");this.pdfDocument=t,this.pagesOverview=le,this.printContainer=p,this._printResolution=M||150,this._optionalContentConfigPromise=Me||t.getOptionalContentConfig(),this._printAnnotationStoragePromise=J||Promise.resolve(),this.l10n=F,this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}layout(){this.throwIfInactive();const t=document.querySelector("body");t==null||t.setAttribute("data-pdfjsprinting","true"),this.pagesOverview.every(M=>M.width===this.pagesOverview[0].width&&M.height===this.pagesOverview[0].height,this)||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style");const p=this.pagesOverview[0];this.pageStyleSheet.textContent="@page { size: "+p.width+"pt "+p.height+"pt;}",t==null||t.append(this.pageStyleSheet)}destroy(){if(activeService!==this)return;this.printContainer.textContent="";const t=document.querySelector("body");t==null||t.removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,activeService=null,ensureOverlay().then(function(){overlayManager.active===dialog&&overlayManager.close(dialog)})}renderPages(){if(this.pdfDocument.isPureXfa)return getXfaHtmlForPrinting(this.printContainer,this.pdfDocument),Promise.resolve();const t=this.pagesOverview.length,le=(p,M)=>{if(this.throwIfInactive(),++this.currentPage>=t){renderProgress(t,t,this.l10n),p();return}const Me=this.currentPage;renderProgress(Me,t,this.l10n),renderPage(this,this.pdfDocument,Me+1,this.pagesOverview[Me],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then(function(){le(p,M)},M)};return new Promise(le)}useRenderedPage(){this.throwIfInactive();const t=document.createElement("img"),le=this.scratchCanvas;"toBlob"in le?le.toBlob(function(M){t.src=URL.createObjectURL(M)}):t.src=le==null?void 0:le.toDataURL();const p=document.createElement("div");return p.className="printedPage",p.append(t),this.printContainer.append(p),new Promise(function(M,Me){t.onload=M,t.onerror=Me})}performPrint(){return this.throwIfInactive(),new Promise(t=>{setTimeout(()=>{if(!this.active){t();return}print.call(window),setTimeout(t,20)},0)})}get active(){return this===activeService}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}const print=window.print;window.print=function(){if(activeService){console.warn("Ignored window.print() because of a pending print job.");return}ensureOverlay().then(function(){activeService&&overlayManager.open(dialog)});try{dispatchEvent("beforeprint")}finally{if(!activeService){console.error("Expected print service to be initialized."),ensureOverlay().then(function(){overlayManager.active===dialog&&overlayManager.close(dialog)});return}const we=activeService;activeService.renderPages().then(function(){return we.performPrint()}).catch(function(){}).then(function(){we.active&&abort()})}};function dispatchEvent(we){const t=document.createEvent("CustomEvent");t.initCustomEvent(we,!1,!1,"custom"),window.dispatchEvent(t)}function abort(){activeService&&(activeService.destroy(),dispatchEvent("afterprint"))}function renderProgress(we,t,le){dialog||(dialog=document.getElementById("printServiceDialog"));const p=Math.round(100*we/t),M=dialog.querySelector("progress"),Me=dialog.querySelector(".relative-progress");M.value=p,le.get("print_progress_percent",{progress:p}).then(J=>{Me.textContent=J})}window.addEventListener("keydown",function(we){we.keyCode===80&&(we.ctrlKey||we.metaKey)&&!we.altKey&&!we.shiftKey&&(window.print(),we.preventDefault(),we.stopImmediatePropagation())},!0);if("onbeforeprint"in window){const we=function(t){t.detail!=="custom"&&t.stopImmediatePropagation()};window.addEventListener("beforeprint",we),window.addEventListener("afterprint",we)}let overlayPromise;function ensureOverlay(){if(!overlayPromise){if(!overlayManager)throw new Error("The overlay manager has not yet been initialized.");dialog||(dialog=document.getElementById("printServiceDialog")),overlayPromise=overlayManager.register(dialog,!0),document.getElementById("printCancel").onclick=abort,dialog.addEventListener("close",abort)}return overlayPromise}const PDFPrintServiceFactory={instance:{supportsPrinting:!0,createPrintService(we,t,le,p,M,Me,J){if(activeService)throw new Error("The print service is created and active.");return activeService=new PDFPrintService(we,t,le,p,M,Me,J),activeService}}},US_PAGE_NAMES={"8.5x11":"Letter","8.5x14":"Legal"},METRIC_PAGE_NAMES={"297x420":"A3","210x297":"A4"};function getPageName(we,t,le){const p=t?we.width:we.height,M=t?we.height:we.width;return le[`${p}x${M}`]}pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.js`;var Ft,Ci,Ti,ni,si,ri,St,Zs,Js,er,tr,ir,nr,sr,rr,ar,or,lr;class PDFDocument{constructor({container:t,viewer:le,thumbs:p,options:M,store:Me}){Te(this,St);Te(this,Ft);Te(this,Ci);Te(this,Ti);Te(this,ni);at(this,"printService");at(this,"url");at(this,"eventBus");at(this,"linkService");at(this,"downloadManager",null);at(this,"findController",null);at(this,"pdfPresentationMode",null);at(this,"viewer");at(this,"document",null);at(this,"store");at(this,"filename","");Te(this,si);Te(this,ri);at(this,"l10n");at(this,"singlePageViewer");at(this,"removePageBorders");at(this,"enablePrintAutoRotate");at(this,"useOnlyCssZoom");at(this,"pageColors");at(this,"textLayerMode");at(this,"maxCanvasPixels");at(this,"printResolution");at(this,"thumbnailWidth");Pe(this,Ci,t),Pe(this,Ti,le),Pe(this,ni,p),this.l10n=(M==null?void 0:M.l10n)??pdf_viewerExports.NullL10n,this.downloadManager=new pdf_viewerExports.DownloadManager,this.textLayerMode=(M==null?void 0:M.textLayerMode)??TextLayerMode.ENABLE,Pe(this,si,pdfExports.AnnotationMode.DISABLE),Pe(this,ri,pdfExports.AnnotationEditorType.DISABLE),this.removePageBorders=(M==null?void 0:M.removePageBorders)??!1,this.singlePageViewer=(M==null?void 0:M.singlePageViewer)??!1,this.enablePrintAutoRotate=(M==null?void 0:M.enablePrintAutoRotate)??!1,this.useOnlyCssZoom=(M==null?void 0:M.useOnlyCssZoom)??!1,this.pageColors=(M==null?void 0:M.pageColors)??null,this.maxCanvasPixels=(M==null?void 0:M.maxCanvasPixels)??16777216,this.printResolution=(M==null?void 0:M.printResolution)??96,this.thumbnailWidth=(M==null?void 0:M.thumbnailWidth)??125,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.l10n=pdf_viewerExports.NullL10n,this.store=Me;const J=new PDFRenderingQueue;J.onIdle=this._cleanup.bind(this),J.isThumbnailViewEnabled=!0,Pe(this,Ft,J);const F=new pdf_viewerExports.EventBus,D=new pdf_viewerExports.PDFLinkService({eventBus:F,externalLinkTarget:2,externalLinkRel:"noopener noreferrer nofollow",ignoreDestinationZoom:!1}),g={container:t,...le&&{viewer:le},eventBus:F,linkService:D,renderingQueue:J,defaultRenderingQueue:!0,textLayerMode:this.textLayerMode,l10n:this.l10n,annotationMode:e(this,si),annotationEditorMode:e(this,ri),removePageBorders:this.removePageBorders,imageResourcesPath:"/images/",useOnlyCssZoom:this.useOnlyCssZoom},r=this.singlePageViewer?new pdf_viewerExports.PDFSinglePageViewer(g):new pdf_viewerExports.PDFViewer(g);J.setViewer(r),document.fullscreenEnabled&&(this.pdfPresentationMode=new PDFPresentationMode({container:t,pdfViewer:r,eventBus:F})),this.eventBus=F,this.linkService=D,this.viewer=r,this.linkService.setViewer(r);const j=(M==null?void 0:M.scaleValue)??"auto";this.store.setDocumentState({scaleValue:j})}async loadDocument(t,le){var Me,J,F;if(this.url)try{URL.revokeObjectURL(this.url.toString())}catch{}(Me=this.document)==null||Me.destroy(),(J=this.viewer)==null||J.cleanup(),this.url=t.toString();const p=(le==null?void 0:le.filename)??pdfExports.getPdfFilenameFromUrl((F=this.url)==null?void 0:F.toString());this.filename=p;const M=await pdfExports.getDocument({url:t}).promise;this.document=M,this.viewer.setDocument(this.document),this.linkService.setDocument(this.document),Z(this,St,tr).call(this),await Z(this,St,Zs).call(this),this.store.setDocumentState({filename:p,numPages:M.numPages,pageNumber:0,url:t.toString()}),await Z(this,St,Js).call(this),this.forceRendering()}forceRendering(t=!0){e(this,Ft).printing=!!this.printService,e(this,Ft).isThumbnailViewEnabled=t,e(this,Ft).renderHighestPriority()}gotoPage(t){this.linkService.goToPage(t)}openOrDownloadData(t,le,p){var M;(M=this.downloadManager)==null||M.openOrDownloadData(t,le,p)}async download(){var p,M;const t=this.url,{filename:le}=this;try{const Me=await this.document.getData(),J=new Blob([Me],{type:"application/pdf"});await((p=this.downloadManager)==null?void 0:p.download(J,t,le,{}))}catch{await((M=this.downloadManager)==null?void 0:M.downloadUrl(t,le,{}))}}async save(){var p;const t=this.url,{filename:le}=this;try{const M=await this.document.saveDocument(),Me=new Blob([M],{type:"application/pdf"});await((p=this.downloadManager)==null?void 0:p.download(Me,t,le,{}))}catch(M){console.error(`Error when saving the document: ${M.message}`),await this.download()}finally{}}downloadOrSave(){const{annotationStorage:t}=this.document??{};t&&t.size>0?this.save():this.download()}get supportsPrinting(){return PDFPrintServiceFactory.instance.supportsPrinting}beforePrint(){if(this.printService||!this.supportsPrinting)return;if(!this.viewer.pageViewsReady){this.l10n.get("printing_not_ready").then(J=>{window.alert(J)});return}const t=this.viewer.getPagesOverview(),le=document.getElementById("printContainer"),p=this.printResolution,M=this.viewer.optionalContentConfigPromise,Me=PDFPrintServiceFactory.instance.createPrintService(this.document,t,le,p,M,null,this.l10n);this.printService=Me,this.forceRendering(),Me.layout()}afterPrint(){var t;this.printService&&(this.printService.destroy(),this.printService=null,(t=this.document)==null||t.annotationStorage.resetModified()),this.forceRendering()}requestPresentationMode(){var t;(t=this.pdfPresentationMode)==null||t.request()}triggerPrinting(){this.supportsPrinting&&window.print()}_cleanup(){if(this.document)try{this.viewer.cleanup(),this.document.cleanup()}catch(t){console.error("Unable to perform cleanup",t)}}setAnnotationEditorMode(t){this.viewer.annotationEditorMode={mode:t},this.store.setDocumentState({annotationEditorMode:t})}setAnnotationEditorParams(t){const le=Array.isArray(t)?t:[t];for(const p of le)this.viewer.annotationEditorParams=p}setSpreadMode(t){isValidSpreadMode(t)&&(this.viewer.spreadMode=t,this.dispatch("switchspreadmode",{mode:t}))}setScrollMode(t){isValidScrollMode(t)&&(this.viewer.scrollMode=t,this.dispatch("switchscrollmode",{mode:t}))}setRotation(t){isValidRotation(t)&&(this.viewer.pagesRotation=t)}getPagesOverview(){var t;try{return((t=this.viewer)==null?void 0:t.getPagesOverview())??[]}catch{return[]}}increaseScale(){this.viewer.increaseScale()}decreaseScale(){this.viewer.decreaseScale()}set currentScaleValue(t){this.viewer.currentScaleValue=t}set currentScale(t){this.viewer.currentScale=t}getPageView(t){return this.viewer.getPageView(t)}on(t,le,p){this.eventBus.on(t,le,p)}off(t,le,p){this.eventBus.off(t,le,p)}dispatch(t,le){this.eventBus.dispatch(t,le)}}Ft=new WeakMap,Ci=new WeakMap,Ti=new WeakMap,ni=new WeakMap,si=new WeakMap,ri=new WeakMap,St=new WeakSet,Zs=async function(){const le=await this.document.getPageLabels()??[],p=le.length;let M=0,Me=0;for(let F=0;F<p;F++){const D=le[F];if(D===(F+1).toString())M++;else if(D==="")Me++;else break}if(M>=p||Me>=p)return;const{viewer:J}=this;J.setPageLabels(le)},Js=async function(){const{info:t,contentLength:le}=await this.document.getMetadata(),p=await this.document.getPage(1),M=Z(this,St,er).call(this,getPageSizeInches(p),0);this.store.setDocumentState({filesize:le,isLinearized:t.IsLinearized,pageSize:M})},er=async function(t,le){if(!t)return;le%180!==0&&(t={width:t.height,height:t.width});const p=isPortraitOrientation(t);let M={width:Math.round(t.width*100)/100,height:Math.round(t.height*100)/100},Me={width:Math.round(t.width*25.4*10)/10,height:Math.round(t.height*25.4*10)/10},J=getPageName(M,p,US_PAGE_NAMES)||getPageName(Me,p,METRIC_PAGE_NAMES);if(!J&&!(Number.isInteger(Me.width)&&Number.isInteger(Me.height))){const I={width:t.width*25.4,height:t.height*25.4},f={width:Math.round(Me.width),height:Math.round(Me.height)};Math.abs(I.width-f.width)<.1&&Math.abs(I.height-f.height)<.1&&(J=getPageName(f,p,METRIC_PAGE_NAMES),J&&(M={width:Math.round(f.width/25.4*100)/100,height:Math.round(f.height/25.4*100)/100},Me=f))}const[{width:F,height:D},g,r,j]=await Promise.all([M,this.l10n.get("document_properties_page_size_unit_inches"),J&&this.l10n.get(`document_properties_page_size_name_${J.toLowerCase()}`),this.l10n.get(`document_properties_page_size_orientation_${p?"portrait":"landscape"}`)]);return{width:F.toLocaleString(),height:D.toLocaleString(),unit:g,name:r,orientation:j}},tr=function(){this.eventBus._on("pagesinit",Z(this,St,ir).bind(this)),this.eventBus._on("scalechanging",Z(this,St,ar).bind(this)),this.eventBus._on("pagechanging",Z(this,St,or).bind(this)),this.eventBus._on("pagerendered",Z(this,St,lr).bind(this)),this.eventBus._on("rotationchanging",Z(this,St,nr).bind(this)),this.eventBus._on("switchspreadmode",Z(this,St,sr).bind(this)),this.eventBus._on("switchscrollmode",Z(this,St,rr).bind(this)),this.eventBus._on("beforeprint",this.beforePrint.bind(this)),this.eventBus._on("afterprint",this.afterPrint.bind(this)),window.onbeforeprint=t=>{this.eventBus.dispatch("beforeprint",{source:window})},window.onafterprint=t=>{this.eventBus.dispatch("afterprint",{source:window})}},ir=async function({source:t}){var p;await((p=this.document)==null?void 0:p.getOutline());const le="auto";t.currentScale=1,t.currentScaleValue="auto",this.store.setDocumentState({pageNumber:1,scaleValue:le,pagesReady:!0})},nr=function({pagesRotation:t,pageNumber:le}){this.store.setDocumentState({pagesRotation:t}),this.forceRendering(),this.viewer.currentPageNumber=le},sr=function({mode:t}){this.store.setDocumentState({spreadMode:t})},rr=function({mode:t}){this.store.setDocumentState({scrollMode:t}),this.viewer.update()},ar=function({scale:t,presetValue:le}){this.store.setDocumentState({scale:t,scaleValue:le}),this.viewer.update()},or=function({pageNumber:t}){this.store.setDocumentState({pageNumber:t})},lr=function({pageNumber:t,error:le}){e(this,ni)&&this.viewer.getPageView(t-1)};const PDFDocumentStoreContext=createContext(),initialState={documentState:{isDocumentLoaded:!1,pagesReady:!1,numPages:0,pageNumber:0,scale:0,scaleValue:"auto",pagesRotation:0,spreadMode:SpreadMode.UNKNOWN,scrollMode:ScrollMode.UNKNOWN,annotationEditorMode:pdfExports.AnnotationEditorType.NONE,url:null},layersState:{layerIds:[],layers:{},selectionLayerIds:[]}},PDViewerProvider=we=>{const[t,le]=splitProps(we,["initialAnnotation","onUpdate"]),[p,M]=createStore(initialState.documentState),[Me,J]=createStore(initialState.layersState),[F,D]=createSignal(!1),g=createUndoHistory([()=>{if(F()){trackStore(Me.layers);const I=structuredClone(unwrap(untrack(()=>Me)));return()=>{J(I)}}}]);createEffect(()=>{var I;D(!1),(I=t.initialAnnotation)!=null&&I.length&&batch(()=>{J("layerIds",[]),J("layers",{}),t.initialAnnotation.forEach((f,h)=>{J("layerIds",h,f.id),J("layers",f.id,{...f})})}),D(!0)});const r={setLayerState:(I,f)=>{I.push(f),J(...I)},setDocumentState:M,history:{canUndo:g.canUndo,canRedo:g.canRedo,undo:g.undo,redo:g.redo,pause:()=>{untrack(()=>D(!1))},resume:()=>{untrack(()=>D(!0))}}};createEffect(()=>{trackStore(Me),untrack(()=>t.onUpdate)&&untrack(()=>we.onUpdate)(Me.layerIds.map(I=>({id:I,...Me.layers[I]})))});const j=[{documentState:p,layersState:Me,pdfDocument:null,pdfUrl:le.pdfUrl,thumbnails:new Map},r];return createComponent(PDFDocumentStoreContext.Provider,{value:j,get children(){return le.children}})},usePDFStoreContext=()=>{const we=useContext(PDFDocumentStoreContext);if(!we)throw new Error("Cannot PDFDocumentStoreContext outside provider");return we},usePDFViewer=we=>{const[t,{setDocumentState:le}]=usePDFStoreContext();let p=null;const[M,Me]=createSignal([]),J=F=>{p=F};return createEffect(()=>{if(t.documentState.isDocumentLoaded&&t.documentState.numPages){const F=[];new Array(t.documentState.numPages).fill(0).forEach((D,g)=>{F[g]=document.getElementById(`stree-pdf-page-${g+1}`)}),Me(F)}}),onMount(()=>{if(t.pdfUrl){const F=new PDFDocument({container:p,store:{setDocumentState:le}});t.pdfDocument=F,t.pdfDocument.loadDocument(t.pdfUrl,we).then(()=>{var D;new Array((D=F.document)==null?void 0:D.numPages).fill(0).map((g,r)=>{const j=F.getPageView(r).div;j&&(j.id=`stree-pdf-page-${r+1}`);const I=document.createElement("svg");I.classList.add("annotationLayer"),I.id=`stree-pdf-annotationLayer-${r+1}`,j.append(I)}),le({isDocumentLoaded:!0})})}}),{isDocumentLoaded:t.documentState.isDocumentLoaded,setViewRef:J,documentState:t.documentState,pdfDocument:t.pdfDocument,listPageDiv:M(),viewerRef:p}};function $(we,t,le,p=M=>M){return we*p(.5-t*(.5-le))}function se(we){return[-we[0],-we[1]]}function l(we,t){return[we[0]+t[0],we[1]+t[1]]}function a(we,t){return[we[0]-t[0],we[1]-t[1]]}function b(we,t){return[we[0]*t,we[1]*t]}function he(we,t){return[we[0]/t,we[1]/t]}function R(we){return[we[1],-we[0]]}function B(we,t){return we[0]*t[0]+we[1]*t[1]}function ue(we,t){return we[0]===t[0]&&we[1]===t[1]}function ge(we){return Math.hypot(we[0],we[1])}function de(we){return we[0]*we[0]+we[1]*we[1]}function A(we,t){return de(a(we,t))}function G(we){return he(we,ge(we))}function ie(we,t){return Math.hypot(we[1]-t[1],we[0]-t[0])}function L(we,t,le){let p=Math.sin(le),M=Math.cos(le),Me=we[0]-t[0],J=we[1]-t[1],F=Me*M-J*p,D=Me*p+J*M;return[F+t[0],D+t[1]]}function K(we,t,le){return l(we,b(a(t,we),le))}function ee(we,t,le){return l(we,b(t,le))}var{min:C,PI:xe}=Math,pe=.275,V=xe+1e-4;function ce(we,t={}){let{size:le=16,smoothing:p=.5,thinning:M=.5,simulatePressure:Me=!0,easing:J=O=>O,start:F={},end:D={},last:g=!1}=t,{cap:r=!0,easing:j=O=>O*(2-O)}=F,{cap:I=!0,easing:f=O=>--O*O*O+1}=D;if(we.length===0||le<=0)return[];let h=we[we.length-1].runningLength,w=F.taper===!1?0:F.taper===!0?Math.max(le,h):F.taper,E=D.taper===!1?0:D.taper===!0?Math.max(le,h):D.taper,y=Math.pow(le*p,2),_=[],x=[],S=we.slice(0,10).reduce((O,Ee)=>{let T=Ee.pressure;if(Me){let P=C(1,Ee.distance/le),Ce=C(1,1-P);T=C(1,O+(Ce-O)*(P*pe))}return(O+T)/2},we[0].pressure),n=$(le,M,we[we.length-1].pressure,J),i,s=we[0].vector,c=we[0].point,v=c,z=c,u=v,N=!1;for(let O=0;O<we.length;O++){let{pressure:Ee}=we[O],{point:T,vector:P,distance:Ce,runningLength:W}=we[O];if(O<we.length-1&&h-W<3)continue;if(M){if(Me){let Re=C(1,Ce/le),Ne=C(1,1-Re);Ee=C(1,S+(Ne-S)*(Re*pe))}n=$(le,M,Ee,J)}else n=le/2;i===void 0&&(i=n);let d=W<w?j(W/w):1,m=h-W<E?f((h-W)/E):1;n=Math.max(.01,n*Math.min(d,m));let k=(O<we.length-1?we[O+1]:we[O]).vector,ye=O<we.length-1?B(P,k):1,ve=B(P,s)<0&&!N,X=ye!==null&&ye<0;if(ve||X){let Re=b(R(s),n);for(let Ne=1/13,He=0;He<=1;He+=Ne)z=L(a(T,Re),T,V*He),_.push(z),u=L(l(T,Re),T,V*-He),x.push(u);c=z,v=u,X&&(N=!0);continue}if(N=!1,O===we.length-1){let Re=b(R(P),n);_.push(a(T,Re)),x.push(l(T,Re));continue}let Se=b(R(K(k,P,ye)),n);z=a(T,Se),(O<=1||A(c,z)>y)&&(_.push(z),c=z),u=l(T,Se),(O<=1||A(v,u)>y)&&(x.push(u),v=u),S=Ee,s=P}let re=we[0].point.slice(0,2),Q=we.length>1?we[we.length-1].point.slice(0,2):l(we[0].point,[1,1]),oe=[],fe=[];if(we.length===1){if(!(w||E)||g){let O=ee(re,G(R(a(re,Q))),-(i||n)),Ee=[];for(let T=1/13,P=T;P<=1;P+=T)Ee.push(L(O,re,V*2*P));return Ee}}else{if(!(w||E&&we.length===1))if(r)for(let Ee=1/13,T=Ee;T<=1;T+=Ee){let P=L(x[0],re,V*T);oe.push(P)}else{let Ee=a(_[0],x[0]),T=b(Ee,.5),P=b(Ee,.51);oe.push(a(re,T),a(re,P),l(re,P),l(re,T))}let O=R(se(we[we.length-1].vector));if(E||w&&we.length===1)fe.push(Q);else if(I){let Ee=ee(Q,O,n);for(let T=1/29,P=T;P<1;P+=T)fe.push(L(Ee,Q,V*3*P))}else fe.push(l(Q,b(O,n)),l(Q,b(O,n*.99)),a(Q,b(O,n*.99)),a(Q,b(O,n)))}return _.concat(fe,x.reverse(),oe)}function me(we,t={}){var le;let{streamline:p=.5,size:M=16,last:Me=!1}=t;if(we.length===0)return[];let J=.15+(1-p)*.85,F=Array.isArray(we[0])?we:we.map(({x:f,y:h,pressure:w=.5})=>[f,h,w]);if(F.length===2){let f=F[1];F=F.slice(0,-1);for(let h=1;h<5;h++)F.push(K(F[0],f,h/4))}F.length===1&&(F=[...F,[...l(F[0],[1,1]),...F[0].slice(2)]]);let D=[{point:[F[0][0],F[0][1]],pressure:F[0][2]>=0?F[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],g=!1,r=0,j=D[0],I=F.length-1;for(let f=1;f<F.length;f++){let h=Me&&f===I?F[f].slice(0,2):K(j.point,F[f],J);if(ue(j.point,h))continue;let w=ie(h,j.point);if(r+=w,f<I&&!g){if(r<M)continue;g=!0}j={point:h,pressure:F[f][2]>=0?F[f][2]:.5,vector:G(a(j.point,h)),distance:w,runningLength:r},D.push(j)}return D[0].vector=((le=D[1])==null?void 0:le.vector)||[0,0],D}function ae(we,t={}){return ce(me(we,t),t)}var _tmpl$$2=template("<svg><path class=drop-shadow-md></svg>",!1,!0);const LayerPath=we=>(()=>{var t=_tmpl$$2();return t.$$pointerdown=le=>we.onPointerDown&&we.onPointerDown(le),createRenderEffect(le=>{var p=getSvgPathFromStroke(ae(we.points,{size:8,thinning:.5,smoothing:.5,streamline:.5})),M=`translate(${we.x}px, ${we.y}px)`,Me=we.fill,J=we.fill;return p!==le.e&&setAttribute(t,"d",le.e=p),M!==le.t&&((le.t=M)!=null?t.style.setProperty("transform",M):t.style.removeProperty("transform")),Me!==le.a&&setAttribute(t,"fill",le.a=Me),J!==le.o&&setAttribute(t,"stroke",le.o=J),le},{e:void 0,t:void 0,a:void 0,o:void 0}),t})();delegateEvents(["pointerdown"]);var _tmpl$$1=template("<div><div><div id=viewer></div><div><svg><g>"),_tmpl$2$1=template('<svg><foreignObject class=drop-shadow-lg x=0 y=0><div class="bg-slate-700/25 shadow-2xl h-full w-full rounded-full"></svg>',!1,!0);const Toolbar=lazy(()=>__vitePreload(()=>import("./toolbar-1Gd19jM3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),LayerPreview=lazy(()=>__vitePreload(()=>import("./index-DHzqgZ2T.js"),__vite__mapDeps([13,5,1,2,7,8,9,10,11,12]))),SelectionBox=lazy(()=>__vitePreload(()=>import("./index-BwCgLK3d.js"),__vite__mapDeps([14,1,2,5,15,7,8,9,10,11,12]))),SelectionTools=lazy(()=>__vitePreload(()=>import("./index-wA7Efter.js"),__vite__mapDeps([16,1,2,5,6,15,17,18,4,19,7,8,9,10,11,12]))),PDFPageViewer=we=>{const{setViewRef:t,pdfDocument:le,documentState:p}=usePDFViewer(),[M,{setLayerState:Me,history:J}]=usePDFStoreContext();let F;const[D,g]=createSignal(),r=createElementSize(D),[j,I]=createSignal({x:0,y:0});let f;const[h,w]=createSignal([]),[E,y]=createSignal(),[_,x]=createStore({mode:CanvasMode.None}),[S,n]=createSignal({r:38,g:38,b:38,a:1}),i=()=>{if(F){const P=F.getBoundingClientRect();y(y),I(Ce=>({...Ce,x:P.x,y:P.y}))}},s=(P,Ce)=>{M.layersState.layerIds.length>=MAX_LAYER||(J.pause(),batch(()=>{const W=uuid(),d={type:P,x:Ce.x,y:Ce.y,width:100,height:100,fill:{...S()},value:_.value||""};P===LayerType.Comment&&(d.width=25,d.height=25),Me(["layerIds",M.layersState.layerIds.length.toString()],W),Me(["layers",W],d),P===LayerType.Comment&&Me(["selectionLayerIds"],[W]),x("mode",CanvasMode.None)}),J.resume())};createEffect(()=>{r.width&&r.height&&(le&&(p.scaleValue==="auto"||p.scaleValue==="page-fit"||p.scaleValue==="page-width")&&(le.viewer.currentScaleValue=p.scaleValue),le==null||le.viewer.update()),i()});const c=P=>{if(_.mode==CanvasMode.Inserting)return;batch(()=>{Me(["selectionLayerIds"],[]),i()});const Ce=pointerEventToCanvasPoint(P,j());_.mode===CanvasMode.Eraser?w([Ce]):_.mode===CanvasMode.Pencil&&O(Ce,P.pressure)},v=(P,Ce)=>{if(_.mode===CanvasMode.Pencil||_.mode===CanvasMode.Inserting||_.mode===CanvasMode.Hightlight||_.mode===CanvasMode.Eraser)return;i();const W=pointerEventToCanvasPoint(P,j());P.stopPropagation(),M.layersState.layerIds.includes(Ce)&&(J.pause(),batch(()=>{Me(["selectionLayerIds","0"],Ce),x({mode:CanvasMode.Translating,current:W})}))},z=P=>{if(_.mode===CanvasMode.Inserting){i();const Ce=pointerEventToCanvasPoint(P,j());s(_.layerType,Ce)}else _.mode==CanvasMode.Eraser?(f&&clearTimeout(f),w([])):_.mode===CanvasMode.Pencil?T():(CanvasMode.Translating&&J.resume(),x({mode:CanvasMode.None}))},u=()=>{var Ce;if(_.mode!=CanvasMode.Hightlight)return;i();const P=getSelectionRects(j(),p.scale);if(P.listRects.length){const W=uuid(),d={type:LayerType.Highlight,x:P.bounds.x,y:P.bounds.y,width:P.bounds.width,height:P.bounds.height,fill:S().r===38&&S().g===38&&S().b===38?{r:255,g:255,b:0,a:.2}:{...S(),a:.2},rects:P.listRects};J.pause(),batch(()=>{Me(["layerIds",M.layersState.layerIds.length.toString()],W),Me(["layers",W],d)}),J.resume()}(Ce=window==null?void 0:window.getSelection())==null||Ce.removeAllRanges()},N=P=>{if(P.preventDefault(),_.mode!==CanvasMode.Translating&&_.mode!==CanvasMode.Eraser&&_.mode!==CanvasMode.Resizing&&_.mode!==CanvasMode.Pencil)return;i();const Ce=pointerEventToCanvasPoint(P,j());_.mode==CanvasMode.Translating?re(Ce):_.mode===CanvasMode.Eraser&&h().length?(w([...h().reverse().slice(0,50).reverse(),Ce]),f=setTimeout(()=>{w(W=>(W.length&&W.shift(),W.map(d=>({...d,y:d.y+1}))))},2500/(h().length+1))):_.mode==CanvasMode.Resizing?oe(Ce):_.mode===CanvasMode.Pencil&&Ee(Ce,P)},re=P=>{if(_.mode!==CanvasMode.Translating)return;const Ce={x:P.x-_.current.x,y:P.y-_.current.y};batch(()=>{for(const W of M.layersState.selectionLayerIds){const d=M.layersState.layers[W];d&&d.type!==LayerType.Highlight&&(Me(["layers",W,"x"],m=>Math.max(m+Ce.x,BORDERWIDTH+2)),Me(["layers",W,"y"],m=>Math.max(m+Ce.y,BORDERWIDTH+2)))}x({mode:CanvasMode.Translating,current:P})})},Q=P=>{I(Ce=>({x:Ce.x+P.deltaX,y:Ce.y+P.deltaY}))},oe=P=>{if(_.mode!==CanvasMode.Resizing)return;const Ce=resizeBounds(_.initialBounds,_.corner,P),W=M.layersState.selectionLayerIds[0];W&&M.layersState.layers[W]&&(J.pause(),batch(()=>{Me(["layers",W,"x"],Ce.x),Me(["layers",W,"y"],Ce.y),Me(["layers",W,"width"],Ce.width),Me(["layers",W,"height"],Ce.height)}),J.resume())},fe=(P,Ce)=>{x({mode:CanvasMode.Resizing,initialBounds:Ce,corner:P})},O=(P,Ce)=>{batch(()=>{Me(["penColor"],{...S()}),Me(["pencilDraft"],[[P.x,P.y,Ce]])})},Ee=(P,Ce)=>{_.mode!==CanvasMode.Pencil||Ce.buttons!==1||!M.layersState.pencilDraft||!M.layersState.pencilDraft.length||Me(["pencilDraft"],W=>[...W,[P.x,P.y,Ce.pressure]])},T=()=>{J.pause();const P=M.layersState.pencilDraft;if(P==null||P.length<2||M.layersState.layerIds.length>=MAX_LAYER){Me(["pencilDraft"],null);return}batch(()=>{const Ce=uuid();Me(["layers",Ce],penPointsToPathLayer(P,{...S()})),Me(["layerIds",M.layersState.layerIds.length.toString()],Ce),Me(["pencilDraft"],null),x({mode:CanvasMode.Pencil})}),J.resume()};return onMount(()=>{F&&F.addEventListener("wheel",Q,{passive:!0})}),(()=>{var P=_tmpl$$1(),Ce=P.firstChild,W=Ce.firstChild,d=W.nextSibling,m=d.firstChild,k=m.firstChild;use(ve=>{t(ve),g(ve)},Ce),Ce.style.setProperty("position","absolute"),W.$$pointerup=u,insert(d,createComponent(SelectionTools,{get camera(){return j()},get lastUsedColor(){return S()},setLastUsedColor:n}),m),m.$$pointermove=N,m.$$pointerup=z,m.$$pointerdown=c;var ye=F;return typeof ye=="function"?use(ye,m):F=m,insert(k,createComponent(For,{get each(){return M.layersState.layerIds},children:ve=>createComponent(LayerPreview,{id:ve,onLayerPointerDown:v,selectionColor:"#0000ff"})}),null),insert(k,createComponent(SelectionBox,{onResizeHandlePointerDown:fe}),null),insert(k,createComponent(Show,{get when(){return h().length},get children(){return createComponent(For,{get each(){return h()},children:(ve,X)=>(()=>{var Se=_tmpl$2$1();return createRenderEffect(Re=>{var Ne=`translate(${ve.x-3}px, ${ve.y+3}px)`,He=Math.min(X()+1,20),ze=Math.min(X()+1,20);return Ne!==Re.e&&((Re.e=Ne)!=null?Se.style.setProperty("transform",Ne):Se.style.removeProperty("transform")),He!==Re.t&&setAttribute(Se,"width",Re.t=He),ze!==Re.a&&setAttribute(Se,"height",Re.a=ze),Re},{e:void 0,t:void 0,a:void 0}),Se})()})}}),null),insert(k,(()=>{var ve=createMemo(()=>M.layersState.pencilDraft!=null&&M.layersState.pencilDraft.length>0);return()=>ve()&&createComponent(LayerPath,{get points(){return M.layersState.pencilDraft},get fill(){return colorToCss(S())},x:0,y:0})})(),null),insert(P,createComponent(Toolbar,{canvasState:_,setCanvasState:x}),null),createRenderEffect(ve=>{var X=cn("relative w-full h-full canvas-pdf-annotate bg-fixed overflow-auto",we.class),Se=cn("left-1/2 -translate-x-1/2",we.canEdit&&"touch-none",_.mode===CanvasMode.Eraser&&"!cursor-[var(--cursor-icon-eraser)]"),Re=cn("pdfViewer"),Ne=cn("absolute top-0 left-0 h-full w-full z-[2]",_.mode===CanvasMode.Hightlight&&"touch-none z-0",_.mode===CanvasMode.Inserting&&(_.layerType===LayerType.Text||_.layerType===LayerType.Sticker)&&"cursor-[var(--cursor-icon-add-text)]",_.mode===CanvasMode.Inserting&&_.layerType==LayerType.Comment&&"cursor-[var(--cursor-icon-comment)]",_.mode===CanvasMode.Inserting&&_.layerType==LayerType.Rectangle&&"cursor-[var(--cursor-icon-rectangle)]",_.mode===CanvasMode.Eraser&&"!cursor-[var(--cursor-icon-eraser)]",_.mode===CanvasMode.Pencil&&"!cursor-[var(--cursor-icon-pencil)]"),He=cn("h-full w-full");return X!==ve.e&&className(P,ve.e=X),Se!==ve.t&&className(Ce,ve.t=Se),Re!==ve.a&&className(W,ve.a=Re),Ne!==ve.o&&className(d,ve.o=Ne),He!==ve.i&&setAttribute(m,"class",ve.i=He),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P})()};delegateEvents(["pointerup","pointerdown","pointermove"]);var _tmpl$=template('<div class="flex flex-col items-center">'),_tmpl$2=template("<div>");function PDFAnnotateTry(){const we=useParams(),[t,le]=useLocalStorage({key:we.sessionId,defaultValue:{pdfData:"",annotation:[]}});return[createComponent(Show,{get when(){return!t().pdfData},get children(){return createComponent(Container,{get children(){return[createComponent(Heading,{children:"PDF Annotate"}),(()=>{var p=_tmpl$();return insert(p,createComponent(FileUpload,{}),null),insert(p,createComponent(Button,{onClick:()=>{le({pdfData:"https://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf",annotation:[]})},class:"items-center gap-1 group/button rounded-full focus:outline-none transition ring-offset-gray-900 bg-gray-800 text-white shadow-lg shadow-black/20 sm:backdrop-blur-sm group-hover/button:bg-gray-50/15 group-hover/button:scale-105 focus-visible:ring-1 focus-visible:ring-offset-2 ring-gray-50/60 text-xs font-medium px-4 py-2 mt-auto origin-left",children:"Using Sample pdf"}),null),p})()]}})}}),createComponent(Show,{get when(){return t().pdfData},get children(){var p=_tmpl$2();return insert(p,createComponent(PDViewerProvider,{get pdfUrl(){return t().pdfData},get initialAnnotation(){return t().annotation||[]},onUpdate:M=>localStorage.setItem(we.sessionId,JSON.stringify({pdfData:t().pdfData,annotation:M})),get children(){return createComponent(PDFPageViewer,{class:"bg-neutral-100 shadow rounded smoth-scroll"})}})),createRenderEffect(()=>className(p,cn("relative overflow-y-hidden p-5 rounded h-[calc(100vh-10px)] smoth-scroll"))),p}})]}const pdfAnnotateTry=Object.freeze(Object.defineProperty({__proto__:null,default:PDFAnnotateTry},Symbol.toStringTag,{value:"Module"}));export{LayerPath as L,pdfAnnotateTry as p,usePDFStoreContext as u};
