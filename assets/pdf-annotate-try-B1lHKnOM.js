const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/toolbar-CvegUleh.js","assets/index-DhydKnRP.js","assets/index-8ZkMxoGC.css","assets/button-DOW7-XBW.js","assets/container-C3qi2OK9.js","assets/animate.es-CJ9iIyw4.js","assets/velocity.es-CI47LKMS.js","assets/use-local-storage-CH-ZvHM0.js","assets/index-q2OQhd4T.js","assets/index-CNdpZk6j.js","assets/use-selection-bouds-CJIWiPAm.js","assets/index-CphTHXtg.js"])))=>i.map(i=>d[i]);
var cr=Object.defineProperty;var On=i=>{throw TypeError(i)};var hr=(i,e,v)=>e in i?cr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[e]=v;var at=(i,e,v)=>hr(i,typeof e!="symbol"?e+"":e,v),xi=(i,e,v)=>e.has(i)||On("Cannot "+v);var t=(i,e,v)=>(xi(i,e,"read from private field"),v?v.call(i):e.get(i)),Me=(i,e,v)=>e.has(i)?On("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,v),Ce=(i,e,v,n)=>(xi(i,e,"write to private field"),n?n.call(i,v):e.set(i,v),v),ne=(i,e,v)=>(xi(i,e,"access private method"),v);var Ot=(i,e,v,n)=>({set _(d){Ce(i,e,d,v)},get _(){return t(i,e,n)}});import{$ as $PROXY,C as $TRACK,E as getListener,G as batch,f as createSignal,J as time,B as noopReturn,K as getUnitConverter,L as transformDefinitions,N as getStyleName,y as isNumber$1,x as isString$1,O as isObject,l as untrack,P as accessWith,m as mergeProps,g as createEffect,e as splitProps,c as createComponent,D as Dynamic,k as createMemo,Q as mergeRefs,j as delegateEvents,i as insert,R as IconUpload,a as createRenderEffect,d as className,b as cn,S as Show,t as template,u as use,T as createMicrotask,U as createRoot,p as useContext,n as createContext,o as onMount,V as sharedConfig,W as onCleanup,s as setAttribute,X as lazy,Y as __vitePreload,F as For,q as useParams,H as Heading}from"./index-DhydKnRP.js";import{C as Container}from"./container-C3qi2OK9.js";import{a as animate}from"./animate.es-CJ9iIyw4.js";import{v as velocityPerSecond}from"./velocity.es-CI47LKMS.js";import{u as useLocalStorage}from"./use-local-storage-CH-ZvHM0.js";const $RAW=Symbol("store-raw"),$NODE=Symbol("store-node"),$HAS=Symbol("store-has"),$SELF=Symbol("store-self");function wrap$1(i){let e=i[$PROXY];if(!e&&(Object.defineProperty(i,$PROXY,{value:e=new Proxy(i,proxyTraps$1)}),!Array.isArray(i))){const v=Object.keys(i),n=Object.getOwnPropertyDescriptors(i);for(let d=0,re=v.length;d<re;d++){const O=v[d];n[O].get&&Object.defineProperty(i,O,{enumerable:n[O].enumerable,get:n[O].get.bind(e)})}}return e}function isWrappable(i){let e;return i!=null&&typeof i=="object"&&(i[$PROXY]||!(e=Object.getPrototypeOf(i))||e===Object.prototype||Array.isArray(i))}function unwrap(i,e=new Set){let v,n,d,re;if(v=i!=null&&i[$RAW])return v;if(!isWrappable(i)||e.has(i))return i;if(Array.isArray(i)){Object.isFrozen(i)?i=i.slice(0):e.add(i);for(let O=0,w=i.length;O<w;O++)d=i[O],(n=unwrap(d,e))!==d&&(i[O]=n)}else{Object.isFrozen(i)?i=Object.assign({},i):e.add(i);const O=Object.keys(i),w=Object.getOwnPropertyDescriptors(i);for(let E=0,p=O.length;E<p;E++)re=O[E],!w[re].get&&(d=i[re],(n=unwrap(d,e))!==d&&(i[re]=n))}return i}function getNodes(i,e){let v=i[e];return v||Object.defineProperty(i,e,{value:v=Object.create(null)}),v}function getNode(i,e,v){if(i[e])return i[e];const[n,d]=createSignal(v,{equals:!1,internal:!0});return n.$=d,i[e]=n}function proxyDescriptor$1(i,e){const v=Reflect.getOwnPropertyDescriptor(i,e);return!v||v.get||!v.configurable||e===$PROXY||e===$NODE||(delete v.value,delete v.writable,v.get=()=>i[$PROXY][e]),v}function trackSelf(i){getListener()&&getNode(getNodes(i,$NODE),$SELF)()}function ownKeys(i){return trackSelf(i),Reflect.ownKeys(i)}const proxyTraps$1={get(i,e,v){if(e===$RAW)return i;if(e===$PROXY)return v;if(e===$TRACK)return trackSelf(i),v;const n=getNodes(i,$NODE),d=n[e];let re=d?d():i[e];if(e===$NODE||e===$HAS||e==="__proto__")return re;if(!d){const O=Object.getOwnPropertyDescriptor(i,e);getListener()&&(typeof re!="function"||i.hasOwnProperty(e))&&!(O&&O.get)&&(re=getNode(n,e,re)())}return isWrappable(re)?wrap$1(re):re},has(i,e){return e===$RAW||e===$PROXY||e===$TRACK||e===$NODE||e===$HAS||e==="__proto__"?!0:(getListener()&&getNode(getNodes(i,$HAS),e)(),e in i)},set(){return!0},deleteProperty(){return!0},ownKeys,getOwnPropertyDescriptor:proxyDescriptor$1};function setProperty(i,e,v,n=!1){if(!n&&i[e]===v)return;const d=i[e],re=i.length;v===void 0?(delete i[e],i[$HAS]&&i[$HAS][e]&&d!==void 0&&i[$HAS][e].$()):(i[e]=v,i[$HAS]&&i[$HAS][e]&&d===void 0&&i[$HAS][e].$());let O=getNodes(i,$NODE),w;if((w=getNode(O,e,d))&&w.$(()=>v),Array.isArray(i)&&i.length!==re){for(let E=i.length;E<re;E++)(w=O[E])&&w.$();(w=getNode(O,"length",re))&&w.$(i.length)}(w=O[$SELF])&&w.$()}function mergeStoreNode(i,e){const v=Object.keys(e);for(let n=0;n<v.length;n+=1){const d=v[n];setProperty(i,d,e[d])}}function updateArray(i,e){if(typeof e=="function"&&(e=e(i)),e=unwrap(e),Array.isArray(e)){if(i===e)return;let v=0,n=e.length;for(;v<n;v++){const d=e[v];i[v]!==d&&setProperty(i,v,d)}setProperty(i,"length",n)}else mergeStoreNode(i,e)}function updatePath(i,e,v=[]){let n,d=i;if(e.length>1){n=e.shift();const O=typeof n,w=Array.isArray(i);if(Array.isArray(n)){for(let E=0;E<n.length;E++)updatePath(i,[n[E]].concat(e),v);return}else if(w&&O==="function"){for(let E=0;E<i.length;E++)n(i[E],E)&&updatePath(i,[E].concat(e),v);return}else if(w&&O==="object"){const{from:E=0,to:p=i.length-1,by:r=1}=n;for(let H=E;H<=p;H+=r)updatePath(i,[H].concat(e),v);return}else if(e.length>1){updatePath(i[n],e,[n].concat(v));return}d=i[n],v=[n].concat(v)}let re=e[0];typeof re=="function"&&(re=re(d,v),re===d)||n===void 0&&re==null||(re=unwrap(re),n===void 0||isWrappable(d)&&isWrappable(re)&&!Array.isArray(re)?mergeStoreNode(d,re):setProperty(i,n,re))}function createStore(...[i,e]){const v=unwrap(i||{}),n=Array.isArray(v),d=wrap$1(v);function re(...O){batch(()=>{n&&O.length===1?updateArray(v,O[0]):updatePath(v,O)})}return[d,re]}const sampleT=5;function calcGeneratorVelocity(i,e,v){const n=Math.max(e-sampleT,0);return velocityPerSecond(v-i(n),e-n)}const defaults={stiffness:100,damping:10,mass:1},calcDampingRatio=(i=defaults.stiffness,e=defaults.damping,v=defaults.mass)=>e/(2*Math.sqrt(i*v));function hasReachedTarget(i,e,v){return i<e&&v>=e||i>e&&v<=e}const spring$1=({stiffness:i=defaults.stiffness,damping:e=defaults.damping,mass:v=defaults.mass,from:n=0,to:d=1,velocity:re=0,restSpeed:O,restDistance:w}={})=>{re=re?time.s(re):0;const E={done:!1,hasReachedTarget:!1,current:n,target:d},p=d-n,r=Math.sqrt(i/v)/1e3,H=calcDampingRatio(i,e,v),N=Math.abs(p)<5;O||(O=N?.01:2),w||(w=N?.005:.5);let g;if(H<1){const u=r*Math.sqrt(1-H*H);g=M=>d-Math.exp(-H*r*M)*((-re+H*r*p)/u*Math.sin(u*M)+p*Math.cos(u*M))}else g=u=>d-Math.exp(-r*u)*(p+(-re+r*p)*u);return u=>{E.current=g(u);const M=u===0?re:calcGeneratorVelocity(g,u,E.current),P=Math.abs(M)<=O,x=Math.abs(d-E.current)<=w;return E.done=P&&x,E.hasReachedTarget=hasReachedTarget(n,d,E.current),E}},timeStep=10,maxDuration=1e4;function pregenerateKeyframes(i,e=noopReturn){let v,n=timeStep,d=i(0);const re=[e(d.current)];for(;!d.done&&n<maxDuration;)d=i(n),re.push(e(d.done?d.target:d.current)),v===void 0&&d.hasReachedTarget&&(v=n),n+=timeStep;const O=n-timeStep;return re.length===1&&re.push(d.current),{keyframes:re,duration:O/1e3,overshootDuration:(v??O)/1e3}}function canGenerate(i){return isNumber$1(i)&&!isNaN(i)}function getAsNumber(i){return isString$1(i)?parseFloat(i):i}function createGeneratorEasing(i){const e=new WeakMap;return(v={})=>{const n=new Map,d=(O=0,w=100,E=0,p=!1)=>{const r=`${O}-${w}-${E}-${p}`;return n.has(r)||n.set(r,i(Object.assign({from:O,to:w,velocity:E},v))),n.get(r)},re=(O,w)=>(e.has(O)||e.set(O,pregenerateKeyframes(O,w)),e.get(O));return{createAnimation:(O,w=!0,E,p,r)=>{let H,N,g,u=0,M=noopReturn;const P=O.length;if(w){M=getUnitConverter(O,p?transformDefinitions.get(getStyleName(p)):void 0);const x=O[P-1];if(g=getAsNumber(x),P>1&&O[0]!==null)N=getAsNumber(O[0]);else{const S=r==null?void 0:r.generator;if(S){const{animation:F,generatorStartTime:I}=r,o=(F==null?void 0:F.startTime)||I||0,s=(F==null?void 0:F.currentTime)||performance.now()-o,c=S(s).current;N=c,u=calcGeneratorVelocity(f=>S(f).current,s,c)}else E&&(N=getAsNumber(E()))}}if(canGenerate(N)&&canGenerate(g)){const x=d(N,g,u,p==null?void 0:p.includes("scale"));H=Object.assign(Object.assign({},re(x,M)),{easing:"linear"}),r&&(r.generator=x,r.generatorStartTime=performance.now())}return H||(H={easing:"ease",duration:re(d(0,100)).overshootDuration}),H}}}}const spring=createGeneratorEasing(spring$1);function createStaticStore(i){const e={...i},v={...i},n={},d=O=>{let w=n[O];if(!w){if(!getListener())return e[O];n[O]=w=createSignal(e[O],{internal:!0}),delete e[O]}return w[0]()};for(const O in i)Object.defineProperty(v,O,{get:()=>d(O),enumerable:!0});const re=(O,w)=>{const E=n[O];if(E)return E[1](w);O in e&&(e[O]=accessWith(w,[e[O]]))};return[v,(O,w)=>{if(isObject(O)){const E=untrack(()=>Object.entries(accessWith(O,v)));batch(()=>{for(const[p,r]of E)re(p,()=>r)})}else re(O,w);return v}]}function addItemToArray(i,e,v=-1){return v in i?[...i.slice(0,v),e,...i.slice(v)]:[...i,e]}function removeItemFromArray(i,e){const v=[...i],n=v.indexOf(e);return n!==-1&&v.splice(n,1),v}function isNumber(i){return typeof i=="number"}function isString(i){return Object.prototype.toString.call(i)==="[object String]"}function isFunction(i){return typeof i=="function"}function createGenerateId(i){return e=>`${i()}-${e}`}function contains(i,e){return i?i===e||i.contains(e):!1}function getActiveElement(i,e=!1){const{activeElement:v}=getDocument(i);if(!(v!=null&&v.nodeName))return null;if(isFrame(v)&&v.contentDocument)return getActiveElement(v.contentDocument.body,e);if(e){const n=v.getAttribute("aria-activedescendant");if(n){const d=getDocument(v).getElementById(n);if(d)return d}}return v}function getWindow(i){return getDocument(i).defaultView||window}function getDocument(i){return i?i.ownerDocument||i:document}function isFrame(i){return i.tagName==="IFRAME"}var EventKey=(i=>(i.Escape="Escape",i.Enter="Enter",i.Tab="Tab",i.Space=" ",i.ArrowDown="ArrowDown",i.ArrowLeft="ArrowLeft",i.ArrowRight="ArrowRight",i.ArrowUp="ArrowUp",i.End="End",i.Home="Home",i.PageDown="PageDown",i.PageUp="PageUp",i))(EventKey||{});function testPlatform(i){var e;return typeof window<"u"&&window.navigator!=null?i.test(((e=window.navigator.userAgentData)==null?void 0:e.platform)||window.navigator.platform):!1}function isMac(){return testPlatform(/^Mac/i)}function isIPhone(){return testPlatform(/^iPhone/i)}function isIPad(){return testPlatform(/^iPad/i)||isMac()&&navigator.maxTouchPoints>1}function isIOS(){return isIPhone()||isIPad()}function isAppleDevice(){return isMac()||isIOS()}function callHandler(i,e){return e&&(isFunction(e)?e(i):e[0](e[1],i)),i==null?void 0:i.defaultPrevented}function composeEventHandlers(i){return e=>{for(const v of i)callHandler(e,v)}}function isCtrlKey(i){return isMac()?i.metaKey&&!i.ctrlKey:i.ctrlKey&&!i.metaKey}function focusWithoutScrolling(i){if(i)if(supportsPreventScroll())i.focus({preventScroll:!0});else{const e=getScrollableElements(i);i.focus(),restoreScrollPosition(e)}}var supportsPreventScrollCached=null;function supportsPreventScroll(){if(supportsPreventScrollCached==null){supportsPreventScrollCached=!1;try{document.createElement("div").focus({get preventScroll(){return supportsPreventScrollCached=!0,!0}})}catch{}}return supportsPreventScrollCached}function getScrollableElements(i){let e=i.parentNode;const v=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&v.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&v.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),v}function restoreScrollPosition(i){for(const{element:e,scrollTop:v,scrollLeft:n}of i)e.scrollTop=v,e.scrollLeft=n}var focusableElements=["input:not([type='hidden']):not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","[tabindex]","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]:not([contenteditable='false'])"],tabbableElements=[...focusableElements,'[tabindex]:not([tabindex="-1"]):not([disabled])'],FOCUSABLE_ELEMENT_SELECTOR=`${focusableElements.join(":not([hidden]),")},[tabindex]:not([disabled]):not([hidden])`,TABBABLE_ELEMENT_SELECTOR=tabbableElements.join(':not([hidden]):not([tabindex="-1"]),');function getAllTabbableIn(i,e){const n=Array.from(i.querySelectorAll(FOCUSABLE_ELEMENT_SELECTOR)).filter(isTabbable);return e&&isTabbable(i)&&n.unshift(i),n.forEach((d,re)=>{if(isFrame(d)&&d.contentDocument){const O=d.contentDocument.body,w=getAllTabbableIn(O,!1);n.splice(re,1,...w)}}),n}function isTabbable(i){return isFocusable(i)&&!hasNegativeTabIndex(i)}function isFocusable(i){return i.matches(FOCUSABLE_ELEMENT_SELECTOR)&&isElementVisible(i)}function hasNegativeTabIndex(i){return Number.parseInt(i.getAttribute("tabindex")||"0",10)<0}function isElementVisible(i,e){return i.nodeName!=="#comment"&&isStyleVisible(i)&&isAttributeVisible(i,e)&&(!i.parentElement||isElementVisible(i.parentElement,i))}function isStyleVisible(i){if(!(i instanceof HTMLElement)&&!(i instanceof SVGElement))return!1;const{display:e,visibility:v}=i.style;let n=e!=="none"&&v!=="hidden"&&v!=="collapse";if(n){if(!i.ownerDocument.defaultView)return n;const{getComputedStyle:d}=i.ownerDocument.defaultView,{display:re,visibility:O}=d(i);n=re!=="none"&&O!=="hidden"&&O!=="collapse"}return n}function isAttributeVisible(i,e){return!i.hasAttribute("hidden")&&(i.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?i.hasAttribute("open"):!0)}function getFocusableTreeWalker(i,e,v){const n=e!=null&&e.tabbable?TABBABLE_ELEMENT_SELECTOR:FOCUSABLE_ELEMENT_SELECTOR,d=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode(re){var O;return(O=e==null?void 0:e.from)!=null&&O.contains(re)?NodeFilter.FILTER_REJECT:re.matches(n)&&isElementVisible(re)&&!v&&(!(e!=null&&e.accept)||e.accept(re))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(d.currentNode=e.from),d}function getScrollParent(i){let e=i;for(;e&&!isScrollable(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}function isScrollable(i){const e=window.getComputedStyle(i);return/(auto|scroll)/.test(e.overflow+e.overflowX+e.overflowY)}function noop(){}function getEventPoint(i){return[i.clientX,i.clientY]}function isPointInPolygon(i,e){const[v,n]=i;let d=!1;const re=e.length;for(let O=re,w=0,E=O-1;w<O;E=w++){const[p,r]=e[w],[H,N]=e[E],[,g]=e[E===0?O-1:E-1]||[0,0],u=(r-N)*(v-p)-(p-H)*(n-r);if(N<r){if(n>=N&&n<r){if(u===0)return!0;u>0&&(n===N?n>g&&(d=!d):d=!d)}}else if(r<N){if(n>r&&n<=N){if(u===0)return!0;u<0&&(n===N?n<g&&(d=!d):d=!d)}}else if(n===r&&(v>=H&&v<=p||v>=p&&v<=H))return!0}return d}function mergeDefaultProps(i,e){return mergeProps(i,e)}var transitionsByElement=new Map,transitionCallbacks=new Set;function setupGlobalEvents(){if(typeof window>"u")return;const i=v=>{if(!v.target)return;let n=transitionsByElement.get(v.target);n||(n=new Set,transitionsByElement.set(v.target,n),v.target.addEventListener("transitioncancel",e)),n.add(v.propertyName)},e=v=>{if(!v.target)return;const n=transitionsByElement.get(v.target);if(n&&(n.delete(v.propertyName),n.size===0&&(v.target.removeEventListener("transitioncancel",e),transitionsByElement.delete(v.target)),transitionsByElement.size===0)){for(const d of transitionCallbacks)d();transitionCallbacks.clear()}};document.body.addEventListener("transitionrun",i),document.body.addEventListener("transitionend",e)}typeof document<"u"&&(document.readyState!=="loading"?setupGlobalEvents():document.addEventListener("DOMContentLoaded",setupGlobalEvents));function scrollIntoView(i,e){const v=relativeOffset(i,e,"left"),n=relativeOffset(i,e,"top"),d=e.offsetWidth,re=e.offsetHeight;let O=i.scrollLeft,w=i.scrollTop;const E=O+i.offsetWidth,p=w+i.offsetHeight;v<=O?O=v:v+d>E&&(O+=v+d-E),n<=w?w=n:n+re>p&&(w+=n+re-p),i.scrollLeft=O,i.scrollTop=w}function relativeOffset(i,e,v){const n=v==="left"?"offsetLeft":"offsetTop";let d=0;for(;e.offsetParent&&(d+=e[n],e.offsetParent!==i);){if(e.offsetParent.contains(i)){d-=i[n];break}e=e.offsetParent}return d}function scrollIntoViewport(i,e){var v,n;if(document.contains(i)){const d=document.scrollingElement||document.documentElement;if(window.getComputedStyle(d).overflow==="hidden"){let O=getScrollParent(i);for(;i&&O&&i!==d&&O!==d;)scrollIntoView(O,i),i=O,O=getScrollParent(i)}else{const{left:O,top:w}=i.getBoundingClientRect();(v=i==null?void 0:i.scrollIntoView)==null||v.call(i,{block:"nearest"});const{left:E,top:p}=i.getBoundingClientRect();(Math.abs(O-E)>1||Math.abs(w-p)>1)&&((n=i.scrollIntoView)==null||n.call(i,{block:"nearest"}))}}}var visuallyHiddenStyles={border:"0",clip:"rect(0 0 0 0)","clip-path":"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:"0",position:"absolute",width:"1px","white-space":"nowrap"};function createTagName(i,e){const[v,n]=createSignal(stringOrUndefined(e==null?void 0:e()));return createEffect(()=>{var d;n(((d=i())==null?void 0:d.tagName.toLowerCase())||stringOrUndefined(e==null?void 0:e()))}),v}function stringOrUndefined(i){return isString(i)?i:void 0}function Polymorphic(i){const[e,v]=splitProps(i,["as"]);if(!e.as)throw new Error("[kobalte]: Polymorphic is missing the required `as` prop.");return createComponent(Dynamic,mergeProps(v,{get component(){return e.as}}))}var __defProp=Object.defineProperty,__export=(i,e)=>{for(var v in e)__defProp(i,v,{get:e[v],enumerable:!0})},button_exports={};__export(button_exports,{Button:()=>Button,Root:()=>ButtonRoot});var BUTTON_INPUT_TYPES=["button","color","file","image","reset","submit"];function isButton(i){const e=i.tagName.toLowerCase();return e==="button"?!0:e==="input"&&i.type?BUTTON_INPUT_TYPES.indexOf(i.type)!==-1:!1}function ButtonRoot(i){let e;const v=mergeDefaultProps({type:"button"},i),[n,d]=splitProps(v,["ref","type","disabled"]),re=createTagName(()=>e,()=>"button"),O=createMemo(()=>{const p=re();return p==null?!1:isButton({tagName:p,type:n.type})}),w=createMemo(()=>re()==="input"),E=createMemo(()=>re()==="a"&&(e==null?void 0:e.getAttribute("href"))!=null);return createComponent(Polymorphic,mergeProps({as:"button",ref(p){var r=mergeRefs(H=>e=H,n.ref);typeof r=="function"&&r(p)},get type(){return O()||w()?n.type:void 0},get role(){return!O()&&!E()?"button":void 0},get tabIndex(){return!O()&&!E()&&!n.disabled?0:void 0},get disabled(){return O()||w()?n.disabled:void 0},get"aria-disabled"(){return!O()&&!w()&&n.disabled?!0:void 0},get"data-disabled"(){return n.disabled?"":void 0}},d))}var Button=ButtonRoot,_tmpl$$3=template("<div id=file-upload>"),_tmpl$2$2=template('<div class="absolute group-hover/file:opacity-100 opacity-0 border border-dashed border-sky-400 inset-0 z-30 bg-transparent flex items-center justify-center h-32 mt-4 w-full max-w-[8rem] mx-auto rounded-md">'),_tmpl$3=template('<div class=w-full><div class="p-10 group/file block rounded-lg cursor-pointer w-full relative overflow-hidden"><div class="flex flex-col items-center justify-center"><p class="relative z-20 font-sans font-bold text-neutral-700 dark:text-neutral-300 text-base">Upload file</p><p class="relative z-20 font-sans font-normal text-neutral-400 dark:text-neutral-400 text-base mt-2">Drag or drop your files here or click to upload</p></div><div class="relative w-full mt-10 max-w-xl mx-auto">');const mainVariant={intial:{x:[null,0],y:[null,0],opacity:[null,1]},animate:{x:[null,20],y:[null,-20],opacity:[null,.9]},transition:{easing:spring({stiffness:300,damping:20})}},FileUpload=()=>{let i;const[e,v]=createSignal([]),n=(d=!1)=>{d?animate(i,mainVariant.intial):animate(i,mainVariant.animate,mainVariant.transition)};return(()=>{var d=_tmpl$3(),re=d.firstChild,O=re.firstChild,w=O.nextSibling;return re.addEventListener("mouseleave",()=>n(!0)),re.addEventListener("mouseenter",()=>n()),re.$$click=()=>{},insert(w,createComponent(Show,{get when(){return!e().length},get children(){return[(()=>{var E=_tmpl$$3(),p=i;return typeof p=="function"?use(p,E):i=E,insert(E,createComponent(IconUpload,{class:"h-4 w-4 text-neutral-600 dark:text-neutral-300"})),createRenderEffect(()=>className(E,cn("relative group-hover/file:shadow-2xl z-40 bg-white dark:bg-neutral-900 flex items-center justify-center h-32 mt-4 w-full max-w-[8rem] mx-auto rounded-md","shadow-[0px_10px_50px_rgba(0,0,0,0.1)]"))),E})(),_tmpl$2$2()]}})),d})()};delegateEvents(["click"]);var LayerType=(i=>(i[i.Highlight=0]="Highlight",i[i.Path=1]="Path",i[i.Text=2]="Text",i[i.Comment=3]="Comment",i[i.Rectangle=4]="Rectangle",i[i.Sticker=5]="Sticker",i))(LayerType||{}),Side=(i=>(i[i.Top=1]="Top",i[i.Bottom=2]="Bottom",i[i.Left=4]="Left",i[i.Right=8]="Right",i))(Side||{}),CanvasMode=(i=>(i[i.None=0]="None",i[i.Pressing=1]="Pressing",i[i.SelectionNet=2]="SelectionNet",i[i.Translating=3]="Translating",i[i.Inserting=4]="Inserting",i[i.Resizing=5]="Resizing",i[i.Pencil=6]="Pencil",i[i.Hightlight=7]="Hightlight",i[i.Eraser=8]="Eraser",i))(CanvasMode||{});const MAX_LAYER=500,RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},TextLayerMode={DISABLE:0,ENABLE:1},ScrollMode={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},SpreadMode={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function getPageSizeInches({view:i,userUnit:e,rotate:v}){const[n,d,re,O]=i,w=v%180!==0,E=(re-n)/72*e,p=(O-d)/72*e;return{width:w?p:E,height:w?E:p}}function normalizeWheelEventDirection(i){let e=Math.hypot(i.deltaX,i.deltaY);const v=Math.atan2(i.deltaY,i.deltaX);return-.25*Math.PI<v&&v<.75*Math.PI&&(e=-e),e}function normalizeWheelEventDelta(i){const e=i.deltaMode;let v=normalizeWheelEventDirection(i);const n=30,d=30;return e===WheelEvent.DOM_DELTA_PIXEL?v/=n*d:e===WheelEvent.DOM_DELTA_LINE&&(v/=d),v}function isValidRotation(i){return Number.isInteger(i)&&i%90===0}function isValidScrollMode(i){return Number.isInteger(i)&&Object.values(ScrollMode).includes(i)&&i!==ScrollMode.UNKNOWN}function isValidSpreadMode(i){return Number.isInteger(i)&&Object.values(SpreadMode).includes(i)&&i!==SpreadMode.UNKNOWN}function isPortraitOrientation(i){return i.width<=i.height}new Promise(function(i){window.requestAnimationFrame(i)});document.documentElement.style;const REGEXP=/[xy]/g,PATTERN="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",BORDERWIDTH=9;function replacement(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)}function uuid(){return PATTERN.replace(REGEXP,replacement)}function normalizeHtml(i){return i&&i.replace(/&nbsp;|\u202F|\u00A0/g," ").replace(/<br \/>/g,"<br>")}function pointerEventToCanvasPoint(i,e){return{x:Math.round(i.clientX-e.x),y:Math.round(i.clientY-e.y)}}function colorToCss(i){return`#${i.r.toString(16).padStart(2,"0")}${i.g.toString(16).padStart(2,"0")}${i.b.toString(16).padStart(2,"0")}${Math.floor((i.a||1)*255).toString(16).padStart(2,"0")}`}function getSelectionRects(i,e=1){const v={x:-1,y:-1,height:0,width:0},n=[];try{const d=window.getSelection();if(d){let O=d.getRangeAt(0).getClientRects();O.length>0&&O[0].width>0&&O[0].height>0&&Object.values(O).forEach(w=>{const E={x:w.left-i.x,y:w.top-i.y,width:w.width,height:w.height};E.width>0&&E.height>0&&E.x>-1&&E.y>-1&&((v.x===-1||v.y===-1)&&(v.x=E.x,v.y=E.y),v.x=Math.min(v.x,E.x),v.y=Math.min(v.y,E.y),E.width+E.x>v.width+v.x&&(v.width=E.width+E.x-v.x),E.height+E.y>v.y+v.height&&(v.height=E.height+E.y-v.y),n.push(E))})}}catch{}return{listRects:n,bounds:v}}function processRuleSet(i,e){return i+` {
`+processDeclarationBlock(e)+`
}`}function processDeclarationBlock(i){return Object.keys(i).map(function(e){return processDeclaration(e,i[e])}).join(`
`)}function processDeclaration(i,e){return!isNaN(e)&&e!=0&&(e=e+"px"),hyphenate(i)+": "+e+";"}function hyphenate(i){return i.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}function createStyleSheet(i){var e=document.createElement("style"),v=Object.keys(i).map(function(n){return processRuleSet(n,i[n])}).join(`
`);return e.setAttribute("type","text/css"),e.appendChild(document.createTextNode(v)),e}createStyleSheet({body:{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}});function resizeBounds(i,e,v){const n={x:i.x,y:i.y,width:i.width,height:i.height};return(e&Side.Left)===Side.Left&&(n.x=Math.min(v.x,i.x+i.width),n.width=Math.abs(i.x+i.width-v.x)),(e&Side.Right)===Side.Right&&(n.x=Math.min(v.x,i.x),n.width=Math.abs(v.x-i.x)),(e&Side.Top)===Side.Top&&(n.y=Math.min(v.y,i.y+i.height),n.height=Math.abs(i.y+i.height-v.y)),(e&Side.Bottom)===Side.Bottom&&(n.y=Math.min(v.y,i.y),n.height=Math.abs(v.y-i.y)),n}function penPointsToPathLayer(i,e){if(i.length<2)throw new Error("Cannot transform points with less than 2 points");let v=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,re=Number.NEGATIVE_INFINITY;for(const O of i){const[w,E]=O;v>w&&(v=w),n>E&&(n=E),d<w&&(d=w),re<E&&(re=E)}return{type:LayerType.Path,x:v,y:n,width:d-v,height:re-n,fill:e,points:i.map(([O,w,E])=>[O-v,w-n,E])}}function getSvgPathFromStroke(i){if(!i.length)return"";const e=i.reduce((v,[n,d],re,O)=>{const[w,E]=O[(re+1)%O.length];return v.push(n,d,(n+w)/2,(d+E)/2),v},["M",...i[0],"Q"]);return e.push("Z"),e.join(" ")}function getAugmentedNamespace(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var v=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};v.prototype=e.prototype}else v={};return Object.defineProperty(v,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var d=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(v,n,d.get?d:{enumerable:!0,get:function(){return i[n]}})}),v}function commonjsRequire(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,v){module.exports=e.pdfjsLib=v()})(globalThis,()=>(()=>{var __webpack_modules__=[,(i,e)=>{var mt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=D,e.bytesToString=Ne,e.createValidAbsoluteUrl=Te,e.getModificationDate=De,e.getUuid=it,e.getVerbosityLevel=_e,e.info=be,e.isArrayBuffer=Z,e.isArrayEqual=Le,e.isNodeJS=void 0,e.normalizeUnicode=Ze,e.objectFromMap=Ye,e.objectSize=qe,e.setVerbosityLevel=te,e.shadow=q,e.string32=$e,e.stringToBytes=He,e.stringToPDFString=h,e.stringToUTF8String=X,e.unreachable=Pe,e.utf8StringToString=oe,e.warn=W;const v=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=v;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const d=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=d;const re=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=re;const O=1.35;e.LINE_FACTOR=O;const w=.35;e.LINE_DESCENT_FACTOR=w;const E=w/O;e.BASELINE_FACTOR=E;const p={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=p;const r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=r;const H="pdfjs_internal_editor_";e.AnnotationEditorPrefix=H;const N={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=N;const g={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=g;const u={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=u;const M={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=M;const P={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=P;const x={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=x;const S={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=S;const F={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=F;const I={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=I;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=o;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=s;const c={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=c;const f={O:"PageOpen",C:"PageClose"};e.PageActionEventType=f;const T={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=T;const Y={NONE:0,BINARY:1};e.CMapCompressionType=Y;const _={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=_;const j={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=j;let fe=T.WARNINGS;function te(Xe){Number.isInteger(Xe)&&(fe=Xe)}function _e(){return fe}function be(Xe){fe>=T.INFOS&&console.log(`Info: ${Xe}`)}function W(Xe){fe>=T.WARNINGS&&console.log(`Warning: ${Xe}`)}function Pe(Xe){throw new Error(Xe)}function D(Xe,Be){Xe||Pe(Be)}function k(Xe){switch(Xe==null?void 0:Xe.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Te(Xe,Be=null,Ue=null){if(!Xe)return null;try{if(Ue&&typeof Xe=="string"){if(Ue.addDefaultProtocol&&Xe.startsWith("www.")){const ft=Xe.match(/\./g);(ft==null?void 0:ft.length)>=2&&(Xe=`http://${Xe}`)}if(Ue.tryConvertEncoding)try{Xe=X(Xe)}catch{}}const nt=Be?new URL(Xe,Be):new URL(Xe);if(k(nt))return nt}catch{}return null}function q(Xe,Be,Ue,nt=!1){return Object.defineProperty(Xe,Be,{value:Ue,enumerable:!nt,configurable:!0,writable:!1}),Ue}const m=function(){function Be(Ue,nt){this.constructor===Be&&Pe("Cannot initialize BaseException."),this.message=Ue,this.name=nt}return Be.prototype=new Error,Be.constructor=Be,Be}();e.BaseException=m;class y extends m{constructor(Be,Ue){super(Be,"PasswordException"),this.code=Ue}}e.PasswordException=y;class U extends m{constructor(Be,Ue){super(Be,"UnknownErrorException"),this.details=Ue}}e.UnknownErrorException=U;class Ae extends m{constructor(Be){super(Be,"InvalidPDFException")}}e.InvalidPDFException=Ae;class ye extends m{constructor(Be){super(Be,"MissingPDFException")}}e.MissingPDFException=ye;class Q extends m{constructor(Be,Ue){super(Be,"UnexpectedResponseException"),this.status=Ue}}e.UnexpectedResponseException=Q;class we extends m{constructor(Be){super(Be,"FormatError")}}e.FormatError=we;class Re extends m{constructor(Be){super(Be,"AbortException")}}e.AbortException=Re;function Ne(Xe){(typeof Xe!="object"||(Xe==null?void 0:Xe.length)===void 0)&&Pe("Invalid argument for bytesToString");const Be=Xe.length,Ue=8192;if(Be<Ue)return String.fromCharCode.apply(null,Xe);const nt=[];for(let ft=0;ft<Be;ft+=Ue){const ut=Math.min(ft+Ue,Be),Se=Xe.subarray(ft,ut);nt.push(String.fromCharCode.apply(null,Se))}return nt.join("")}function He(Xe){typeof Xe!="string"&&Pe("Invalid argument for stringToBytes");const Be=Xe.length,Ue=new Uint8Array(Be);for(let nt=0;nt<Be;++nt)Ue[nt]=Xe.charCodeAt(nt)&255;return Ue}function $e(Xe){return String.fromCharCode(Xe>>24&255,Xe>>16&255,Xe>>8&255,Xe&255)}function qe(Xe){return Object.keys(Xe).length}function Ye(Xe){const Be=Object.create(null);for(const[Ue,nt]of Xe)Be[Ue]=nt;return Be}function Oe(){const Xe=new Uint8Array(4);return Xe[0]=1,new Uint32Array(Xe.buffer,0,1)[0]===1}function Fe(){try{return new Function(""),!0}catch{return!1}}class J{static get isLittleEndian(){return q(this,"isLittleEndian",Oe())}static get isEvalSupported(){return q(this,"isEvalSupported",Fe())}static get isOffscreenCanvasSupported(){return q(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?q(this,"platform",{isWin:!1,isMac:!1}):q(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Be,Ue;return q(this,"isCSSRoundSupported",(Ue=(Be=globalThis.CSS)==null?void 0:Be.supports)==null?void 0:Ue.call(Be,"width: round(1.5px, 1px)"))}}e.FeatureTest=J;const Ee=[...Array(256).keys()].map(Xe=>Xe.toString(16).padStart(2,"0"));class Ie{static makeHexColor(Be,Ue,nt){return`#${Ee[Be]}${Ee[Ue]}${Ee[nt]}`}static scaleMinMax(Be,Ue){let nt;Be[0]?(Be[0]<0&&(nt=Ue[0],Ue[0]=Ue[1],Ue[1]=nt),Ue[0]*=Be[0],Ue[1]*=Be[0],Be[3]<0&&(nt=Ue[2],Ue[2]=Ue[3],Ue[3]=nt),Ue[2]*=Be[3],Ue[3]*=Be[3]):(nt=Ue[0],Ue[0]=Ue[2],Ue[2]=nt,nt=Ue[1],Ue[1]=Ue[3],Ue[3]=nt,Be[1]<0&&(nt=Ue[2],Ue[2]=Ue[3],Ue[3]=nt),Ue[2]*=Be[1],Ue[3]*=Be[1],Be[2]<0&&(nt=Ue[0],Ue[0]=Ue[1],Ue[1]=nt),Ue[0]*=Be[2],Ue[1]*=Be[2]),Ue[0]+=Be[4],Ue[1]+=Be[4],Ue[2]+=Be[5],Ue[3]+=Be[5]}static transform(Be,Ue){return[Be[0]*Ue[0]+Be[2]*Ue[1],Be[1]*Ue[0]+Be[3]*Ue[1],Be[0]*Ue[2]+Be[2]*Ue[3],Be[1]*Ue[2]+Be[3]*Ue[3],Be[0]*Ue[4]+Be[2]*Ue[5]+Be[4],Be[1]*Ue[4]+Be[3]*Ue[5]+Be[5]]}static applyTransform(Be,Ue){const nt=Be[0]*Ue[0]+Be[1]*Ue[2]+Ue[4],ft=Be[0]*Ue[1]+Be[1]*Ue[3]+Ue[5];return[nt,ft]}static applyInverseTransform(Be,Ue){const nt=Ue[0]*Ue[3]-Ue[1]*Ue[2],ft=(Be[0]*Ue[3]-Be[1]*Ue[2]+Ue[2]*Ue[5]-Ue[4]*Ue[3])/nt,ut=(-Be[0]*Ue[1]+Be[1]*Ue[0]+Ue[4]*Ue[1]-Ue[5]*Ue[0])/nt;return[ft,ut]}static getAxialAlignedBoundingBox(Be,Ue){const nt=this.applyTransform(Be,Ue),ft=this.applyTransform(Be.slice(2,4),Ue),ut=this.applyTransform([Be[0],Be[3]],Ue),Se=this.applyTransform([Be[2],Be[1]],Ue);return[Math.min(nt[0],ft[0],ut[0],Se[0]),Math.min(nt[1],ft[1],ut[1],Se[1]),Math.max(nt[0],ft[0],ut[0],Se[0]),Math.max(nt[1],ft[1],ut[1],Se[1])]}static inverseTransform(Be){const Ue=Be[0]*Be[3]-Be[1]*Be[2];return[Be[3]/Ue,-Be[1]/Ue,-Be[2]/Ue,Be[0]/Ue,(Be[2]*Be[5]-Be[4]*Be[3])/Ue,(Be[4]*Be[1]-Be[5]*Be[0])/Ue]}static singularValueDecompose2dScale(Be){const Ue=[Be[0],Be[2],Be[1],Be[3]],nt=Be[0]*Ue[0]+Be[1]*Ue[2],ft=Be[0]*Ue[1]+Be[1]*Ue[3],ut=Be[2]*Ue[0]+Be[3]*Ue[2],Se=Be[2]*Ue[1]+Be[3]*Ue[3],We=(nt+Se)/2,et=Math.sqrt((nt+Se)**2-4*(nt*Se-ut*ft))/2,rt=We+et||1,ot=We-et||1;return[Math.sqrt(rt),Math.sqrt(ot)]}static normalizeRect(Be){const Ue=Be.slice(0);return Be[0]>Be[2]&&(Ue[0]=Be[2],Ue[2]=Be[0]),Be[1]>Be[3]&&(Ue[1]=Be[3],Ue[3]=Be[1]),Ue}static intersect(Be,Ue){const nt=Math.max(Math.min(Be[0],Be[2]),Math.min(Ue[0],Ue[2])),ft=Math.min(Math.max(Be[0],Be[2]),Math.max(Ue[0],Ue[2]));if(nt>ft)return null;const ut=Math.max(Math.min(Be[1],Be[3]),Math.min(Ue[1],Ue[3])),Se=Math.min(Math.max(Be[1],Be[3]),Math.max(Ue[1],Ue[3]));return ut>Se?null:[nt,ut,ft,Se]}static bezierBoundingBox(Be,Ue,nt,ft,ut,Se,We,et){const rt=[],ot=[[],[]];let tt,ve,le,ke,je,ze,Ke,Qe;for(let _t=0;_t<2;++_t){if(_t===0?(ve=6*Be-12*nt+6*ut,tt=-3*Be+9*nt-9*ut+3*We,le=3*nt-3*Be):(ve=6*Ue-12*ft+6*Se,tt=-3*Ue+9*ft-9*Se+3*et,le=3*ft-3*Ue),Math.abs(tt)<1e-12){if(Math.abs(ve)<1e-12)continue;ke=-le/ve,0<ke&&ke<1&&rt.push(ke);continue}Ke=ve*ve-4*le*tt,Qe=Math.sqrt(Ke),!(Ke<0)&&(je=(-ve+Qe)/(2*tt),0<je&&je<1&&rt.push(je),ze=(-ve-Qe)/(2*tt),0<ze&&ze<1&&rt.push(ze))}let ht=rt.length,lt;const st=ht;for(;ht--;)ke=rt[ht],lt=1-ke,ot[0][ht]=lt*lt*lt*Be+3*lt*lt*ke*nt+3*lt*ke*ke*ut+ke*ke*ke*We,ot[1][ht]=lt*lt*lt*Ue+3*lt*lt*ke*ft+3*lt*ke*ke*Se+ke*ke*ke*et;return ot[0][st]=Be,ot[1][st]=Ue,ot[0][st+1]=We,ot[1][st+1]=et,ot[0].length=ot[1].length=st+2,[Math.min(...ot[0]),Math.min(...ot[1]),Math.max(...ot[0]),Math.max(...ot[1])]}}e.Util=Ie;const z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function h(Xe){if(Xe[0]>="ï"){let Ue;if(Xe[0]==="þ"&&Xe[1]==="ÿ"?Ue="utf-16be":Xe[0]==="ÿ"&&Xe[1]==="þ"?Ue="utf-16le":Xe[0]==="ï"&&Xe[1]==="»"&&Xe[2]==="¿"&&(Ue="utf-8"),Ue)try{const nt=new TextDecoder(Ue,{fatal:!0}),ft=He(Xe);return nt.decode(ft)}catch(nt){W(`stringToPDFString: "${nt}".`)}}const Be=[];for(let Ue=0,nt=Xe.length;Ue<nt;Ue++){const ft=z[Xe.charCodeAt(Ue)];Be.push(ft?String.fromCharCode(ft):Xe.charAt(Ue))}return Be.join("")}function X(Xe){return decodeURIComponent(escape(Xe))}function oe(Xe){return unescape(encodeURIComponent(Xe))}function Z(Xe){return typeof Xe=="object"&&(Xe==null?void 0:Xe.byteLength)!==void 0}function Le(Xe,Be){if(Xe.length!==Be.length)return!1;for(let Ue=0,nt=Xe.length;Ue<nt;Ue++)if(Xe[Ue]!==Be[Ue])return!1;return!0}function De(Xe=new Date){return[Xe.getUTCFullYear().toString(),(Xe.getUTCMonth()+1).toString().padStart(2,"0"),Xe.getUTCDate().toString().padStart(2,"0"),Xe.getUTCHours().toString().padStart(2,"0"),Xe.getUTCMinutes().toString().padStart(2,"0"),Xe.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ge{constructor(){Me(this,mt,!1);this.promise=new Promise((Be,Ue)=>{this.resolve=nt=>{Ce(this,mt,!0),Be(nt)},this.reject=nt=>{Ce(this,mt,!0),Ue(nt)}})}get settled(){return t(this,mt)}}mt=new WeakMap,e.PromiseCapability=Ge;let Ve=null,Je=null;function Ze(Xe){return Ve||(Ve=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Je=new Map([["ﬅ","ſt"]])),Xe.replaceAll(Ve,(Be,Ue,nt)=>Ue?Ue.normalize("NFKC"):Je.get(nt))}function it(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Xe=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Xe);else for(let Be=0;Be<32;Be++)Xe[Be]=Math.floor(Math.random()*255);return Ne(Xe)}const pt="pdfjs_internal_id_";e.AnnotationPrefix=pt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var i,v,n,d,Nt,ai,w,E,p,r,H,N,g,u,M,oi,x,S,Mi,I,o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(c){if(typeof c=="string"||c instanceof URL?c={url:c}:(0,_util.isArrayBuffer)(c)&&(c={data:c}),typeof c!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!c.url&&!c.data&&!c.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const f=new PDFDocumentLoadingTask,{docId:T}=f,Y=c.url?getUrlProp(c.url):null,_=c.data?getDataProp(c.data):null,j=c.httpHeaders||null,fe=c.withCredentials===!0,te=c.password??null,_e=c.range instanceof PDFDataRangeTransport?c.range:null,be=Number.isInteger(c.rangeChunkSize)&&c.rangeChunkSize>0?c.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let W=c.worker instanceof PDFWorker?c.worker:null;const Pe=c.verbosity,D=typeof c.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(c.docBaseUrl)?c.docBaseUrl:null,k=typeof c.cMapUrl=="string"?c.cMapUrl:null,Te=c.cMapPacked!==!1,q=c.CMapReaderFactory||DefaultCMapReaderFactory,m=typeof c.standardFontDataUrl=="string"?c.standardFontDataUrl:null,y=c.StandardFontDataFactory||DefaultStandardFontDataFactory,U=c.stopAtErrors!==!0,Ae=Number.isInteger(c.maxImageSize)&&c.maxImageSize>-1?c.maxImageSize:-1,ye=c.isEvalSupported!==!1,Q=typeof c.isOffscreenCanvasSupported=="boolean"?c.isOffscreenCanvasSupported:!_util.isNodeJS,we=Number.isInteger(c.canvasMaxAreaInBytes)?c.canvasMaxAreaInBytes:-1,Re=typeof c.disableFontFace=="boolean"?c.disableFontFace:_util.isNodeJS,Ne=c.fontExtraProperties===!0,He=c.enableXfa===!0,$e=c.ownerDocument||globalThis.document,qe=c.disableRange===!0,Ye=c.disableStream===!0,Oe=c.disableAutoFetch===!0,Fe=c.pdfBug===!0,J=_e?_e.length:c.length??NaN,Ee=typeof c.useSystemFonts=="boolean"?c.useSystemFonts:!_util.isNodeJS&&!Re,Ie=typeof c.useWorkerFetch=="boolean"?c.useWorkerFetch:q===_display_utils.DOMCMapReaderFactory&&y===_display_utils.DOMStandardFontDataFactory&&k&&m&&(0,_display_utils.isValidFetchUrl)(k,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(m,document.baseURI),z=c.canvasFactory||new DefaultCanvasFactory({ownerDocument:$e}),h=c.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:$e}),X=null;(0,_util.setVerbosityLevel)(Pe);const oe={canvasFactory:z,filterFactory:h};if(Ie||(oe.cMapReaderFactory=new q({baseUrl:k,isCompressed:Te}),oe.standardFontDataFactory=new y({baseUrl:m})),!W){const De={verbosity:Pe,port:_worker_options.GlobalWorkerOptions.workerPort};W=De.port?PDFWorker.fromPort(De):new PDFWorker(De),f._worker=W}const Z={docId:T,apiVersion:"3.11.174",data:_,password:te,disableAutoFetch:Oe,rangeChunkSize:be,length:J,docBaseUrl:D,enableXfa:He,evaluatorOptions:{maxImageSize:Ae,disableFontFace:Re,ignoreErrors:U,isEvalSupported:ye,isOffscreenCanvasSupported:Q,canvasMaxAreaInBytes:we,fontExtraProperties:Ne,useSystemFonts:Ee,cMapUrl:Ie?k:null,standardFontDataUrl:Ie?m:null}},Le={ignoreErrors:U,isEvalSupported:ye,disableFontFace:Re,fontExtraProperties:Ne,enableXfa:He,ownerDocument:$e,disableAutoFetch:Oe,pdfBug:Fe,styleElement:X};return W.promise.then(function(){if(f.destroyed)throw new Error("Loading aborted");const De=_fetchDocument(W,Z),Ge=new Promise(function(Ve){let Je;_e?Je=new _transport_stream.PDFDataTransportStream({length:J,initialData:_e.initialData,progressiveDone:_e.progressiveDone,contentDispositionFilename:_e.contentDispositionFilename,disableRange:qe,disableStream:Ye},_e):_||(Je=(it=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(it):(0,_display_utils.isValidFetchUrl)(it.url)?new _displayFetch_stream.PDFFetchStream(it):new _displayNetwork.PDFNetworkStream(it))({url:Y,length:J,httpHeaders:j,withCredentials:fe,rangeChunkSize:be,disableRange:qe,disableStream:Ye})),Ve(Je)});return Promise.all([De,Ge]).then(function([Ve,Je]){if(f.destroyed)throw new Error("Loading aborted");const Ze=new _message_handler.MessageHandler(T,Ve,W.port),it=new WorkerTransport(Ze,f,Je,Le,oe);f._transport=it,Ze.send("Ready",null)})}).catch(f._capability.reject),f}async function _fetchDocument(c,f){if(c.destroyed)throw new Error("Worker was destroyed");const T=await c.messageHandler.sendWithPromise("GetDocRequest",f,f.data?[f.data.buffer]:null);if(c.destroyed)throw new Error("Worker was destroyed");return T}function getUrlProp(c){if(c instanceof URL)return c.href;try{return new URL(c,window.location).href}catch{if(_util.isNodeJS&&typeof c=="string")return c}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(c){if(_util.isNodeJS&&typeof Buffer<"u"&&c instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength)return c;if(typeof c=="string")return(0,_util.stringToBytes)(c);if(typeof c=="object"&&!isNaN(c==null?void 0:c.length)||(0,_util.isArrayBuffer)(c))return new Uint8Array(c);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Ot(e,i)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var f,T,Y;this.destroyed=!0;try{(f=this._worker)!=null&&f.port&&(this._worker._pendingDestroy=!0),await((T=this._transport)==null?void 0:T.destroy())}catch(_){throw(Y=this._worker)!=null&&Y.port&&delete this._worker._pendingDestroy,_}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};i=new WeakMap,Me(e,i,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(f,T,Y=!1,_=null){this.length=f,this.initialData=T,this.progressiveDone=Y,this.contentDispositionFilename=_,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(f){this._rangeListeners.push(f)}addProgressListener(f){this._progressListeners.push(f)}addProgressiveReadListener(f){this._progressiveReadListeners.push(f)}addProgressiveDoneListener(f){this._progressiveDoneListeners.push(f)}onDataRange(f,T){for(const Y of this._rangeListeners)Y(f,T)}onDataProgress(f,T){this._readyCapability.promise.then(()=>{for(const Y of this._progressListeners)Y(f,T)})}onDataProgressiveRead(f){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(f)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const f of this._progressiveDoneListeners)f()})}transportReady(){this._readyCapability.resolve()}requestDataRange(f,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(f,T){this._pdfInfo=f,this._transport=T,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Y=>{if(!Y)return Y;const _=[];for(const j in Y)_.push(...Y[j]);return _}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(f){return this._transport.getPage(f)}getPageIndex(f){return this._transport.getPageIndex(f)}getDestinations(){return this._transport.getDestinations()}getDestination(f){return this._transport.getDestination(f)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(f=!1){return this._transport.startCleanup(f||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(f,T,Y,_=!1){Me(this,d);Me(this,v,null);Me(this,n,!1);this._pageIndex=f,this._pageInfo=T,this._transport=Y,this._stats=_?new _display_utils.StatTimer:null,this._pdfBug=_,this.commonObjs=Y.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:f,rotation:T=this.rotate,offsetX:Y=0,offsetY:_=0,dontFlip:j=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:f,rotation:T,offsetX:Y,offsetY:_,dontFlip:j})}getAnnotations({intent:f="display"}={}){const T=this._transport.getRenderingIntent(f);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var f;return((f=this._transport._htmlForXfa)==null?void 0:f.children[this._pageIndex])||null}render({canvasContext:f,viewport:T,intent:Y="display",annotationMode:_=_util.AnnotationMode.ENABLE,transform:j=null,background:fe=null,optionalContentConfigPromise:te=null,annotationCanvasMap:_e=null,pageColors:be=null,printAnnotationStorage:W=null}){var y,U;(y=this._stats)==null||y.time("Overall");const Pe=this._transport.getRenderingIntent(Y,_,W);Ce(this,n,!1),ne(this,d,ai).call(this),te||(te=this._transport.getOptionalContentConfig());let D=this._intentStates.get(Pe.cacheKey);D||(D=Object.create(null),this._intentStates.set(Pe.cacheKey,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const k=!!(Pe.renderingIntent&_util.RenderingIntentFlag.PRINT);D.displayReadyCapability||(D.displayReadyCapability=new _util.PromiseCapability,D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(Pe));const Te=Ae=>{var ye,Q;D.renderTasks.delete(q),(this._maybeCleanupAfterRender||k)&&Ce(this,n,!0),ne(this,d,Nt).call(this,!k),Ae?(q.capability.reject(Ae),this._abortOperatorList({intentState:D,reason:Ae instanceof Error?Ae:new Error(Ae)})):q.capability.resolve(),(ye=this._stats)==null||ye.timeEnd("Rendering"),(Q=this._stats)==null||Q.timeEnd("Overall")},q=new InternalRenderTask({callback:Te,params:{canvasContext:f,viewport:T,transform:j,background:fe},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:_e,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:be});(D.renderTasks||(D.renderTasks=new Set)).add(q);const m=q.task;return Promise.all([D.displayReadyCapability.promise,te]).then(([Ae,ye])=>{var Q;if(this.destroyed){Te();return}(Q=this._stats)==null||Q.time("Rendering"),q.initializeGraphics({transparency:Ae,optionalContentConfig:ye}),q.operatorListChanged()}).catch(Te),m}getOperatorList({intent:f="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:Y=null}={}){var _e;function _(){fe.operatorList.lastChunk&&(fe.opListReadCapability.resolve(fe.operatorList),fe.renderTasks.delete(te))}const j=this._transport.getRenderingIntent(f,T,Y,!0);let fe=this._intentStates.get(j.cacheKey);fe||(fe=Object.create(null),this._intentStates.set(j.cacheKey,fe));let te;return fe.opListReadCapability||(te=Object.create(null),te.operatorListChanged=_,fe.opListReadCapability=new _util.PromiseCapability,(fe.renderTasks||(fe.renderTasks=new Set)).add(te),fe.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(_e=this._stats)==null||_e.time("Page Request"),this._pumpOperatorList(j)),fe.opListReadCapability.promise}streamTextContent({includeMarkedContent:f=!1,disableNormalization:T=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:f===!0,disableNormalization:T===!0},{highWaterMark:100,size(_){return _.items.length}})}getTextContent(f={}){if(this._transport._htmlForXfa)return this.getXfa().then(Y=>_xfa_text.XfaText.textContent(Y));const T=this.streamTextContent(f);return new Promise(function(Y,_){function j(){fe.read().then(function({value:_e,done:be}){if(be){Y(te);return}Object.assign(te.styles,_e.styles),te.items.push(..._e.items),j()},_)}const fe=T.getReader(),te={items:[],styles:Object.create(null)};j()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const f=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const Y of T.renderTasks)f.push(Y.completed),Y.cancel();return this.objs.clear(),Ce(this,n,!1),ne(this,d,ai).call(this),Promise.all(f)}cleanup(f=!1){Ce(this,n,!0);const T=ne(this,d,Nt).call(this,!1);return f&&T&&this._stats&&(this._stats=new _display_utils.StatTimer),T}_startRenderPage(f,T){var _,j;const Y=this._intentStates.get(T);Y&&((_=this._stats)==null||_.timeEnd("Page Request"),(j=Y.displayReadyCapability)==null||j.resolve(f))}_renderPageChunk(f,T){for(let Y=0,_=f.length;Y<_;Y++)T.operatorList.fnArray.push(f.fnArray[Y]),T.operatorList.argsArray.push(f.argsArray[Y]);T.operatorList.lastChunk=f.lastChunk,T.operatorList.separateAnnots=f.separateAnnots;for(const Y of T.renderTasks)Y.operatorListChanged();f.lastChunk&&ne(this,d,Nt).call(this,!0)}_pumpOperatorList({renderingIntent:f,cacheKey:T,annotationStorageSerializable:Y}){const{map:_,transfers:j}=Y,te=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:f,cacheKey:T,annotationStorage:_},j).getReader(),_e=this._intentStates.get(T);_e.streamReader=te;const be=()=>{te.read().then(({value:W,done:Pe})=>{if(Pe){_e.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(W,_e),be())},W=>{if(_e.streamReader=null,!this._transport.destroyed){if(_e.operatorList){_e.operatorList.lastChunk=!0;for(const Pe of _e.renderTasks)Pe.operatorListChanged();ne(this,d,Nt).call(this,!0)}if(_e.displayReadyCapability)_e.displayReadyCapability.reject(W);else if(_e.opListReadCapability)_e.opListReadCapability.reject(W);else throw W}})};be()}_abortOperatorList({intentState:f,reason:T,force:Y=!1}){if(f.streamReader){if(f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null),!Y){if(f.renderTasks.size>0)return;if(T instanceof _display_utils.RenderingCancelledException){let _=RENDERING_CANCELLED_TIMEOUT;T.extraDelay>0&&T.extraDelay<1e3&&(_+=T.extraDelay),f.streamReaderCancelTimeout=setTimeout(()=>{f.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:f,reason:T,force:!0})},_);return}}if(f.streamReader.cancel(new _util.AbortException(T.message)).catch(()=>{}),f.streamReader=null,!this._transport.destroyed){for(const[_,j]of this._intentStates)if(j===f){this._intentStates.delete(_);break}this.cleanup()}}}get stats(){return this._stats}}v=new WeakMap,n=new WeakMap,d=new WeakSet,Nt=function(f=!1){if(ne(this,d,ai).call(this),!t(this,n)||this.destroyed)return!1;if(f)return Ce(this,v,setTimeout(()=>{Ce(this,v,null),ne(this,d,Nt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:T,operatorList:Y}of this._intentStates.values())if(T.size>0||!Y.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ce(this,n,!1),!0},ai=function(){t(this,v)&&(clearTimeout(t(this,v)),Ce(this,v,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Me(this,w,new Set);Me(this,E,Promise.resolve())}postMessage(f,T){const Y={data:structuredClone(f,T?{transfer:T}:null)};t(this,E).then(()=>{for(const _ of t(this,w))_.call(this,Y)})}addEventListener(f,T){t(this,w).add(T)}removeEventListener(f,T){t(this,w).delete(T)}terminate(){t(this,w).clear()}}w=new WeakMap,E=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const c=(p=document==null?void 0:document.currentScript)==null?void 0:p.src;c&&(PDFWorkerUtil.fallbackWorkerSrc=c.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(c,f){let T;try{if(T=new URL(c),!T.origin||T.origin==="null")return!1}catch{return!1}const Y=new URL(f,T);return T.origin===Y.origin},PDFWorkerUtil.createCDNWrapper=function(c){const f=`importScripts("${c}");`;return URL.createObjectURL(new Blob([f]))}}const _PDFWorker=class _PDFWorker{constructor({name:c=null,port:f=null,verbosity:T=(0,_util.getVerbosityLevel)()}={}){var Y;if(this.name=c,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,f){if((Y=t(_PDFWorker,r))!=null&&Y.has(f))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,r)||Ce(_PDFWorker,r,new WeakMap)).set(f,this),this._initializeFromPort(f);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(c){this._port=c,this._messageHandler=new _message_handler.MessageHandler("main","worker",c),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:c}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,c)||(c=PDFWorkerUtil.createCDNWrapper(new URL(c,window.location).href));const f=new Worker(c),T=new _message_handler.MessageHandler("main","worker",f),Y=()=>{f.removeEventListener("error",_),T.destroy(),f.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},_=()=>{this._webWorker||Y()};f.addEventListener("error",_),T.on("test",fe=>{if(f.removeEventListener("error",_),this.destroyed){Y();return}fe?(this._messageHandler=T,this._port=f,this._webWorker=f,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),f.terminate())}),T.on("ready",fe=>{if(f.removeEventListener("error",_),this.destroyed){Y();return}try{j()}catch{this._setupFakeWorker()}});const j=()=>{const fe=new Uint8Array;T.send("test",fe,[fe.buffer])};j();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(c=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const f=new LoopbackPort;this._port=f;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,Y=new _message_handler.MessageHandler(T+"_worker",T,f);c.setup(Y,f);const _=new _message_handler.MessageHandler(T,T+"_worker",f);this._messageHandler=_,this._readyCapability.resolve(),_.send("configure",{verbosity:this.verbosity})}).catch(c=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${c.message}".`))})}destroy(){var c;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(c=t(_PDFWorker,r))==null||c.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(c){var T;if(!(c!=null&&c.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const f=(T=t(this,r))==null?void 0:T.get(c.port);if(f){if(f._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return f}return new _PDFWorker(c)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var c;try{return((c=globalThis.pdfjsWorker)==null?void 0:c.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};r=new WeakMap,Me(_PDFWorker,r);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(f,T,Y,_,j){Me(this,M);Me(this,H,new Map);Me(this,N,new Map);Me(this,g,new Map);Me(this,u,null);this.messageHandler=f,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:_.ownerDocument,styleElement:_.styleElement}),this._params=_,this.canvasFactory=j.canvasFactory,this.filterFactory=j.filterFactory,this.cMapReaderFactory=j.cMapReaderFactory,this.standardFontDataFactory=j.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Y,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(f,T=_util.AnnotationMode.ENABLE,Y=null,_=!1){let j=_util.RenderingIntentFlag.DISPLAY,fe=_annotation_storage.SerializableEmpty;switch(f){case"any":j=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":j=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${f}`)}switch(T){case _util.AnnotationMode.DISABLE:j+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:j+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:j+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,fe=(j&_util.RenderingIntentFlag.PRINT&&Y instanceof _annotation_storage.PrintAnnotationStorage?Y:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return _&&(j+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:j,cacheKey:`${j}_${fe.hash}`,annotationStorageSerializable:fe}}destroy(){var Y;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Y=t(this,u))==null||Y.reject(new Error("Worker was destroyed during onPassword callback"));const f=[];for(const _ of t(this,N).values())f.push(_._destroy());t(this,N).clear(),t(this,g).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return f.push(T),Promise.all(f).then(()=>{var _;this.commonObjs.clear(),this.fontLoader.clear(),t(this,H).clear(),this.filterFactory.destroy(),(_=this._networkStream)==null||_.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:f,loadingTask:T}=this;f.on("GetReader",(Y,_)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=j=>{this._lastProgress={loaded:j.loaded,total:j.total}},_.onPull=()=>{this._fullReader.read().then(function({value:j,done:fe}){if(fe){_.close();return}(0,_util.assert)(j instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(j),1,[j])}).catch(j=>{_.error(j)})},_.onCancel=j=>{this._fullReader.cancel(j),_.ready.catch(fe=>{if(!this.destroyed)throw fe})}}),f.on("ReaderHeadersReady",Y=>{const _=new _util.PromiseCapability,j=this._fullReader;return j.headersReady.then(()=>{var fe;(!j.isStreamingSupported||!j.isRangeSupported)&&(this._lastProgress&&((fe=T.onProgress)==null||fe.call(T,this._lastProgress)),j.onProgress=te=>{var _e;(_e=T.onProgress)==null||_e.call(T,{loaded:te.loaded,total:te.total})}),_.resolve({isStreamingSupported:j.isStreamingSupported,isRangeSupported:j.isRangeSupported,contentLength:j.contentLength})},_.reject),_.promise}),f.on("GetRangeReader",(Y,_)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const j=this._networkStream.getRangeReader(Y.begin,Y.end);if(!j){_.close();return}_.onPull=()=>{j.read().then(function({value:fe,done:te}){if(te){_.close();return}(0,_util.assert)(fe instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(fe),1,[fe])}).catch(fe=>{_.error(fe)})},_.onCancel=fe=>{j.cancel(fe),_.ready.catch(te=>{if(!this.destroyed)throw te})}}),f.on("GetDoc",({pdfInfo:Y})=>{this._numPages=Y.numPages,this._htmlForXfa=Y.htmlForXfa,delete Y.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(Y,this))}),f.on("DocException",function(Y){let _;switch(Y.name){case"PasswordException":_=new _util.PasswordException(Y.message,Y.code);break;case"InvalidPDFException":_=new _util.InvalidPDFException(Y.message);break;case"MissingPDFException":_=new _util.MissingPDFException(Y.message);break;case"UnexpectedResponseException":_=new _util.UnexpectedResponseException(Y.message,Y.status);break;case"UnknownErrorException":_=new _util.UnknownErrorException(Y.message,Y.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(_)}),f.on("PasswordRequest",Y=>{if(Ce(this,u,new _util.PromiseCapability),T.onPassword){const _=j=>{j instanceof Error?t(this,u).reject(j):t(this,u).resolve({password:j})};try{T.onPassword(_,Y.code)}catch(j){t(this,u).reject(j)}}else t(this,u).reject(new _util.PasswordException(Y.message,Y.code));return t(this,u).promise}),f.on("DataLoaded",Y=>{var _;(_=T.onProgress)==null||_.call(T,{loaded:Y.length,total:Y.length}),this.downloadInfoCapability.resolve(Y)}),f.on("StartRenderPage",Y=>{if(this.destroyed)return;t(this,N).get(Y.pageIndex)._startRenderPage(Y.transparency,Y.cacheKey)}),f.on("commonobj",([Y,_,j])=>{var fe;if(!this.destroyed&&!this.commonObjs.has(Y))switch(_){case"Font":const te=this._params;if("error"in j){const W=j.error;(0,_util.warn)(`Error during font loading: ${W}`),this.commonObjs.resolve(Y,W);break}const _e=te.pdfBug&&((fe=globalThis.FontInspector)!=null&&fe.enabled)?(W,Pe)=>globalThis.FontInspector.fontAdded(W,Pe):null,be=new _font_loader.FontFaceObject(j,{isEvalSupported:te.isEvalSupported,disableFontFace:te.disableFontFace,ignoreErrors:te.ignoreErrors,inspectFont:_e});this.fontLoader.bind(be).catch(W=>f.sendWithPromise("FontFallback",{id:Y})).finally(()=>{!te.fontExtraProperties&&be.data&&(be.data=null),this.commonObjs.resolve(Y,be)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Y,j);break;default:throw new Error(`Got unknown common object type ${_}`)}}),f.on("obj",([Y,_,j,fe])=>{var _e;if(this.destroyed)return;const te=t(this,N).get(_);if(!te.objs.has(Y))switch(j){case"Image":if(te.objs.resolve(Y,fe),fe){let be;if(fe.bitmap){const{width:W,height:Pe}=fe;be=W*Pe*4}else be=((_e=fe.data)==null?void 0:_e.length)||0;be>_util.MAX_IMAGE_SIZE_TO_CACHE&&(te._maybeCleanupAfterRender=!0)}break;case"Pattern":te.objs.resolve(Y,fe);break;default:throw new Error(`Got unknown object type ${j}`)}}),f.on("DocProgress",Y=>{var _;this.destroyed||(_=T.onProgress)==null||_.call(T,{loaded:Y.loaded,total:Y.total})}),f.on("FetchBuiltInCMap",Y=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Y):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),f.on("FetchStandardFontData",Y=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Y):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Y;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:f,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:f,filename:((Y=this._fullReader)==null?void 0:Y.filename)??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(f){if(!Number.isInteger(f)||f<=0||f>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=f-1,Y=t(this,g).get(T);if(Y)return Y;const _=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(j=>{if(this.destroyed)throw new Error("Transport destroyed");const fe=new PDFPageProxy(T,j,this,this._params.pdfBug);return t(this,N).set(T,fe),fe});return t(this,g).set(T,_),_}getPageIndex(f){return typeof f!="object"||f===null||!Number.isInteger(f.num)||f.num<0||!Number.isInteger(f.gen)||f.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:f.num,gen:f.gen})}getAnnotations(f,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:f,intent:T})}getFieldObjects(){return ne(this,M,oi).call(this,"GetFieldObjects")}hasJSActions(){return ne(this,M,oi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(f){return typeof f!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:f})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return ne(this,M,oi).call(this,"GetDocJSActions")}getPageJSActions(f){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:f})}getStructTree(f){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:f})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(f=>new _optional_content_config.OptionalContentConfig(f))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const f="GetMetadata",T=t(this,H).get(f);if(T)return T;const Y=this.messageHandler.sendWithPromise(f,null).then(_=>{var j,fe;return{info:_[0],metadata:_[1]?new _metadata.Metadata(_[1]):null,contentDispositionFilename:((j=this._fullReader)==null?void 0:j.filename)??null,contentLength:((fe=this._fullReader)==null?void 0:fe.contentLength)??null}});return t(this,H).set(f,Y),Y}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(f=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of t(this,N).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),f||this.fontLoader.clear(),t(this,H).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:f,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:f,enableXfa:T})}}H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakSet,oi=function(f,T=null){const Y=t(this,H).get(f);if(Y)return Y;const _=this.messageHandler.sendWithPromise(f,T);return t(this,H).set(f,_),_};class PDFObjects{constructor(){Me(this,S);Me(this,x,Object.create(null))}get(f,T=null){if(T){const _=ne(this,S,Mi).call(this,f);return _.capability.promise.then(()=>T(_.data)),null}const Y=t(this,x)[f];if(!(Y!=null&&Y.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${f}.`);return Y.data}has(f){const T=t(this,x)[f];return(T==null?void 0:T.capability.settled)||!1}resolve(f,T=null){const Y=ne(this,S,Mi).call(this,f);Y.data=T,Y.capability.resolve()}clear(){var f;for(const T in t(this,x)){const{data:Y}=t(this,x)[T];(f=Y==null?void 0:Y.bitmap)==null||f.close()}Ce(this,x,Object.create(null))}}x=new WeakMap,S=new WeakSet,Mi=function(f){var T;return(T=t(this,x))[f]||(T[f]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(f){Me(this,I,null);Ce(this,I,f),this.onContinue=null}get promise(){return t(this,I).capability.promise}cancel(f=0){t(this,I).cancel(null,f)}get separateAnnots(){const{separateAnnots:f}=t(this,I).operatorList;if(!f)return!1;const{annotationCanvasMap:T}=t(this,I);return f.form||f.canvas&&(T==null?void 0:T.size)>0}}I=new WeakMap,exports.RenderTask=RenderTask;const s=class s{constructor({callback:f,params:T,objs:Y,commonObjs:_,annotationCanvasMap:j,operatorList:fe,pageIndex:te,canvasFactory:_e,filterFactory:be,useRequestAnimationFrame:W=!1,pdfBug:Pe=!1,pageColors:D=null}){this.callback=f,this.params=T,this.objs=Y,this.commonObjs=_,this.annotationCanvasMap=j,this.operatorListIdx=null,this.operatorList=fe,this._pageIndex=te,this.canvasFactory=_e,this.filterFactory=be,this._pdfBug=Pe,this.pageColors=D,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=W===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=T.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:f=!1,optionalContentConfig:T}){var te,_e;if(this.cancelled)return;if(this._canvas){if(t(s,o).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(s,o).add(this._canvas)}this._pdfBug&&((te=globalThis.StepperManager)!=null&&te.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Y,viewport:_,transform:j,background:fe}=this.params;this.gfx=new _canvas.CanvasGraphics(Y,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:T},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:j,viewport:_,transparency:f,background:fe}),this.operatorListIdx=0,this.graphicsReady=!0,(_e=this.graphicsReadyCallback)==null||_e.call(this)}cancel(f=null,T=0){var Y;this.running=!1,this.cancelled=!0,(Y=this.gfx)==null||Y.endDrawing(),t(s,o).delete(this._canvas),this.callback(f||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var f;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(f=this.stepper)==null||f.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(s,o).delete(this._canvas),this.callback())))}};o=new WeakMap,Me(s,o,new WeakSet);let InternalRenderTask=s;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(i,e,v)=>{var p,r,H,Nn,g;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=v(1),d=v(4),re=v(8);const O=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=O;class w{constructor(){Me(this,H);Me(this,p,!1);Me(this,r,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(M,P){const x=t(this,r).get(M);return x===void 0?P:Object.assign(P,x)}getRawValue(M){return t(this,r).get(M)}remove(M){if(t(this,r).delete(M),t(this,r).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const P of t(this,r).values())if(P instanceof d.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(M,P){const x=t(this,r).get(M);let S=!1;if(x!==void 0)for(const[F,I]of Object.entries(P))x[F]!==I&&(S=!0,x[F]=I);else S=!0,t(this,r).set(M,P);S&&ne(this,H,Nn).call(this),P instanceof d.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(P.constructor._type)}has(M){return t(this,r).has(M)}getAll(){return t(this,r).size>0?(0,n.objectFromMap)(t(this,r)):null}setAll(M){for(const[P,x]of Object.entries(M))this.setValue(P,x)}get size(){return t(this,r).size}resetModified(){t(this,p)&&(Ce(this,p,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new E(this)}get serializable(){if(t(this,r).size===0)return O;const M=new Map,P=new re.MurmurHash3_64,x=[],S=Object.create(null);let F=!1;for(const[I,o]of t(this,r)){const s=o instanceof d.AnnotationEditor?o.serialize(!1,S):o;s&&(M.set(I,s),P.update(`${I}:${JSON.stringify(s)}`),F||(F=!!s.bitmap))}if(F)for(const I of M.values())I.bitmap&&x.push(I.bitmap);return M.size>0?{map:M,hash:P.hexdigest(),transfers:x}:O}}p=new WeakMap,r=new WeakMap,H=new WeakSet,Nn=function(){t(this,p)||(Ce(this,p,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=w;class E extends w{constructor(P){super();Me(this,g);const{map:x,hash:S,transfers:F}=P.serializable,I=structuredClone(x,F?{transfer:F}:null);Ce(this,g,{map:I,hash:S,transfers:F})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,g)}}g=new WeakMap,e.PrintAnnotationStorage=E},(i,e,v)=>{var E,p,r,H,N,g,u,M,P,x,S,F,I,o,s,Li,Ri,T,Ii,ki,Bn,Vn,Un,Di,Hn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=v(5),d=v(1),re=v(6);const W=class W{constructor(D){Me(this,s);Me(this,E,"");Me(this,p,!1);Me(this,r,null);Me(this,H,null);Me(this,N,null);Me(this,g,!1);Me(this,u,null);Me(this,M,this.focusin.bind(this));Me(this,P,this.focusout.bind(this));Me(this,x,!1);Me(this,S,!1);Me(this,F,!1);at(this,"_initialOptions",Object.create(null));at(this,"_uiManager",null);at(this,"_focusEventsAllowed",!0);at(this,"_l10nPromise",null);Me(this,I,!1);Me(this,o,W._zIndex++);this.constructor===W&&(0,d.unreachable)("Cannot initialize AnnotationEditor."),this.parent=D.parent,this.id=D.id,this.width=this.height=null,this.pageIndex=D.parent.pageIndex,this.name=D.name,this.div=null,this._uiManager=D.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=D.isCentered,this._structTreeParentId=null;const{rotation:k,rawDims:{pageWidth:Te,pageHeight:q,pageX:m,pageY:y}}=this.parent.viewport;this.rotation=k,this.pageRotation=(360+k-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Te,q],this.pageTranslation=[m,y];const[U,Ae]=this.parentDimensions;this.x=D.x/U,this.y=D.y/Ae,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,d.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(D){const k=new w({id:D.parent.getNextId(),parent:D.parent,uiManager:D._uiManager});k.annotationElementId=D.annotationElementId,k.deleted=!0,k._uiManager.addToAnnotationStorage(k)}static initialize(D,k=null){if(W._l10nPromise||(W._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(q=>[q,D.get(q)]))),k!=null&&k.strings)for(const q of k.strings)W._l10nPromise.set(q,D.get(q));if(W._borderLineWidth!==-1)return;const Te=getComputedStyle(document.documentElement);W._borderLineWidth=parseFloat(Te.getPropertyValue("--outline-width"))||0}static updateDefaultParams(D,k){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(D){return!1}static paste(D,k){(0,d.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,I)}set _isDraggable(D){var k;Ce(this,I,D),(k=this.div)==null||k.classList.toggle("draggable",D)}center(){const[D,k]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*k/(D*2),this.y+=this.width*D/(k*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*k/(D*2),this.y-=this.width*D/(k*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(D){this._uiManager.addCommands(D)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,o)}setParent(D){D!==null&&(this.pageIndex=D.pageIndex,this.pageDimensions=D.pageDimensions),this.parent=D}focusin(D){this._focusEventsAllowed&&(t(this,x)?Ce(this,x,!1):this.parent.setSelected(this))}focusout(D){var Te;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const k=D.relatedTarget;k!=null&&k.closest(`#${this.id}`)||(D.preventDefault(),(Te=this.parent)!=null&&Te.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(D,k,Te,q){const[m,y]=this.parentDimensions;[Te,q]=this.screenToPageTranslation(Te,q),this.x=(D+Te)/m,this.y=(k+q)/y,this.fixAndSetPosition()}translate(D,k){ne(this,s,Li).call(this,this.parentDimensions,D,k)}translateInPage(D,k){ne(this,s,Li).call(this,this.pageDimensions,D,k),this.div.scrollIntoView({block:"nearest"})}drag(D,k){const[Te,q]=this.parentDimensions;if(this.x+=D/Te,this.y+=k/q,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ye,y:Q}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ye,Q)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:m,y}=this;const[U,Ae]=ne(this,s,Ri).call(this);m+=U,y+=Ae,this.div.style.left=`${(100*m).toFixed(2)}%`,this.div.style.top=`${(100*y).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[D,k]=this.pageDimensions;let{x:Te,y:q,width:m,height:y}=this;switch(m*=D,y*=k,Te*=D,q*=k,this.rotation){case 0:Te=Math.max(0,Math.min(D-m,Te)),q=Math.max(0,Math.min(k-y,q));break;case 90:Te=Math.max(0,Math.min(D-y,Te)),q=Math.min(k,Math.max(m,q));break;case 180:Te=Math.min(D,Math.max(m,Te)),q=Math.min(k,Math.max(y,q));break;case 270:Te=Math.min(D,Math.max(y,Te)),q=Math.max(0,Math.min(k-m,q));break}this.x=Te/=D,this.y=q/=k;const[U,Ae]=ne(this,s,Ri).call(this);Te+=U,q+=Ae;const{style:ye}=this.div;ye.left=`${(100*Te).toFixed(2)}%`,ye.top=`${(100*q).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(D,k){var Te;return ne(Te=W,T,Ii).call(Te,D,k,this.parentRotation)}pageTranslationToScreen(D,k){var Te;return ne(Te=W,T,Ii).call(Te,D,k,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:D,pageDimensions:[k,Te]}=this,q=k*D,m=Te*D;return d.FeatureTest.isCSSRoundSupported?[Math.round(q),Math.round(m)]:[q,m]}setDims(D,k){var m;const[Te,q]=this.parentDimensions;this.div.style.width=`${(100*D/Te).toFixed(2)}%`,t(this,g)||(this.div.style.height=`${(100*k/q).toFixed(2)}%`),(m=t(this,r))==null||m.classList.toggle("small",D<W.SMALL_EDITOR_SIZE||k<W.SMALL_EDITOR_SIZE)}fixDims(){const{style:D}=this.div,{height:k,width:Te}=D,q=Te.endsWith("%"),m=!t(this,g)&&k.endsWith("%");if(q&&m)return;const[y,U]=this.parentDimensions;q||(D.width=`${(100*parseFloat(Te)/y).toFixed(2)}%`),!t(this,g)&&!m&&(D.height=`${(100*parseFloat(k)/U).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,r))return;const D=Ce(this,r,document.createElement("button"));D.className="altText";const k=await W._l10nPromise.get("editor_alt_text_button_label");D.textContent=k,D.setAttribute("aria-label",k),D.tabIndex="0",D.addEventListener("contextmenu",re.noContextMenu),D.addEventListener("pointerdown",Te=>Te.stopPropagation()),D.addEventListener("click",Te=>{Te.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),D.addEventListener("keydown",Te=>{Te.target===D&&Te.key==="Enter"&&(Te.preventDefault(),this._uiManager.editAltText(this))}),ne(this,s,Di).call(this),this.div.append(D),W.SMALL_EDITOR_SIZE||(W.SMALL_EDITOR_SIZE=Math.min(128,Math.round(D.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,E),decorative:t(this,p)}}set altTextData({altText:D,decorative:k}){t(this,E)===D&&t(this,p)===k||(Ce(this,E,D),Ce(this,p,k),ne(this,s,Di).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,M)),this.div.addEventListener("focusout",t(this,P));const[D,k]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*k/D).toFixed(2)}%`,this.div.style.maxHeight=`${(100*D/k).toFixed(2)}%`);const[Te,q]=this.getInitialTranslation();return this.translate(Te,q),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(D){const{isMac:k}=d.FeatureTest.platform;if(D.button!==0||D.ctrlKey&&k){D.preventDefault();return}Ce(this,x,!0),ne(this,s,Hn).call(this,D)}moveInDOM(){var D;(D=this.parent)==null||D.moveEditorInDOM(this)}_setParentAndPosition(D,k,Te){D.changeParent(this),this.x=k,this.y=Te,this.fixAndSetPosition()}getRect(D,k){const Te=this.parentScale,[q,m]=this.pageDimensions,[y,U]=this.pageTranslation,Ae=D/Te,ye=k/Te,Q=this.x*q,we=this.y*m,Re=this.width*q,Ne=this.height*m;switch(this.rotation){case 0:return[Q+Ae+y,m-we-ye-Ne+U,Q+Ae+Re+y,m-we-ye+U];case 90:return[Q+ye+y,m-we+Ae+U,Q+ye+Ne+y,m-we+Ae+Re+U];case 180:return[Q-Ae-Re+y,m-we+ye+U,Q-Ae+y,m-we+ye+Ne+U];case 270:return[Q-ye-Ne+y,m-we-Ae-Re+U,Q-ye+y,m-we-Ae+U];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(D,k){const[Te,q,m,y]=D,U=m-Te,Ae=y-q;switch(this.rotation){case 0:return[Te,k-y,U,Ae];case 90:return[Te,k-q,Ae,U];case 180:return[m,k-q,U,Ae];case 270:return[m,k-y,Ae,U];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Ce(this,F,!0)}disableEditMode(){Ce(this,F,!1)}isInEditMode(){return t(this,F)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var D,k;(D=this.div)==null||D.addEventListener("focusin",t(this,M)),(k=this.div)==null||k.addEventListener("focusout",t(this,P))}serialize(D=!1,k=null){(0,d.unreachable)("An editor must be serializable")}static deserialize(D,k,Te){const q=new this.prototype.constructor({parent:k,id:k.getNextId(),uiManager:Te});q.rotation=D.rotation;const[m,y]=q.pageDimensions,[U,Ae,ye,Q]=q.getRectInCurrentCoords(D.rect,y);return q.x=U/m,q.y=Ae/y,q.width=ye/m,q.height=Q/y,q}remove(){var D;this.div.removeEventListener("focusin",t(this,M)),this.div.removeEventListener("focusout",t(this,P)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(D=t(this,r))==null||D.remove(),Ce(this,r,null),Ce(this,H,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(ne(this,s,Bn).call(this),t(this,u).classList.remove("hidden"))}select(){var D;this.makeResizable(),(D=this.div)==null||D.classList.add("selectedEditor")}unselect(){var D,k,Te;(D=t(this,u))==null||D.classList.add("hidden"),(k=this.div)==null||k.classList.remove("selectedEditor"),(Te=this.div)!=null&&Te.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(D,k){}disableEditing(){t(this,r)&&(t(this,r).hidden=!0)}enableEditing(){t(this,r)&&(t(this,r).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,S)}set isEditing(D){Ce(this,S,D),this.parent&&(D?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(D,k){Ce(this,g,!0);const Te=D/k,{style:q}=this.div;q.aspectRatio=Te,q.height="auto"}static get MIN_SIZE(){return 16}};E=new WeakMap,p=new WeakMap,r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,S=new WeakMap,F=new WeakMap,I=new WeakMap,o=new WeakMap,s=new WeakSet,Li=function([D,k],Te,q){[Te,q]=this.screenToPageTranslation(Te,q),this.x+=Te/D,this.y+=q/k,this.fixAndSetPosition()},Ri=function(){const[D,k]=this.parentDimensions,{_borderLineWidth:Te}=W,q=Te/D,m=Te/k;switch(this.rotation){case 90:return[-q,m];case 180:return[q,m];case 270:return[q,-m];default:return[-q,-m]}},T=new WeakSet,Ii=function(D,k,Te){switch(Te){case 90:return[k,-D];case 180:return[-D,-k];case 270:return[-k,D];default:return[D,k]}},ki=function(D){switch(D){case 90:{const[k,Te]=this.pageDimensions;return[0,-k/Te,Te/k,0]}case 180:return[-1,0,0,-1];case 270:{const[k,Te]=this.pageDimensions;return[0,k/Te,-Te/k,0]}default:return[1,0,0,1]}},Bn=function(){if(t(this,u))return;Ce(this,u,document.createElement("div")),t(this,u).classList.add("resizers");const D=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||D.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const k of D){const Te=document.createElement("div");t(this,u).append(Te),Te.classList.add("resizer",k),Te.addEventListener("pointerdown",ne(this,s,Vn).bind(this,k)),Te.addEventListener("contextmenu",re.noContextMenu)}this.div.prepend(t(this,u))},Vn=function(D,k){k.preventDefault();const{isMac:Te}=d.FeatureTest.platform;if(k.button!==0||k.ctrlKey&&Te)return;const q=ne(this,s,Un).bind(this,D),m=this._isDraggable;this._isDraggable=!1;const y={passive:!0,capture:!0};window.addEventListener("pointermove",q,y);const U=this.x,Ae=this.y,ye=this.width,Q=this.height,we=this.parent.div.style.cursor,Re=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(k.target).cursor;const Ne=()=>{this._isDraggable=m,window.removeEventListener("pointerup",Ne),window.removeEventListener("blur",Ne),window.removeEventListener("pointermove",q,y),this.parent.div.style.cursor=we,this.div.style.cursor=Re;const He=this.x,$e=this.y,qe=this.width,Ye=this.height;He===U&&$e===Ae&&qe===ye&&Ye===Q||this.addCommands({cmd:()=>{this.width=qe,this.height=Ye,this.x=He,this.y=$e;const[Oe,Fe]=this.parentDimensions;this.setDims(Oe*qe,Fe*Ye),this.fixAndSetPosition()},undo:()=>{this.width=ye,this.height=Q,this.x=U,this.y=Ae;const[Oe,Fe]=this.parentDimensions;this.setDims(Oe*ye,Fe*Q),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Ne),window.addEventListener("blur",Ne)},Un=function(D,k){const[Te,q]=this.parentDimensions,m=this.x,y=this.y,U=this.width,Ae=this.height,ye=W.MIN_SIZE/Te,Q=W.MIN_SIZE/q,we=Ze=>Math.round(Ze*1e4)/1e4,Re=ne(this,s,ki).call(this,this.rotation),Ne=(Ze,it)=>[Re[0]*Ze+Re[2]*it,Re[1]*Ze+Re[3]*it],He=ne(this,s,ki).call(this,360-this.rotation),$e=(Ze,it)=>[He[0]*Ze+He[2]*it,He[1]*Ze+He[3]*it];let qe,Ye,Oe=!1,Fe=!1;switch(D){case"topLeft":Oe=!0,qe=(Ze,it)=>[0,0],Ye=(Ze,it)=>[Ze,it];break;case"topMiddle":qe=(Ze,it)=>[Ze/2,0],Ye=(Ze,it)=>[Ze/2,it];break;case"topRight":Oe=!0,qe=(Ze,it)=>[Ze,0],Ye=(Ze,it)=>[0,it];break;case"middleRight":Fe=!0,qe=(Ze,it)=>[Ze,it/2],Ye=(Ze,it)=>[0,it/2];break;case"bottomRight":Oe=!0,qe=(Ze,it)=>[Ze,it],Ye=(Ze,it)=>[0,0];break;case"bottomMiddle":qe=(Ze,it)=>[Ze/2,it],Ye=(Ze,it)=>[Ze/2,0];break;case"bottomLeft":Oe=!0,qe=(Ze,it)=>[0,it],Ye=(Ze,it)=>[Ze,0];break;case"middleLeft":Fe=!0,qe=(Ze,it)=>[0,it/2],Ye=(Ze,it)=>[Ze,it/2];break}const J=qe(U,Ae),Ee=Ye(U,Ae);let Ie=Ne(...Ee);const z=we(m+Ie[0]),h=we(y+Ie[1]);let X=1,oe=1,[Z,Le]=this.screenToPageTranslation(k.movementX,k.movementY);if([Z,Le]=$e(Z/Te,Le/q),Oe){const Ze=Math.hypot(U,Ae);X=oe=Math.max(Math.min(Math.hypot(Ee[0]-J[0]-Z,Ee[1]-J[1]-Le)/Ze,1/U,1/Ae),ye/U,Q/Ae)}else Fe?X=Math.max(ye,Math.min(1,Math.abs(Ee[0]-J[0]-Z)))/U:oe=Math.max(Q,Math.min(1,Math.abs(Ee[1]-J[1]-Le)))/Ae;const De=we(U*X),Ge=we(Ae*oe);Ie=Ne(...Ye(De,Ge));const Ve=z-Ie[0],Je=h-Ie[1];this.width=De,this.height=Ge,this.x=Ve,this.y=Je,this.setDims(Te*De,q*Ge),this.fixAndSetPosition()},Di=async function(){var Te;const D=t(this,r);if(!D)return;if(!t(this,E)&&!t(this,p)){D.classList.remove("done"),(Te=t(this,H))==null||Te.remove();return}W._l10nPromise.get("editor_alt_text_edit_button_label").then(q=>{D.setAttribute("aria-label",q)});let k=t(this,H);if(!k){Ce(this,H,k=document.createElement("span")),k.className="tooltip",k.setAttribute("role","tooltip");const q=k.id=`alt-text-tooltip-${this.id}`;D.setAttribute("aria-describedby",q);const m=100;D.addEventListener("mouseenter",()=>{Ce(this,N,setTimeout(()=>{Ce(this,N,null),t(this,H).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},m))}),D.addEventListener("mouseleave",()=>{var y;clearTimeout(t(this,N)),Ce(this,N,null),(y=t(this,H))==null||y.classList.remove("show")})}D.classList.add("done"),k.innerText=t(this,p)?await W._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,E),k.parentNode||D.append(k)},Hn=function(D){if(!this._isDraggable)return;const k=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Te,q;k&&(Te={passive:!0,capture:!0},q=y=>{const[U,Ae]=this.screenToPageTranslation(y.movementX,y.movementY);this._uiManager.dragSelectedEditors(U,Ae)},window.addEventListener("pointermove",q,Te));const m=()=>{if(window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),k&&window.removeEventListener("pointermove",q,Te),Ce(this,x,!1),!this._uiManager.endDragSession()){const{isMac:y}=d.FeatureTest.platform;D.ctrlKey&&!y||D.shiftKey||D.metaKey&&y?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",m),window.addEventListener("blur",m)},Me(W,T),at(W,"_borderLineWidth",-1),at(W,"_colorManager",new n.ColorManager),at(W,"_zIndex",1),at(W,"SMALL_EDITOR_SIZE",0);let O=W;e.AnnotationEditor=O;class w extends O{constructor(D){super(D),this.annotationElementId=D.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(i,e,v)=>{var g,u,M,P,x,Fi,I,o,s,c,f,Wn,_,j,fe,te,_e,be,W,Pe,D,k,Te,q,m,y,U,Ae,ye,Q,we,Re,Ne,He,$e,qe,Ye,Oe,Fe,J,Ee,Ie,z,h,X,oe,Z,jn,Oi,Ni,li,Bi,Vi,Tt,$t,$n,zn,Ui,zt,Hi;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=re,e.opacityToHex=O;var n=v(1),d=v(6);function re(ut,Se,We){for(const et of We)Se.addEventListener(et,ut[et].bind(ut))}function O(ut){return Math.round(Math.min(255,Math.max(1,255*ut))).toString(16).padStart(2,"0")}class w{constructor(){Me(this,g,0)}getId(){return`${n.AnnotationEditorPrefix}${Ot(this,g)._++}`}}g=new WeakMap;const F=class F{constructor(){Me(this,x);Me(this,u,(0,n.getUuid)());Me(this,M,0);Me(this,P,null)}static get _isSVGFittingCanvas(){const Se='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',et=new OffscreenCanvas(1,3).getContext("2d"),rt=new Image;rt.src=Se;const ot=rt.decode().then(()=>(et.drawImage(rt,0,0,1,1,0,0,1,3),new Uint32Array(et.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",ot)}async getFromFile(Se){const{lastModified:We,name:et,size:rt,type:ot}=Se;return ne(this,x,Fi).call(this,`${We}_${et}_${rt}_${ot}`,Se)}async getFromUrl(Se){return ne(this,x,Fi).call(this,Se,Se)}async getFromId(Se){t(this,P)||Ce(this,P,new Map);const We=t(this,P).get(Se);return We?We.bitmap?(We.refCounter+=1,We):We.file?this.getFromFile(We.file):this.getFromUrl(We.url):null}getSvgUrl(Se){const We=t(this,P).get(Se);return We!=null&&We.isSvg?We.svgUrl:null}deleteId(Se){t(this,P)||Ce(this,P,new Map);const We=t(this,P).get(Se);We&&(We.refCounter-=1,We.refCounter===0&&(We.bitmap=null))}isValidId(Se){return Se.startsWith(`image_${t(this,u)}_`)}};u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakSet,Fi=async function(Se,We){t(this,P)||Ce(this,P,new Map);let et=t(this,P).get(Se);if(et===null)return null;if(et!=null&&et.bitmap)return et.refCounter+=1,et;try{et||(et={bitmap:null,id:`image_${t(this,u)}_${Ot(this,M)._++}`,refCounter:0,isSvg:!1});let rt;if(typeof We=="string"){et.url=We;const ot=await fetch(We);if(!ot.ok)throw new Error(ot.statusText);rt=await ot.blob()}else rt=et.file=We;if(rt.type==="image/svg+xml"){const ot=F._isSVGFittingCanvas,tt=new FileReader,ve=new Image,le=new Promise((ke,je)=>{ve.onload=()=>{et.bitmap=ve,et.isSvg=!0,ke()},tt.onload=async()=>{const ze=et.svgUrl=tt.result;ve.src=await ot?`${ze}#svgView(preserveAspectRatio(none))`:ze},ve.onerror=tt.onerror=je});tt.readAsDataURL(rt),await le}else et.bitmap=await createImageBitmap(rt);et.refCounter=1}catch(rt){console.error(rt),et=null}return t(this,P).set(Se,et),et&&t(this,P).set(et.id,et),et};let E=F;class p{constructor(Se=128){Me(this,I,[]);Me(this,o,!1);Me(this,s);Me(this,c,-1);Ce(this,s,Se)}add({cmd:Se,undo:We,mustExec:et,type:rt=NaN,overwriteIfSameType:ot=!1,keepUndo:tt=!1}){if(et&&Se(),t(this,o))return;const ve={cmd:Se,undo:We,type:rt};if(t(this,c)===-1){t(this,I).length>0&&(t(this,I).length=0),Ce(this,c,0),t(this,I).push(ve);return}if(ot&&t(this,I)[t(this,c)].type===rt){tt&&(ve.undo=t(this,I)[t(this,c)].undo),t(this,I)[t(this,c)]=ve;return}const le=t(this,c)+1;le===t(this,s)?t(this,I).splice(0,1):(Ce(this,c,le),le<t(this,I).length&&t(this,I).splice(le)),t(this,I).push(ve)}undo(){t(this,c)!==-1&&(Ce(this,o,!0),t(this,I)[t(this,c)].undo(),Ce(this,o,!1),Ce(this,c,t(this,c)-1))}redo(){t(this,c)<t(this,I).length-1&&(Ce(this,c,t(this,c)+1),Ce(this,o,!0),t(this,I)[t(this,c)].cmd(),Ce(this,o,!1))}hasSomethingToUndo(){return t(this,c)!==-1}hasSomethingToRedo(){return t(this,c)<t(this,I).length-1}destroy(){Ce(this,I,null)}}I=new WeakMap,o=new WeakMap,s=new WeakMap,c=new WeakMap,e.CommandManager=p;class r{constructor(Se){Me(this,f);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:We}=n.FeatureTest.platform;for(const[et,rt,ot={}]of Se)for(const tt of et){const ve=tt.startsWith("mac+");We&&ve?(this.callbacks.set(tt.slice(4),{callback:rt,options:ot}),this.allKeys.add(tt.split("+").at(-1))):!We&&!ve&&(this.callbacks.set(tt,{callback:rt,options:ot}),this.allKeys.add(tt.split("+").at(-1)))}}exec(Se,We){if(!this.allKeys.has(We.key))return;const et=this.callbacks.get(ne(this,f,Wn).call(this,We));if(!et)return;const{callback:rt,options:{bubbles:ot=!1,args:tt=[],checker:ve=null}}=et;ve&&!ve(Se,We)||(rt.bind(Se,...tt)(),ot||(We.stopPropagation(),We.preventDefault()))}}f=new WeakSet,Wn=function(Se){Se.altKey&&this.buffer.push("alt"),Se.ctrlKey&&this.buffer.push("ctrl"),Se.metaKey&&this.buffer.push("meta"),Se.shiftKey&&this.buffer.push("shift"),this.buffer.push(Se.key);const We=this.buffer.join("+");return this.buffer.length=0,We},e.KeyboardManager=r;const Y=class Y{get _colors(){const Se=new Map([["CanvasText",null],["Canvas",null]]);return(0,d.getColorValues)(Se),(0,n.shadow)(this,"_colors",Se)}convert(Se){const We=(0,d.getRGB)(Se);if(!window.matchMedia("(forced-colors: active)").matches)return We;for(const[et,rt]of this._colors)if(rt.every((ot,tt)=>ot===We[tt]))return Y._colorsMapping.get(et);return We}getHexCode(Se){const We=this._colors.get(Se);return We?n.Util.makeHexColor(...We):Se}};at(Y,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let H=Y;e.ColorManager=H;const ft=class ft{constructor(Se,We,et,rt,ot,tt){Me(this,Z);Me(this,_,null);Me(this,j,new Map);Me(this,fe,new Map);Me(this,te,null);Me(this,_e,null);Me(this,be,new p);Me(this,W,0);Me(this,Pe,new Set);Me(this,D,null);Me(this,k,null);Me(this,Te,new Set);Me(this,q,null);Me(this,m,new w);Me(this,y,!1);Me(this,U,!1);Me(this,Ae,null);Me(this,ye,n.AnnotationEditorType.NONE);Me(this,Q,new Set);Me(this,we,null);Me(this,Re,this.blur.bind(this));Me(this,Ne,this.focus.bind(this));Me(this,He,this.copy.bind(this));Me(this,$e,this.cut.bind(this));Me(this,qe,this.paste.bind(this));Me(this,Ye,this.keydown.bind(this));Me(this,Oe,this.onEditingAction.bind(this));Me(this,Fe,this.onPageChanging.bind(this));Me(this,J,this.onScaleChanging.bind(this));Me(this,Ee,this.onRotationChanging.bind(this));Me(this,Ie,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Me(this,z,[0,0]);Me(this,h,null);Me(this,X,null);Me(this,oe,null);Ce(this,X,Se),Ce(this,oe,We),Ce(this,te,et),this._eventBus=rt,this._eventBus._on("editingaction",t(this,Oe)),this._eventBus._on("pagechanging",t(this,Fe)),this._eventBus._on("scalechanging",t(this,J)),this._eventBus._on("rotationchanging",t(this,Ee)),Ce(this,_e,ot.annotationStorage),Ce(this,q,ot.filterFactory),Ce(this,we,tt),this.viewParameters={realScale:d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Se=ft.prototype,We=ot=>{const{activeElement:tt}=document;return tt&&t(ot,X).contains(tt)&&ot.hasSomethingToControl()},et=this.TRANSLATE_SMALL,rt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new r([[["ctrl+a","mac+meta+a"],Se.selectAll],[["ctrl+z","mac+meta+z"],Se.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Se.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Se.delete],[["Escape","mac+Escape"],Se.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Se.translateSelectedEditors,{args:[-et,0],checker:We}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Se.translateSelectedEditors,{args:[-rt,0],checker:We}],[["ArrowRight","mac+ArrowRight"],Se.translateSelectedEditors,{args:[et,0],checker:We}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Se.translateSelectedEditors,{args:[rt,0],checker:We}],[["ArrowUp","mac+ArrowUp"],Se.translateSelectedEditors,{args:[0,-et],checker:We}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Se.translateSelectedEditors,{args:[0,-rt],checker:We}],[["ArrowDown","mac+ArrowDown"],Se.translateSelectedEditors,{args:[0,et],checker:We}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Se.translateSelectedEditors,{args:[0,rt],checker:We}]]))}destroy(){ne(this,Z,li).call(this),ne(this,Z,Oi).call(this),this._eventBus._off("editingaction",t(this,Oe)),this._eventBus._off("pagechanging",t(this,Fe)),this._eventBus._off("scalechanging",t(this,J)),this._eventBus._off("rotationchanging",t(this,Ee));for(const Se of t(this,fe).values())Se.destroy();t(this,fe).clear(),t(this,j).clear(),t(this,Te).clear(),Ce(this,_,null),t(this,Q).clear(),t(this,be).destroy(),t(this,te).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,we)?t(this,q).addHCMFilter(t(this,we).foreground,t(this,we).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,X)).direction)}editAltText(Se){var We;(We=t(this,te))==null||We.editAltText(this,Se)}onPageChanging({pageNumber:Se}){Ce(this,W,Se-1)}focusMainContainer(){t(this,X).focus()}findParent(Se,We){for(const et of t(this,fe).values()){const{x:rt,y:ot,width:tt,height:ve}=et.div.getBoundingClientRect();if(Se>=rt&&Se<=rt+tt&&We>=ot&&We<=ot+ve)return et}return null}disableUserSelect(Se=!1){t(this,oe).classList.toggle("noUserSelect",Se)}addShouldRescale(Se){t(this,Te).add(Se)}removeShouldRescale(Se){t(this,Te).delete(Se)}onScaleChanging({scale:Se}){this.commitOrRemove(),this.viewParameters.realScale=Se*d.PixelsPerInch.PDF_TO_CSS_UNITS;for(const We of t(this,Te))We.onScaleChanging()}onRotationChanging({pagesRotation:Se}){this.commitOrRemove(),this.viewParameters.rotation=Se}addToAnnotationStorage(Se){!Se.isEmpty()&&t(this,_e)&&!t(this,_e).has(Se.id)&&t(this,_e).setValue(Se.id,Se)}blur(){if(!this.hasSelection)return;const{activeElement:Se}=document;for(const We of t(this,Q))if(We.div.contains(Se)){Ce(this,Ae,[We,Se]),We._focusEventsAllowed=!1;break}}focus(){if(!t(this,Ae))return;const[Se,We]=t(this,Ae);Ce(this,Ae,null),We.addEventListener("focusin",()=>{Se._focusEventsAllowed=!0},{once:!0}),We.focus()}addEditListeners(){ne(this,Z,Ni).call(this),ne(this,Z,Bi).call(this)}removeEditListeners(){ne(this,Z,li).call(this),ne(this,Z,Vi).call(this)}copy(Se){var et;if(Se.preventDefault(),(et=t(this,_))==null||et.commitOrRemove(),!this.hasSelection)return;const We=[];for(const rt of t(this,Q)){const ot=rt.serialize(!0);ot&&We.push(ot)}We.length!==0&&Se.clipboardData.setData("application/pdfjs",JSON.stringify(We))}cut(Se){this.copy(Se),this.delete()}paste(Se){Se.preventDefault();const{clipboardData:We}=Se;for(const ot of We.items)for(const tt of t(this,k))if(tt.isHandlingMimeForPasting(ot.type)){tt.paste(ot,this.currentLayer);return}let et=We.getData("application/pdfjs");if(!et)return;try{et=JSON.parse(et)}catch(ot){(0,n.warn)(`paste: "${ot.message}".`);return}if(!Array.isArray(et))return;this.unselectAll();const rt=this.currentLayer;try{const ot=[];for(const le of et){const ke=rt.deserialize(le);if(!ke)return;ot.push(ke)}const tt=()=>{for(const le of ot)ne(this,Z,Ui).call(this,le);ne(this,Z,Hi).call(this,ot)},ve=()=>{for(const le of ot)le.remove()};this.addCommands({cmd:tt,undo:ve,mustExec:!0})}catch(ot){(0,n.warn)(`paste: "${ot.message}".`)}}keydown(Se){var We;(We=this.getActive())!=null&&We.shouldGetKeyboardEvents()||ft._keyboardManager.exec(this,Se)}onEditingAction(Se){["undo","redo","delete","selectAll"].includes(Se.name)&&this[Se.name]()}setEditingState(Se){Se?(ne(this,Z,jn).call(this),ne(this,Z,Ni).call(this),ne(this,Z,Bi).call(this),ne(this,Z,Tt).call(this,{isEditing:t(this,ye)!==n.AnnotationEditorType.NONE,isEmpty:ne(this,Z,zt).call(this),hasSomethingToUndo:t(this,be).hasSomethingToUndo(),hasSomethingToRedo:t(this,be).hasSomethingToRedo(),hasSelectedEditor:!1})):(ne(this,Z,Oi).call(this),ne(this,Z,li).call(this),ne(this,Z,Vi).call(this),ne(this,Z,Tt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Se){if(!t(this,k)){Ce(this,k,Se);for(const We of t(this,k))ne(this,Z,$t).call(this,We.defaultPropertiesToUpdate)}}getId(){return t(this,m).getId()}get currentLayer(){return t(this,fe).get(t(this,W))}getLayer(Se){return t(this,fe).get(Se)}get currentPageIndex(){return t(this,W)}addLayer(Se){t(this,fe).set(Se.pageIndex,Se),t(this,y)?Se.enable():Se.disable()}removeLayer(Se){t(this,fe).delete(Se.pageIndex)}updateMode(Se,We=null){if(t(this,ye)!==Se){if(Ce(this,ye,Se),Se===n.AnnotationEditorType.NONE){this.setEditingState(!1),ne(this,Z,zn).call(this);return}this.setEditingState(!0),ne(this,Z,$n).call(this),this.unselectAll();for(const et of t(this,fe).values())et.updateMode(Se);if(We){for(const et of t(this,j).values())if(et.annotationElementId===We){this.setSelected(et),et.enterInEditMode();break}}}}updateToolbar(Se){Se!==t(this,ye)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Se})}updateParams(Se,We){if(t(this,k)){if(Se===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Se);return}for(const et of t(this,Q))et.updateParams(Se,We);for(const et of t(this,k))et.updateDefaultParams(Se,We)}}enableWaiting(Se=!1){if(t(this,U)!==Se){Ce(this,U,Se);for(const We of t(this,fe).values())Se?We.disableClick():We.enableClick(),We.div.classList.toggle("waiting",Se)}}getEditors(Se){const We=[];for(const et of t(this,j).values())et.pageIndex===Se&&We.push(et);return We}getEditor(Se){return t(this,j).get(Se)}addEditor(Se){t(this,j).set(Se.id,Se)}removeEditor(Se){var We;t(this,j).delete(Se.id),this.unselect(Se),(!Se.annotationElementId||!t(this,Pe).has(Se.annotationElementId))&&((We=t(this,_e))==null||We.remove(Se.id))}addDeletedAnnotationElement(Se){t(this,Pe).add(Se.annotationElementId),Se.deleted=!0}isDeletedAnnotationElement(Se){return t(this,Pe).has(Se)}removeDeletedAnnotationElement(Se){t(this,Pe).delete(Se.annotationElementId),Se.deleted=!1}setActiveEditor(Se){t(this,_)!==Se&&(Ce(this,_,Se),Se&&ne(this,Z,$t).call(this,Se.propertiesToUpdate))}toggleSelected(Se){if(t(this,Q).has(Se)){t(this,Q).delete(Se),Se.unselect(),ne(this,Z,Tt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,Q).add(Se),Se.select(),ne(this,Z,$t).call(this,Se.propertiesToUpdate),ne(this,Z,Tt).call(this,{hasSelectedEditor:!0})}setSelected(Se){for(const We of t(this,Q))We!==Se&&We.unselect();t(this,Q).clear(),t(this,Q).add(Se),Se.select(),ne(this,Z,$t).call(this,Se.propertiesToUpdate),ne(this,Z,Tt).call(this,{hasSelectedEditor:!0})}isSelected(Se){return t(this,Q).has(Se)}unselect(Se){Se.unselect(),t(this,Q).delete(Se),ne(this,Z,Tt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,Q).size!==0}undo(){t(this,be).undo(),ne(this,Z,Tt).call(this,{hasSomethingToUndo:t(this,be).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ne(this,Z,zt).call(this)})}redo(){t(this,be).redo(),ne(this,Z,Tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,be).hasSomethingToRedo(),isEmpty:ne(this,Z,zt).call(this)})}addCommands(Se){t(this,be).add(Se),ne(this,Z,Tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ne(this,Z,zt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Se=[...t(this,Q)],We=()=>{for(const rt of Se)rt.remove()},et=()=>{for(const rt of Se)ne(this,Z,Ui).call(this,rt)};this.addCommands({cmd:We,undo:et,mustExec:!0})}commitOrRemove(){var Se;(Se=t(this,_))==null||Se.commitOrRemove()}hasSomethingToControl(){return t(this,_)||this.hasSelection}selectAll(){for(const Se of t(this,Q))Se.commit();ne(this,Z,Hi).call(this,t(this,j).values())}unselectAll(){if(t(this,_)){t(this,_).commitOrRemove();return}if(this.hasSelection){for(const Se of t(this,Q))Se.unselect();t(this,Q).clear(),ne(this,Z,Tt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Se,We,et=!1){if(et||this.commitOrRemove(),!this.hasSelection)return;t(this,z)[0]+=Se,t(this,z)[1]+=We;const[rt,ot]=t(this,z),tt=[...t(this,Q)],ve=1e3;t(this,h)&&clearTimeout(t(this,h)),Ce(this,h,setTimeout(()=>{Ce(this,h,null),t(this,z)[0]=t(this,z)[1]=0,this.addCommands({cmd:()=>{for(const le of tt)t(this,j).has(le.id)&&le.translateInPage(rt,ot)},undo:()=>{for(const le of tt)t(this,j).has(le.id)&&le.translateInPage(-rt,-ot)},mustExec:!1})},ve));for(const le of tt)le.translateInPage(Se,We)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Ce(this,D,new Map);for(const Se of t(this,Q))t(this,D).set(Se,{savedX:Se.x,savedY:Se.y,savedPageIndex:Se.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,D))return!1;this.disableUserSelect(!1);const Se=t(this,D);Ce(this,D,null);let We=!1;for(const[{x:rt,y:ot,pageIndex:tt},ve]of Se)ve.newX=rt,ve.newY=ot,ve.newPageIndex=tt,We||(We=rt!==ve.savedX||ot!==ve.savedY||tt!==ve.savedPageIndex);if(!We)return!1;const et=(rt,ot,tt,ve)=>{if(t(this,j).has(rt.id)){const le=t(this,fe).get(ve);le?rt._setParentAndPosition(le,ot,tt):(rt.pageIndex=ve,rt.x=ot,rt.y=tt)}};return this.addCommands({cmd:()=>{for(const[rt,{newX:ot,newY:tt,newPageIndex:ve}]of Se)et(rt,ot,tt,ve)},undo:()=>{for(const[rt,{savedX:ot,savedY:tt,savedPageIndex:ve}]of Se)et(rt,ot,tt,ve)},mustExec:!0}),!0}dragSelectedEditors(Se,We){if(t(this,D))for(const et of t(this,D).keys())et.drag(Se,We)}rebuild(Se){if(Se.parent===null){const We=this.getLayer(Se.pageIndex);We?(We.changeParent(Se),We.addOrRebuild(Se)):(this.addEditor(Se),this.addToAnnotationStorage(Se),Se.rebuild())}else Se.parent.addOrRebuild(Se)}isActive(Se){return t(this,_)===Se}getActive(){return t(this,_)}getMode(){return t(this,ye)}get imageManager(){return(0,n.shadow)(this,"imageManager",new E)}};_=new WeakMap,j=new WeakMap,fe=new WeakMap,te=new WeakMap,_e=new WeakMap,be=new WeakMap,W=new WeakMap,Pe=new WeakMap,D=new WeakMap,k=new WeakMap,Te=new WeakMap,q=new WeakMap,m=new WeakMap,y=new WeakMap,U=new WeakMap,Ae=new WeakMap,ye=new WeakMap,Q=new WeakMap,we=new WeakMap,Re=new WeakMap,Ne=new WeakMap,He=new WeakMap,$e=new WeakMap,qe=new WeakMap,Ye=new WeakMap,Oe=new WeakMap,Fe=new WeakMap,J=new WeakMap,Ee=new WeakMap,Ie=new WeakMap,z=new WeakMap,h=new WeakMap,X=new WeakMap,oe=new WeakMap,Z=new WeakSet,jn=function(){window.addEventListener("focus",t(this,Ne)),window.addEventListener("blur",t(this,Re))},Oi=function(){window.removeEventListener("focus",t(this,Ne)),window.removeEventListener("blur",t(this,Re))},Ni=function(){window.addEventListener("keydown",t(this,Ye),{capture:!0})},li=function(){window.removeEventListener("keydown",t(this,Ye),{capture:!0})},Bi=function(){document.addEventListener("copy",t(this,He)),document.addEventListener("cut",t(this,$e)),document.addEventListener("paste",t(this,qe))},Vi=function(){document.removeEventListener("copy",t(this,He)),document.removeEventListener("cut",t(this,$e)),document.removeEventListener("paste",t(this,qe))},Tt=function(Se){Object.entries(Se).some(([et,rt])=>t(this,Ie)[et]!==rt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Ie),Se)})},$t=function(Se){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Se})},$n=function(){if(!t(this,y)){Ce(this,y,!0);for(const Se of t(this,fe).values())Se.enable()}},zn=function(){if(this.unselectAll(),t(this,y)){Ce(this,y,!1);for(const Se of t(this,fe).values())Se.disable()}},Ui=function(Se){const We=t(this,fe).get(Se.pageIndex);We?We.addOrRebuild(Se):this.addEditor(Se)},zt=function(){if(t(this,j).size===0)return!0;if(t(this,j).size===1)for(const Se of t(this,j).values())return Se.isEmpty();return!1},Hi=function(Se){t(this,Q).clear();for(const We of Se)We.isEmpty()||(t(this,Q).add(We),We.select());ne(this,Z,Tt).call(this,{hasSelectedEditor:!0})},at(ft,"TRANSLATE_SMALL",1),at(ft,"TRANSLATE_BIG",10);let N=ft;e.AnnotationEditorUIManager=N},(i,e,v)=>{var W,Pe,D,k,Te,q,m,y,U,Ae,ye,Q,Bt,Vt,Wi,ci,hi,Gt,Xt;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=c,e.getColorValues=j,e.getCurrentTransform=fe,e.getCurrentTransformInverse=te,e.getFilenameFromUrl=x,e.getPdfFilenameFromUrl=S,e.getRGB=_,e.getXfaPageViewport=Y,e.isDataScheme=M,e.isPdfFile=P,e.isValidFetchUrl=I,e.loadScript=s,e.noContextMenu=o,e.setLayerDimensions=_e;var n=v(7),d=v(1);const re="http://www.w3.org/2000/svg",be=class be{};at(be,"CSS",96),at(be,"PDF",72),at(be,"PDF_TO_CSS_UNITS",be.CSS/be.PDF);let O=be;e.PixelsPerInch=O;class w extends n.BaseFilterFactory{constructor({docId:J,ownerDocument:Ee=globalThis.document}={}){super();Me(this,Q);Me(this,W);Me(this,Pe);Me(this,D);Me(this,k);Me(this,Te);Me(this,q);Me(this,m);Me(this,y);Me(this,U);Me(this,Ae);Me(this,ye,0);Ce(this,D,J),Ce(this,k,Ee)}addFilter(J){if(!J)return"none";let Ee=t(this,Q,Bt).get(J);if(Ee)return Ee;let Ie,z,h,X;if(J.length===1){const De=J[0],Ge=new Array(256);for(let Ve=0;Ve<256;Ve++)Ge[Ve]=De[Ve]/255;X=Ie=z=h=Ge.join(",")}else{const[De,Ge,Ve]=J,Je=new Array(256),Ze=new Array(256),it=new Array(256);for(let pt=0;pt<256;pt++)Je[pt]=De[pt]/255,Ze[pt]=Ge[pt]/255,it[pt]=Ve[pt]/255;Ie=Je.join(","),z=Ze.join(","),h=it.join(","),X=`${Ie}${z}${h}`}if(Ee=t(this,Q,Bt).get(X),Ee)return t(this,Q,Bt).set(J,Ee),Ee;const oe=`g_${t(this,D)}_transfer_map_${Ot(this,ye)._++}`,Z=`url(#${oe})`;t(this,Q,Bt).set(J,Z),t(this,Q,Bt).set(X,Z);const Le=ne(this,Q,ci).call(this,oe);return ne(this,Q,Gt).call(this,Ie,z,h,Le),Z}addHCMFilter(J,Ee){var Ge;const Ie=`${J}-${Ee}`;if(t(this,q)===Ie)return t(this,m);if(Ce(this,q,Ie),Ce(this,m,"none"),(Ge=t(this,Te))==null||Ge.remove(),!J||!Ee)return t(this,m);const z=ne(this,Q,Xt).call(this,J);J=d.Util.makeHexColor(...z);const h=ne(this,Q,Xt).call(this,Ee);if(Ee=d.Util.makeHexColor(...h),t(this,Q,Vt).style.color="",J==="#000000"&&Ee==="#ffffff"||J===Ee)return t(this,m);const X=new Array(256);for(let Ve=0;Ve<=255;Ve++){const Je=Ve/255;X[Ve]=Je<=.03928?Je/12.92:((Je+.055)/1.055)**2.4}const oe=X.join(","),Z=`g_${t(this,D)}_hcm_filter`,Le=Ce(this,y,ne(this,Q,ci).call(this,Z));ne(this,Q,Gt).call(this,oe,oe,oe,Le),ne(this,Q,Wi).call(this,Le);const De=(Ve,Je)=>{const Ze=z[Ve]/255,it=h[Ve]/255,pt=new Array(Je+1);for(let mt=0;mt<=Je;mt++)pt[mt]=Ze+mt/Je*(it-Ze);return pt.join(",")};return ne(this,Q,Gt).call(this,De(0,5),De(1,5),De(2,5),Le),Ce(this,m,`url(#${Z})`),t(this,m)}addHighlightHCMFilter(J,Ee,Ie,z){var it;const h=`${J}-${Ee}-${Ie}-${z}`;if(t(this,U)===h)return t(this,Ae);if(Ce(this,U,h),Ce(this,Ae,"none"),(it=t(this,y))==null||it.remove(),!J||!Ee)return t(this,Ae);const[X,oe]=[J,Ee].map(ne(this,Q,Xt).bind(this));let Z=Math.round(.2126*X[0]+.7152*X[1]+.0722*X[2]),Le=Math.round(.2126*oe[0]+.7152*oe[1]+.0722*oe[2]),[De,Ge]=[Ie,z].map(ne(this,Q,Xt).bind(this));Le<Z&&([Z,Le,De,Ge]=[Le,Z,Ge,De]),t(this,Q,Vt).style.color="";const Ve=(pt,mt,Xe)=>{const Be=new Array(256),Ue=(Le-Z)/Xe,nt=pt/255,ft=(mt-pt)/(255*Xe);let ut=0;for(let Se=0;Se<=Xe;Se++){const We=Math.round(Z+Se*Ue),et=nt+Se*ft;for(let rt=ut;rt<=We;rt++)Be[rt]=et;ut=We+1}for(let Se=ut;Se<256;Se++)Be[Se]=Be[ut-1];return Be.join(",")},Je=`g_${t(this,D)}_hcm_highlight_filter`,Ze=Ce(this,y,ne(this,Q,ci).call(this,Je));return ne(this,Q,Wi).call(this,Ze),ne(this,Q,Gt).call(this,Ve(De[0],Ge[0],5),Ve(De[1],Ge[1],5),Ve(De[2],Ge[2],5),Ze),Ce(this,Ae,`url(#${Je})`),t(this,Ae)}destroy(J=!1){J&&(t(this,m)||t(this,Ae))||(t(this,Pe)&&(t(this,Pe).parentNode.parentNode.remove(),Ce(this,Pe,null)),t(this,W)&&(t(this,W).clear(),Ce(this,W,null)),Ce(this,ye,0))}}W=new WeakMap,Pe=new WeakMap,D=new WeakMap,k=new WeakMap,Te=new WeakMap,q=new WeakMap,m=new WeakMap,y=new WeakMap,U=new WeakMap,Ae=new WeakMap,ye=new WeakMap,Q=new WeakSet,Bt=function(){return t(this,W)||Ce(this,W,new Map)},Vt=function(){if(!t(this,Pe)){const J=t(this,k).createElement("div"),{style:Ee}=J;Ee.visibility="hidden",Ee.contain="strict",Ee.width=Ee.height=0,Ee.position="absolute",Ee.top=Ee.left=0,Ee.zIndex=-1;const Ie=t(this,k).createElementNS(re,"svg");Ie.setAttribute("width",0),Ie.setAttribute("height",0),Ce(this,Pe,t(this,k).createElementNS(re,"defs")),J.append(Ie),Ie.append(t(this,Pe)),t(this,k).body.append(J)}return t(this,Pe)},Wi=function(J){const Ee=t(this,k).createElementNS(re,"feColorMatrix");Ee.setAttribute("type","matrix"),Ee.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),J.append(Ee)},ci=function(J){const Ee=t(this,k).createElementNS(re,"filter");return Ee.setAttribute("color-interpolation-filters","sRGB"),Ee.setAttribute("id",J),t(this,Q,Vt).append(Ee),Ee},hi=function(J,Ee,Ie){const z=t(this,k).createElementNS(re,Ee);z.setAttribute("type","discrete"),z.setAttribute("tableValues",Ie),J.append(z)},Gt=function(J,Ee,Ie,z){const h=t(this,k).createElementNS(re,"feComponentTransfer");z.append(h),ne(this,Q,hi).call(this,h,"feFuncR",J),ne(this,Q,hi).call(this,h,"feFuncG",Ee),ne(this,Q,hi).call(this,h,"feFuncB",Ie)},Xt=function(J){return t(this,Q,Vt).style.color=J,_(getComputedStyle(t(this,Q,Vt)).getPropertyValue("color"))},e.DOMFilterFactory=w;class E extends n.BaseCanvasFactory{constructor({ownerDocument:Fe=globalThis.document}={}){super(),this._document=Fe}_createCanvas(Fe,J){const Ee=this._document.createElement("canvas");return Ee.width=Fe,Ee.height=J,Ee}}e.DOMCanvasFactory=E;async function p(Oe,Fe=!1){if(I(Oe,document.baseURI)){const J=await fetch(Oe);if(!J.ok)throw new Error(J.statusText);return Fe?new Uint8Array(await J.arrayBuffer()):(0,d.stringToBytes)(await J.text())}return new Promise((J,Ee)=>{const Ie=new XMLHttpRequest;Ie.open("GET",Oe,!0),Fe&&(Ie.responseType="arraybuffer"),Ie.onreadystatechange=()=>{if(Ie.readyState===XMLHttpRequest.DONE){if(Ie.status===200||Ie.status===0){let z;if(Fe&&Ie.response?z=new Uint8Array(Ie.response):!Fe&&Ie.responseText&&(z=(0,d.stringToBytes)(Ie.responseText)),z){J(z);return}}Ee(new Error(Ie.statusText))}},Ie.send(null)})}class r extends n.BaseCMapReaderFactory{_fetchData(Fe,J){return p(Fe,this.isCompressed).then(Ee=>({cMapData:Ee,compressionType:J}))}}e.DOMCMapReaderFactory=r;class H extends n.BaseStandardFontDataFactory{_fetchData(Fe){return p(Fe,!0)}}e.DOMStandardFontDataFactory=H;class N extends n.BaseSVGFactory{_createSVG(Fe){return document.createElementNS(re,Fe)}}e.DOMSVGFactory=N;class g{constructor({viewBox:Fe,scale:J,rotation:Ee,offsetX:Ie=0,offsetY:z=0,dontFlip:h=!1}){this.viewBox=Fe,this.scale=J,this.rotation=Ee,this.offsetX=Ie,this.offsetY=z;const X=(Fe[2]+Fe[0])/2,oe=(Fe[3]+Fe[1])/2;let Z,Le,De,Ge;switch(Ee%=360,Ee<0&&(Ee+=360),Ee){case 180:Z=-1,Le=0,De=0,Ge=1;break;case 90:Z=0,Le=1,De=1,Ge=0;break;case 270:Z=0,Le=-1,De=-1,Ge=0;break;case 0:Z=1,Le=0,De=0,Ge=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}h&&(De=-De,Ge=-Ge);let Ve,Je,Ze,it;Z===0?(Ve=Math.abs(oe-Fe[1])*J+Ie,Je=Math.abs(X-Fe[0])*J+z,Ze=(Fe[3]-Fe[1])*J,it=(Fe[2]-Fe[0])*J):(Ve=Math.abs(X-Fe[0])*J+Ie,Je=Math.abs(oe-Fe[1])*J+z,Ze=(Fe[2]-Fe[0])*J,it=(Fe[3]-Fe[1])*J),this.transform=[Z*J,Le*J,De*J,Ge*J,Ve-Z*J*X-De*J*oe,Je-Le*J*X-Ge*J*oe],this.width=Ze,this.height=it}get rawDims(){const{viewBox:Fe}=this;return(0,d.shadow)(this,"rawDims",{pageWidth:Fe[2]-Fe[0],pageHeight:Fe[3]-Fe[1],pageX:Fe[0],pageY:Fe[1]})}clone({scale:Fe=this.scale,rotation:J=this.rotation,offsetX:Ee=this.offsetX,offsetY:Ie=this.offsetY,dontFlip:z=!1}={}){return new g({viewBox:this.viewBox.slice(),scale:Fe,rotation:J,offsetX:Ee,offsetY:Ie,dontFlip:z})}convertToViewportPoint(Fe,J){return d.Util.applyTransform([Fe,J],this.transform)}convertToViewportRectangle(Fe){const J=d.Util.applyTransform([Fe[0],Fe[1]],this.transform),Ee=d.Util.applyTransform([Fe[2],Fe[3]],this.transform);return[J[0],J[1],Ee[0],Ee[1]]}convertToPdfPoint(Fe,J){return d.Util.applyInverseTransform([Fe,J],this.transform)}}e.PageViewport=g;class u extends d.BaseException{constructor(Fe,J=0){super(Fe,"RenderingCancelledException"),this.extraDelay=J}}e.RenderingCancelledException=u;function M(Oe){const Fe=Oe.length;let J=0;for(;J<Fe&&Oe[J].trim()==="";)J++;return Oe.substring(J,J+5).toLowerCase()==="data:"}function P(Oe){return typeof Oe=="string"&&/\.pdf$/i.test(Oe)}function x(Oe,Fe=!1){return Fe||([Oe]=Oe.split(/[#?]/,1)),Oe.substring(Oe.lastIndexOf("/")+1)}function S(Oe,Fe="document.pdf"){if(typeof Oe!="string")return Fe;if(M(Oe))return(0,d.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Fe;const J=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Ee=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Ie=J.exec(Oe);let z=Ee.exec(Ie[1])||Ee.exec(Ie[2])||Ee.exec(Ie[3]);if(z&&(z=z[0],z.includes("%")))try{z=Ee.exec(decodeURIComponent(z))[0]}catch{}return z||Fe}class F{constructor(){at(this,"started",Object.create(null));at(this,"times",[])}time(Fe){Fe in this.started&&(0,d.warn)(`Timer is already running for ${Fe}`),this.started[Fe]=Date.now()}timeEnd(Fe){Fe in this.started||(0,d.warn)(`Timer has not been started for ${Fe}`),this.times.push({name:Fe,start:this.started[Fe],end:Date.now()}),delete this.started[Fe]}toString(){const Fe=[];let J=0;for(const{name:Ee}of this.times)J=Math.max(Ee.length,J);for(const{name:Ee,start:Ie,end:z}of this.times)Fe.push(`${Ee.padEnd(J)} ${z-Ie}ms
`);return Fe.join("")}}e.StatTimer=F;function I(Oe,Fe){try{const{protocol:J}=Fe?new URL(Oe,Fe):new URL(Oe);return J==="http:"||J==="https:"}catch{return!1}}function o(Oe){Oe.preventDefault()}function s(Oe,Fe=!1){return new Promise((J,Ee)=>{const Ie=document.createElement("script");Ie.src=Oe,Ie.onload=function(z){Fe&&Ie.remove(),J(z)},Ie.onerror=function(){Ee(new Error(`Cannot load script at: ${Ie.src}`))},(document.head||document.documentElement).append(Ie)})}function c(Oe){console.log("Deprecated API usage: "+Oe)}let f;class T{static toDateObject(Fe){if(!Fe||typeof Fe!="string")return null;f||(f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const J=f.exec(Fe);if(!J)return null;const Ee=parseInt(J[1],10);let Ie=parseInt(J[2],10);Ie=Ie>=1&&Ie<=12?Ie-1:0;let z=parseInt(J[3],10);z=z>=1&&z<=31?z:1;let h=parseInt(J[4],10);h=h>=0&&h<=23?h:0;let X=parseInt(J[5],10);X=X>=0&&X<=59?X:0;let oe=parseInt(J[6],10);oe=oe>=0&&oe<=59?oe:0;const Z=J[7]||"Z";let Le=parseInt(J[8],10);Le=Le>=0&&Le<=23?Le:0;let De=parseInt(J[9],10)||0;return De=De>=0&&De<=59?De:0,Z==="-"?(h+=Le,X+=De):Z==="+"&&(h-=Le,X-=De),new Date(Date.UTC(Ee,Ie,z,h,X,oe))}}e.PDFDateString=T;function Y(Oe,{scale:Fe=1,rotation:J=0}){const{width:Ee,height:Ie}=Oe.attributes.style,z=[0,0,parseInt(Ee),parseInt(Ie)];return new g({viewBox:z,scale:Fe,rotation:J})}function _(Oe){if(Oe.startsWith("#")){const Fe=parseInt(Oe.slice(1),16);return[(Fe&16711680)>>16,(Fe&65280)>>8,Fe&255]}return Oe.startsWith("rgb(")?Oe.slice(4,-1).split(",").map(Fe=>parseInt(Fe)):Oe.startsWith("rgba(")?Oe.slice(5,-1).split(",").map(Fe=>parseInt(Fe)).slice(0,3):((0,d.warn)(`Not a valid color format: "${Oe}"`),[0,0,0])}function j(Oe){const Fe=document.createElement("span");Fe.style.visibility="hidden",document.body.append(Fe);for(const J of Oe.keys()){Fe.style.color=J;const Ee=window.getComputedStyle(Fe).color;Oe.set(J,_(Ee))}Fe.remove()}function fe(Oe){const{a:Fe,b:J,c:Ee,d:Ie,e:z,f:h}=Oe.getTransform();return[Fe,J,Ee,Ie,z,h]}function te(Oe){const{a:Fe,b:J,c:Ee,d:Ie,e:z,f:h}=Oe.getTransform().invertSelf();return[Fe,J,Ee,Ie,z,h]}function _e(Oe,Fe,J=!1,Ee=!0){if(Fe instanceof g){const{pageWidth:Ie,pageHeight:z}=Fe.rawDims,{style:h}=Oe,X=d.FeatureTest.isCSSRoundSupported,oe=`var(--scale-factor) * ${Ie}px`,Z=`var(--scale-factor) * ${z}px`,Le=X?`round(${oe}, 1px)`:`calc(${oe})`,De=X?`round(${Z}, 1px)`:`calc(${Z})`;!J||Fe.rotation%180===0?(h.width=Le,h.height=De):(h.width=De,h.height=Le)}Ee&&Oe.setAttribute("data-main-rotation",Fe.rotation)}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=v(1);class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(r){return"none"}addHCMFilter(r,H){return"none"}addHighlightHCMFilter(r,H,N,g){return"none"}destroy(r=!1){}}e.BaseFilterFactory=d;class re{constructor(){this.constructor===re&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(r,H){if(r<=0||H<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(r,H);return{canvas:N,context:N.getContext("2d")}}reset(r,H,N){if(!r.canvas)throw new Error("Canvas is not specified");if(H<=0||N<=0)throw new Error("Invalid canvas size");r.canvas.width=H,r.canvas.height=N}destroy(r){if(!r.canvas)throw new Error("Canvas is not specified");r.canvas.width=0,r.canvas.height=0,r.canvas=null,r.context=null}_createCanvas(r,H){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=re;class O{constructor({baseUrl:r=null,isCompressed:H=!0}){this.constructor===O&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=r,this.isCompressed=H}async fetch({name:r}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!r)throw new Error("CMap name must be specified.");const H=this.baseUrl+r+(this.isCompressed?".bcmap":""),N=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(H,N).catch(g=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${H}`)})}_fetchData(r,H){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=O;class w{constructor({baseUrl:r=null}){this.constructor===w&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=r}async fetch({filename:r}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!r)throw new Error("Font filename must be specified.");const H=`${this.baseUrl}${r}`;return this._fetchData(H).catch(N=>{throw new Error(`Unable to load font data at: ${H}`)})}_fetchData(r){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=w;class E{constructor(){this.constructor===E&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(r,H,N=!1){if(r<=0||H<=0)throw new Error("Invalid SVG dimensions");const g=this._createSVG("svg:svg");return g.setAttribute("version","1.1"),N||(g.setAttribute("width",`${r}px`),g.setAttribute("height",`${H}px`)),g.setAttribute("preserveAspectRatio","none"),g.setAttribute("viewBox",`0 0 ${r} ${H}`),g}createElement(r){if(typeof r!="string")throw new Error("Invalid SVG element type");return this._createSVG(r)}_createSVG(r){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=E},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=v(1);const d=3285377520,re=4294901760,O=65535;class w{constructor(p){this.h1=p?p&4294967295:d,this.h2=p?p&4294967295:d}update(p){let r,H;if(typeof p=="string"){r=new Uint8Array(p.length*2),H=0;for(let c=0,f=p.length;c<f;c++){const T=p.charCodeAt(c);T<=255?r[H++]=T:(r[H++]=T>>>8,r[H++]=T&255)}}else if((0,n.isArrayBuffer)(p))r=p.slice(),H=r.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const N=H>>2,g=H-N*4,u=new Uint32Array(r.buffer,0,N);let M=0,P=0,x=this.h1,S=this.h2;const F=3432918353,I=461845907,o=F&O,s=I&O;for(let c=0;c<N;c++)c&1?(M=u[c],M=M*F&re|M*o&O,M=M<<15|M>>>17,M=M*I&re|M*s&O,x^=M,x=x<<13|x>>>19,x=x*5+3864292196):(P=u[c],P=P*F&re|P*o&O,P=P<<15|P>>>17,P=P*I&re|P*s&O,S^=P,S=S<<13|S>>>19,S=S*5+3864292196);switch(M=0,g){case 3:M^=r[N*4+2]<<16;case 2:M^=r[N*4+1]<<8;case 1:M^=r[N*4],M=M*F&re|M*o&O,M=M<<15|M>>>17,M=M*I&re|M*s&O,N&1?x^=M:S^=M}this.h1=x,this.h2=S}hexdigest(){let p=this.h1,r=this.h2;return p^=r>>>1,p=p*3981806797&re|p*36045&O,r=r*4283543511&re|((r<<16|p>>>16)*2950163797&re)>>>16,p^=r>>>1,p=p*444984403&re|p*60499&O,r=r*3301882366&re|((r<<16|p>>>16)*3120437893&re)>>>16,p^=r>>>1,(p>>>0).toString(16).padStart(8,"0")+(r>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=w},(i,e,v)=>{var O;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=v(1);class d{constructor({ownerDocument:E=globalThis.document,styleElement:p=null}){Me(this,O,new Set);this._document=E,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(E){this.nativeFontFaces.add(E),this._document.fonts.add(E)}removeNativeFontFace(E){this.nativeFontFaces.delete(E),this._document.fonts.delete(E)}insertRule(E){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const p=this.styleElement.sheet;p.insertRule(E,p.cssRules.length)}clear(){for(const E of this.nativeFontFaces)this._document.fonts.delete(E);this.nativeFontFaces.clear(),t(this,O).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(E){if(!(!E||t(this,O).has(E.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:p,src:r,style:H}=E,N=new FontFace(p,r,H);this.addNativeFontFace(N);try{await N.load(),t(this,O).add(p)}catch{(0,n.warn)(`Cannot load system font: ${E.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(N)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(E){if(E.attached||E.missingFile&&!E.systemFontInfo)return;if(E.attached=!0,E.systemFontInfo){await this.loadSystemFont(E.systemFontInfo);return}if(this.isFontLoadingAPISupported){const r=E.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(H){throw(0,n.warn)(`Failed to load font '${r.family}': '${H}'.`),E.disableFontFace=!0,H}}return}const p=E.createFontFaceRule();if(p){if(this.insertRule(p),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const H=this._queueLoadingCallback(r);this._prepareFontLoadEvent(E,H)})}}get isFontLoadingAPISupported(){var p;const E=!!((p=this._document)!=null&&p.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",E)}get isSyncFontLoadingSupported(){let E=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(E=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",E)}_queueLoadingCallback(E){function p(){for((0,n.assert)(!H.done,"completeRequest() cannot be called twice."),H.done=!0;r.length>0&&r[0].done;){const N=r.shift();setTimeout(N.callback,0)}}const{loadingRequests:r}=this,H={done:!1,complete:p,callback:E};return r.push(H),H}get _loadTestFont(){const E=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",E)}_prepareFontLoadEvent(E,p){function r(_,j){return _.charCodeAt(j)<<24|_.charCodeAt(j+1)<<16|_.charCodeAt(j+2)<<8|_.charCodeAt(j+3)&255}function H(_,j,fe,te){const _e=_.substring(0,j),be=_.substring(j+fe);return _e+te+be}let N,g;const u=this._document.createElement("canvas");u.width=1,u.height=1;const M=u.getContext("2d");let P=0;function x(_,j){if(++P>30){(0,n.warn)("Load test font never loaded."),j();return}if(M.font="30px "+_,M.fillText(".",0,20),M.getImageData(0,0,1,1).data[3]>0){j();return}setTimeout(x.bind(null,_,j))}const S=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=H(F,976,S.length,S);const o=16,s=1482184792;let c=r(F,o);for(N=0,g=S.length-3;N<g;N+=4)c=c-s+r(S,N)|0;N<S.length&&(c=c-s+r(S+"XXX",N)|0),F=H(F,o,4,(0,n.string32)(c));const f=`url(data:font/opentype;base64,${btoa(F)});`,T=`@font-face {font-family:"${S}";src:${f}}`;this.insertRule(T);const Y=this._document.createElement("div");Y.style.visibility="hidden",Y.style.width=Y.style.height="10px",Y.style.position="absolute",Y.style.top=Y.style.left="0px";for(const _ of[E.loadedName,S]){const j=this._document.createElement("span");j.textContent="Hi",j.style.fontFamily=_,Y.append(j)}this._document.body.append(Y),x(S,()=>{Y.remove(),p.complete()})}}O=new WeakMap,e.FontLoader=d;class re{constructor(E,{isEvalSupported:p=!0,disableFontFace:r=!1,ignoreErrors:H=!1,inspectFont:N=null}){this.compiledGlyphs=Object.create(null);for(const g in E)this[g]=E[g];this.isEvalSupported=p!==!1,this.disableFontFace=r===!0,this.ignoreErrors=H===!0,this._inspectFont=N}createNativeFontFace(){var p;if(!this.data||this.disableFontFace)return null;let E;if(!this.cssFontInfo)E=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),E=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(p=this._inspectFont)==null||p.call(this,this),E}createFontFaceRule(){var H;if(!this.data||this.disableFontFace)return null;const E=(0,n.bytesToString)(this.data),p=`url(data:${this.mimetype};base64,${btoa(E)});`;let r;if(!this.cssFontInfo)r=`@font-face {font-family:"${this.loadedName}";src:${p}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),r=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${p}}`}return(H=this._inspectFont)==null||H.call(this,this,p),r}getPathGenerator(E,p){if(this.compiledGlyphs[p]!==void 0)return this.compiledGlyphs[p];let r;try{r=E.get(this.loadedName+"_path_"+p)}catch(H){if(!this.ignoreErrors)throw H;return(0,n.warn)(`getPathGenerator - ignoring character: "${H}".`),this.compiledGlyphs[p]=function(N,g){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const H=[];for(const N of r){const g=N.args!==void 0?N.args.join(","):"";H.push("c.",N.cmd,"(",g,`);
`)}return this.compiledGlyphs[p]=new Function("c","size",H.join(""))}return this.compiledGlyphs[p]=function(H,N){for(const g of r)g.cmd==="scale"&&(g.args=[N,-N]),H[g.cmd].apply(H,g.args)}}}e.FontFaceObject=re},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=v(7);v(1);const d=function(p){return new Promise((r,H)=>{require$$5.readFile(p,(g,u)=>{if(g||!u){H(new Error(g));return}r(new Uint8Array(u))})})};class re extends n.BaseFilterFactory{}e.NodeFilterFactory=re;class O extends n.BaseCanvasFactory{_createCanvas(r,H){return require$$5.createCanvas(r,H)}}e.NodeCanvasFactory=O;class w extends n.BaseCMapReaderFactory{_fetchData(r,H){return d(r).then(N=>({cMapData:N,compressionType:H}))}}e.NodeCMapReaderFactory=w;class E extends n.BaseStandardFontDataFactory{_fetchData(r){return d(r)}}e.NodeStandardFontDataFactory=E},(i,e,v)=>{var Pe,ji,$i;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=v(1),d=v(6),re=v(12),O=v(13);const w=16,E=100,p=4096,r=15,H=10,N=1e3,g=16;function u(q,m){if(q._removeMirroring)throw new Error("Context is already forwarding operations.");q.__originalSave=q.save,q.__originalRestore=q.restore,q.__originalRotate=q.rotate,q.__originalScale=q.scale,q.__originalTranslate=q.translate,q.__originalTransform=q.transform,q.__originalSetTransform=q.setTransform,q.__originalResetTransform=q.resetTransform,q.__originalClip=q.clip,q.__originalMoveTo=q.moveTo,q.__originalLineTo=q.lineTo,q.__originalBezierCurveTo=q.bezierCurveTo,q.__originalRect=q.rect,q.__originalClosePath=q.closePath,q.__originalBeginPath=q.beginPath,q._removeMirroring=()=>{q.save=q.__originalSave,q.restore=q.__originalRestore,q.rotate=q.__originalRotate,q.scale=q.__originalScale,q.translate=q.__originalTranslate,q.transform=q.__originalTransform,q.setTransform=q.__originalSetTransform,q.resetTransform=q.__originalResetTransform,q.clip=q.__originalClip,q.moveTo=q.__originalMoveTo,q.lineTo=q.__originalLineTo,q.bezierCurveTo=q.__originalBezierCurveTo,q.rect=q.__originalRect,q.closePath=q.__originalClosePath,q.beginPath=q.__originalBeginPath,delete q._removeMirroring},q.save=function(){m.save(),this.__originalSave()},q.restore=function(){m.restore(),this.__originalRestore()},q.translate=function(U,Ae){m.translate(U,Ae),this.__originalTranslate(U,Ae)},q.scale=function(U,Ae){m.scale(U,Ae),this.__originalScale(U,Ae)},q.transform=function(U,Ae,ye,Q,we,Re){m.transform(U,Ae,ye,Q,we,Re),this.__originalTransform(U,Ae,ye,Q,we,Re)},q.setTransform=function(U,Ae,ye,Q,we,Re){m.setTransform(U,Ae,ye,Q,we,Re),this.__originalSetTransform(U,Ae,ye,Q,we,Re)},q.resetTransform=function(){m.resetTransform(),this.__originalResetTransform()},q.rotate=function(U){m.rotate(U),this.__originalRotate(U)},q.clip=function(U){m.clip(U),this.__originalClip(U)},q.moveTo=function(y,U){m.moveTo(y,U),this.__originalMoveTo(y,U)},q.lineTo=function(y,U){m.lineTo(y,U),this.__originalLineTo(y,U)},q.bezierCurveTo=function(y,U,Ae,ye,Q,we){m.bezierCurveTo(y,U,Ae,ye,Q,we),this.__originalBezierCurveTo(y,U,Ae,ye,Q,we)},q.rect=function(y,U,Ae,ye){m.rect(y,U,Ae,ye),this.__originalRect(y,U,Ae,ye)},q.closePath=function(){m.closePath(),this.__originalClosePath()},q.beginPath=function(){m.beginPath(),this.__originalBeginPath()}}class M{constructor(m){this.canvasFactory=m,this.cache=Object.create(null)}getCanvas(m,y,U){let Ae;return this.cache[m]!==void 0?(Ae=this.cache[m],this.canvasFactory.reset(Ae,y,U)):(Ae=this.canvasFactory.create(y,U),this.cache[m]=Ae),Ae}delete(m){delete this.cache[m]}clear(){for(const m in this.cache){const y=this.cache[m];this.canvasFactory.destroy(y),delete this.cache[m]}}}function P(q,m,y,U,Ae,ye,Q,we,Re,Ne){const[He,$e,qe,Ye,Oe,Fe]=(0,d.getCurrentTransform)(q);if($e===0&&qe===0){const Ie=Q*He+Oe,z=Math.round(Ie),h=we*Ye+Fe,X=Math.round(h),oe=(Q+Re)*He+Oe,Z=Math.abs(Math.round(oe)-z)||1,Le=(we+Ne)*Ye+Fe,De=Math.abs(Math.round(Le)-X)||1;return q.setTransform(Math.sign(He),0,0,Math.sign(Ye),z,X),q.drawImage(m,y,U,Ae,ye,0,0,Z,De),q.setTransform(He,$e,qe,Ye,Oe,Fe),[Z,De]}if(He===0&&Ye===0){const Ie=we*qe+Oe,z=Math.round(Ie),h=Q*$e+Fe,X=Math.round(h),oe=(we+Ne)*qe+Oe,Z=Math.abs(Math.round(oe)-z)||1,Le=(Q+Re)*$e+Fe,De=Math.abs(Math.round(Le)-X)||1;return q.setTransform(0,Math.sign($e),Math.sign(qe),0,z,X),q.drawImage(m,y,U,Ae,ye,0,0,De,Z),q.setTransform(He,$e,qe,Ye,Oe,Fe),[De,Z]}q.drawImage(m,y,U,Ae,ye,Q,we,Re,Ne);const J=Math.hypot(He,$e),Ee=Math.hypot(qe,Ye);return[J*Re,Ee*Ne]}function x(q){const{width:m,height:y}=q;if(m>N||y>N)return null;const U=1e3,Ae=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),ye=m+1;let Q=new Uint8Array(ye*(y+1)),we,Re,Ne;const He=m+7&-8;let $e=new Uint8Array(He*y),qe=0;for(const Ee of q.data){let Ie=128;for(;Ie>0;)$e[qe++]=Ee&Ie?0:255,Ie>>=1}let Ye=0;for(qe=0,$e[qe]!==0&&(Q[0]=1,++Ye),Re=1;Re<m;Re++)$e[qe]!==$e[qe+1]&&(Q[Re]=$e[qe]?2:1,++Ye),qe++;for($e[qe]!==0&&(Q[Re]=2,++Ye),we=1;we<y;we++){qe=we*He,Ne=we*ye,$e[qe-He]!==$e[qe]&&(Q[Ne]=$e[qe]?1:8,++Ye);let Ee=($e[qe]?4:0)+($e[qe-He]?8:0);for(Re=1;Re<m;Re++)Ee=(Ee>>2)+($e[qe+1]?4:0)+($e[qe-He+1]?8:0),Ae[Ee]&&(Q[Ne+Re]=Ae[Ee],++Ye),qe++;if($e[qe-He]!==$e[qe]&&(Q[Ne+Re]=$e[qe]?2:4,++Ye),Ye>U)return null}for(qe=He*(y-1),Ne=we*ye,$e[qe]!==0&&(Q[Ne]=8,++Ye),Re=1;Re<m;Re++)$e[qe]!==$e[qe+1]&&(Q[Ne+Re]=$e[qe]?4:8,++Ye),qe++;if($e[qe]!==0&&(Q[Ne+Re]=4,++Ye),Ye>U)return null;const Oe=new Int32Array([0,ye,-1,0,-ye,0,0,0,1]),Fe=new Path2D;for(we=0;Ye&&we<=y;we++){let Ee=we*ye;const Ie=Ee+m;for(;Ee<Ie&&!Q[Ee];)Ee++;if(Ee===Ie)continue;Fe.moveTo(Ee%ye,we);const z=Ee;let h=Q[Ee];do{const X=Oe[h];do Ee+=X;while(!Q[Ee]);const oe=Q[Ee];oe!==5&&oe!==10?(h=oe,Q[Ee]=0):(h=oe&51*h>>4,Q[Ee]&=h>>2|h<<2),Fe.lineTo(Ee%ye,Ee/ye|0),Q[Ee]||--Ye}while(z!==Ee);--we}return $e=null,Q=null,function(Ee){Ee.save(),Ee.scale(1/m,-1/y),Ee.translate(0,-y),Ee.fill(Fe),Ee.beginPath(),Ee.restore()}}class S{constructor(m,y){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,m,y])}clone(){const m=Object.create(this);return m.clipBox=this.clipBox.slice(),m}setCurrentPoint(m,y){this.x=m,this.y=y}updatePathMinMax(m,y,U){[y,U]=n.Util.applyTransform([y,U],m),this.minX=Math.min(this.minX,y),this.minY=Math.min(this.minY,U),this.maxX=Math.max(this.maxX,y),this.maxY=Math.max(this.maxY,U)}updateRectMinMax(m,y){const U=n.Util.applyTransform(y,m),Ae=n.Util.applyTransform(y.slice(2),m);this.minX=Math.min(this.minX,U[0],Ae[0]),this.minY=Math.min(this.minY,U[1],Ae[1]),this.maxX=Math.max(this.maxX,U[0],Ae[0]),this.maxY=Math.max(this.maxY,U[1],Ae[1])}updateScalingPathMinMax(m,y){n.Util.scaleMinMax(m,y),this.minX=Math.min(this.minX,y[0]),this.maxX=Math.max(this.maxX,y[1]),this.minY=Math.min(this.minY,y[2]),this.maxY=Math.max(this.maxY,y[3])}updateCurvePathMinMax(m,y,U,Ae,ye,Q,we,Re,Ne,He){const $e=n.Util.bezierBoundingBox(y,U,Ae,ye,Q,we,Re,Ne);if(He){He[0]=Math.min(He[0],$e[0],$e[2]),He[1]=Math.max(He[1],$e[0],$e[2]),He[2]=Math.min(He[2],$e[1],$e[3]),He[3]=Math.max(He[3],$e[1],$e[3]);return}this.updateRectMinMax(m,$e)}getPathBoundingBox(m=re.PathType.FILL,y=null){const U=[this.minX,this.minY,this.maxX,this.maxY];if(m===re.PathType.STROKE){y||(0,n.unreachable)("Stroke bounding box must include transform.");const Ae=n.Util.singularValueDecompose2dScale(y),ye=Ae[0]*this.lineWidth/2,Q=Ae[1]*this.lineWidth/2;U[0]-=ye,U[1]-=Q,U[2]+=ye,U[3]+=Q}return U}updateClipFromPath(){const m=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(m||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(m){this.clipBox=m,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(m=re.PathType.FILL,y=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(m,y))}}function F(q,m){if(typeof ImageData<"u"&&m instanceof ImageData){q.putImageData(m,0,0);return}const y=m.height,U=m.width,Ae=y%g,ye=(y-Ae)/g,Q=Ae===0?ye:ye+1,we=q.createImageData(U,g);let Re=0,Ne;const He=m.data,$e=we.data;let qe,Ye,Oe,Fe;if(m.kind===n.ImageKind.GRAYSCALE_1BPP){const J=He.byteLength,Ee=new Uint32Array($e.buffer,0,$e.byteLength>>2),Ie=Ee.length,z=U+7>>3,h=4294967295,X=n.FeatureTest.isLittleEndian?4278190080:255;for(qe=0;qe<Q;qe++){for(Oe=qe<ye?g:Ae,Ne=0,Ye=0;Ye<Oe;Ye++){const oe=J-Re;let Z=0;const Le=oe>z?U:oe*8-7,De=Le&-8;let Ge=0,Ve=0;for(;Z<De;Z+=8)Ve=He[Re++],Ee[Ne++]=Ve&128?h:X,Ee[Ne++]=Ve&64?h:X,Ee[Ne++]=Ve&32?h:X,Ee[Ne++]=Ve&16?h:X,Ee[Ne++]=Ve&8?h:X,Ee[Ne++]=Ve&4?h:X,Ee[Ne++]=Ve&2?h:X,Ee[Ne++]=Ve&1?h:X;for(;Z<Le;Z++)Ge===0&&(Ve=He[Re++],Ge=128),Ee[Ne++]=Ve&Ge?h:X,Ge>>=1}for(;Ne<Ie;)Ee[Ne++]=0;q.putImageData(we,0,qe*g)}}else if(m.kind===n.ImageKind.RGBA_32BPP){for(Ye=0,Fe=U*g*4,qe=0;qe<ye;qe++)$e.set(He.subarray(Re,Re+Fe)),Re+=Fe,q.putImageData(we,0,Ye),Ye+=g;qe<Q&&(Fe=U*Ae*4,$e.set(He.subarray(Re,Re+Fe)),q.putImageData(we,0,Ye))}else if(m.kind===n.ImageKind.RGB_24BPP)for(Oe=g,Fe=U*Oe,qe=0;qe<Q;qe++){for(qe>=ye&&(Oe=Ae,Fe=U*Oe),Ne=0,Ye=Fe;Ye--;)$e[Ne++]=He[Re++],$e[Ne++]=He[Re++],$e[Ne++]=He[Re++],$e[Ne++]=255;q.putImageData(we,0,qe*g)}else throw new Error(`bad image kind: ${m.kind}`)}function I(q,m){if(m.bitmap){q.drawImage(m.bitmap,0,0);return}const y=m.height,U=m.width,Ae=y%g,ye=(y-Ae)/g,Q=Ae===0?ye:ye+1,we=q.createImageData(U,g);let Re=0;const Ne=m.data,He=we.data;for(let $e=0;$e<Q;$e++){const qe=$e<ye?g:Ae;({srcPos:Re}=(0,O.convertBlackAndWhiteToRGBA)({src:Ne,srcPos:Re,dest:He,width:U,height:qe,nonBlackColor:0})),q.putImageData(we,0,$e*g)}}function o(q,m){const y=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const U of y)q[U]!==void 0&&(m[U]=q[U]);q.setLineDash!==void 0&&(m.setLineDash(q.getLineDash()),m.lineDashOffset=q.lineDashOffset)}function s(q){if(q.strokeStyle=q.fillStyle="#000000",q.fillRule="nonzero",q.globalAlpha=1,q.lineWidth=1,q.lineCap="butt",q.lineJoin="miter",q.miterLimit=10,q.globalCompositeOperation="source-over",q.font="10px sans-serif",q.setLineDash!==void 0&&(q.setLineDash([]),q.lineDashOffset=0),!n.isNodeJS){const{filter:m}=q;m!=="none"&&m!==""&&(q.filter="none")}}function c(q,m,y,U){const Ae=q.length;for(let ye=3;ye<Ae;ye+=4){const Q=q[ye];if(Q===0)q[ye-3]=m,q[ye-2]=y,q[ye-1]=U;else if(Q<255){const we=255-Q;q[ye-3]=q[ye-3]*Q+m*we>>8,q[ye-2]=q[ye-2]*Q+y*we>>8,q[ye-1]=q[ye-1]*Q+U*we>>8}}}function f(q,m,y){const U=q.length,Ae=1/255;for(let ye=3;ye<U;ye+=4){const Q=y?y[q[ye]]:q[ye];m[ye]=m[ye]*Q*Ae|0}}function T(q,m,y){const U=q.length;for(let Ae=3;Ae<U;Ae+=4){const ye=q[Ae-3]*77+q[Ae-2]*152+q[Ae-1]*28;m[Ae]=y?m[Ae]*y[ye>>8]>>8:m[Ae]*ye>>16}}function Y(q,m,y,U,Ae,ye,Q,we,Re,Ne,He){const $e=!!ye,qe=$e?ye[0]:0,Ye=$e?ye[1]:0,Oe=$e?ye[2]:0,Fe=Ae==="Luminosity"?T:f,Ee=Math.min(U,Math.ceil(1048576/y));for(let Ie=0;Ie<U;Ie+=Ee){const z=Math.min(Ee,U-Ie),h=q.getImageData(we-Ne,Ie+(Re-He),y,z),X=m.getImageData(we,Ie+Re,y,z);$e&&c(h.data,qe,Ye,Oe),Fe(h.data,X.data,Q),m.putImageData(X,we,Ie+Re)}}function _(q,m,y,U){const Ae=U[0],ye=U[1],Q=U[2]-Ae,we=U[3]-ye;Q===0||we===0||(Y(m.context,y,Q,we,m.subtype,m.backdrop,m.transferMap,Ae,ye,m.offsetX,m.offsetY),q.save(),q.globalAlpha=1,q.globalCompositeOperation="source-over",q.setTransform(1,0,0,1,0,0),q.drawImage(y.canvas,0,0),q.restore())}function j(q,m){const y=n.Util.singularValueDecompose2dScale(q);y[0]=Math.fround(y[0]),y[1]=Math.fround(y[1]);const U=Math.fround((globalThis.devicePixelRatio||1)*d.PixelsPerInch.PDF_TO_CSS_UNITS);return m!==void 0?m:y[0]<=U||y[1]<=U}const fe=["butt","round","square"],te=["miter","round","bevel"],_e={},be={},Te=class Te{constructor(m,y,U,Ae,ye,{optionalContentConfig:Q,markedContentStack:we=null},Re,Ne){Me(this,Pe);this.ctx=m,this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=y,this.objs=U,this.canvasFactory=Ae,this.filterFactory=ye,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=we||[],this.optionalContentConfig=Q,this.cachedCanvases=new M(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Re,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Ne,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(m,y=null){return typeof m=="string"?m.startsWith("g_")?this.commonObjs.get(m):this.objs.get(m):y}beginDrawing({transform:m,viewport:y,transparency:U=!1,background:Ae=null}){const ye=this.ctx.canvas.width,Q=this.ctx.canvas.height,we=this.ctx.fillStyle;if(this.ctx.fillStyle=Ae||"#ffffff",this.ctx.fillRect(0,0,ye,Q),this.ctx.fillStyle=we,U){const Re=this.cachedCanvases.getCanvas("transparent",ye,Q);this.compositeCtx=this.ctx,this.transparentCanvas=Re.canvas,this.ctx=Re.context,this.ctx.save(),this.ctx.transform(...(0,d.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),s(this.ctx),m&&(this.ctx.transform(...m),this.outputScaleX=m[0],this.outputScaleY=m[0]),this.ctx.transform(...y.transform),this.viewportScale=y.scale,this.baseTransform=(0,d.getCurrentTransform)(this.ctx)}executeOperatorList(m,y,U,Ae){const ye=m.argsArray,Q=m.fnArray;let we=y||0;const Re=ye.length;if(Re===we)return we;const Ne=Re-we>H&&typeof U=="function",He=Ne?Date.now()+r:0;let $e=0;const qe=this.commonObjs,Ye=this.objs;let Oe;for(;;){if(Ae!==void 0&&we===Ae.nextBreakPoint)return Ae.breakIt(we,U),we;if(Oe=Q[we],Oe!==n.OPS.dependency)this[Oe].apply(this,ye[we]);else for(const Fe of ye[we]){const J=Fe.startsWith("g_")?qe:Ye;if(!J.has(Fe))return J.get(Fe,U),we}if(we++,we===Re)return we;if(Ne&&++$e>H){if(Date.now()>He)return U(),we;$e=0}}}endDrawing(){ne(this,Pe,ji).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const m of this._cachedBitmapsMap.values()){for(const y of m.values())typeof HTMLCanvasElement<"u"&&y instanceof HTMLCanvasElement&&(y.width=y.height=0);m.clear()}this._cachedBitmapsMap.clear(),ne(this,Pe,$i).call(this)}_scaleImage(m,y){const U=m.width,Ae=m.height;let ye=Math.max(Math.hypot(y[0],y[1]),1),Q=Math.max(Math.hypot(y[2],y[3]),1),we=U,Re=Ae,Ne="prescale1",He,$e;for(;ye>2&&we>1||Q>2&&Re>1;){let qe=we,Ye=Re;ye>2&&we>1&&(qe=we>=16384?Math.floor(we/2)-1||1:Math.ceil(we/2),ye/=we/qe),Q>2&&Re>1&&(Ye=Re>=16384?Math.floor(Re/2)-1||1:Math.ceil(Re)/2,Q/=Re/Ye),He=this.cachedCanvases.getCanvas(Ne,qe,Ye),$e=He.context,$e.clearRect(0,0,qe,Ye),$e.drawImage(m,0,0,we,Re,0,0,qe,Ye),m=He.canvas,we=qe,Re=Ye,Ne=Ne==="prescale1"?"prescale2":"prescale1"}return{img:m,paintWidth:we,paintHeight:Re}}_createMaskCanvas(m){const y=this.ctx,{width:U,height:Ae}=m,ye=this.current.fillColor,Q=this.current.patternFill,we=(0,d.getCurrentTransform)(y);let Re,Ne,He,$e;if((m.bitmap||m.data)&&m.count>1){const Z=m.bitmap||m.data.buffer;Ne=JSON.stringify(Q?we:[we.slice(0,4),ye]),Re=this._cachedBitmapsMap.get(Z),Re||(Re=new Map,this._cachedBitmapsMap.set(Z,Re));const Le=Re.get(Ne);if(Le&&!Q){const De=Math.round(Math.min(we[0],we[2])+we[4]),Ge=Math.round(Math.min(we[1],we[3])+we[5]);return{canvas:Le,offsetX:De,offsetY:Ge}}He=Le}He||($e=this.cachedCanvases.getCanvas("maskCanvas",U,Ae),I($e.context,m));let qe=n.Util.transform(we,[1/U,0,0,-1/Ae,0,0]);qe=n.Util.transform(qe,[1,0,0,1,0,-Ae]);const Ye=n.Util.applyTransform([0,0],qe),Oe=n.Util.applyTransform([U,Ae],qe),Fe=n.Util.normalizeRect([Ye[0],Ye[1],Oe[0],Oe[1]]),J=Math.round(Fe[2]-Fe[0])||1,Ee=Math.round(Fe[3]-Fe[1])||1,Ie=this.cachedCanvases.getCanvas("fillCanvas",J,Ee),z=Ie.context,h=Math.min(Ye[0],Oe[0]),X=Math.min(Ye[1],Oe[1]);z.translate(-h,-X),z.transform(...qe),He||(He=this._scaleImage($e.canvas,(0,d.getCurrentTransformInverse)(z)),He=He.img,Re&&Q&&Re.set(Ne,He)),z.imageSmoothingEnabled=j((0,d.getCurrentTransform)(z),m.interpolate),P(z,He,0,0,He.width,He.height,0,0,U,Ae),z.globalCompositeOperation="source-in";const oe=n.Util.transform((0,d.getCurrentTransformInverse)(z),[1,0,0,1,-h,-X]);return z.fillStyle=Q?ye.getPattern(y,this,oe,re.PathType.FILL):ye,z.fillRect(0,0,U,Ae),Re&&!Q&&(this.cachedCanvases.delete("fillCanvas"),Re.set(Ne,Ie.canvas)),{canvas:Ie.canvas,offsetX:Math.round(h),offsetY:Math.round(X)}}setLineWidth(m){m!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=m,this.ctx.lineWidth=m}setLineCap(m){this.ctx.lineCap=fe[m]}setLineJoin(m){this.ctx.lineJoin=te[m]}setMiterLimit(m){this.ctx.miterLimit=m}setDash(m,y){const U=this.ctx;U.setLineDash!==void 0&&(U.setLineDash(m),U.lineDashOffset=y)}setRenderingIntent(m){}setFlatness(m){}setGState(m){for(const[y,U]of m)switch(y){case"LW":this.setLineWidth(U);break;case"LC":this.setLineCap(U);break;case"LJ":this.setLineJoin(U);break;case"ML":this.setMiterLimit(U);break;case"D":this.setDash(U[0],U[1]);break;case"RI":this.setRenderingIntent(U);break;case"FL":this.setFlatness(U);break;case"Font":this.setFont(U[0],U[1]);break;case"CA":this.current.strokeAlpha=U;break;case"ca":this.current.fillAlpha=U,this.ctx.globalAlpha=U;break;case"BM":this.ctx.globalCompositeOperation=U;break;case"SMask":this.current.activeSMask=U?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(U);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const m=this.inSMaskMode;this.current.activeSMask&&!m?this.beginSMaskMode():!this.current.activeSMask&&m&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const m=this.ctx.canvas.width,y=this.ctx.canvas.height,U="smaskGroupAt"+this.groupLevel,Ae=this.cachedCanvases.getCanvas(U,m,y);this.suspendedCtx=this.ctx,this.ctx=Ae.context;const ye=this.ctx;ye.setTransform(...(0,d.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,ye),u(ye,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(m){if(!this.current.activeSMask)return;m?(m[0]=Math.floor(m[0]),m[1]=Math.floor(m[1]),m[2]=Math.ceil(m[2]),m[3]=Math.ceil(m[3])):m=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const y=this.current.activeSMask,U=this.suspendedCtx;_(U,y,this.ctx,m),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const m=this.current;this.stateStack.push(m),this.current=m.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(m,y,U,Ae,ye,Q){this.ctx.transform(m,y,U,Ae,ye,Q),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(m,y,U){const Ae=this.ctx,ye=this.current;let Q=ye.x,we=ye.y,Re,Ne;const He=(0,d.getCurrentTransform)(Ae),$e=He[0]===0&&He[3]===0||He[1]===0&&He[2]===0,qe=$e?U.slice(0):null;for(let Ye=0,Oe=0,Fe=m.length;Ye<Fe;Ye++)switch(m[Ye]|0){case n.OPS.rectangle:Q=y[Oe++],we=y[Oe++];const J=y[Oe++],Ee=y[Oe++],Ie=Q+J,z=we+Ee;Ae.moveTo(Q,we),J===0||Ee===0?Ae.lineTo(Ie,z):(Ae.lineTo(Ie,we),Ae.lineTo(Ie,z),Ae.lineTo(Q,z)),$e||ye.updateRectMinMax(He,[Q,we,Ie,z]),Ae.closePath();break;case n.OPS.moveTo:Q=y[Oe++],we=y[Oe++],Ae.moveTo(Q,we),$e||ye.updatePathMinMax(He,Q,we);break;case n.OPS.lineTo:Q=y[Oe++],we=y[Oe++],Ae.lineTo(Q,we),$e||ye.updatePathMinMax(He,Q,we);break;case n.OPS.curveTo:Re=Q,Ne=we,Q=y[Oe+4],we=y[Oe+5],Ae.bezierCurveTo(y[Oe],y[Oe+1],y[Oe+2],y[Oe+3],Q,we),ye.updateCurvePathMinMax(He,Re,Ne,y[Oe],y[Oe+1],y[Oe+2],y[Oe+3],Q,we,qe),Oe+=6;break;case n.OPS.curveTo2:Re=Q,Ne=we,Ae.bezierCurveTo(Q,we,y[Oe],y[Oe+1],y[Oe+2],y[Oe+3]),ye.updateCurvePathMinMax(He,Re,Ne,Q,we,y[Oe],y[Oe+1],y[Oe+2],y[Oe+3],qe),Q=y[Oe+2],we=y[Oe+3],Oe+=4;break;case n.OPS.curveTo3:Re=Q,Ne=we,Q=y[Oe+2],we=y[Oe+3],Ae.bezierCurveTo(y[Oe],y[Oe+1],Q,we,Q,we),ye.updateCurvePathMinMax(He,Re,Ne,y[Oe],y[Oe+1],Q,we,Q,we,qe),Oe+=4;break;case n.OPS.closePath:Ae.closePath();break}$e&&ye.updateScalingPathMinMax(He,qe),ye.setCurrentPoint(Q,we)}closePath(){this.ctx.closePath()}stroke(m=!0){const y=this.ctx,U=this.current.strokeColor;y.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof U=="object"&&(U!=null&&U.getPattern)?(y.save(),y.strokeStyle=U.getPattern(y,this,(0,d.getCurrentTransformInverse)(y),re.PathType.STROKE),this.rescaleAndStroke(!1),y.restore()):this.rescaleAndStroke(!0)),m&&this.consumePath(this.current.getClippedPathBoundingBox()),y.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(m=!0){const y=this.ctx,U=this.current.fillColor,Ae=this.current.patternFill;let ye=!1;Ae&&(y.save(),y.fillStyle=U.getPattern(y,this,(0,d.getCurrentTransformInverse)(y),re.PathType.FILL),ye=!0);const Q=this.current.getClippedPathBoundingBox();this.contentVisible&&Q!==null&&(this.pendingEOFill?(y.fill("evenodd"),this.pendingEOFill=!1):y.fill()),ye&&y.restore(),m&&this.consumePath(Q)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=_e}eoClip(){this.pendingClip=be}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const m=this.pendingTextPaths,y=this.ctx;if(m===void 0){y.beginPath();return}y.save(),y.beginPath();for(const U of m)y.setTransform(...U.transform),y.translate(U.x,U.y),U.addToPath(y,U.fontSize);y.restore(),y.clip(),y.beginPath(),delete this.pendingTextPaths}setCharSpacing(m){this.current.charSpacing=m}setWordSpacing(m){this.current.wordSpacing=m}setHScale(m){this.current.textHScale=m/100}setLeading(m){this.current.leading=-m}setFont(m,y){var He;const U=this.commonObjs.get(m),Ae=this.current;if(!U)throw new Error(`Can't find font for ${m}`);if(Ae.fontMatrix=U.fontMatrix||n.FONT_IDENTITY_MATRIX,(Ae.fontMatrix[0]===0||Ae.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+m),y<0?(y=-y,Ae.fontDirection=-1):Ae.fontDirection=1,this.current.font=U,this.current.fontSize=y,U.isType3Font)return;const ye=U.loadedName||"sans-serif",Q=((He=U.systemFontInfo)==null?void 0:He.css)||`"${ye}", ${U.fallbackName}`;let we="normal";U.black?we="900":U.bold&&(we="bold");const Re=U.italic?"italic":"normal";let Ne=y;y<w?Ne=w:y>E&&(Ne=E),this.current.fontSizeScale=y/Ne,this.ctx.font=`${Re} ${we} ${Ne}px ${Q}`}setTextRenderingMode(m){this.current.textRenderingMode=m}setTextRise(m){this.current.textRise=m}moveText(m,y){this.current.x=this.current.lineX+=m,this.current.y=this.current.lineY+=y}setLeadingMoveText(m,y){this.setLeading(-y),this.moveText(m,y)}setTextMatrix(m,y,U,Ae,ye,Q){this.current.textMatrix=[m,y,U,Ae,ye,Q],this.current.textMatrixScale=Math.hypot(m,y),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(m,y,U,Ae){const ye=this.ctx,Q=this.current,we=Q.font,Re=Q.textRenderingMode,Ne=Q.fontSize/Q.fontSizeScale,He=Re&n.TextRenderingMode.FILL_STROKE_MASK,$e=!!(Re&n.TextRenderingMode.ADD_TO_PATH_FLAG),qe=Q.patternFill&&!we.missingFile;let Ye;(we.disableFontFace||$e||qe)&&(Ye=we.getPathGenerator(this.commonObjs,m)),we.disableFontFace||qe?(ye.save(),ye.translate(y,U),ye.beginPath(),Ye(ye,Ne),Ae&&ye.setTransform(...Ae),(He===n.TextRenderingMode.FILL||He===n.TextRenderingMode.FILL_STROKE)&&ye.fill(),(He===n.TextRenderingMode.STROKE||He===n.TextRenderingMode.FILL_STROKE)&&ye.stroke(),ye.restore()):((He===n.TextRenderingMode.FILL||He===n.TextRenderingMode.FILL_STROKE)&&ye.fillText(m,y,U),(He===n.TextRenderingMode.STROKE||He===n.TextRenderingMode.FILL_STROKE)&&ye.strokeText(m,y,U)),$e&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,d.getCurrentTransform)(ye),x:y,y:U,fontSize:Ne,addToPath:Ye})}get isFontSubpixelAAEnabled(){const{context:m}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);m.scale(1.5,1),m.fillText("I",0,10);const y=m.getImageData(0,0,10,10).data;let U=!1;for(let Ae=3;Ae<y.length;Ae+=4)if(y[Ae]>0&&y[Ae]<255){U=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",U)}showText(m){const y=this.current,U=y.font;if(U.isType3Font)return this.showType3Text(m);const Ae=y.fontSize;if(Ae===0)return;const ye=this.ctx,Q=y.fontSizeScale,we=y.charSpacing,Re=y.wordSpacing,Ne=y.fontDirection,He=y.textHScale*Ne,$e=m.length,qe=U.vertical,Ye=qe?1:-1,Oe=U.defaultVMetrics,Fe=Ae*y.fontMatrix[0],J=y.textRenderingMode===n.TextRenderingMode.FILL&&!U.disableFontFace&&!y.patternFill;ye.save(),ye.transform(...y.textMatrix),ye.translate(y.x,y.y+y.textRise),Ne>0?ye.scale(He,-1):ye.scale(He,1);let Ee;if(y.patternFill){ye.save();const oe=y.fillColor.getPattern(ye,this,(0,d.getCurrentTransformInverse)(ye),re.PathType.FILL);Ee=(0,d.getCurrentTransform)(ye),ye.restore(),ye.fillStyle=oe}let Ie=y.lineWidth;const z=y.textMatrixScale;if(z===0||Ie===0){const oe=y.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(oe===n.TextRenderingMode.STROKE||oe===n.TextRenderingMode.FILL_STROKE)&&(Ie=this.getSinglePixelWidth())}else Ie/=z;if(Q!==1&&(ye.scale(Q,Q),Ie/=Q),ye.lineWidth=Ie,U.isInvalidPDFjsFont){const oe=[];let Z=0;for(const Le of m)oe.push(Le.unicode),Z+=Le.width;ye.fillText(oe.join(""),0,0),y.x+=Z*Fe*He,ye.restore(),this.compose();return}let h=0,X;for(X=0;X<$e;++X){const oe=m[X];if(typeof oe=="number"){h+=Ye*oe*Ae/1e3;continue}let Z=!1;const Le=(oe.isSpace?Re:0)+we,De=oe.fontChar,Ge=oe.accent;let Ve,Je,Ze=oe.width;if(qe){const pt=oe.vmetric||Oe,mt=-(oe.vmetric?pt[1]:Ze*.5)*Fe,Xe=pt[2]*Fe;Ze=pt?-pt[0]:Ze,Ve=mt/Q,Je=(h+Xe)/Q}else Ve=h/Q,Je=0;if(U.remeasure&&Ze>0){const pt=ye.measureText(De).width*1e3/Ae*Q;if(Ze<pt&&this.isFontSubpixelAAEnabled){const mt=Ze/pt;Z=!0,ye.save(),ye.scale(mt,1),Ve/=mt}else Ze!==pt&&(Ve+=(Ze-pt)/2e3*Ae/Q)}if(this.contentVisible&&(oe.isInFont||U.missingFile)){if(J&&!Ge)ye.fillText(De,Ve,Je);else if(this.paintChar(De,Ve,Je,Ee),Ge){const pt=Ve+Ae*Ge.offset.x/Q,mt=Je-Ae*Ge.offset.y/Q;this.paintChar(Ge.fontChar,pt,mt,Ee)}}const it=qe?Ze*Fe-Le*Ne:Ze*Fe+Le*Ne;h+=it,Z&&ye.restore()}qe?y.y-=h:y.x+=h*He,ye.restore(),this.compose()}showType3Text(m){const y=this.ctx,U=this.current,Ae=U.font,ye=U.fontSize,Q=U.fontDirection,we=Ae.vertical?1:-1,Re=U.charSpacing,Ne=U.wordSpacing,He=U.textHScale*Q,$e=U.fontMatrix||n.FONT_IDENTITY_MATRIX,qe=m.length,Ye=U.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Oe,Fe,J,Ee;if(!(Ye||ye===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,y.save(),y.transform(...U.textMatrix),y.translate(U.x,U.y),y.scale(He,Q),Oe=0;Oe<qe;++Oe){if(Fe=m[Oe],typeof Fe=="number"){Ee=we*Fe*ye/1e3,this.ctx.translate(Ee,0),U.x+=Ee*He;continue}const Ie=(Fe.isSpace?Ne:0)+Re,z=Ae.charProcOperatorList[Fe.operatorListId];if(!z){(0,n.warn)(`Type3 character "${Fe.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Fe,this.save(),y.scale(ye,ye),y.transform(...$e),this.executeOperatorList(z),this.restore()),J=n.Util.applyTransform([Fe.width,0],$e)[0]*ye+Ie,y.translate(J,0),U.x+=J*He}y.restore(),this.processingType3=null}}setCharWidth(m,y){}setCharWidthAndBounds(m,y,U,Ae,ye,Q){this.ctx.rect(U,Ae,ye-U,Q-Ae),this.ctx.clip(),this.endPath()}getColorN_Pattern(m){let y;if(m[0]==="TilingPattern"){const U=m[1],Ae=this.baseTransform||(0,d.getCurrentTransform)(this.ctx),ye={createCanvasGraphics:Q=>new Te(Q,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};y=new re.TilingPattern(m,U,this.ctx,ye,Ae)}else y=this._getPattern(m[1],m[2]);return y}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(m,y,U){const Ae=n.Util.makeHexColor(m,y,U);this.ctx.strokeStyle=Ae,this.current.strokeColor=Ae}setFillRGBColor(m,y,U){const Ae=n.Util.makeHexColor(m,y,U);this.ctx.fillStyle=Ae,this.current.fillColor=Ae,this.current.patternFill=!1}_getPattern(m,y=null){let U;return this.cachedPatterns.has(m)?U=this.cachedPatterns.get(m):(U=(0,re.getShadingPattern)(this.getObject(m)),this.cachedPatterns.set(m,U)),y&&(U.matrix=y),U}shadingFill(m){if(!this.contentVisible)return;const y=this.ctx;this.save();const U=this._getPattern(m);y.fillStyle=U.getPattern(y,this,(0,d.getCurrentTransformInverse)(y),re.PathType.SHADING);const Ae=(0,d.getCurrentTransformInverse)(y);if(Ae){const{width:ye,height:Q}=y.canvas,[we,Re,Ne,He]=n.Util.getAxialAlignedBoundingBox([0,0,ye,Q],Ae);this.ctx.fillRect(we,Re,Ne-we,He-Re)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(m,y){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(m)&&m.length===6&&this.transform(...m),this.baseTransform=(0,d.getCurrentTransform)(this.ctx),y)){const U=y[2]-y[0],Ae=y[3]-y[1];this.ctx.rect(y[0],y[1],U,Ae),this.current.updateRectMinMax((0,d.getCurrentTransform)(this.ctx),y),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(m){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const y=this.ctx;m.isolated||(0,n.info)("TODO: Support non-isolated groups."),m.knockout&&(0,n.warn)("Knockout groups not supported.");const U=(0,d.getCurrentTransform)(y);if(m.matrix&&y.transform(...m.matrix),!m.bbox)throw new Error("Bounding box is required.");let Ae=n.Util.getAxialAlignedBoundingBox(m.bbox,(0,d.getCurrentTransform)(y));const ye=[0,0,y.canvas.width,y.canvas.height];Ae=n.Util.intersect(Ae,ye)||[0,0,0,0];const Q=Math.floor(Ae[0]),we=Math.floor(Ae[1]);let Re=Math.max(Math.ceil(Ae[2])-Q,1),Ne=Math.max(Math.ceil(Ae[3])-we,1),He=1,$e=1;Re>p&&(He=Re/p,Re=p),Ne>p&&($e=Ne/p,Ne=p),this.current.startNewPathAndClipBox([0,0,Re,Ne]);let qe="groupAt"+this.groupLevel;m.smask&&(qe+="_smask_"+this.smaskCounter++%2);const Ye=this.cachedCanvases.getCanvas(qe,Re,Ne),Oe=Ye.context;Oe.scale(1/He,1/$e),Oe.translate(-Q,-we),Oe.transform(...U),m.smask?this.smaskStack.push({canvas:Ye.canvas,context:Oe,offsetX:Q,offsetY:we,scaleX:He,scaleY:$e,subtype:m.smask.subtype,backdrop:m.smask.backdrop,transferMap:m.smask.transferMap||null,startTransformInverse:null}):(y.setTransform(1,0,0,1,0,0),y.translate(Q,we),y.scale(He,$e),y.save()),o(y,Oe),this.ctx=Oe,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(y),this.groupLevel++}endGroup(m){if(!this.contentVisible)return;this.groupLevel--;const y=this.ctx,U=this.groupStack.pop();if(this.ctx=U,this.ctx.imageSmoothingEnabled=!1,m.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Ae=(0,d.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Ae);const ye=n.Util.getAxialAlignedBoundingBox([0,0,y.canvas.width,y.canvas.height],Ae);this.ctx.drawImage(y.canvas,0,0),this.ctx.restore(),this.compose(ye)}}beginAnnotation(m,y,U,Ae,ye){if(ne(this,Pe,ji).call(this),s(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(y)&&y.length===4){const Q=y[2]-y[0],we=y[3]-y[1];if(ye&&this.annotationCanvasMap){U=U.slice(),U[4]-=y[0],U[5]-=y[1],y=y.slice(),y[0]=y[1]=0,y[2]=Q,y[3]=we;const[Re,Ne]=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(this.ctx)),{viewportScale:He}=this,$e=Math.ceil(Q*this.outputScaleX*He),qe=Math.ceil(we*this.outputScaleY*He);this.annotationCanvas=this.canvasFactory.create($e,qe);const{canvas:Ye,context:Oe}=this.annotationCanvas;this.annotationCanvasMap.set(m,Ye),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Oe,this.ctx.save(),this.ctx.setTransform(Re,0,0,-Ne,0,we*Ne),s(this.ctx)}else s(this.ctx),this.ctx.rect(y[0],y[1],Q,we),this.ctx.clip(),this.endPath()}this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...U),this.transform(...Ae)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),ne(this,Pe,$i).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(m){if(!this.contentVisible)return;const y=m.count;m=this.getObject(m.data,m),m.count=y;const U=this.ctx,Ae=this.processingType3;if(Ae&&(Ae.compiled===void 0&&(Ae.compiled=x(m)),Ae.compiled)){Ae.compiled(U);return}const ye=this._createMaskCanvas(m),Q=ye.canvas;U.save(),U.setTransform(1,0,0,1,0,0),U.drawImage(Q,ye.offsetX,ye.offsetY),U.restore(),this.compose()}paintImageMaskXObjectRepeat(m,y,U=0,Ae=0,ye,Q){if(!this.contentVisible)return;m=this.getObject(m.data,m);const we=this.ctx;we.save();const Re=(0,d.getCurrentTransform)(we);we.transform(y,U,Ae,ye,0,0);const Ne=this._createMaskCanvas(m);we.setTransform(1,0,0,1,Ne.offsetX-Re[4],Ne.offsetY-Re[5]);for(let He=0,$e=Q.length;He<$e;He+=2){const qe=n.Util.transform(Re,[y,U,Ae,ye,Q[He],Q[He+1]]),[Ye,Oe]=n.Util.applyTransform([0,0],qe);we.drawImage(Ne.canvas,Ye,Oe)}we.restore(),this.compose()}paintImageMaskXObjectGroup(m){if(!this.contentVisible)return;const y=this.ctx,U=this.current.fillColor,Ae=this.current.patternFill;for(const ye of m){const{data:Q,width:we,height:Re,transform:Ne}=ye,He=this.cachedCanvases.getCanvas("maskCanvas",we,Re),$e=He.context;$e.save();const qe=this.getObject(Q,ye);I($e,qe),$e.globalCompositeOperation="source-in",$e.fillStyle=Ae?U.getPattern($e,this,(0,d.getCurrentTransformInverse)(y),re.PathType.FILL):U,$e.fillRect(0,0,we,Re),$e.restore(),y.save(),y.transform(...Ne),y.scale(1,-1),P(y,He.canvas,0,0,we,Re,0,-1,1,1),y.restore()}this.compose()}paintImageXObject(m){if(!this.contentVisible)return;const y=this.getObject(m);if(!y){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(y)}paintImageXObjectRepeat(m,y,U,Ae){if(!this.contentVisible)return;const ye=this.getObject(m);if(!ye){(0,n.warn)("Dependent image isn't ready yet");return}const Q=ye.width,we=ye.height,Re=[];for(let Ne=0,He=Ae.length;Ne<He;Ne+=2)Re.push({transform:[y,0,0,U,Ae[Ne],Ae[Ne+1]],x:0,y:0,w:Q,h:we});this.paintInlineImageXObjectGroup(ye,Re)}applyTransferMapsToCanvas(m){return this.current.transferMaps!=="none"&&(m.filter=this.current.transferMaps,m.drawImage(m.canvas,0,0),m.filter="none"),m.canvas}applyTransferMapsToBitmap(m){if(this.current.transferMaps==="none")return m.bitmap;const{bitmap:y,width:U,height:Ae}=m,ye=this.cachedCanvases.getCanvas("inlineImage",U,Ae),Q=ye.context;return Q.filter=this.current.transferMaps,Q.drawImage(y,0,0),Q.filter="none",ye.canvas}paintInlineImageXObject(m){if(!this.contentVisible)return;const y=m.width,U=m.height,Ae=this.ctx;if(this.save(),!n.isNodeJS){const{filter:we}=Ae;we!=="none"&&we!==""&&(Ae.filter="none")}Ae.scale(1/y,-1/U);let ye;if(m.bitmap)ye=this.applyTransferMapsToBitmap(m);else if(typeof HTMLElement=="function"&&m instanceof HTMLElement||!m.data)ye=m;else{const Re=this.cachedCanvases.getCanvas("inlineImage",y,U).context;F(Re,m),ye=this.applyTransferMapsToCanvas(Re)}const Q=this._scaleImage(ye,(0,d.getCurrentTransformInverse)(Ae));Ae.imageSmoothingEnabled=j((0,d.getCurrentTransform)(Ae),m.interpolate),P(Ae,Q.img,0,0,Q.paintWidth,Q.paintHeight,0,-U,y,U),this.compose(),this.restore()}paintInlineImageXObjectGroup(m,y){if(!this.contentVisible)return;const U=this.ctx;let Ae;if(m.bitmap)Ae=m.bitmap;else{const ye=m.width,Q=m.height,Re=this.cachedCanvases.getCanvas("inlineImage",ye,Q).context;F(Re,m),Ae=this.applyTransferMapsToCanvas(Re)}for(const ye of y)U.save(),U.transform(...ye.transform),U.scale(1,-1),P(U,Ae,ye.x,ye.y,ye.w,ye.h,0,-1,1,1),U.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(m){}markPointProps(m,y){}beginMarkedContent(m){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(m,y){m==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(y)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(m){const y=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(m);const U=this.ctx;this.pendingClip&&(y||(this.pendingClip===be?U.clip("evenodd"):U.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),U.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const m=(0,d.getCurrentTransform)(this.ctx);if(m[1]===0&&m[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(m[0]),Math.abs(m[3]));else{const y=Math.abs(m[0]*m[3]-m[2]*m[1]),U=Math.hypot(m[0],m[2]),Ae=Math.hypot(m[1],m[3]);this._cachedGetSinglePixelWidth=Math.max(U,Ae)/y}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:m}=this.current,{a:y,b:U,c:Ae,d:ye}=this.ctx.getTransform();let Q,we;if(U===0&&Ae===0){const Re=Math.abs(y),Ne=Math.abs(ye);if(Re===Ne)if(m===0)Q=we=1/Re;else{const He=Re*m;Q=we=He<1?1/He:1}else if(m===0)Q=1/Re,we=1/Ne;else{const He=Re*m,$e=Ne*m;Q=He<1?1/He:1,we=$e<1?1/$e:1}}else{const Re=Math.abs(y*ye-U*Ae),Ne=Math.hypot(y,U),He=Math.hypot(Ae,ye);if(m===0)Q=He/Re,we=Ne/Re;else{const $e=m*Re;Q=He>$e?He/$e:1,we=Ne>$e?Ne/$e:1}}this._cachedScaleForStroking[0]=Q,this._cachedScaleForStroking[1]=we}return this._cachedScaleForStroking}rescaleAndStroke(m){const{ctx:y}=this,{lineWidth:U}=this.current,[Ae,ye]=this.getScaleForStroking();if(y.lineWidth=U||1,Ae===1&&ye===1){y.stroke();return}const Q=y.getLineDash();if(m&&y.save(),y.scale(Ae,ye),Q.length>0){const we=Math.max(Ae,ye);y.setLineDash(Q.map(Re=>Re/we)),y.lineDashOffset/=we}y.stroke(),m&&y.restore()}isContentVisible(){for(let m=this.markedContentStack.length-1;m>=0;m--)if(!this.markedContentStack[m].visible)return!1;return!0}};Pe=new WeakSet,ji=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},$i=function(){if(this.pageColors){const m=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(m!=="none"){const y=this.ctx.filter;this.ctx.filter=m,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=y}}};let W=Te;e.CanvasGraphics=W;for(const q in n.OPS)W.prototype[q]!==void 0&&(W.prototype[n.OPS[q]]=W.prototype[q])},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=g;var n=v(1),d=v(6);const re={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=re;function O(x,S){if(!S)return;const F=S[2]-S[0],I=S[3]-S[1],o=new Path2D;o.rect(S[0],S[1],F,I),x.clip(o)}class w{constructor(){this.constructor===w&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class E extends w{constructor(S){super(),this._type=S[1],this._bbox=S[2],this._colorStops=S[3],this._p0=S[4],this._p1=S[5],this._r0=S[6],this._r1=S[7],this.matrix=null}_createGradient(S){let F;this._type==="axial"?F=S.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(F=S.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const I of this._colorStops)F.addColorStop(I[0],I[1]);return F}getPattern(S,F,I,o){let s;if(o===re.STROKE||o===re.FILL){const c=F.current.getClippedPathBoundingBox(o,(0,d.getCurrentTransform)(S))||[0,0,0,0],f=Math.ceil(c[2]-c[0])||1,T=Math.ceil(c[3]-c[1])||1,Y=F.cachedCanvases.getCanvas("pattern",f,T,!0),_=Y.context;_.clearRect(0,0,_.canvas.width,_.canvas.height),_.beginPath(),_.rect(0,0,_.canvas.width,_.canvas.height),_.translate(-c[0],-c[1]),I=n.Util.transform(I,[1,0,0,1,c[0],c[1]]),_.transform(...F.baseTransform),this.matrix&&_.transform(...this.matrix),O(_,this._bbox),_.fillStyle=this._createGradient(_),_.fill(),s=S.createPattern(Y.canvas,"no-repeat");const j=new DOMMatrix(I);s.setTransform(j)}else O(S,this._bbox),s=this._createGradient(S);return s}}function p(x,S,F,I,o,s,c,f){const T=S.coords,Y=S.colors,_=x.data,j=x.width*4;let fe;T[F+1]>T[I+1]&&(fe=F,F=I,I=fe,fe=s,s=c,c=fe),T[I+1]>T[o+1]&&(fe=I,I=o,o=fe,fe=c,c=f,f=fe),T[F+1]>T[I+1]&&(fe=F,F=I,I=fe,fe=s,s=c,c=fe);const te=(T[F]+S.offsetX)*S.scaleX,_e=(T[F+1]+S.offsetY)*S.scaleY,be=(T[I]+S.offsetX)*S.scaleX,W=(T[I+1]+S.offsetY)*S.scaleY,Pe=(T[o]+S.offsetX)*S.scaleX,D=(T[o+1]+S.offsetY)*S.scaleY;if(_e>=D)return;const k=Y[s],Te=Y[s+1],q=Y[s+2],m=Y[c],y=Y[c+1],U=Y[c+2],Ae=Y[f],ye=Y[f+1],Q=Y[f+2],we=Math.round(_e),Re=Math.round(D);let Ne,He,$e,qe,Ye,Oe,Fe,J;for(let Ee=we;Ee<=Re;Ee++){if(Ee<W){const oe=Ee<_e?0:(_e-Ee)/(_e-W);Ne=te-(te-be)*oe,He=k-(k-m)*oe,$e=Te-(Te-y)*oe,qe=q-(q-U)*oe}else{let oe;Ee>D?oe=1:W===D?oe=0:oe=(W-Ee)/(W-D),Ne=be-(be-Pe)*oe,He=m-(m-Ae)*oe,$e=y-(y-ye)*oe,qe=U-(U-Q)*oe}let Ie;Ee<_e?Ie=0:Ee>D?Ie=1:Ie=(_e-Ee)/(_e-D),Ye=te-(te-Pe)*Ie,Oe=k-(k-Ae)*Ie,Fe=Te-(Te-ye)*Ie,J=q-(q-Q)*Ie;const z=Math.round(Math.min(Ne,Ye)),h=Math.round(Math.max(Ne,Ye));let X=j*Ee+z*4;for(let oe=z;oe<=h;oe++)Ie=(Ne-oe)/(Ne-Ye),Ie<0?Ie=0:Ie>1&&(Ie=1),_[X++]=He-(He-Oe)*Ie|0,_[X++]=$e-($e-Fe)*Ie|0,_[X++]=qe-(qe-J)*Ie|0,_[X++]=255}}function r(x,S,F){const I=S.coords,o=S.colors;let s,c;switch(S.type){case"lattice":const f=S.verticesPerRow,T=Math.floor(I.length/f)-1,Y=f-1;for(s=0;s<T;s++){let _=s*f;for(let j=0;j<Y;j++,_++)p(x,F,I[_],I[_+1],I[_+f],o[_],o[_+1],o[_+f]),p(x,F,I[_+f+1],I[_+1],I[_+f],o[_+f+1],o[_+1],o[_+f])}break;case"triangles":for(s=0,c=I.length;s<c;s+=3)p(x,F,I[s],I[s+1],I[s+2],o[s],o[s+1],o[s+2]);break;default:throw new Error("illegal figure")}}class H extends w{constructor(S){super(),this._coords=S[2],this._colors=S[3],this._figures=S[4],this._bounds=S[5],this._bbox=S[7],this._background=S[8],this.matrix=null}_createMeshCanvas(S,F,I){const f=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),Y=Math.ceil(this._bounds[2])-f,_=Math.ceil(this._bounds[3])-T,j=Math.min(Math.ceil(Math.abs(Y*S[0]*1.1)),3e3),fe=Math.min(Math.ceil(Math.abs(_*S[1]*1.1)),3e3),te=Y/j,_e=_/fe,be={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-T,scaleX:1/te,scaleY:1/_e},W=j+2*2,Pe=fe+2*2,D=I.getCanvas("mesh",W,Pe,!1),k=D.context,Te=k.createImageData(j,fe);if(F){const m=Te.data;for(let y=0,U=m.length;y<U;y+=4)m[y]=F[0],m[y+1]=F[1],m[y+2]=F[2],m[y+3]=255}for(const m of this._figures)r(Te,m,be);return k.putImageData(Te,2,2),{canvas:D.canvas,offsetX:f-2*te,offsetY:T-2*_e,scaleX:te,scaleY:_e}}getPattern(S,F,I,o){O(S,this._bbox);let s;if(o===re.SHADING)s=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(S));else if(s=n.Util.singularValueDecompose2dScale(F.baseTransform),this.matrix){const f=n.Util.singularValueDecompose2dScale(this.matrix);s=[s[0]*f[0],s[1]*f[1]]}const c=this._createMeshCanvas(s,o===re.SHADING?null:this._background,F.cachedCanvases);return o!==re.SHADING&&(S.setTransform(...F.baseTransform),this.matrix&&S.transform(...this.matrix)),S.translate(c.offsetX,c.offsetY),S.scale(c.scaleX,c.scaleY),S.createPattern(c.canvas,"no-repeat")}}class N extends w{getPattern(){return"hotpink"}}function g(x){switch(x[0]){case"RadialAxial":return new E(x);case"Mesh":return new H(x);case"Dummy":return new N}throw new Error(`Unknown IR type: ${x[0]}`)}const u={COLORED:1,UNCOLORED:2},P=class P{constructor(S,F,I,o,s){this.operatorList=S[2],this.matrix=S[3]||[1,0,0,1,0,0],this.bbox=S[4],this.xstep=S[5],this.ystep=S[6],this.paintType=S[7],this.tilingType=S[8],this.color=F,this.ctx=I,this.canvasGraphicsFactory=o,this.baseTransform=s}createPatternCanvas(S){const F=this.operatorList,I=this.bbox,o=this.xstep,s=this.ystep,c=this.paintType,f=this.tilingType,T=this.color,Y=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+f);const _=I[0],j=I[1],fe=I[2],te=I[3],_e=n.Util.singularValueDecompose2dScale(this.matrix),be=n.Util.singularValueDecompose2dScale(this.baseTransform),W=[_e[0]*be[0],_e[1]*be[1]],Pe=this.getSizeAndScale(o,this.ctx.canvas.width,W[0]),D=this.getSizeAndScale(s,this.ctx.canvas.height,W[1]),k=S.cachedCanvases.getCanvas("pattern",Pe.size,D.size,!0),Te=k.context,q=Y.createCanvasGraphics(Te);q.groupLevel=S.groupLevel,this.setFillAndStrokeStyleToContext(q,c,T);let m=_,y=j,U=fe,Ae=te;return _<0&&(m=0,U+=Math.abs(_)),j<0&&(y=0,Ae+=Math.abs(j)),Te.translate(-(Pe.scale*m),-(D.scale*y)),q.transform(Pe.scale,0,0,D.scale,0,0),Te.save(),this.clipBbox(q,m,y,U,Ae),q.baseTransform=(0,d.getCurrentTransform)(q.ctx),q.executeOperatorList(F),q.endDrawing(),{canvas:k.canvas,scaleX:Pe.scale,scaleY:D.scale,offsetX:m,offsetY:y}}getSizeAndScale(S,F,I){S=Math.abs(S);const o=Math.max(P.MAX_PATTERN_SIZE,F);let s=Math.ceil(S*I);return s>=o?s=o:I=s/S,{scale:I,size:s}}clipBbox(S,F,I,o,s){const c=o-F,f=s-I;S.ctx.rect(F,I,c,f),S.current.updateRectMinMax((0,d.getCurrentTransform)(S.ctx),[F,I,o,s]),S.clip(),S.endPath()}setFillAndStrokeStyleToContext(S,F,I){const o=S.ctx,s=S.current;switch(F){case u.COLORED:const c=this.ctx;o.fillStyle=c.fillStyle,o.strokeStyle=c.strokeStyle,s.fillColor=c.fillStyle,s.strokeColor=c.strokeStyle;break;case u.UNCOLORED:const f=n.Util.makeHexColor(I[0],I[1],I[2]);o.fillStyle=f,o.strokeStyle=f,s.fillColor=f,s.strokeColor=f;break;default:throw new n.FormatError(`Unsupported paint type: ${F}`)}}getPattern(S,F,I,o){let s=I;o!==re.SHADING&&(s=n.Util.transform(s,F.baseTransform),this.matrix&&(s=n.Util.transform(s,this.matrix)));const c=this.createPatternCanvas(F);let f=new DOMMatrix(s);f=f.translate(c.offsetX,c.offsetY),f=f.scale(1/c.scaleX,1/c.scaleY);const T=S.createPattern(c.canvas,"repeat");return T.setTransform(f),T}};at(P,"MAX_PATTERN_SIZE",3e3);let M=P;e.TilingPattern=M},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=re,e.convertToRGBA=d,e.grayToRGBA=w;var n=v(1);function d(E){switch(E.kind){case n.ImageKind.GRAYSCALE_1BPP:return re(E);case n.ImageKind.RGB_24BPP:return O(E)}return null}function re({src:E,srcPos:p=0,dest:r,width:H,height:N,nonBlackColor:g=4294967295,inverseDecode:u=!1}){const M=n.FeatureTest.isLittleEndian?4278190080:255,[P,x]=u?[g,M]:[M,g],S=H>>3,F=H&7,I=E.length;r=new Uint32Array(r.buffer);let o=0;for(let s=0;s<N;s++){for(const f=p+S;p<f;p++){const T=p<I?E[p]:255;r[o++]=T&128?x:P,r[o++]=T&64?x:P,r[o++]=T&32?x:P,r[o++]=T&16?x:P,r[o++]=T&8?x:P,r[o++]=T&4?x:P,r[o++]=T&2?x:P,r[o++]=T&1?x:P}if(F===0)continue;const c=p<I?E[p++]:255;for(let f=0;f<F;f++)r[o++]=c&1<<7-f?x:P}return{srcPos:p,destPos:o}}function O({src:E,srcPos:p=0,dest:r,destPos:H=0,width:N,height:g}){let u=0;const M=E.length>>2,P=new Uint32Array(E.buffer,p,M);if(n.FeatureTest.isLittleEndian){for(;u<M-2;u+=3,H+=4){const x=P[u],S=P[u+1],F=P[u+2];r[H]=x|4278190080,r[H+1]=x>>>24|S<<8|4278190080,r[H+2]=S>>>16|F<<16|4278190080,r[H+3]=F>>>8|4278190080}for(let x=u*4,S=E.length;x<S;x+=3)r[H++]=E[x]|E[x+1]<<8|E[x+2]<<16|4278190080}else{for(;u<M-2;u+=3,H+=4){const x=P[u],S=P[u+1],F=P[u+2];r[H]=x|255,r[H+1]=x<<24|S>>>8|255,r[H+2]=S<<16|F>>>16|255,r[H+3]=F<<8|255}for(let x=u*4,S=E.length;x<S;x+=3)r[H++]=E[x]<<24|E[x+1]<<16|E[x+2]<<8|255}return{srcPos:p,destPos:H}}function w(E,p){if(n.FeatureTest.isLittleEndian)for(let r=0,H=E.length;r<H;r++)p[r]=E[r]*65793|4278190080;else for(let r=0,H=E.length;r<H;r++)p[r]=E[r]*16843008|255}},(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const v=Object.create(null);e.GlobalWorkerOptions=v,v.workerPort=null,v.workerSrc=""},(i,e,v)=>{var E,Gn,Xn,di;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=v(1);const d={UNKNOWN:0,DATA:1,ERROR:2},re={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function O(N){switch(N instanceof Error||typeof N=="object"&&N!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),N.name){case"AbortException":return new n.AbortException(N.message);case"MissingPDFException":return new n.MissingPDFException(N.message);case"PasswordException":return new n.PasswordException(N.message,N.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(N.message,N.status);case"UnknownErrorException":return new n.UnknownErrorException(N.message,N.details);default:return new n.UnknownErrorException(N.message,N.toString())}}class w{constructor(g,u,M){Me(this,E);this.sourceName=g,this.targetName=u,this.comObj=M,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=P=>{const x=P.data;if(x.targetName!==this.sourceName)return;if(x.stream){ne(this,E,Xn).call(this,x);return}if(x.callback){const F=x.callbackId,I=this.callbackCapabilities[F];if(!I)throw new Error(`Cannot resolve callback ${F}`);if(delete this.callbackCapabilities[F],x.callback===d.DATA)I.resolve(x.data);else if(x.callback===d.ERROR)I.reject(O(x.reason));else throw new Error("Unexpected callback case");return}const S=this.actionHandler[x.action];if(!S)throw new Error(`Unknown action from worker: ${x.action}`);if(x.callbackId){const F=this.sourceName,I=x.sourceName;new Promise(function(o){o(S(x.data))}).then(function(o){M.postMessage({sourceName:F,targetName:I,callback:d.DATA,callbackId:x.callbackId,data:o})},function(o){M.postMessage({sourceName:F,targetName:I,callback:d.ERROR,callbackId:x.callbackId,reason:O(o)})});return}if(x.streamId){ne(this,E,Gn).call(this,x);return}S(x.data)},M.addEventListener("message",this._onComObjOnMessage)}on(g,u){const M=this.actionHandler;if(M[g])throw new Error(`There is already an actionName called "${g}"`);M[g]=u}send(g,u,M){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:g,data:u},M)}sendWithPromise(g,u,M){const P=this.callbackId++,x=new n.PromiseCapability;this.callbackCapabilities[P]=x;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:g,callbackId:P,data:u},M)}catch(S){x.reject(S)}return x.promise}sendWithStream(g,u,M,P){const x=this.streamId++,S=this.sourceName,F=this.targetName,I=this.comObj;return new ReadableStream({start:o=>{const s=new n.PromiseCapability;return this.streamControllers[x]={controller:o,startCall:s,pullCall:null,cancelCall:null,isClosed:!1},I.postMessage({sourceName:S,targetName:F,action:g,streamId:x,data:u,desiredSize:o.desiredSize},P),s.promise},pull:o=>{const s=new n.PromiseCapability;return this.streamControllers[x].pullCall=s,I.postMessage({sourceName:S,targetName:F,stream:re.PULL,streamId:x,desiredSize:o.desiredSize}),s.promise},cancel:o=>{(0,n.assert)(o instanceof Error,"cancel must have a valid reason");const s=new n.PromiseCapability;return this.streamControllers[x].cancelCall=s,this.streamControllers[x].isClosed=!0,I.postMessage({sourceName:S,targetName:F,stream:re.CANCEL,streamId:x,reason:O(o)}),s.promise}},M)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}E=new WeakSet,Gn=function(g){const u=g.streamId,M=this.sourceName,P=g.sourceName,x=this.comObj,S=this,F=this.actionHandler[g.action],I={enqueue(o,s=1,c){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=s,f>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),x.postMessage({sourceName:M,targetName:P,stream:re.ENQUEUE,streamId:u,chunk:o},c)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:M,targetName:P,stream:re.CLOSE,streamId:u}),delete S.streamSinks[u])},error(o){(0,n.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:M,targetName:P,stream:re.ERROR,streamId:u,reason:O(o)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:g.desiredSize,ready:null};I.sinkCapability.resolve(),I.ready=I.sinkCapability.promise,this.streamSinks[u]=I,new Promise(function(o){o(F(g.data,I))}).then(function(){x.postMessage({sourceName:M,targetName:P,stream:re.START_COMPLETE,streamId:u,success:!0})},function(o){x.postMessage({sourceName:M,targetName:P,stream:re.START_COMPLETE,streamId:u,reason:O(o)})})},Xn=function(g){const u=g.streamId,M=this.sourceName,P=g.sourceName,x=this.comObj,S=this.streamControllers[u],F=this.streamSinks[u];switch(g.stream){case re.START_COMPLETE:g.success?S.startCall.resolve():S.startCall.reject(O(g.reason));break;case re.PULL_COMPLETE:g.success?S.pullCall.resolve():S.pullCall.reject(O(g.reason));break;case re.PULL:if(!F){x.postMessage({sourceName:M,targetName:P,stream:re.PULL_COMPLETE,streamId:u,success:!0});break}F.desiredSize<=0&&g.desiredSize>0&&F.sinkCapability.resolve(),F.desiredSize=g.desiredSize,new Promise(function(I){var o;I((o=F.onPull)==null?void 0:o.call(F))}).then(function(){x.postMessage({sourceName:M,targetName:P,stream:re.PULL_COMPLETE,streamId:u,success:!0})},function(I){x.postMessage({sourceName:M,targetName:P,stream:re.PULL_COMPLETE,streamId:u,reason:O(I)})});break;case re.ENQUEUE:if((0,n.assert)(S,"enqueue should have stream controller"),S.isClosed)break;S.controller.enqueue(g.chunk);break;case re.CLOSE:if((0,n.assert)(S,"close should have stream controller"),S.isClosed)break;S.isClosed=!0,S.controller.close(),ne(this,E,di).call(this,S,u);break;case re.ERROR:(0,n.assert)(S,"error should have stream controller"),S.controller.error(O(g.reason)),ne(this,E,di).call(this,S,u);break;case re.CANCEL_COMPLETE:g.success?S.cancelCall.resolve():S.cancelCall.reject(O(g.reason)),ne(this,E,di).call(this,S,u);break;case re.CANCEL:if(!F)break;new Promise(function(I){var o;I((o=F.onCancel)==null?void 0:o.call(F,O(g.reason)))}).then(function(){x.postMessage({sourceName:M,targetName:P,stream:re.CANCEL_COMPLETE,streamId:u,success:!0})},function(I){x.postMessage({sourceName:M,targetName:P,stream:re.CANCEL_COMPLETE,streamId:u,reason:O(I)})}),F.sinkCapability.reject(O(g.reason)),F.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}},di=async function(g,u){var M,P,x;await Promise.allSettled([(M=g.startCall)==null?void 0:M.promise,(P=g.pullCall)==null?void 0:P.promise,(x=g.cancelCall)==null?void 0:x.promise]),delete this.streamControllers[u]},e.MessageHandler=w},(i,e,v)=>{var re,O;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=v(1);class d{constructor({parsedData:E,rawData:p}){Me(this,re);Me(this,O);Ce(this,re,E),Ce(this,O,p)}getRaw(){return t(this,O)}get(E){return t(this,re).get(E)??null}getAll(){return(0,n.objectFromMap)(t(this,re))}has(E){return t(this,re).has(E)}}re=new WeakMap,O=new WeakMap,e.Metadata=d},(i,e,v)=>{var E,p,r,H,N,g,zi;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=v(1),d=v(8);const re=Symbol("INTERNAL");class O{constructor(P,x){Me(this,E,!0);this.name=P,this.intent=x}get visible(){return t(this,E)}_setVisible(P,x){P!==re&&(0,n.unreachable)("Internal method `_setVisible` called."),Ce(this,E,x)}}E=new WeakMap;class w{constructor(P){Me(this,g);Me(this,p,null);Me(this,r,new Map);Me(this,H,null);Me(this,N,null);if(this.name=null,this.creator=null,P!==null){this.name=P.name,this.creator=P.creator,Ce(this,N,P.order);for(const x of P.groups)t(this,r).set(x.id,new O(x.name,x.intent));if(P.baseState==="OFF")for(const x of t(this,r).values())x._setVisible(re,!1);for(const x of P.on)t(this,r).get(x)._setVisible(re,!0);for(const x of P.off)t(this,r).get(x)._setVisible(re,!1);Ce(this,H,this.getHash())}}isVisible(P){if(t(this,r).size===0)return!0;if(!P)return(0,n.warn)("Optional content group not defined."),!0;if(P.type==="OCG")return t(this,r).has(P.id)?t(this,r).get(P.id).visible:((0,n.warn)(`Optional content group not found: ${P.id}`),!0);if(P.type==="OCMD"){if(P.expression)return ne(this,g,zi).call(this,P.expression);if(!P.policy||P.policy==="AnyOn"){for(const x of P.ids){if(!t(this,r).has(x))return(0,n.warn)(`Optional content group not found: ${x}`),!0;if(t(this,r).get(x).visible)return!0}return!1}else if(P.policy==="AllOn"){for(const x of P.ids){if(!t(this,r).has(x))return(0,n.warn)(`Optional content group not found: ${x}`),!0;if(!t(this,r).get(x).visible)return!1}return!0}else if(P.policy==="AnyOff"){for(const x of P.ids){if(!t(this,r).has(x))return(0,n.warn)(`Optional content group not found: ${x}`),!0;if(!t(this,r).get(x).visible)return!0}return!1}else if(P.policy==="AllOff"){for(const x of P.ids){if(!t(this,r).has(x))return(0,n.warn)(`Optional content group not found: ${x}`),!0;if(t(this,r).get(x).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${P.policy}.`),!0}return(0,n.warn)(`Unknown group type ${P.type}.`),!0}setVisibility(P,x=!0){if(!t(this,r).has(P)){(0,n.warn)(`Optional content group not found: ${P}`);return}t(this,r).get(P)._setVisible(re,!!x),Ce(this,p,null)}get hasInitialVisibility(){return t(this,H)===null||this.getHash()===t(this,H)}getOrder(){return t(this,r).size?t(this,N)?t(this,N).slice():[...t(this,r).keys()]:null}getGroups(){return t(this,r).size>0?(0,n.objectFromMap)(t(this,r)):null}getGroup(P){return t(this,r).get(P)||null}getHash(){if(t(this,p)!==null)return t(this,p);const P=new d.MurmurHash3_64;for(const[x,S]of t(this,r))P.update(`${x}:${S.visible}`);return Ce(this,p,P.hexdigest())}}p=new WeakMap,r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakSet,zi=function(P){const x=P.length;if(x<2)return!0;const S=P[0];for(let F=1;F<x;F++){const I=P[F];let o;if(Array.isArray(I))o=ne(this,g,zi).call(this,I);else if(t(this,r).has(I))o=t(this,r).get(I).visible;else return(0,n.warn)(`Optional content group not found: ${I}`),!0;switch(S){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return S==="And"},e.OptionalContentConfig=w},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=v(1),d=v(6);class re{constructor({length:p,initialData:r,progressiveDone:H=!1,contentDispositionFilename:N=null,disableRange:g=!1,disableStream:u=!1},M){if((0,n.assert)(M,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=H,this._contentDispositionFilename=N,(r==null?void 0:r.length)>0){const P=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(P)}this._pdfDataRangeTransport=M,this._isStreamingSupported=!u,this._isRangeSupported=!g,this._contentLength=p,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((P,x)=>{this._onReceiveData({begin:P,chunk:x})}),this._pdfDataRangeTransport.addProgressListener((P,x)=>{this._onProgress({loaded:P,total:x})}),this._pdfDataRangeTransport.addProgressiveReadListener(P=>{this._onReceiveData({chunk:P})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:p,chunk:r}){const H=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;if(p===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(H):this._queuedChunks.push(H);else{const N=this._rangeReaders.some(function(g){return g._begin!==p?!1:(g._enqueue(H),!0)});(0,n.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}_onProgress(p){var r,H,N,g;p.total===void 0?(H=(r=this._rangeReaders[0])==null?void 0:r.onProgress)==null||H.call(r,{loaded:p.loaded}):(g=(N=this._fullRequestReader)==null?void 0:N.onProgress)==null||g.call(N,{loaded:p.loaded,total:p.total})}_onProgressiveDone(){var p;(p=this._fullRequestReader)==null||p.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(p){const r=this._rangeReaders.indexOf(p);r>=0&&this._rangeReaders.splice(r,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const p=this._queuedChunks;return this._queuedChunks=null,new O(this,p,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(p,r){if(r<=this._progressiveDataLength)return null;const H=new w(this,p,r);return this._pdfDataRangeTransport.requestDataRange(p,r),this._rangeReaders.push(H),H}cancelAllRequests(p){var r;(r=this._fullRequestReader)==null||r.cancel(p);for(const H of this._rangeReaders.slice(0))H.cancel(p);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=re;class O{constructor(p,r,H=!1,N=null){this._stream=p,this._done=H||!1,this._filename=(0,d.isPdfFile)(N)?N:null,this._queuedChunks=r||[],this._loaded=0;for(const g of this._queuedChunks)this._loaded+=g.byteLength;this._requests=[],this._headersReady=Promise.resolve(),p._fullRequestReader=this,this.onProgress=null}_enqueue(p){this._done||(this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunks.push(p),this._loaded+=p.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=new n.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class w{constructor(p,r,H){this._stream=p,this._begin=r,this._end=H,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(p){if(!this._done){if(this._requests.length===0)this._queuedChunk=p;else{this._requests.shift().resolve({value:p,done:!1});for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const r=this._queuedChunk;return this._queuedChunk=null,{value:r,done:!1}}if(this._done)return{value:void 0,done:!0};const p=new n.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=v(1),d=v(20);function re(H,N,g){return{method:"GET",headers:H,signal:g.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function O(H){const N=new Headers;for(const g in H){const u=H[g];u!==void 0&&N.append(g,u)}return N}function w(H){return H instanceof Uint8Array?H.buffer:H instanceof ArrayBuffer?H:((0,n.warn)(`getArrayBuffer - unexpected data format: ${H}`),new Uint8Array(H).buffer)}class E{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new p(this),this._fullRequestReader}getRangeReader(N,g){if(g<=this._progressiveDataLength)return null;const u=new r(this,N,g);return this._rangeRequestReaders.push(u),u}cancelAllRequests(N){var g;(g=this._fullRequestReader)==null||g.cancel(N);for(const u of this._rangeRequestReaders.slice(0))u.cancel(N)}}e.PDFFetchStream=E;class p{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const g=N.source;this._withCredentials=g.withCredentials||!1,this._contentLength=g.length,this._headersCapability=new n.PromiseCapability,this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._headers=O(this._stream.httpHeaders);const u=g.url;fetch(u,re(this._headers,this._withCredentials,this._abortController)).then(M=>{if(!(0,d.validateResponseStatus)(M.status))throw(0,d.createResponseStatusError)(M.status,u);this._reader=M.body.getReader(),this._headersCapability.resolve();const P=F=>M.headers.get(F),{allowRangeRequests:x,suggestedLength:S}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:P,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=x,this._contentLength=S||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(P),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;await this._headersCapability.promise;const{value:N,done:g}=await this._reader.read();return g?{value:N,done:g}:(this._loaded+=N.byteLength,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded,total:this._contentLength}),{value:w(N),done:!1})}cancel(N){var g;(g=this._reader)==null||g.cancel(N),this._abortController.abort()}}class r{constructor(N,g,u){this._stream=N,this._reader=null,this._loaded=0;const M=N.source;this._withCredentials=M.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!M.disableStream,this._abortController=new AbortController,this._headers=O(this._stream.httpHeaders),this._headers.append("Range",`bytes=${g}-${u-1}`);const P=M.url;fetch(P,re(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,d.validateResponseStatus)(x.status))throw(0,d.createResponseStatusError)(x.status,P);this._readCapability.resolve(),this._reader=x.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;await this._readCapability.promise;const{value:N,done:g}=await this._reader.read();return g?{value:N,done:g}:(this._loaded+=N.byteLength,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded}),{value:w(N),done:!1})}cancel(N){var g;(g=this._reader)==null||g.cancel(N),this._abortController.abort()}}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=E,e.extractFilenameFromHeader=w,e.validateRangeRequestCapabilities=O,e.validateResponseStatus=p;var n=v(1),d=v(21),re=v(6);function O({getResponseHeader:r,isHttp:H,rangeChunkSize:N,disableRange:g}){const u={allowRangeRequests:!1,suggestedLength:void 0},M=parseInt(r("Content-Length"),10);return!Number.isInteger(M)||(u.suggestedLength=M,M<=2*N)||g||!H||r("Accept-Ranges")!=="bytes"||(r("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function w(r){const H=r("Content-Disposition");if(H){let N=(0,d.getFilenameFromContentDispositionHeader)(H);if(N.includes("%"))try{N=decodeURIComponent(N)}catch{}if((0,re.isPdfFile)(N))return N}return null}function E(r,H){return r===404||r===0&&H.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+H+'".'):new n.UnexpectedResponseException(`Unexpected server response (${r}) while retrieving PDF "${H}".`,r)}function p(r){return r===200||r===206}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=d;var n=v(1);function d(re){let O=!0,w=E("filename\\*","i").exec(re);if(w){w=w[1];let M=N(w);return M=unescape(M),M=g(M),M=u(M),r(M)}if(w=H(re),w){const M=u(w);return r(M)}if(w=E("filename","i").exec(re),w){w=w[1];let M=N(w);return M=u(M),r(M)}function E(M,P){return new RegExp("(?:^|;)\\s*"+M+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',P)}function p(M,P){if(M){if(!/^[\x00-\xFF]+$/.test(P))return P;try{const x=new TextDecoder(M,{fatal:!0}),S=(0,n.stringToBytes)(P);P=x.decode(S),O=!1}catch{}}return P}function r(M){return O&&/[\x80-\xff]/.test(M)&&(M=p("utf-8",M),O&&(M=p("iso-8859-1",M))),M}function H(M){const P=[];let x;const S=E("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=S.exec(M))!==null;){let[,I,o,s]=x;if(I=parseInt(I,10),I in P){if(I===0)break;continue}P[I]=[o,s]}const F=[];for(let I=0;I<P.length&&I in P;++I){let[o,s]=P[I];s=N(s),o&&(s=unescape(s),I===0&&(s=g(s))),F.push(s)}return F.join("")}function N(M){if(M.startsWith('"')){const P=M.slice(1).split('\\"');for(let x=0;x<P.length;++x){const S=P[x].indexOf('"');S!==-1&&(P[x]=P[x].slice(0,S),P.length=x+1),P[x]=P[x].replaceAll(/\\(.)/g,"$1")}M=P.join('"')}return M}function g(M){const P=M.indexOf("'");if(P===-1)return M;const x=M.slice(0,P),F=M.slice(P+1).replace(/^[^']*'/,"");return p(x,F)}function u(M){return!M.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(M)?M:M.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(P,x,S,F){if(S==="q"||S==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(I,o){return String.fromCharCode(parseInt(o,16))}),p(x,F);try{F=atob(F)}catch{}return p(x,F)})}return""}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=v(1),d=v(20);const re=200,O=206;function w(N){const g=N.response;return typeof g!="string"?g:(0,n.stringToBytes)(g).buffer}class E{constructor(g,u={}){this.url=g,this.isHttp=/^https?:/i.test(g),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(g,u,M){const P={begin:g,end:u};for(const x in M)P[x]=M[x];return this.request(P)}requestFull(g){return this.request(g)}request(g){const u=new XMLHttpRequest,M=this.currXhrId++,P=this.pendingRequests[M]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const x in this.httpHeaders){const S=this.httpHeaders[x];S!==void 0&&u.setRequestHeader(x,S)}return this.isHttp&&"begin"in g&&"end"in g?(u.setRequestHeader("Range",`bytes=${g.begin}-${g.end-1}`),P.expectedStatus=O):P.expectedStatus=re,u.responseType="arraybuffer",g.onError&&(u.onerror=function(x){g.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,M),u.onprogress=this.onProgress.bind(this,M),P.onHeadersReceived=g.onHeadersReceived,P.onDone=g.onDone,P.onError=g.onError,P.onProgress=g.onProgress,u.send(null),M}onProgress(g,u){var P;const M=this.pendingRequests[g];M&&((P=M.onProgress)==null||P.call(M,u))}onStateChange(g,u){var I,o,s;const M=this.pendingRequests[g];if(!M)return;const P=M.xhr;if(P.readyState>=2&&M.onHeadersReceived&&(M.onHeadersReceived(),delete M.onHeadersReceived),P.readyState!==4||!(g in this.pendingRequests))return;if(delete this.pendingRequests[g],P.status===0&&this.isHttp){(I=M.onError)==null||I.call(M,P.status);return}const x=P.status||re;if(!(x===re&&M.expectedStatus===O)&&x!==M.expectedStatus){(o=M.onError)==null||o.call(M,P.status);return}const F=w(P);if(x===O){const c=P.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);M.onDone({begin:parseInt(f[1],10),chunk:F})}else F?M.onDone({begin:0,chunk:F}):(s=M.onError)==null||s.call(M,P.status)}getRequestXhr(g){return this.pendingRequests[g].xhr}isPendingRequest(g){return g in this.pendingRequests}abortRequest(g){const u=this.pendingRequests[g].xhr;delete this.pendingRequests[g],u.abort()}}class p{constructor(g){this._source=g,this._manager=new E(g.url,{httpHeaders:g.httpHeaders,withCredentials:g.withCredentials}),this._rangeChunkSize=g.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(g){const u=this._rangeRequestReaders.indexOf(g);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new r(this._manager,this._source),this._fullRequestReader}getRangeReader(g,u){const M=new H(this._manager,g,u);return M.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(M),M}cancelAllRequests(g){var u;(u=this._fullRequestReader)==null||u.cancel(g);for(const M of this._rangeRequestReaders.slice(0))M.cancel(g)}}e.PDFNetworkStream=p;class r{constructor(g,u){this._manager=g;const M={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=g.requestFull(M),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const g=this._fullRequestId,u=this._manager.getRequestXhr(g),M=S=>u.getResponseHeader(S),{allowRangeRequests:P,suggestedLength:x}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});P&&(this._isRangeSupported=!0),this._contentLength=x||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(M),this._isRangeSupported&&this._manager.abortRequest(g),this._headersReceivedCapability.resolve()}_onDone(g){if(g&&(this._requests.length>0?this._requests.shift().resolve({value:g.chunk,done:!1}):this._cachedChunks.push(g.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(g){this._storedError=(0,d.createResponseStatusError)(g,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(g){var u;(u=this.onProgress)==null||u.call(this,{loaded:g.loaded,total:g.lengthComputable?g.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const g=new n.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0,this._headersReceivedCapability.reject(g);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class H{constructor(g,u,M){this._manager=g;const P={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._requestId=g.requestRange(u,M,P),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var g;(g=this.onClosed)==null||g.call(this,this)}_onDone(g){const u=g.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(g){this._storedError=(0,d.createResponseStatusError)(g,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(g){var u;this.isStreamingSupported||(u=this.onProgress)==null||u.call(this,{loaded:g.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const g=new n.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=v(1),d=v(20);const re=/^file:\/\/\/[a-zA-Z]:\//;function O(M){const P=require$$5,x=P.parse(M);return x.protocol==="file:"||x.host?x:/^[a-z]:[/\\]/i.test(M)?P.parse(`file:///${M}`):(x.host||(x.protocol="file:"),x)}class w{constructor(P){this.source=P,this.url=O(P.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&P.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var P;return((P=this._fullRequestReader)==null?void 0:P._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new g(this):new H(this),this._fullRequestReader}getRangeReader(P,x){if(x<=this._progressiveDataLength)return null;const S=this.isFsUrl?new u(this,P,x):new N(this,P,x);return this._rangeRequestReaders.push(S),S}cancelAllRequests(P){var x;(x=this._fullRequestReader)==null||x.cancel(P);for(const S of this._rangeRequestReaders.slice(0))S.cancel(P)}}e.PDFNodeStream=w;class E{constructor(P){this._url=P.url,this._done=!1,this._storedError=null,this.onProgress=null;const x=P.source;this._contentLength=x.length,this._loaded=0,this._filename=null,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const P=this._readableStream.read();return P===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=P.length,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){if(!this._readableStream){this._error(P);return}this._readableStream.destroy(P)}_error(P){this._storedError=P,this._readCapability.resolve()}_setReadableStream(P){this._readableStream=P,P.on("readable",()=>{this._readCapability.resolve()}),P.on("end",()=>{P.destroy(),this._done=!0,this._readCapability.resolve()}),P.on("error",x=>{this._error(x)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(P){this._url=P.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const x=P.source;this._isStreamingSupported=!x.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const P=this._readableStream.read();return P===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=P.length,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){if(!this._readableStream){this._error(P);return}this._readableStream.destroy(P)}_error(P){this._storedError=P,this._readCapability.resolve()}_setReadableStream(P){this._readableStream=P,P.on("readable",()=>{this._readCapability.resolve()}),P.on("end",()=>{P.destroy(),this._done=!0,this._readCapability.resolve()}),P.on("error",x=>{this._error(x)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function r(M,P){return{protocol:M.protocol,auth:M.auth,host:M.hostname,port:M.port,path:M.path,method:"GET",headers:P}}class H extends E{constructor(P){super(P);const x=S=>{if(S.statusCode===404){const s=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=s,this._headersCapability.reject(s);return}this._headersCapability.resolve(),this._setReadableStream(S);const F=s=>this._readableStream.headers[s.toLowerCase()],{allowRangeRequests:I,suggestedLength:o}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:F,isHttp:P.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=I,this._contentLength=o||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(F)};if(this._request=null,this._url.protocol==="http:"){const S=require$$5;this._request=S.request(r(this._url,P.httpHeaders),x)}else{const S=require$$5;this._request=S.request(r(this._url,P.httpHeaders),x)}this._request.on("error",S=>{this._storedError=S,this._headersCapability.reject(S)}),this._request.end()}}class N extends p{constructor(P,x,S){super(P),this._httpHeaders={};for(const I in P.httpHeaders){const o=P.httpHeaders[I];o!==void 0&&(this._httpHeaders[I]=o)}this._httpHeaders.Range=`bytes=${x}-${S-1}`;const F=I=>{if(I.statusCode===404){const o=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(I)};if(this._request=null,this._url.protocol==="http:"){const I=require$$5;this._request=I.request(r(this._url,this._httpHeaders),F)}else{const I=require$$5;this._request=I.request(r(this._url,this._httpHeaders),F)}this._request.on("error",I=>{this._storedError=I}),this._request.end()}}class g extends E{constructor(P){super(P);let x=decodeURIComponent(this._url.path);re.test(this._url.href)&&(x=x.replace(/^\//,""));const S=require$$5;S.lstat(x,(F,I)=>{if(F){F.code==="ENOENT"&&(F=new n.MissingPDFException(`Missing PDF "${x}".`)),this._storedError=F,this._headersCapability.reject(F);return}this._contentLength=I.size,this._setReadableStream(S.createReadStream(x)),this._headersCapability.resolve()})}}class u extends p{constructor(P,x,S){super(P);let F=decodeURIComponent(this._url.path);re.test(this._url.href)&&(F=F.replace(/^\//,""));const I=require$$5;this._setReadableStream(I.createReadStream(F,{start:x,end:S-1}))}}},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=v(6),d=v(1);const re={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},O="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/1999/xlink",E=["butt","round","square"],p=["miter","round","bevel"],r=function(I,o="",s=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!s)return URL.createObjectURL(new Blob([I],{type:o}));const c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let f=`data:${o};base64,`;for(let T=0,Y=I.length;T<Y;T+=3){const _=I[T]&255,j=I[T+1]&255,fe=I[T+2]&255,te=_>>2,_e=(_&3)<<4|j>>4,be=T+1<Y?(j&15)<<2|fe>>6:64,W=T+2<Y?fe&63:64;f+=c[te]+c[_e]+c[be]+c[W]}return f},H=function(){const I=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,s=new Int32Array(256);for(let fe=0;fe<256;fe++){let te=fe;for(let _e=0;_e<8;_e++)te=te&1?3988292384^te>>1&2147483647:te>>1&2147483647;s[fe]=te}function c(fe,te,_e){let be=-1;for(let W=te;W<_e;W++){const Pe=(be^fe[W])&255,D=s[Pe];be=be>>>8^D}return be^-1}function f(fe,te,_e,be){let W=be;const Pe=te.length;_e[W]=Pe>>24&255,_e[W+1]=Pe>>16&255,_e[W+2]=Pe>>8&255,_e[W+3]=Pe&255,W+=4,_e[W]=fe.charCodeAt(0)&255,_e[W+1]=fe.charCodeAt(1)&255,_e[W+2]=fe.charCodeAt(2)&255,_e[W+3]=fe.charCodeAt(3)&255,W+=4,_e.set(te,W),W+=te.length;const D=c(_e,be+4,W);_e[W]=D>>24&255,_e[W+1]=D>>16&255,_e[W+2]=D>>8&255,_e[W+3]=D&255}function T(fe,te,_e){let be=1,W=0;for(let Pe=te;Pe<_e;++Pe)be=(be+(fe[Pe]&255))%65521,W=(W+be)%65521;return W<<16|be}function Y(fe){if(!d.isNodeJS)return _(fe);try{const te=parseInt(process.versions.node)>=8?fe:Buffer.from(fe),_e=require$$5.deflateSync(te,{level:9});return _e instanceof Uint8Array?_e:new Uint8Array(_e)}catch(te){(0,d.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+te)}return _(fe)}function _(fe){let te=fe.length;const _e=65535,be=Math.ceil(te/_e),W=new Uint8Array(2+te+be*5+4);let Pe=0;W[Pe++]=120,W[Pe++]=156;let D=0;for(;te>_e;)W[Pe++]=0,W[Pe++]=255,W[Pe++]=255,W[Pe++]=0,W[Pe++]=0,W.set(fe.subarray(D,D+_e),Pe),Pe+=_e,D+=_e,te-=_e;W[Pe++]=1,W[Pe++]=te&255,W[Pe++]=te>>8&255,W[Pe++]=~te&65535&255,W[Pe++]=(~te&65535)>>8&255,W.set(fe.subarray(D),Pe),Pe+=fe.length-D;const k=T(fe,0,fe.length);return W[Pe++]=k>>24&255,W[Pe++]=k>>16&255,W[Pe++]=k>>8&255,W[Pe++]=k&255,W}function j(fe,te,_e,be){const W=fe.width,Pe=fe.height;let D,k,Te;const q=fe.data;switch(te){case d.ImageKind.GRAYSCALE_1BPP:k=0,D=1,Te=W+7>>3;break;case d.ImageKind.RGB_24BPP:k=2,D=8,Te=W*3;break;case d.ImageKind.RGBA_32BPP:k=6,D=8,Te=W*4;break;default:throw new Error("invalid format")}const m=new Uint8Array((1+Te)*Pe);let y=0,U=0;for(let Ne=0;Ne<Pe;++Ne)m[y++]=0,m.set(q.subarray(U,U+Te),y),U+=Te,y+=Te;if(te===d.ImageKind.GRAYSCALE_1BPP&&be){y=0;for(let Ne=0;Ne<Pe;Ne++){y++;for(let He=0;He<Te;He++)m[y++]^=255}}const Ae=new Uint8Array([W>>24&255,W>>16&255,W>>8&255,W&255,Pe>>24&255,Pe>>16&255,Pe>>8&255,Pe&255,D,k,0,0,0]),ye=Y(m),Q=I.length+o*3+Ae.length+ye.length,we=new Uint8Array(Q);let Re=0;return we.set(I,Re),Re+=I.length,f("IHDR",Ae,we,Re),Re+=o+Ae.length,f("IDATA",ye,we,Re),Re+=o+ye.length,f("IEND",new Uint8Array(0),we,Re),r(we,"image/png",_e)}return function(te,_e,be){const W=te.kind===void 0?d.ImageKind.GRAYSCALE_1BPP:te.kind;return j(te,W,_e,be)}}();class N{constructor(){this.fontSizeScale=1,this.fontWeight=re.fontWeight,this.fontSize=0,this.textMatrix=d.IDENTITY_MATRIX,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=d.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=re.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,s){this.x=o,this.y=s}}function g(I){let o=[];const s=[];for(const c of I){if(c.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),s.push(o),o=o.at(-1).items;continue}c.fn==="restore"?o=s.pop():o.push(c)}return o}function u(I){if(Number.isInteger(I))return I.toString();const o=I.toFixed(10);let s=o.length-1;if(o[s]!=="0")return o;do s--;while(o[s]==="0");return o.substring(0,o[s]==="."?s:s+1)}function M(I){if(I[4]===0&&I[5]===0){if(I[1]===0&&I[2]===0)return I[0]===1&&I[3]===1?"":`scale(${u(I[0])} ${u(I[3])})`;if(I[0]===I[3]&&I[1]===-I[2]){const o=Math.acos(I[0])*180/Math.PI;return`rotate(${u(o)})`}}else if(I[0]===1&&I[1]===0&&I[2]===0&&I[3]===1)return`translate(${u(I[4])} ${u(I[5])})`;return`matrix(${u(I[0])} ${u(I[1])} ${u(I[2])} ${u(I[3])} ${u(I[4])} ${u(I[5])})`}let P=0,x=0,S=0;class F{constructor(o,s,c=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new N,this.transformMatrix=d.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=s,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!c,this._operatorIdMapping=[];for(const f in d.OPS)this._operatorIdMapping[d.OPS[f]]=f}getObject(o,s=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):s}save(){this.transformStack.push(this.transformMatrix);const o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){const s=o.fnArray,c=o.argsArray;for(let f=0,T=s.length;f<T;f++)if(s[f]===d.OPS.dependency)for(const Y of c[f]){const _=Y.startsWith("g_")?this.commonObjs:this.objs,j=new Promise(fe=>{_.get(Y,fe)});this.current.dependencies.push(j)}return Promise.all(this.current.dependencies)}transform(o,s,c,f,T,Y){const _=[o,s,c,f,T,Y];this.transformMatrix=d.Util.transform(this.transformMatrix,_),this.tgrp=null}getSVG(o,s){this.viewport=s;const c=this._initialize(s);return this.loadDependencies(o).then(()=>(this.transformMatrix=d.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),c))}convertOpList(o){const s=this._operatorIdMapping,c=o.argsArray,f=o.fnArray,T=[];for(let Y=0,_=f.length;Y<_;Y++){const j=f[Y];T.push({fnId:j,fn:s[j],args:c[Y]})}return g(T)}executeOpTree(o){for(const s of o){const c=s.fn,f=s.fnId,T=s.args;switch(f|0){case d.OPS.beginText:this.beginText();break;case d.OPS.dependency:break;case d.OPS.setLeading:this.setLeading(T);break;case d.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case d.OPS.setFont:this.setFont(T);break;case d.OPS.showText:this.showText(T[0]);break;case d.OPS.showSpacedText:this.showText(T[0]);break;case d.OPS.endText:this.endText();break;case d.OPS.moveText:this.moveText(T[0],T[1]);break;case d.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case d.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case d.OPS.setHScale:this.setHScale(T[0]);break;case d.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case d.OPS.setTextRise:this.setTextRise(T[0]);break;case d.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case d.OPS.setLineWidth:this.setLineWidth(T[0]);break;case d.OPS.setLineJoin:this.setLineJoin(T[0]);break;case d.OPS.setLineCap:this.setLineCap(T[0]);break;case d.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case d.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case d.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case d.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case d.OPS.setFillColorN:this.setFillColorN(T);break;case d.OPS.shadingFill:this.shadingFill(T[0]);break;case d.OPS.setDash:this.setDash(T[0],T[1]);break;case d.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case d.OPS.setFlatness:this.setFlatness(T[0]);break;case d.OPS.setGState:this.setGState(T[0]);break;case d.OPS.fill:this.fill();break;case d.OPS.eoFill:this.eoFill();break;case d.OPS.stroke:this.stroke();break;case d.OPS.fillStroke:this.fillStroke();break;case d.OPS.eoFillStroke:this.eoFillStroke();break;case d.OPS.clip:this.clip("nonzero");break;case d.OPS.eoClip:this.clip("evenodd");break;case d.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case d.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case d.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case d.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case d.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case d.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case d.OPS.closePath:this.closePath();break;case d.OPS.closeStroke:this.closeStroke();break;case d.OPS.closeFillStroke:this.closeFillStroke();break;case d.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case d.OPS.nextLine:this.nextLine();break;case d.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case d.OPS.constructPath:this.constructPath(T[0],T[1]);break;case d.OPS.endPath:this.endPath();break;case 92:this.group(s.items);break;default:(0,d.warn)(`Unimplemented operator ${c}`);break}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,s,c,f,T,Y){const _=this.current;_.textMatrix=_.lineMatrix=[o,s,c,f,T,Y],_.textMatrixScale=Math.hypot(o,s),_.x=_.lineX=0,_.y=_.lineY=0,_.xcoords=[],_.ycoords=[],_.tspan=this.svgFactory.createElement("svg:tspan"),_.tspan.setAttributeNS(null,"font-family",_.fontFamily),_.tspan.setAttributeNS(null,"font-size",`${u(_.fontSize)}px`),_.tspan.setAttributeNS(null,"y",u(-_.y)),_.txtElement=this.svgFactory.createElement("svg:text"),_.txtElement.append(_.tspan)}beginText(){const o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=d.IDENTITY_MATRIX,o.lineMatrix=d.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,s){const c=this.current;c.x=c.lineX+=o,c.y=c.lineY+=s,c.xcoords=[],c.ycoords=[],c.tspan=this.svgFactory.createElement("svg:tspan"),c.tspan.setAttributeNS(null,"font-family",c.fontFamily),c.tspan.setAttributeNS(null,"font-size",`${u(c.fontSize)}px`),c.tspan.setAttributeNS(null,"y",u(-c.y))}showText(o){const s=this.current,c=s.font,f=s.fontSize;if(f===0)return;const T=s.fontSizeScale,Y=s.charSpacing,_=s.wordSpacing,j=s.fontDirection,fe=s.textHScale*j,te=c.vertical,_e=te?1:-1,be=c.defaultVMetrics,W=f*s.fontMatrix[0];let Pe=0;for(const Te of o){if(Te===null){Pe+=j*_;continue}else if(typeof Te=="number"){Pe+=_e*Te*f/1e3;continue}const q=(Te.isSpace?_:0)+Y,m=Te.fontChar;let y,U,Ae=Te.width;if(te){let Q;const we=Te.vmetric||be;Q=Te.vmetric?we[1]:Ae*.5,Q=-Q*W;const Re=we[2]*W;Ae=we?-we[0]:Ae,y=Q/T,U=(Pe+Re)/T}else y=Pe/T,U=0;(Te.isInFont||c.missingFile)&&(s.xcoords.push(s.x+y),te&&s.ycoords.push(-s.y+U),s.tspan.textContent+=m);const ye=te?Ae*W-q*j:Ae*W+q*j;Pe+=ye}s.tspan.setAttributeNS(null,"x",s.xcoords.map(u).join(" ")),te?s.tspan.setAttributeNS(null,"y",s.ycoords.map(u).join(" ")):s.tspan.setAttributeNS(null,"y",u(-s.y)),te?s.y-=Pe:s.x+=Pe*fe,s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${u(s.fontSize)}px`),s.fontStyle!==re.fontStyle&&s.tspan.setAttributeNS(null,"font-style",s.fontStyle),s.fontWeight!==re.fontWeight&&s.tspan.setAttributeNS(null,"font-weight",s.fontWeight);const D=s.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;if(D===d.TextRenderingMode.FILL||D===d.TextRenderingMode.FILL_STROKE?(s.fillColor!==re.fillColor&&s.tspan.setAttributeNS(null,"fill",s.fillColor),s.fillAlpha<1&&s.tspan.setAttributeNS(null,"fill-opacity",s.fillAlpha)):s.textRenderingMode===d.TextRenderingMode.ADD_TO_PATH?s.tspan.setAttributeNS(null,"fill","transparent"):s.tspan.setAttributeNS(null,"fill","none"),D===d.TextRenderingMode.STROKE||D===d.TextRenderingMode.FILL_STROKE){const Te=1/(s.textMatrixScale||1);this._setStrokeAttributes(s.tspan,Te)}let k=s.textMatrix;s.textRise!==0&&(k=k.slice(),k[5]+=s.textRise),s.txtElement.setAttributeNS(null,"transform",`${M(k)} scale(${u(fe)}, -1)`),s.txtElement.setAttributeNS(O,"xml:space","preserve"),s.txtElement.append(s.tspan),s.txtgrp.append(s.txtElement),this._ensureTransformGroup().append(s.txtElement)}setLeadingMoveText(o,s){this.setLeading(-s),this.moveText(o,s)}addFontStyle(o){if(!o.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const s=r(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${s}); }
`}setFont(o){const s=this.current,c=this.commonObjs.get(o[0]);let f=o[1];s.font=c,this.embedFonts&&!c.missingFile&&!this.embeddedFonts[c.loadedName]&&(this.addFontStyle(c),this.embeddedFonts[c.loadedName]=c),s.fontMatrix=c.fontMatrix||d.FONT_IDENTITY_MATRIX;let T="normal";c.black?T="900":c.bold&&(T="bold");const Y=c.italic?"italic":"normal";f<0?(f=-f,s.fontDirection=-1):s.fontDirection=1,s.fontSize=f,s.fontFamily=c.loadedName,s.fontWeight=T,s.fontStyle=Y,s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"y",u(-s.y)),s.xcoords=[],s.ycoords=[]}endText(){var s;const o=this.current;o.textRenderingMode&d.TextRenderingMode.ADD_TO_PATH_FLAG&&((s=o.txtElement)!=null&&s.hasChildNodes())&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=E[o]}setLineJoin(o){this.current.lineJoin=p[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,s,c){this.current.strokeColor=d.Util.makeHexColor(o,s,c)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,s,c){this.current.fillColor=d.Util.makeHexColor(o,s,c),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){const{width:s,height:c}=this.viewport,f=d.Util.inverseTransform(this.transformMatrix),[T,Y,_,j]=d.Util.getAxialAlignedBoundingBox([0,0,s,c],f),fe=this.svgFactory.createElement("svg:rect");fe.setAttributeNS(null,"x",T),fe.setAttributeNS(null,"y",Y),fe.setAttributeNS(null,"width",_-T),fe.setAttributeNS(null,"height",j-Y),fe.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&fe.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(fe)}_makeColorN_Pattern(o){return o[0]==="TilingPattern"?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){const s=o[1],c=o[2],f=o[3]||d.IDENTITY_MATRIX,[T,Y,_,j]=o[4],fe=o[5],te=o[6],_e=o[7],be=`shading${S++}`,[W,Pe,D,k]=d.Util.normalizeRect([...d.Util.applyTransform([T,Y],f),...d.Util.applyTransform([_,j],f)]),[Te,q]=d.Util.singularValueDecompose2dScale(f),m=fe*Te,y=te*q,U=this.svgFactory.createElement("svg:pattern");U.setAttributeNS(null,"id",be),U.setAttributeNS(null,"patternUnits","userSpaceOnUse"),U.setAttributeNS(null,"width",m),U.setAttributeNS(null,"height",y),U.setAttributeNS(null,"x",`${W}`),U.setAttributeNS(null,"y",`${Pe}`);const Ae=this.svg,ye=this.transformMatrix,Q=this.current.fillColor,we=this.current.strokeColor,Re=this.svgFactory.create(D-W,k-Pe);if(this.svg=Re,this.transformMatrix=f,_e===2){const Ne=d.Util.makeHexColor(...s);this.current.fillColor=Ne,this.current.strokeColor=Ne}return this.executeOpTree(this.convertOpList(c)),this.svg=Ae,this.transformMatrix=ye,this.current.fillColor=Q,this.current.strokeColor=we,U.append(Re.childNodes[0]),this.defs.append(U),`url(#${be})`}_makeShadingPattern(o){switch(typeof o=="string"&&(o=this.objs.get(o)),o[0]){case"RadialAxial":const s=`shading${S++}`,c=o[3];let f;switch(o[1]){case"axial":const T=o[4],Y=o[5];f=this.svgFactory.createElement("svg:linearGradient"),f.setAttributeNS(null,"id",s),f.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),f.setAttributeNS(null,"x1",T[0]),f.setAttributeNS(null,"y1",T[1]),f.setAttributeNS(null,"x2",Y[0]),f.setAttributeNS(null,"y2",Y[1]);break;case"radial":const _=o[4],j=o[5],fe=o[6],te=o[7];f=this.svgFactory.createElement("svg:radialGradient"),f.setAttributeNS(null,"id",s),f.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),f.setAttributeNS(null,"cx",j[0]),f.setAttributeNS(null,"cy",j[1]),f.setAttributeNS(null,"r",te),f.setAttributeNS(null,"fx",_[0]),f.setAttributeNS(null,"fy",_[1]),f.setAttributeNS(null,"fr",fe);break;default:throw new Error(`Unknown RadialAxial type: ${o[1]}`)}for(const T of c){const Y=this.svgFactory.createElement("svg:stop");Y.setAttributeNS(null,"offset",T[0]),Y.setAttributeNS(null,"stop-color",T[1]),f.append(Y)}return this.defs.append(f),`url(#${s})`;case"Mesh":return(0,d.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${o[0]}`)}}setDash(o,s){this.current.dashArray=o,this.current.dashPhase=s}constructPath(o,s){const c=this.current;let f=c.x,T=c.y,Y=[],_=0;for(const j of o)switch(j|0){case d.OPS.rectangle:f=s[_++],T=s[_++];const fe=s[_++],te=s[_++],_e=f+fe,be=T+te;Y.push("M",u(f),u(T),"L",u(_e),u(T),"L",u(_e),u(be),"L",u(f),u(be),"Z");break;case d.OPS.moveTo:f=s[_++],T=s[_++],Y.push("M",u(f),u(T));break;case d.OPS.lineTo:f=s[_++],T=s[_++],Y.push("L",u(f),u(T));break;case d.OPS.curveTo:f=s[_+4],T=s[_+5],Y.push("C",u(s[_]),u(s[_+1]),u(s[_+2]),u(s[_+3]),u(f),u(T)),_+=6;break;case d.OPS.curveTo2:Y.push("C",u(f),u(T),u(s[_]),u(s[_+1]),u(s[_+2]),u(s[_+3])),f=s[_+2],T=s[_+3],_+=4;break;case d.OPS.curveTo3:f=s[_+2],T=s[_+3],Y.push("C",u(s[_]),u(s[_+1]),u(f),u(T),u(f),u(T)),_+=4;break;case d.OPS.closePath:Y.push("Z");break}Y=Y.join(" "),c.path&&o.length>0&&o[0]!==d.OPS.rectangle&&o[0]!==d.OPS.moveTo?Y=c.path.getAttributeNS(null,"d")+Y:(c.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(c.path)),c.path.setAttributeNS(null,"d",Y),c.path.setAttributeNS(null,"fill","none"),c.element=c.path,c.setCurrentPoint(f,T)}endPath(){const o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}const s=`clippath${P++}`,c=this.svgFactory.createElement("svg:clipPath");c.setAttributeNS(null,"id",s),c.setAttributeNS(null,"transform",M(this.transformMatrix));const f=o.element.cloneNode(!0);if(this.pendingClip==="evenodd"?f.setAttributeNS(null,"clip-rule","evenodd"):f.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,c.append(f),this.defs.append(c),o.activeClipUrl){o.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;c.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${s})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){const o=this.current;if(o.path){const s=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",s)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[s,c]of o)switch(s){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c);break;case"CA":this.setStrokeAlpha(c);break;case"ca":this.setFillAlpha(c);break;default:(0,d.warn)(`Unimplemented graphic state operator ${s}`);break}}fill(){const o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){const o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,s=1){const c=this.current;let f=c.dashArray;s!==1&&f.length>0&&(f=f.map(function(T){return s*T})),o.setAttributeNS(null,"stroke",c.strokeColor),o.setAttributeNS(null,"stroke-opacity",c.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",u(c.miterLimit)),o.setAttributeNS(null,"stroke-linecap",c.lineCap),o.setAttributeNS(null,"stroke-linejoin",c.lineJoin),o.setAttributeNS(null,"stroke-width",u(s*c.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",f.map(u).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",u(s*c.dashPhase)+"px")}eoFill(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){const s=this.getObject(o);if(!s){(0,d.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(s)}paintInlineImageXObject(o,s){const c=o.width,f=o.height,T=H(o,this.forceDataSchema,!!s),Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x","0"),Y.setAttributeNS(null,"y","0"),Y.setAttributeNS(null,"width",u(c)),Y.setAttributeNS(null,"height",u(f)),this.current.element=Y,this.clip("nonzero");const _=this.svgFactory.createElement("svg:image");_.setAttributeNS(w,"xlink:href",T),_.setAttributeNS(null,"x","0"),_.setAttributeNS(null,"y",u(-f)),_.setAttributeNS(null,"width",u(c)+"px"),_.setAttributeNS(null,"height",u(f)+"px"),_.setAttributeNS(null,"transform",`scale(${u(1/c)} ${u(-1/f)})`),s?s.append(_):this._ensureTransformGroup().append(_)}paintImageMaskXObject(o){const s=this.getObject(o.data,o);if(s.bitmap){(0,d.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const c=this.current,f=s.width,T=s.height,Y=c.fillColor;c.maskId=`mask${x++}`;const _=this.svgFactory.createElement("svg:mask");_.setAttributeNS(null,"id",c.maskId);const j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x","0"),j.setAttributeNS(null,"y","0"),j.setAttributeNS(null,"width",u(f)),j.setAttributeNS(null,"height",u(T)),j.setAttributeNS(null,"fill",Y),j.setAttributeNS(null,"mask",`url(#${c.maskId})`),this.defs.append(_),this._ensureTransformGroup().append(j),this.paintInlineImageXObject(s,_)}paintFormXObjectBegin(o,s){if(Array.isArray(o)&&o.length===6&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),s){const c=s[2]-s[0],f=s[3]-s[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",s[0]),T.setAttributeNS(null,"y",s[1]),T.setAttributeNS(null,"width",u(c)),T.setAttributeNS(null,"height",u(f)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){const s=this.svgFactory.create(o.width,o.height),c=this.svgFactory.createElement("svg:defs");s.append(c),this.defs=c;const f=this.svgFactory.createElement("svg:g");return f.setAttributeNS(null,"transform",M(o.transform)),s.append(f),this.svg=f,s}_ensureClipGroup(){if(!this.current.clipGroup){const o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",M(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=F},(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class v{static textContent(d){const re=[],O={items:re,styles:Object.create(null)};function w(E){var H;if(!E)return;let p=null;const r=E.name;if(r==="#text")p=E.value;else if(v.shouldBuildText(r))(H=E==null?void 0:E.attributes)!=null&&H.textContent?p=E.attributes.textContent:E.value&&(p=E.value);else return;if(p!==null&&re.push({str:p}),!!E.children)for(const N of E.children)w(N)}return w(d),O}static shouldBuildText(d){return!(d==="textarea"||d==="input"||d==="option"||d==="select")}}e.XfaText=v},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=M,e.updateTextLayer=P;var n=v(1),d=v(6);const re=1e5,O=30,w=.8,E=new Map;function p(x,S){let F;if(S&&n.FeatureTest.isOffscreenCanvasSupported)F=new OffscreenCanvas(x,x).getContext("2d",{alpha:!1});else{const I=document.createElement("canvas");I.width=I.height=x,F=I.getContext("2d",{alpha:!1})}return F}function r(x,S){const F=E.get(x);if(F)return F;const I=p(O,S);I.font=`${O}px ${x}`;const o=I.measureText("");let s=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);if(s){const T=s/(s+c);return E.set(x,T),I.canvas.width=I.canvas.height=0,T}I.strokeStyle="red",I.clearRect(0,0,O,O),I.strokeText("g",0,0);let f=I.getImageData(0,0,O,O).data;c=0;for(let T=f.length-1-3;T>=0;T-=4)if(f[T]>0){c=Math.ceil(T/4/O);break}I.clearRect(0,0,O,O),I.strokeText("A",0,O),f=I.getImageData(0,0,O,O).data,s=0;for(let T=0,Y=f.length;T<Y;T+=4)if(f[T]>0){s=O-Math.floor(T/4/O);break}if(I.canvas.width=I.canvas.height=0,s){const T=s/(s+c);return E.set(x,T),T}return E.set(x,w),w}function H(x,S,F){const I=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:S.str!=="",hasEOL:S.hasEOL,fontSize:0};x._textDivs.push(I);const s=n.Util.transform(x._transform,S.transform);let c=Math.atan2(s[1],s[0]);const f=F[S.fontName];f.vertical&&(c+=Math.PI/2);const T=Math.hypot(s[2],s[3]),Y=T*r(f.fontFamily,x._isOffscreenCanvasSupported);let _,j;c===0?(_=s[4],j=s[5]-Y):(_=s[4]+Y*Math.sin(c),j=s[5]-Y*Math.cos(c));const fe="calc(var(--scale-factor)*",te=I.style;x._container===x._rootContainer?(te.left=`${(100*_/x._pageWidth).toFixed(2)}%`,te.top=`${(100*j/x._pageHeight).toFixed(2)}%`):(te.left=`${fe}${_.toFixed(2)}px)`,te.top=`${fe}${j.toFixed(2)}px)`),te.fontSize=`${fe}${T.toFixed(2)}px)`,te.fontFamily=f.fontFamily,o.fontSize=T,I.setAttribute("role","presentation"),I.textContent=S.str,I.dir=S.dir,x._fontInspectorEnabled&&(I.dataset.fontName=S.fontName),c!==0&&(o.angle=c*(180/Math.PI));let _e=!1;if(S.str.length>1)_e=!0;else if(S.str!==" "&&S.transform[0]!==S.transform[3]){const be=Math.abs(S.transform[0]),W=Math.abs(S.transform[3]);be!==W&&Math.max(be,W)/Math.min(be,W)>1.5&&(_e=!0)}_e&&(o.canvasWidth=f.vertical?S.height:S.width),x._textDivProperties.set(I,o),x._isReadableStream&&x._layoutText(I)}function N(x){const{div:S,scale:F,properties:I,ctx:o,prevFontSize:s,prevFontFamily:c}=x,{style:f}=S;let T="";if(I.canvasWidth!==0&&I.hasText){const{fontFamily:Y}=f,{canvasWidth:_,fontSize:j}=I;(s!==j||c!==Y)&&(o.font=`${j*F}px ${Y}`,x.prevFontSize=j,x.prevFontFamily=Y);const{width:fe}=o.measureText(S.textContent);fe>0&&(T=`scaleX(${_*F/fe})`)}I.angle!==0&&(T=`rotate(${I.angle}deg) ${T}`),T.length>0&&(f.transform=T)}function g(x){if(x._canceled)return;const S=x._textDivs,F=x._capability;if(S.length>re){F.resolve();return}if(!x._isReadableStream)for(const o of S)x._layoutText(o);F.resolve()}class u{constructor({textContentSource:S,container:F,viewport:I,textDivs:o,textDivProperties:s,textContentItemsStr:c,isOffscreenCanvasSupported:f}){var fe;this._textContentSource=S,this._isReadableStream=S instanceof ReadableStream,this._container=this._rootContainer=F,this._textDivs=o||[],this._textContentItemsStr=c||[],this._isOffscreenCanvasSupported=f,this._fontInspectorEnabled=!!((fe=globalThis.FontInspector)!=null&&fe.enabled),this._reader=null,this._textDivProperties=s||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:I.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:p(0,f)};const{pageWidth:T,pageHeight:Y,pageX:_,pageY:j}=I.rawDims;this._transform=[1,0,0,-1,-_,j+Y],this._pageWidth=T,this._pageHeight=Y,(0,d.setLayerDimensions)(F,I),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(S,F){for(const I of S){if(I.str===void 0){if(I.type==="beginMarkedContentProps"||I.type==="beginMarkedContent"){const o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),I.id!==null&&this._container.setAttribute("id",`${I.id}`),o.append(this._container)}else I.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(I.str),H(this,I,F)}}_layoutText(S){const F=this._layoutTextParams.properties=this._textDivProperties.get(S);if(this._layoutTextParams.div=S,N(this._layoutTextParams),F.hasText&&this._container.append(S),F.hasEOL){const I=document.createElement("br");I.setAttribute("role","presentation"),this._container.append(I)}}_render(){const S=new n.PromiseCapability;let F=Object.create(null);if(this._isReadableStream){const I=()=>{this._reader.read().then(({value:o,done:s})=>{if(s){S.resolve();return}Object.assign(F,o.styles),this._processItems(o.items,F),I()},S.reject)};this._reader=this._textContentSource.getReader(),I()}else if(this._textContentSource){const{items:I,styles:o}=this._textContentSource;this._processItems(I,o),S.resolve()}else throw new Error('No "textContentSource" parameter specified.');S.promise.then(()=>{F=null,g(this)},this._capability.reject)}}e.TextLayerRenderTask=u;function M(x){!x.textContentSource&&(x.textContent||x.textContentStream)&&((0,d.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),x.textContentSource=x.textContent||x.textContentStream);const{container:S,viewport:F}=x,I=getComputedStyle(S),o=I.getPropertyValue("visibility"),s=parseFloat(I.getPropertyValue("--scale-factor"));o==="visible"&&(!s||Math.abs(s-F.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const c=new u(x);return c._render(),c}function P({container:x,viewport:S,textDivs:F,textDivProperties:I,isOffscreenCanvasSupported:o,mustRotate:s=!0,mustRescale:c=!0}){if(s&&(0,d.setLayerDimensions)(x,{rotation:S.rotation}),c){const f=p(0,o),Y={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f};for(const _ of F)Y.properties=I.get(_),Y.div=_,N(Y)}}},(i,e,v)=>{var r,H,N,g,u,M,P,x,S,F,I,Gi,ui,Xi,qi;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=v(1),d=v(4),re=v(28),O=v(33),w=v(6),E=v(34);const T=class T{constructor({uiManager:_,pageIndex:j,div:fe,accessibilityManager:te,annotationLayer:_e,viewport:be,l10n:W}){Me(this,I);Me(this,r);Me(this,H,!1);Me(this,N,null);Me(this,g,this.pointerup.bind(this));Me(this,u,this.pointerdown.bind(this));Me(this,M,new Map);Me(this,P,!1);Me(this,x,!1);Me(this,S,!1);Me(this,F);const Pe=[re.FreeTextEditor,O.InkEditor,E.StampEditor];if(!T._initialized){T._initialized=!0;for(const D of Pe)D.initialize(W)}_.registerEditorTypes(Pe),Ce(this,F,_),this.pageIndex=j,this.div=fe,Ce(this,r,te),Ce(this,N,_e),this.viewport=be,t(this,F).addLayer(this)}get isEmpty(){return t(this,M).size===0}updateToolbar(_){t(this,F).updateToolbar(_)}updateMode(_=t(this,F).getMode()){ne(this,I,qi).call(this),_===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),_!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",_===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",_===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",_===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(_){if(!_&&t(this,F).getMode()!==n.AnnotationEditorType.INK)return;if(!_){for(const fe of t(this,M).values())if(fe.isEmpty()){fe.setInBackground();return}}ne(this,I,ui).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(_){t(this,F).setEditingState(_)}addCommands(_){t(this,F).addCommands(_)}enable(){this.div.style.pointerEvents="auto";const _=new Set;for(const fe of t(this,M).values())fe.enableEditing(),fe.annotationElementId&&_.add(fe.annotationElementId);if(!t(this,N))return;const j=t(this,N).getEditableAnnotations();for(const fe of j){if(fe.hide(),t(this,F).isDeletedAnnotationElement(fe.data.id)||_.has(fe.data.id))continue;const te=this.deserialize(fe);te&&(this.addOrRebuild(te),te.enableEditing())}}disable(){var j;Ce(this,S,!0),this.div.style.pointerEvents="none";const _=new Set;for(const fe of t(this,M).values()){if(fe.disableEditing(),!fe.annotationElementId||fe.serialize()!==null){_.add(fe.annotationElementId);continue}(j=this.getEditableAnnotation(fe.annotationElementId))==null||j.show(),fe.remove()}if(t(this,N)){const fe=t(this,N).getEditableAnnotations();for(const te of fe){const{id:_e}=te.data;_.has(_e)||t(this,F).isDeletedAnnotationElement(_e)||te.show()}}ne(this,I,qi).call(this),this.isEmpty&&(this.div.hidden=!0),Ce(this,S,!1)}getEditableAnnotation(_){var j;return((j=t(this,N))==null?void 0:j.getEditableAnnotation(_))||null}setActiveEditor(_){t(this,F).getActive()!==_&&t(this,F).setActiveEditor(_)}enableClick(){this.div.addEventListener("pointerdown",t(this,u)),this.div.addEventListener("pointerup",t(this,g))}disableClick(){this.div.removeEventListener("pointerdown",t(this,u)),this.div.removeEventListener("pointerup",t(this,g))}attach(_){t(this,M).set(_.id,_);const{annotationElementId:j}=_;j&&t(this,F).isDeletedAnnotationElement(j)&&t(this,F).removeDeletedAnnotationElement(_)}detach(_){var j;t(this,M).delete(_.id),(j=t(this,r))==null||j.removePointerInTextLayer(_.contentDiv),!t(this,S)&&_.annotationElementId&&t(this,F).addDeletedAnnotationElement(_)}remove(_){this.detach(_),t(this,F).removeEditor(_),_.div.contains(document.activeElement)&&setTimeout(()=>{t(this,F).focusMainContainer()},0),_.div.remove(),_.isAttachedToDOM=!1,t(this,x)||this.addInkEditorIfNeeded(!1)}changeParent(_){var j;_.parent!==this&&(_.annotationElementId&&(t(this,F).addDeletedAnnotationElement(_.annotationElementId),d.AnnotationEditor.deleteAnnotationElement(_),_.annotationElementId=null),this.attach(_),(j=_.parent)==null||j.detach(_),_.setParent(this),_.div&&_.isAttachedToDOM&&(_.div.remove(),this.div.append(_.div)))}add(_){if(this.changeParent(_),t(this,F).addEditor(_),this.attach(_),!_.isAttachedToDOM){const j=_.render();this.div.append(j),_.isAttachedToDOM=!0}_.fixAndSetPosition(),_.onceAdded(),t(this,F).addToAnnotationStorage(_)}moveEditorInDOM(_){var fe;if(!_.isAttachedToDOM)return;const{activeElement:j}=document;_.div.contains(j)&&(_._focusEventsAllowed=!1,setTimeout(()=>{_.div.contains(document.activeElement)?_._focusEventsAllowed=!0:(_.div.addEventListener("focusin",()=>{_._focusEventsAllowed=!0},{once:!0}),j.focus())},0)),_._structTreeParentId=(fe=t(this,r))==null?void 0:fe.moveElementInDOM(this.div,_.div,_.contentDiv,!0)}addOrRebuild(_){_.needsToBeRebuilt()?_.rebuild():this.add(_)}addUndoableEditor(_){const j=()=>_._uiManager.rebuild(_),fe=()=>{_.remove()};this.addCommands({cmd:j,undo:fe,mustExec:!1})}getNextId(){return t(this,F).getId()}pasteEditor(_,j){t(this,F).updateToolbar(_),t(this,F).updateMode(_);const{offsetX:fe,offsetY:te}=ne(this,I,Xi).call(this),_e=this.getNextId(),be=ne(this,I,Gi).call(this,{parent:this,id:_e,x:fe,y:te,uiManager:t(this,F),isCentered:!0,...j});be&&this.add(be)}deserialize(_){switch(_.annotationType??_.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return re.FreeTextEditor.deserialize(_,this,t(this,F));case n.AnnotationEditorType.INK:return O.InkEditor.deserialize(_,this,t(this,F));case n.AnnotationEditorType.STAMP:return E.StampEditor.deserialize(_,this,t(this,F))}return null}addNewEditor(){ne(this,I,ui).call(this,ne(this,I,Xi).call(this),!0)}setSelected(_){t(this,F).setSelected(_)}toggleSelected(_){t(this,F).toggleSelected(_)}isSelected(_){return t(this,F).isSelected(_)}unselect(_){t(this,F).unselect(_)}pointerup(_){const{isMac:j}=n.FeatureTest.platform;if(!(_.button!==0||_.ctrlKey&&j)&&_.target===this.div&&t(this,P)){if(Ce(this,P,!1),!t(this,H)){Ce(this,H,!0);return}if(t(this,F).getMode()===n.AnnotationEditorType.STAMP){t(this,F).unselectAll();return}ne(this,I,ui).call(this,_,!1)}}pointerdown(_){if(t(this,P)){Ce(this,P,!1);return}const{isMac:j}=n.FeatureTest.platform;if(_.button!==0||_.ctrlKey&&j||_.target!==this.div)return;Ce(this,P,!0);const fe=t(this,F).getActive();Ce(this,H,!fe||fe.isEmpty())}findNewParent(_,j,fe){const te=t(this,F).findParent(j,fe);return te===null||te===this?!1:(te.changeParent(_),!0)}destroy(){var _,j;((_=t(this,F).getActive())==null?void 0:_.parent)===this&&(t(this,F).commitOrRemove(),t(this,F).setActiveEditor(null));for(const fe of t(this,M).values())(j=t(this,r))==null||j.removePointerInTextLayer(fe.contentDiv),fe.setParent(null),fe.isAttachedToDOM=!1,fe.div.remove();this.div=null,t(this,M).clear(),t(this,F).removeLayer(this)}render({viewport:_}){this.viewport=_,(0,w.setLayerDimensions)(this.div,_);for(const j of t(this,F).getEditors(this.pageIndex))this.add(j);this.updateMode()}update({viewport:_}){t(this,F).commitOrRemove(),this.viewport=_,(0,w.setLayerDimensions)(this.div,{rotation:_.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:_,pageHeight:j}=this.viewport.rawDims;return[_,j]}};r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,S=new WeakMap,F=new WeakMap,I=new WeakSet,Gi=function(_){switch(t(this,F).getMode()){case n.AnnotationEditorType.FREETEXT:return new re.FreeTextEditor(_);case n.AnnotationEditorType.INK:return new O.InkEditor(_);case n.AnnotationEditorType.STAMP:return new E.StampEditor(_)}return null},ui=function(_,j){const fe=this.getNextId(),te=ne(this,I,Gi).call(this,{parent:this,id:fe,x:_.offsetX,y:_.offsetY,uiManager:t(this,F),isCentered:j});return te&&this.add(te),te},Xi=function(){const{x:_,y:j,width:fe,height:te}=this.div.getBoundingClientRect(),_e=Math.max(0,_),be=Math.max(0,j),W=Math.min(window.innerWidth,_+fe),Pe=Math.min(window.innerHeight,j+te),D=(_e+W)/2-_,k=(be+Pe)/2-j,[Te,q]=this.viewport.rotation%180===0?[D,k]:[k,D];return{offsetX:Te,offsetY:q}},qi=function(){Ce(this,x,!0);for(const _ of t(this,M).values())_.isEmpty()&&_.remove();Ce(this,x,!1)},at(T,"_initialized",!1);let p=T;e.AnnotationEditorLayer=p},(i,e,v)=>{var E,p,r,H,N,g,u,M,P,x,qn,Yn,Kn,qt,Yi,Qn,Ki;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=v(1),d=v(5),re=v(4),O=v(29);const T=class T extends re.AnnotationEditor{constructor(j){super({...j,name:"freeTextEditor"});Me(this,x);Me(this,E,this.editorDivBlur.bind(this));Me(this,p,this.editorDivFocus.bind(this));Me(this,r,this.editorDivInput.bind(this));Me(this,H,this.editorDivKeydown.bind(this));Me(this,N);Me(this,g,"");Me(this,u,`${this.id}-editor`);Me(this,M);Me(this,P,null);Ce(this,N,j.color||T._defaultColor||re.AnnotationEditor._defaultLineColor),Ce(this,M,j.fontSize||T._defaultFontSize)}static get _keyboardManager(){const j=T.prototype,fe=be=>be.isEmpty(),te=d.AnnotationEditorUIManager.TRANSLATE_SMALL,_e=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new d.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],j.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],j.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],j._translateEmpty,{args:[-te,0],checker:fe}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],j._translateEmpty,{args:[-_e,0],checker:fe}],[["ArrowRight","mac+ArrowRight"],j._translateEmpty,{args:[te,0],checker:fe}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],j._translateEmpty,{args:[_e,0],checker:fe}],[["ArrowUp","mac+ArrowUp"],j._translateEmpty,{args:[0,-te],checker:fe}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],j._translateEmpty,{args:[0,-_e],checker:fe}],[["ArrowDown","mac+ArrowDown"],j._translateEmpty,{args:[0,te],checker:fe}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],j._translateEmpty,{args:[0,_e],checker:fe}]]))}static initialize(j){re.AnnotationEditor.initialize(j,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const fe=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(fe.getPropertyValue("--freetext-padding"))}static updateDefaultParams(j,fe){switch(j){case n.AnnotationEditorParamsType.FREETEXT_SIZE:T._defaultFontSize=fe;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:T._defaultColor=fe;break}}updateParams(j,fe){switch(j){case n.AnnotationEditorParamsType.FREETEXT_SIZE:ne(this,x,qn).call(this,fe);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:ne(this,x,Yn).call(this,fe);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,T._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,T._defaultColor||re.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,M)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,N)]]}_translateEmpty(j,fe){this._uiManager.translateSelectedEditors(j,fe,!0)}getInitialTranslation(){const j=this.parentScale;return[-T._internalPadding*j,-(T._internalPadding+t(this,M))*j]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,H)),this.editorDiv.addEventListener("focus",t(this,p)),this.editorDiv.addEventListener("blur",t(this,E)),this.editorDiv.addEventListener("input",t(this,r)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,u)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,H)),this.editorDiv.removeEventListener("focus",t(this,p)),this.editorDiv.removeEventListener("blur",t(this,E)),this.editorDiv.removeEventListener("input",t(this,r)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(j){this._focusEventsAllowed&&(super.focusin(j),j.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var j;if(this.width){ne(this,x,Ki).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(j=this._initialOptions)!=null&&j.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const j=t(this,g),fe=Ce(this,g,ne(this,x,Kn).call(this).trimEnd());if(j===fe)return;const te=_e=>{if(Ce(this,g,_e),!_e){this.remove();return}ne(this,x,Yi).call(this),this._uiManager.rebuild(this),ne(this,x,qt).call(this)};this.addCommands({cmd:()=>{te(fe)},undo:()=>{te(j)},mustExec:!1}),ne(this,x,qt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(j){this.enterInEditMode()}keydown(j){j.target===this.div&&j.key==="Enter"&&(this.enterInEditMode(),j.preventDefault())}editorDivKeydown(j){T._keyboardManager.exec(this,j)}editorDivFocus(j){this.isEditing=!0}editorDivBlur(j){this.isEditing=!1}editorDivInput(j){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let j,fe;this.width&&(j=this.x,fe=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,u)),this.enableEditing(),re.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(_e=>{var be;return(be=this.editorDiv)==null?void 0:be.setAttribute("aria-label",_e)}),re.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(_e=>{var be;return(be=this.editorDiv)==null?void 0:be.setAttribute("default-content",_e)}),this.editorDiv.contentEditable=!0;const{style:te}=this.editorDiv;if(te.fontSize=`calc(${t(this,M)}px * var(--scale-factor))`,te.color=t(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[_e,be]=this.parentDimensions;if(this.annotationElementId){const{position:W}=t(this,P);let[Pe,D]=this.getInitialTranslation();[Pe,D]=this.pageTranslationToScreen(Pe,D);const[k,Te]=this.pageDimensions,[q,m]=this.pageTranslation;let y,U;switch(this.rotation){case 0:y=j+(W[0]-q)/k,U=fe+this.height-(W[1]-m)/Te;break;case 90:y=j+(W[0]-q)/k,U=fe-(W[1]-m)/Te,[Pe,D]=[D,-Pe];break;case 180:y=j-this.width+(W[0]-q)/k,U=fe-(W[1]-m)/Te,[Pe,D]=[-Pe,-D];break;case 270:y=j+(W[0]-q-this.height*Te)/k,U=fe+(W[1]-m-this.width*k)/Te,[Pe,D]=[-D,Pe];break}this.setAt(y*_e,U*be,Pe,D)}else this.setAt(j*_e,fe*be,this.width*_e,this.height*be);ne(this,x,Yi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(j,fe,te){let _e=null;if(j instanceof O.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:W,fontColor:Pe},rect:D,rotation:k,id:Te},textContent:q,textPosition:m,parent:{page:{pageNumber:y}}}=j;if(!q||q.length===0)return null;_e=j={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(Pe),fontSize:W,value:q.join(`
`),position:m,pageIndex:y-1,rect:D,rotation:k,id:Te,deleted:!1}}const be=super.deserialize(j,fe,te);return Ce(be,M,j.fontSize),Ce(be,N,n.Util.makeHexColor(...j.color)),Ce(be,g,j.value),be.annotationElementId=j.id||null,Ce(be,P,_e),be}serialize(j=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const fe=T._internalPadding*this.parentScale,te=this.getRect(fe,fe),_e=re.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,N)),be={annotationType:n.AnnotationEditorType.FREETEXT,color:_e,fontSize:t(this,M),value:t(this,g),pageIndex:this.pageIndex,rect:te,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return j?be:this.annotationElementId&&!ne(this,x,Qn).call(this,be)?null:(be.id=this.annotationElementId,be)}};E=new WeakMap,p=new WeakMap,r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakSet,qn=function(j){const fe=_e=>{this.editorDiv.style.fontSize=`calc(${_e}px * var(--scale-factor))`,this.translate(0,-(_e-t(this,M))*this.parentScale),Ce(this,M,_e),ne(this,x,qt).call(this)},te=t(this,M);this.addCommands({cmd:()=>{fe(j)},undo:()=>{fe(te)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Yn=function(j){const fe=t(this,N);this.addCommands({cmd:()=>{Ce(this,N,this.editorDiv.style.color=j)},undo:()=>{Ce(this,N,this.editorDiv.style.color=fe)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Kn=function(){const j=this.editorDiv.getElementsByTagName("div");if(j.length===0)return this.editorDiv.innerText;const fe=[];for(const te of j)fe.push(te.innerText.replace(/\r\n?|\n/,""));return fe.join(`
`)},qt=function(){const[j,fe]=this.parentDimensions;let te;if(this.isAttachedToDOM)te=this.div.getBoundingClientRect();else{const{currentLayer:_e,div:be}=this,W=be.style.display;be.style.display="hidden",_e.div.append(this.div),te=be.getBoundingClientRect(),be.remove(),be.style.display=W}this.rotation%180===this.parentRotation%180?(this.width=te.width/j,this.height=te.height/fe):(this.width=te.height/j,this.height=te.width/fe),this.fixAndSetPosition()},Yi=function(){if(this.editorDiv.replaceChildren(),!!t(this,g))for(const j of t(this,g).split(`
`)){const fe=document.createElement("div");fe.append(j?document.createTextNode(j):document.createElement("br")),this.editorDiv.append(fe)}},Qn=function(j){const{value:fe,fontSize:te,color:_e,rect:be,pageIndex:W}=t(this,P);return j.value!==fe||j.fontSize!==te||j.rect.some((Pe,D)=>Math.abs(Pe-be[D])>=1)||j.color.some((Pe,D)=>Pe!==_e[D])||j.pageIndex!==W},Ki=function(j=!1){if(!this.annotationElementId)return;if(ne(this,x,qt).call(this),!j&&(this.width===0||this.height===0)){setTimeout(()=>ne(this,x,Ki).call(this,!0),0);return}const fe=T._internalPadding*this.parentScale;t(this,P).rect=this.getRect(fe,fe)},at(T,"_freeTextDefaultContent",""),at(T,"_internalPadding",0),at(T,"_defaultColor",null),at(T,"_defaultFontSize",10),at(T,"_type","freetext");let w=T;e.FreeTextEditor=w},(i,e,v)=>{var U,ye,Dt,Zn,Re,Ne,He,$e,qe,Ye,Oe,Fe,J,Ee,Ie,z,h,X,oe,Z,Le,De,Jn,fi,Qi,Zi,it,pt,mt,Xe,Be,Ue,nt,Ji,ut,Se,We,et,es,en;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=v(1),d=v(6),re=v(3),O=v(30),w=v(31),E=v(32);const p=1e3,r=9,H=new WeakSet;function N(tt){return{width:tt[2]-tt[0],height:tt[3]-tt[1]}}class g{static create(ve){switch(ve.data.annotationType){case n.AnnotationType.LINK:return new M(ve);case n.AnnotationType.TEXT:return new P(ve);case n.AnnotationType.WIDGET:switch(ve.data.fieldType){case"Tx":return new S(ve);case"Btn":return ve.data.radioButton?new o(ve):ve.data.checkBox?new I(ve):new s(ve);case"Ch":return new c(ve);case"Sig":return new F(ve)}return new x(ve);case n.AnnotationType.POPUP:return new f(ve);case n.AnnotationType.FREETEXT:return new Y(ve);case n.AnnotationType.LINE:return new _(ve);case n.AnnotationType.SQUARE:return new j(ve);case n.AnnotationType.CIRCLE:return new fe(ve);case n.AnnotationType.POLYLINE:return new te(ve);case n.AnnotationType.CARET:return new be(ve);case n.AnnotationType.INK:return new W(ve);case n.AnnotationType.POLYGON:return new _e(ve);case n.AnnotationType.HIGHLIGHT:return new Pe(ve);case n.AnnotationType.UNDERLINE:return new D(ve);case n.AnnotationType.SQUIGGLY:return new k(ve);case n.AnnotationType.STRIKEOUT:return new Te(ve);case n.AnnotationType.STAMP:return new q(ve);case n.AnnotationType.FILEATTACHMENT:return new m(ve);default:return new u(ve)}}}const Ae=class Ae{constructor(ve,{isRenderable:le=!1,ignoreBorder:ke=!1,createQuadrilaterals:je=!1}={}){Me(this,U,!1);this.isRenderable=le,this.data=ve.data,this.layer=ve.layer,this.linkService=ve.linkService,this.downloadManager=ve.downloadManager,this.imageResourcesPath=ve.imageResourcesPath,this.renderForms=ve.renderForms,this.svgFactory=ve.svgFactory,this.annotationStorage=ve.annotationStorage,this.enableScripting=ve.enableScripting,this.hasJSActions=ve.hasJSActions,this._fieldObjects=ve.fieldObjects,this.parent=ve.parent,le&&(this.container=this._createContainer(ke)),je&&this._createQuadrilaterals()}static _hasPopupData({titleObj:ve,contentsObj:le,richText:ke}){return!!(ve!=null&&ve.str||le!=null&&le.str||ke!=null&&ke.str)}get hasPopupData(){return Ae._hasPopupData(this.data)}_createContainer(ve){const{data:le,parent:{page:ke,viewport:je}}=this,ze=document.createElement("section");ze.setAttribute("data-annotation-id",le.id),this instanceof x||(ze.tabIndex=p),ze.style.zIndex=this.parent.zIndex++,this.data.popupRef&&ze.setAttribute("aria-haspopup","dialog"),le.noRotate&&ze.classList.add("norotate");const{pageWidth:Ke,pageHeight:Qe,pageX:ht,pageY:lt}=je.rawDims;if(!le.rect||this instanceof f){const{rotation:gt}=le;return!le.hasOwnCanvas&&gt!==0&&this.setRotation(gt,ze),ze}const{width:st,height:_t}=N(le.rect),ct=n.Util.normalizeRect([le.rect[0],ke.view[3]-le.rect[1]+ke.view[1],le.rect[2],ke.view[3]-le.rect[3]+ke.view[1]]);if(!ve&&le.borderStyle.width>0){ze.style.borderWidth=`${le.borderStyle.width}px`;const gt=le.borderStyle.horizontalCornerRadius,bt=le.borderStyle.verticalCornerRadius;if(gt>0||bt>0){const St=`calc(${gt}px * var(--scale-factor)) / calc(${bt}px * var(--scale-factor))`;ze.style.borderRadius=St}else if(this instanceof o){const St=`calc(${st}px * var(--scale-factor)) / calc(${_t}px * var(--scale-factor))`;ze.style.borderRadius=St}switch(le.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:ze.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:ze.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:ze.style.borderBottomStyle="solid";break}const yt=le.borderColor||null;yt?(Ce(this,U,!0),ze.style.borderColor=n.Util.makeHexColor(yt[0]|0,yt[1]|0,yt[2]|0)):ze.style.borderWidth=0}ze.style.left=`${100*(ct[0]-ht)/Ke}%`,ze.style.top=`${100*(ct[1]-lt)/Qe}%`;const{rotation:dt}=le;return le.hasOwnCanvas||dt===0?(ze.style.width=`${100*st/Ke}%`,ze.style.height=`${100*_t/Qe}%`):this.setRotation(dt,ze),ze}setRotation(ve,le=this.container){if(!this.data.rect)return;const{pageWidth:ke,pageHeight:je}=this.parent.viewport.rawDims,{width:ze,height:Ke}=N(this.data.rect);let Qe,ht;ve%180===0?(Qe=100*ze/ke,ht=100*Ke/je):(Qe=100*Ke/ke,ht=100*ze/je),le.style.width=`${Qe}%`,le.style.height=`${ht}%`,le.setAttribute("data-main-rotation",(360-ve)%360)}get _commonActions(){const ve=(le,ke,je)=>{const ze=je.detail[le],Ke=ze[0],Qe=ze.slice(1);je.target.style[ke]=O.ColorConverters[`${Ke}_HTML`](Qe),this.annotationStorage.setValue(this.data.id,{[ke]:O.ColorConverters[`${Ke}_rgb`](Qe)})};return(0,n.shadow)(this,"_commonActions",{display:le=>{const{display:ke}=le.detail,je=ke%2===1;this.container.style.visibility=je?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:je,noPrint:ke===1||ke===2})},print:le=>{this.annotationStorage.setValue(this.data.id,{noPrint:!le.detail.print})},hidden:le=>{const{hidden:ke}=le.detail;this.container.style.visibility=ke?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ke,noView:ke})},focus:le=>{setTimeout(()=>le.target.focus({preventScroll:!1}),0)},userName:le=>{le.target.title=le.detail.userName},readonly:le=>{le.target.disabled=le.detail.readonly},required:le=>{this._setRequired(le.target,le.detail.required)},bgColor:le=>{ve("bgColor","backgroundColor",le)},fillColor:le=>{ve("fillColor","backgroundColor",le)},fgColor:le=>{ve("fgColor","color",le)},textColor:le=>{ve("textColor","color",le)},borderColor:le=>{ve("borderColor","borderColor",le)},strokeColor:le=>{ve("strokeColor","borderColor",le)},rotation:le=>{const ke=le.detail.rotation;this.setRotation(ke),this.annotationStorage.setValue(this.data.id,{rotation:ke})}})}_dispatchEventFromSandbox(ve,le){const ke=this._commonActions;for(const je of Object.keys(le.detail)){const ze=ve[je]||ke[je];ze==null||ze(le)}}_setDefaultPropertiesFromJS(ve){if(!this.enableScripting)return;const le=this.annotationStorage.getRawValue(this.data.id);if(!le)return;const ke=this._commonActions;for(const[je,ze]of Object.entries(le)){const Ke=ke[je];if(Ke){const Qe={detail:{[je]:ze},target:ve};Ke(Qe),delete le[je]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:ve}=this.data;if(!ve)return;const[le,ke,je,ze]=this.data.rect;if(ve.length===1){const[,{x:bt,y:yt},{x:St,y:wt}]=ve[0];if(je===bt&&ze===yt&&le===St&&ke===wt)return}const{style:Ke}=this.container;let Qe;if(t(this,U)){const{borderColor:bt,borderWidth:yt}=Ke;Ke.borderWidth=0,Qe=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${bt}" stroke-width="${yt}">`],this.container.classList.add("hasBorder")}const ht=je-le,lt=ze-ke,{svgFactory:st}=this,_t=st.createElement("svg");_t.classList.add("quadrilateralsContainer"),_t.setAttribute("width",0),_t.setAttribute("height",0);const ct=st.createElement("defs");_t.append(ct);const dt=st.createElement("clipPath"),gt=`clippath_${this.data.id}`;dt.setAttribute("id",gt),dt.setAttribute("clipPathUnits","objectBoundingBox"),ct.append(dt);for(const[,{x:bt,y:yt},{x:St,y:wt}]of ve){const Et=st.createElement("rect"),Mt=(St-le)/ht,It=(ze-yt)/lt,kt=(bt-St)/ht,Fn=(yt-wt)/lt;Et.setAttribute("x",Mt),Et.setAttribute("y",It),Et.setAttribute("width",kt),Et.setAttribute("height",Fn),dt.append(Et),Qe==null||Qe.push(`<rect vector-effect="non-scaling-stroke" x="${Mt}" y="${It}" width="${kt}" height="${Fn}"/>`)}t(this,U)&&(Qe.push("</g></svg>')"),Ke.backgroundImage=Qe.join("")),this.container.append(_t),this.container.style.clipPath=`url(#${gt})`}_createPopup(){const{container:ve,data:le}=this;ve.setAttribute("aria-haspopup","dialog");const ke=new f({data:{color:le.color,titleObj:le.titleObj,modificationDate:le.modificationDate,contentsObj:le.contentsObj,richText:le.richText,parentRect:le.rect,borderStyle:0,id:`popup_${le.id}`,rotation:le.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ke.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(ve,le=null){const ke=[];if(this._fieldObjects){const je=this._fieldObjects[ve];if(je)for(const{page:ze,id:Ke,exportValues:Qe}of je){if(ze===-1||Ke===le)continue;const ht=typeof Qe=="string"?Qe:null,lt=document.querySelector(`[data-element-id="${Ke}"]`);if(lt&&!H.has(lt)){(0,n.warn)(`_getElementsByName - element not allowed: ${Ke}`);continue}ke.push({id:Ke,exportValue:ht,domElement:lt})}return ke}for(const je of document.getElementsByName(ve)){const{exportValue:ze}=je,Ke=je.getAttribute("data-element-id");Ke!==le&&H.has(je)&&ke.push({id:Ke,exportValue:ze,domElement:je})}return ke}show(){var ve;this.container&&(this.container.hidden=!1),(ve=this.popup)==null||ve.maybeShow()}hide(){var ve;this.container&&(this.container.hidden=!0),(ve=this.popup)==null||ve.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const ve=this.getElementsToTriggerPopup();if(Array.isArray(ve))for(const le of ve)le.classList.add("highlightArea");else ve.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:ve,data:{id:le}}=this;this.container.addEventListener("dblclick",()=>{var ke;(ke=this.linkService.eventBus)==null||ke.dispatch("switchannotationeditormode",{source:this,mode:ve,editId:le})})}};U=new WeakMap;let u=Ae;class M extends u{constructor(le,ke=null){super(le,{isRenderable:!0,ignoreBorder:!!(ke!=null&&ke.ignoreBorder),createQuadrilaterals:!0});Me(this,ye);this.isTooltipOnly=le.data.isTooltipOnly}render(){const{data:le,linkService:ke}=this,je=document.createElement("a");je.setAttribute("data-element-id",le.id);let ze=!1;return le.url?(ke.addLinkAttributes(je,le.url,le.newWindow),ze=!0):le.action?(this._bindNamedAction(je,le.action),ze=!0):le.attachment?(this._bindAttachment(je,le.attachment),ze=!0):le.setOCGState?(ne(this,ye,Zn).call(this,je,le.setOCGState),ze=!0):le.dest?(this._bindLink(je,le.dest),ze=!0):(le.actions&&(le.actions.Action||le.actions["Mouse Up"]||le.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(je,le),ze=!0),le.resetForm?(this._bindResetFormAction(je,le.resetForm),ze=!0):this.isTooltipOnly&&!ze&&(this._bindLink(je,""),ze=!0)),this.container.classList.add("linkAnnotation"),ze&&this.container.append(je),this.container}_bindLink(le,ke){le.href=this.linkService.getDestinationHash(ke),le.onclick=()=>(ke&&this.linkService.goToDestination(ke),!1),(ke||ke==="")&&ne(this,ye,Dt).call(this)}_bindNamedAction(le,ke){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>(this.linkService.executeNamedAction(ke),!1),ne(this,ye,Dt).call(this)}_bindAttachment(le,ke){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>{var je;return(je=this.downloadManager)==null||je.openOrDownloadData(this.container,ke.content,ke.filename),!1},ne(this,ye,Dt).call(this)}_bindJSAction(le,ke){le.href=this.linkService.getAnchorUrl("");const je=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ze of Object.keys(ke.actions)){const Ke=je.get(ze);Ke&&(le[Ke]=()=>{var Qe;return(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ke.id,name:ze}}),!1})}le.onclick||(le.onclick=()=>!1),ne(this,ye,Dt).call(this)}_bindResetFormAction(le,ke){const je=le.onclick;if(je||(le.href=this.linkService.getAnchorUrl("")),ne(this,ye,Dt).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),je||(le.onclick=()=>!1);return}le.onclick=()=>{var _t;je==null||je();const{fields:ze,refs:Ke,include:Qe}=ke,ht=[];if(ze.length!==0||Ke.length!==0){const ct=new Set(Ke);for(const dt of ze){const gt=this._fieldObjects[dt]||[];for(const{id:bt}of gt)ct.add(bt)}for(const dt of Object.values(this._fieldObjects))for(const gt of dt)ct.has(gt.id)===Qe&&ht.push(gt)}else for(const ct of Object.values(this._fieldObjects))ht.push(...ct);const lt=this.annotationStorage,st=[];for(const ct of ht){const{id:dt}=ct;switch(st.push(dt),ct.type){case"text":{const bt=ct.defaultValue||"";lt.setValue(dt,{value:bt});break}case"checkbox":case"radiobutton":{const bt=ct.defaultValue===ct.exportValues;lt.setValue(dt,{value:bt});break}case"combobox":case"listbox":{const bt=ct.defaultValue||"";lt.setValue(dt,{value:bt});break}default:continue}const gt=document.querySelector(`[data-element-id="${dt}"]`);if(gt){if(!H.has(gt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${dt}`);continue}}else continue;gt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}})),!1}}}ye=new WeakSet,Dt=function(){this.container.setAttribute("data-internal-link","")},Zn=function(le,ke){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>(this.linkService.executeSetOCGState(ke),!1),ne(this,ye,Dt).call(this)};class P extends u{constructor(ve){super(ve,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const ve=document.createElement("img");return ve.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",ve.alt="[{{type}} Annotation]",ve.dataset.l10nId="text_annotation_type",ve.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(ve),this.container}}class x extends u{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(ve){var le;this.data.hasOwnCanvas&&(((le=ve.previousSibling)==null?void 0:le.nodeName)==="CANVAS"&&(ve.previousSibling.hidden=!0),ve.hidden=!1)}_getKeyModifier(ve){const{isWin:le,isMac:ke}=n.FeatureTest.platform;return le&&ve.ctrlKey||ke&&ve.metaKey}_setEventListener(ve,le,ke,je,ze){ke.includes("mouse")?ve.addEventListener(ke,Ke=>{var Qe;(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:je,value:ze(Ke),shift:Ke.shiftKey,modifier:this._getKeyModifier(Ke)}})}):ve.addEventListener(ke,Ke=>{var Qe;if(ke==="blur"){if(!le.focused||!Ke.relatedTarget)return;le.focused=!1}else if(ke==="focus"){if(le.focused)return;le.focused=!0}ze&&((Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:je,value:ze(Ke)}}))})}_setEventListeners(ve,le,ke,je){var ze,Ke,Qe;for(const[ht,lt]of ke)(lt==="Action"||(ze=this.data.actions)!=null&&ze[lt])&&((lt==="Focus"||lt==="Blur")&&(le||(le={focused:!1})),this._setEventListener(ve,le,ht,lt,je),lt==="Focus"&&!((Ke=this.data.actions)!=null&&Ke.Blur)?this._setEventListener(ve,le,"blur","Blur",null):lt==="Blur"&&!((Qe=this.data.actions)!=null&&Qe.Focus)&&this._setEventListener(ve,le,"focus","Focus",null))}_setBackgroundColor(ve){const le=this.data.backgroundColor||null;ve.style.backgroundColor=le===null?"transparent":n.Util.makeHexColor(le[0],le[1],le[2])}_setTextStyle(ve){const le=["left","center","right"],{fontColor:ke}=this.data.defaultAppearanceData,je=this.data.defaultAppearanceData.fontSize||r,ze=ve.style;let Ke;const Qe=2,ht=lt=>Math.round(10*lt)/10;if(this.data.multiLine){const lt=Math.abs(this.data.rect[3]-this.data.rect[1]-Qe),st=Math.round(lt/(n.LINE_FACTOR*je))||1,_t=lt/st;Ke=Math.min(je,ht(_t/n.LINE_FACTOR))}else{const lt=Math.abs(this.data.rect[3]-this.data.rect[1]-Qe);Ke=Math.min(je,ht(lt/n.LINE_FACTOR))}ze.fontSize=`calc(${Ke}px * var(--scale-factor))`,ze.color=n.Util.makeHexColor(ke[0],ke[1],ke[2]),this.data.textAlignment!==null&&(ze.textAlign=le[this.data.textAlignment])}_setRequired(ve,le){le?ve.setAttribute("required",!0):ve.removeAttribute("required"),ve.setAttribute("aria-required",le)}}class S extends x{constructor(ve){const le=ve.renderForms||!ve.data.hasAppearance&&!!ve.data.fieldValue;super(ve,{isRenderable:le})}setPropertyOnSiblings(ve,le,ke,je){const ze=this.annotationStorage;for(const Ke of this._getElementsByName(ve.name,ve.id))Ke.domElement&&(Ke.domElement[le]=ke),ze.setValue(Ke.id,{[je]:ke})}render(){var je,ze;const ve=this.annotationStorage,le=this.data.id;this.container.classList.add("textWidgetAnnotation");let ke=null;if(this.renderForms){const Ke=ve.getValue(le,{value:this.data.fieldValue});let Qe=Ke.value||"";const ht=ve.getValue(le,{charLimit:this.data.maxLen}).charLimit;ht&&Qe.length>ht&&(Qe=Qe.slice(0,ht));let lt=Ke.formattedValue||((je=this.data.textContent)==null?void 0:je.join(`
`))||null;lt&&this.data.comb&&(lt=lt.replaceAll(/\s+/g,""));const st={userValue:Qe,formattedValue:lt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ke=document.createElement("textarea"),ke.textContent=lt??Qe,this.data.doNotScroll&&(ke.style.overflowY="hidden")):(ke=document.createElement("input"),ke.type="text",ke.setAttribute("value",lt??Qe),this.data.doNotScroll&&(ke.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ke.hidden=!0),H.add(ke),ke.setAttribute("data-element-id",le),ke.disabled=this.data.readOnly,ke.name=this.data.fieldName,ke.tabIndex=p,this._setRequired(ke,this.data.required),ht&&(ke.maxLength=ht),ke.addEventListener("input",ct=>{ve.setValue(le,{value:ct.target.value}),this.setPropertyOnSiblings(ke,"value",ct.target.value,"value"),st.formattedValue=null}),ke.addEventListener("resetform",ct=>{const dt=this.data.defaultFieldValue??"";ke.value=st.userValue=dt,st.formattedValue=null});let _t=ct=>{const{formattedValue:dt}=st;dt!=null&&(ct.target.value=dt),ct.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ke.addEventListener("focus",dt=>{if(st.focused)return;const{target:gt}=dt;st.userValue&&(gt.value=st.userValue),st.lastCommittedValue=gt.value,st.commitKey=1,st.focused=!0}),ke.addEventListener("updatefromsandbox",dt=>{this.showElementAndHideCanvas(dt.target);const gt={value(bt){st.userValue=bt.detail.value??"",ve.setValue(le,{value:st.userValue.toString()}),bt.target.value=st.userValue},formattedValue(bt){const{formattedValue:yt}=bt.detail;st.formattedValue=yt,yt!=null&&bt.target!==document.activeElement&&(bt.target.value=yt),ve.setValue(le,{formattedValue:yt})},selRange(bt){bt.target.setSelectionRange(...bt.detail.selRange)},charLimit:bt=>{var Et;const{charLimit:yt}=bt.detail,{target:St}=bt;if(yt===0){St.removeAttribute("maxLength");return}St.setAttribute("maxLength",yt);let wt=st.userValue;!wt||wt.length<=yt||(wt=wt.slice(0,yt),St.value=st.userValue=wt,ve.setValue(le,{value:wt}),(Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:le,name:"Keystroke",value:wt,willCommit:!0,commitKey:1,selStart:St.selectionStart,selEnd:St.selectionEnd}}))}};this._dispatchEventFromSandbox(gt,dt)}),ke.addEventListener("keydown",dt=>{var yt;st.commitKey=1;let gt=-1;if(dt.key==="Escape"?gt=0:dt.key==="Enter"&&!this.data.multiLine?gt=2:dt.key==="Tab"&&(st.commitKey=3),gt===-1)return;const{value:bt}=dt.target;st.lastCommittedValue!==bt&&(st.lastCommittedValue=bt,st.userValue=bt,(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:le,name:"Keystroke",value:bt,willCommit:!0,commitKey:gt,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}}))});const ct=_t;_t=null,ke.addEventListener("blur",dt=>{var bt;if(!st.focused||!dt.relatedTarget)return;st.focused=!1;const{value:gt}=dt.target;st.userValue=gt,st.lastCommittedValue!==gt&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:le,name:"Keystroke",value:gt,willCommit:!0,commitKey:st.commitKey,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}})),ct(dt)}),(ze=this.data.actions)!=null&&ze.Keystroke&&ke.addEventListener("beforeinput",dt=>{var It;st.lastCommittedValue=null;const{data:gt,target:bt}=dt,{value:yt,selectionStart:St,selectionEnd:wt}=bt;let Et=St,Mt=wt;switch(dt.inputType){case"deleteWordBackward":{const kt=yt.substring(0,St).match(/\w*[^\w]*$/);kt&&(Et-=kt[0].length);break}case"deleteWordForward":{const kt=yt.substring(St).match(/^[^\w]*\w*/);kt&&(Mt+=kt[0].length);break}case"deleteContentBackward":St===wt&&(Et-=1);break;case"deleteContentForward":St===wt&&(Mt+=1);break}dt.preventDefault(),(It=this.linkService.eventBus)==null||It.dispatch("dispatcheventinsandbox",{source:this,detail:{id:le,name:"Keystroke",value:yt,change:gt||"",willCommit:!1,selStart:Et,selEnd:Mt}})}),this._setEventListeners(ke,st,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.value)}if(_t&&ke.addEventListener("blur",_t),this.data.comb){const dt=(this.data.rect[2]-this.data.rect[0])/ht;ke.classList.add("comb"),ke.style.letterSpacing=`calc(${dt}px * var(--scale-factor) - 1ch)`}}else ke=document.createElement("div"),ke.textContent=this.data.fieldValue,ke.style.verticalAlign="middle",ke.style.display="table-cell";return this._setTextStyle(ke),this._setBackgroundColor(ke),this._setDefaultPropertiesFromJS(ke),this.container.append(ke),this.container}}class F extends x{constructor(ve){super(ve,{isRenderable:!!ve.data.hasOwnCanvas})}}class I extends x{constructor(ve){super(ve,{isRenderable:ve.renderForms})}render(){const ve=this.annotationStorage,le=this.data,ke=le.id;let je=ve.getValue(ke,{value:le.exportValue===le.fieldValue}).value;typeof je=="string"&&(je=je!=="Off",ve.setValue(ke,{value:je})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ze=document.createElement("input");return H.add(ze),ze.setAttribute("data-element-id",ke),ze.disabled=le.readOnly,this._setRequired(ze,this.data.required),ze.type="checkbox",ze.name=le.fieldName,je&&ze.setAttribute("checked",!0),ze.setAttribute("exportValue",le.exportValue),ze.tabIndex=p,ze.addEventListener("change",Ke=>{const{name:Qe,checked:ht}=Ke.target;for(const lt of this._getElementsByName(Qe,ke)){const st=ht&&lt.exportValue===le.exportValue;lt.domElement&&(lt.domElement.checked=st),ve.setValue(lt.id,{value:st})}ve.setValue(ke,{value:ht})}),ze.addEventListener("resetform",Ke=>{const Qe=le.defaultFieldValue||"Off";Ke.target.checked=Qe===le.exportValue}),this.enableScripting&&this.hasJSActions&&(ze.addEventListener("updatefromsandbox",Ke=>{const Qe={value(ht){ht.target.checked=ht.detail.value!=="Off",ve.setValue(ke,{value:ht.target.checked})}};this._dispatchEventFromSandbox(Qe,Ke)}),this._setEventListeners(ze,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ke=>Ke.target.checked)),this._setBackgroundColor(ze),this._setDefaultPropertiesFromJS(ze),this.container.append(ze),this.container}}class o extends x{constructor(ve){super(ve,{isRenderable:ve.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const ve=this.annotationStorage,le=this.data,ke=le.id;let je=ve.getValue(ke,{value:le.fieldValue===le.buttonValue}).value;typeof je=="string"&&(je=je!==le.buttonValue,ve.setValue(ke,{value:je}));const ze=document.createElement("input");if(H.add(ze),ze.setAttribute("data-element-id",ke),ze.disabled=le.readOnly,this._setRequired(ze,this.data.required),ze.type="radio",ze.name=le.fieldName,je&&ze.setAttribute("checked",!0),ze.tabIndex=p,ze.addEventListener("change",Ke=>{const{name:Qe,checked:ht}=Ke.target;for(const lt of this._getElementsByName(Qe,ke))ve.setValue(lt.id,{value:!1});ve.setValue(ke,{value:ht})}),ze.addEventListener("resetform",Ke=>{const Qe=le.defaultFieldValue;Ke.target.checked=Qe!=null&&Qe===le.buttonValue}),this.enableScripting&&this.hasJSActions){const Ke=le.buttonValue;ze.addEventListener("updatefromsandbox",Qe=>{const ht={value:lt=>{const st=Ke===lt.detail.value;for(const _t of this._getElementsByName(lt.target.name)){const ct=st&&_t.id===ke;_t.domElement&&(_t.domElement.checked=ct),ve.setValue(_t.id,{value:ct})}}};this._dispatchEventFromSandbox(ht,Qe)}),this._setEventListeners(ze,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Qe=>Qe.target.checked)}return this._setBackgroundColor(ze),this._setDefaultPropertiesFromJS(ze),this.container.append(ze),this.container}}class s extends M{constructor(ve){super(ve,{ignoreBorder:ve.data.hasAppearance})}render(){const ve=super.render();ve.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(ve.title=this.data.alternativeText);const le=ve.lastChild;return this.enableScripting&&this.hasJSActions&&le&&(this._setDefaultPropertiesFromJS(le),le.addEventListener("updatefromsandbox",ke=>{this._dispatchEventFromSandbox({},ke)})),ve}}class c extends x{constructor(ve){super(ve,{isRenderable:ve.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const ve=this.annotationStorage,le=this.data.id,ke=ve.getValue(le,{value:this.data.fieldValue}),je=document.createElement("select");H.add(je),je.setAttribute("data-element-id",le),je.disabled=this.data.readOnly,this._setRequired(je,this.data.required),je.name=this.data.fieldName,je.tabIndex=p;let ze=this.data.combo&&this.data.options.length>0;this.data.combo||(je.size=this.data.options.length,this.data.multiSelect&&(je.multiple=!0)),je.addEventListener("resetform",st=>{const _t=this.data.defaultFieldValue;for(const ct of je.options)ct.selected=ct.value===_t});for(const st of this.data.options){const _t=document.createElement("option");_t.textContent=st.displayValue,_t.value=st.exportValue,ke.value.includes(st.exportValue)&&(_t.setAttribute("selected",!0),ze=!1),je.append(_t)}let Ke=null;if(ze){const st=document.createElement("option");st.value=" ",st.setAttribute("hidden",!0),st.setAttribute("selected",!0),je.prepend(st),Ke=()=>{st.remove(),je.removeEventListener("input",Ke),Ke=null},je.addEventListener("input",Ke)}const Qe=st=>{const _t=st?"value":"textContent",{options:ct,multiple:dt}=je;return dt?Array.prototype.filter.call(ct,gt=>gt.selected).map(gt=>gt[_t]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][_t]};let ht=Qe(!1);const lt=st=>{const _t=st.target.options;return Array.prototype.map.call(_t,ct=>({displayValue:ct.textContent,exportValue:ct.value}))};return this.enableScripting&&this.hasJSActions?(je.addEventListener("updatefromsandbox",st=>{const _t={value(ct){Ke==null||Ke();const dt=ct.detail.value,gt=new Set(Array.isArray(dt)?dt:[dt]);for(const bt of je.options)bt.selected=gt.has(bt.value);ve.setValue(le,{value:Qe(!0)}),ht=Qe(!1)},multipleSelection(ct){je.multiple=!0},remove(ct){const dt=je.options,gt=ct.detail.remove;dt[gt].selected=!1,je.remove(gt),dt.length>0&&Array.prototype.findIndex.call(dt,yt=>yt.selected)===-1&&(dt[0].selected=!0),ve.setValue(le,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},clear(ct){for(;je.length!==0;)je.remove(0);ve.setValue(le,{value:null,items:[]}),ht=Qe(!1)},insert(ct){const{index:dt,displayValue:gt,exportValue:bt}=ct.detail.insert,yt=je.children[dt],St=document.createElement("option");St.textContent=gt,St.value=bt,yt?yt.before(St):je.append(St),ve.setValue(le,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},items(ct){const{items:dt}=ct.detail;for(;je.length!==0;)je.remove(0);for(const gt of dt){const{displayValue:bt,exportValue:yt}=gt,St=document.createElement("option");St.textContent=bt,St.value=yt,je.append(St)}je.options.length>0&&(je.options[0].selected=!0),ve.setValue(le,{value:Qe(!0),items:lt(ct)}),ht=Qe(!1)},indices(ct){const dt=new Set(ct.detail.indices);for(const gt of ct.target.options)gt.selected=dt.has(gt.index);ve.setValue(le,{value:Qe(!0)}),ht=Qe(!1)},editable(ct){ct.target.disabled=!ct.detail.editable}};this._dispatchEventFromSandbox(_t,st)}),je.addEventListener("input",st=>{var ct;const _t=Qe(!0);ve.setValue(le,{value:_t}),st.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:le,name:"Keystroke",value:ht,changeEx:_t,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(je,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],st=>st.target.value)):je.addEventListener("input",function(st){ve.setValue(le,{value:Qe(!0)})}),this.data.combo&&this._setTextStyle(je),this._setBackgroundColor(je),this._setDefaultPropertiesFromJS(je),this.container.append(je),this.container}}class f extends u{constructor(ve){const{data:le,elements:ke}=ve;super(ve,{isRenderable:u._hasPopupData(le)}),this.elements=ke}render(){this.container.classList.add("popupAnnotation");const ve=new T({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),le=[];for(const ke of this.elements)ke.popup=ve,le.push(ke.data.id),ke.addHighlightArea();return this.container.setAttribute("aria-controls",le.map(ke=>`${n.AnnotationPrefix}${ke}`).join(",")),this.container}}class T{constructor({container:ve,color:le,elements:ke,titleObj:je,modificationDate:ze,contentsObj:Ke,richText:Qe,parent:ht,rect:lt,parentRect:st,open:_t}){Me(this,De);Me(this,Re,null);Me(this,Ne,ne(this,De,Jn).bind(this));Me(this,He,ne(this,De,Zi).bind(this));Me(this,$e,ne(this,De,Qi).bind(this));Me(this,qe,ne(this,De,fi).bind(this));Me(this,Ye,null);Me(this,Oe,null);Me(this,Fe,null);Me(this,J,null);Me(this,Ee,null);Me(this,Ie,null);Me(this,z,!1);Me(this,h,null);Me(this,X,null);Me(this,oe,null);Me(this,Z,null);Me(this,Le,!1);var dt;Ce(this,Oe,ve),Ce(this,Z,je),Ce(this,Fe,Ke),Ce(this,oe,Qe),Ce(this,Ee,ht),Ce(this,Ye,le),Ce(this,X,lt),Ce(this,Ie,st),Ce(this,J,ke);const ct=d.PDFDateString.toDateObject(ze);ct&&Ce(this,Re,ht.l10n.get("annotation_date_string",{date:ct.toLocaleDateString(),time:ct.toLocaleTimeString()})),this.trigger=ke.flatMap(gt=>gt.getElementsToTriggerPopup());for(const gt of this.trigger)gt.addEventListener("click",t(this,qe)),gt.addEventListener("mouseenter",t(this,$e)),gt.addEventListener("mouseleave",t(this,He)),gt.classList.add("popupTriggerArea");for(const gt of ke)(dt=gt.container)==null||dt.addEventListener("keydown",t(this,Ne));t(this,Oe).hidden=!0,_t&&ne(this,De,fi).call(this)}render(){if(t(this,h))return;const{page:{view:ve},viewport:{rawDims:{pageWidth:le,pageHeight:ke,pageX:je,pageY:ze}}}=t(this,Ee),Ke=Ce(this,h,document.createElement("div"));if(Ke.className="popup",t(this,Ye)){const Et=Ke.style.outlineColor=n.Util.makeHexColor(...t(this,Ye));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Ke.style.backgroundColor=`color-mix(in srgb, ${Et} 30%, white)`:Ke.style.backgroundColor=n.Util.makeHexColor(...t(this,Ye).map(It=>Math.floor(.7*(255-It)+It)))}const Qe=document.createElement("span");Qe.className="header";const ht=document.createElement("h1");if(Qe.append(ht),{dir:ht.dir,str:ht.textContent}=t(this,Z),Ke.append(Qe),t(this,Re)){const Et=document.createElement("span");Et.classList.add("popupDate"),t(this,Re).then(Mt=>{Et.textContent=Mt}),Qe.append(Et)}const lt=t(this,Fe),st=t(this,oe);if(st!=null&&st.str&&(!(lt!=null&&lt.str)||lt.str===st.str))E.XfaLayer.render({xfaHtml:st.html,intent:"richText",div:Ke}),Ke.lastChild.classList.add("richText","popupContent");else{const Et=this._formatContents(lt);Ke.append(Et)}let _t=!!t(this,Ie),ct=_t?t(this,Ie):t(this,X);for(const Et of t(this,J))if(!ct||n.Util.intersect(Et.data.rect,ct)!==null){ct=Et.data.rect,_t=!0;break}const dt=n.Util.normalizeRect([ct[0],ve[3]-ct[1]+ve[1],ct[2],ve[3]-ct[3]+ve[1]]),bt=_t?ct[2]-ct[0]+5:0,yt=dt[0]+bt,St=dt[1],{style:wt}=t(this,Oe);wt.left=`${100*(yt-je)/le}%`,wt.top=`${100*(St-ze)/ke}%`,t(this,Oe).append(Ke)}_formatContents({str:ve,dir:le}){const ke=document.createElement("p");ke.classList.add("popupContent"),ke.dir=le;const je=ve.split(/(?:\r\n?|\n)/);for(let ze=0,Ke=je.length;ze<Ke;++ze){const Qe=je[ze];ke.append(document.createTextNode(Qe)),ze<Ke-1&&ke.append(document.createElement("br"))}return ke}forceHide(){Ce(this,Le,this.isVisible),t(this,Le)&&(t(this,Oe).hidden=!0)}maybeShow(){t(this,Le)&&(Ce(this,Le,!1),t(this,Oe).hidden=!1)}get isVisible(){return t(this,Oe).hidden===!1}}Re=new WeakMap,Ne=new WeakMap,He=new WeakMap,$e=new WeakMap,qe=new WeakMap,Ye=new WeakMap,Oe=new WeakMap,Fe=new WeakMap,J=new WeakMap,Ee=new WeakMap,Ie=new WeakMap,z=new WeakMap,h=new WeakMap,X=new WeakMap,oe=new WeakMap,Z=new WeakMap,Le=new WeakMap,De=new WeakSet,Jn=function(ve){ve.altKey||ve.shiftKey||ve.ctrlKey||ve.metaKey||(ve.key==="Enter"||ve.key==="Escape"&&t(this,z))&&ne(this,De,fi).call(this)},fi=function(){Ce(this,z,!t(this,z)),t(this,z)?(ne(this,De,Qi).call(this),t(this,Oe).addEventListener("click",t(this,qe)),t(this,Oe).addEventListener("keydown",t(this,Ne))):(ne(this,De,Zi).call(this),t(this,Oe).removeEventListener("click",t(this,qe)),t(this,Oe).removeEventListener("keydown",t(this,Ne)))},Qi=function(){t(this,h)||this.render(),this.isVisible?t(this,z)&&t(this,Oe).classList.add("focused"):(t(this,Oe).hidden=!1,t(this,Oe).style.zIndex=parseInt(t(this,Oe).style.zIndex)+1e3)},Zi=function(){t(this,Oe).classList.remove("focused"),!(t(this,z)||!this.isVisible)&&(t(this,Oe).hidden=!0,t(this,Oe).style.zIndex=parseInt(t(this,Oe).style.zIndex)-1e3)};class Y extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0}),this.textContent=ve.data.textContent,this.textPosition=ve.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const ve=document.createElement("div");ve.classList.add("annotationTextContent"),ve.setAttribute("role","comment");for(const le of this.textContent){const ke=document.createElement("span");ke.textContent=le,ve.append(ke)}this.container.append(ve)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=Y;class _ extends u{constructor(le){super(le,{isRenderable:!0,ignoreBorder:!0});Me(this,it,null)}render(){this.container.classList.add("lineAnnotation");const le=this.data,{width:ke,height:je}=N(le.rect),ze=this.svgFactory.create(ke,je,!0),Ke=Ce(this,it,this.svgFactory.createElement("svg:line"));return Ke.setAttribute("x1",le.rect[2]-le.lineCoordinates[0]),Ke.setAttribute("y1",le.rect[3]-le.lineCoordinates[1]),Ke.setAttribute("x2",le.rect[2]-le.lineCoordinates[2]),Ke.setAttribute("y2",le.rect[3]-le.lineCoordinates[3]),Ke.setAttribute("stroke-width",le.borderStyle.width||1),Ke.setAttribute("stroke","transparent"),Ke.setAttribute("fill","transparent"),ze.append(Ke),this.container.append(ze),!le.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,it)}addHighlightArea(){this.container.classList.add("highlightArea")}}it=new WeakMap;class j extends u{constructor(le){super(le,{isRenderable:!0,ignoreBorder:!0});Me(this,pt,null)}render(){this.container.classList.add("squareAnnotation");const le=this.data,{width:ke,height:je}=N(le.rect),ze=this.svgFactory.create(ke,je,!0),Ke=le.borderStyle.width,Qe=Ce(this,pt,this.svgFactory.createElement("svg:rect"));return Qe.setAttribute("x",Ke/2),Qe.setAttribute("y",Ke/2),Qe.setAttribute("width",ke-Ke),Qe.setAttribute("height",je-Ke),Qe.setAttribute("stroke-width",Ke||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),ze.append(Qe),this.container.append(ze),!le.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,pt)}addHighlightArea(){this.container.classList.add("highlightArea")}}pt=new WeakMap;class fe extends u{constructor(le){super(le,{isRenderable:!0,ignoreBorder:!0});Me(this,mt,null)}render(){this.container.classList.add("circleAnnotation");const le=this.data,{width:ke,height:je}=N(le.rect),ze=this.svgFactory.create(ke,je,!0),Ke=le.borderStyle.width,Qe=Ce(this,mt,this.svgFactory.createElement("svg:ellipse"));return Qe.setAttribute("cx",ke/2),Qe.setAttribute("cy",je/2),Qe.setAttribute("rx",ke/2-Ke/2),Qe.setAttribute("ry",je/2-Ke/2),Qe.setAttribute("stroke-width",Ke||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),ze.append(Qe),this.container.append(ze),!le.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap;class te extends u{constructor(le){super(le,{isRenderable:!0,ignoreBorder:!0});Me(this,Xe,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const le=this.data,{width:ke,height:je}=N(le.rect),ze=this.svgFactory.create(ke,je,!0);let Ke=[];for(const ht of le.vertices){const lt=ht.x-le.rect[0],st=le.rect[3]-ht.y;Ke.push(lt+","+st)}Ke=Ke.join(" ");const Qe=Ce(this,Xe,this.svgFactory.createElement(this.svgElementName));return Qe.setAttribute("points",Ke),Qe.setAttribute("stroke-width",le.borderStyle.width||1),Qe.setAttribute("stroke","transparent"),Qe.setAttribute("fill","transparent"),ze.append(Qe),this.container.append(ze),!le.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Xe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xe=new WeakMap;class _e extends te{constructor(ve){super(ve),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class be extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class W extends u{constructor(le){super(le,{isRenderable:!0,ignoreBorder:!0});Me(this,Be,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const le=this.data,{width:ke,height:je}=N(le.rect),ze=this.svgFactory.create(ke,je,!0);for(const Ke of le.inkLists){let Qe=[];for(const lt of Ke){const st=lt.x-le.rect[0],_t=le.rect[3]-lt.y;Qe.push(`${st},${_t}`)}Qe=Qe.join(" ");const ht=this.svgFactory.createElement(this.svgElementName);t(this,Be).push(ht),ht.setAttribute("points",Qe),ht.setAttribute("stroke-width",le.borderStyle.width||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),!le.popupRef&&this.hasPopupData&&this._createPopup(),ze.append(ht)}return this.container.append(ze),this.container}getElementsToTriggerPopup(){return t(this,Be)}addHighlightArea(){this.container.classList.add("highlightArea")}}Be=new WeakMap,e.InkAnnotationElement=W;class Pe extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class D extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class k extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Te extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class q extends u{constructor(ve){super(ve,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=q;class m extends u{constructor(le){var ze;super(le,{isRenderable:!0});Me(this,nt);Me(this,Ue,null);const{filename:ke,content:je}=this.data.file;this.filename=(0,d.getFilenameFromUrl)(ke,!0),this.content=je,(ze=this.linkService.eventBus)==null||ze.dispatch("fileattachmentannotation",{source:this,filename:ke,content:je})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:le,data:ke}=this;let je;ke.hasAppearance||ke.fillAlpha===0?je=document.createElement("div"):(je=document.createElement("img"),je.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ke.name)?"paperclip":"pushpin"}.svg`,ke.fillAlpha&&ke.fillAlpha<1&&(je.style=`filter: opacity(${Math.round(ke.fillAlpha*100)}%);`)),je.addEventListener("dblclick",ne(this,nt,Ji).bind(this)),Ce(this,Ue,je);const{isMac:ze}=n.FeatureTest.platform;return le.addEventListener("keydown",Ke=>{Ke.key==="Enter"&&(ze?Ke.metaKey:Ke.ctrlKey)&&ne(this,nt,Ji).call(this)}),!ke.popupRef&&this.hasPopupData?this._createPopup():je.classList.add("popupTriggerArea"),le.append(je),le}getElementsToTriggerPopup(){return t(this,Ue)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ue=new WeakMap,nt=new WeakSet,Ji=function(){var le;(le=this.downloadManager)==null||le.openOrDownloadData(this.container,this.content,this.filename)};class y{constructor({div:ve,accessibilityManager:le,annotationCanvasMap:ke,l10n:je,page:ze,viewport:Ke}){Me(this,et);Me(this,ut,null);Me(this,Se,null);Me(this,We,new Map);this.div=ve,Ce(this,ut,le),Ce(this,Se,ke),this.l10n=je,this.page=ze,this.viewport=Ke,this.zIndex=0,this.l10n||(this.l10n=w.NullL10n)}async render(ve){const{annotations:le}=ve,ke=this.div;(0,d.setLayerDimensions)(ke,this.viewport);const je=new Map,ze={data:null,layer:ke,linkService:ve.linkService,downloadManager:ve.downloadManager,imageResourcesPath:ve.imageResourcesPath||"",renderForms:ve.renderForms!==!1,svgFactory:new d.DOMSVGFactory,annotationStorage:ve.annotationStorage||new re.AnnotationStorage,enableScripting:ve.enableScripting===!0,hasJSActions:ve.hasJSActions,fieldObjects:ve.fieldObjects,parent:this,elements:null};for(const Ke of le){if(Ke.noHTML)continue;const Qe=Ke.annotationType===n.AnnotationType.POPUP;if(Qe){const st=je.get(Ke.id);if(!st)continue;ze.elements=st}else{const{width:st,height:_t}=N(Ke.rect);if(st<=0||_t<=0)continue}ze.data=Ke;const ht=g.create(ze);if(!ht.isRenderable)continue;if(!Qe&&Ke.popupRef){const st=je.get(Ke.popupRef);st?st.push(ht):je.set(Ke.popupRef,[ht])}ht.annotationEditorType>0&&t(this,We).set(ht.data.id,ht);const lt=ht.render();Ke.hidden&&(lt.style.visibility="hidden"),ne(this,et,es).call(this,lt,Ke.id)}ne(this,et,en).call(this),await this.l10n.translate(ke)}update({viewport:ve}){const le=this.div;this.viewport=ve,(0,d.setLayerDimensions)(le,{rotation:ve.rotation}),ne(this,et,en).call(this),le.hidden=!1}getEditableAnnotations(){return Array.from(t(this,We).values())}getEditableAnnotation(ve){return t(this,We).get(ve)}}ut=new WeakMap,Se=new WeakMap,We=new WeakMap,et=new WeakSet,es=function(ve,le){var je;const ke=ve.firstChild||ve;ke.id=`${n.AnnotationPrefix}${le}`,this.div.append(ve),(je=t(this,ut))==null||je.moveElementInDOM(this.div,ve,ke,!1)},en=function(){if(!t(this,Se))return;const ve=this.div;for(const[le,ke]of t(this,Se)){const je=ve.querySelector(`[data-annotation-id="${le}"]`);if(!je)continue;const{firstChild:ze}=je;ze?ze.nodeName==="CANVAS"?ze.replaceWith(ke):ze.before(ke):je.append(ke)}t(this,Se).clear()},e.AnnotationLayer=y},(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function v(re){return Math.floor(Math.max(0,Math.min(1,re))*255).toString(16).padStart(2,"0")}function n(re){return Math.max(0,Math.min(255,255*re))}class d{static CMYK_G([O,w,E,p]){return["G",1-Math.min(1,.3*O+.59*E+.11*w+p)]}static G_CMYK([O]){return["CMYK",0,0,0,1-O]}static G_RGB([O]){return["RGB",O,O,O]}static G_rgb([O]){return O=n(O),[O,O,O]}static G_HTML([O]){const w=v(O);return`#${w}${w}${w}`}static RGB_G([O,w,E]){return["G",.3*O+.59*w+.11*E]}static RGB_rgb(O){return O.map(n)}static RGB_HTML(O){return`#${O.map(v).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([O,w,E,p]){return["RGB",1-Math.min(1,O+p),1-Math.min(1,E+p),1-Math.min(1,w+p)]}static CMYK_rgb([O,w,E,p]){return[n(1-Math.min(1,O+p)),n(1-Math.min(1,E+p)),n(1-Math.min(1,w+p))]}static CMYK_HTML(O){const w=this.CMYK_RGB(O).slice(1);return this.RGB_HTML(w)}static RGB_CMYK([O,w,E]){const p=1-O,r=1-w,H=1-E,N=Math.min(p,r,H);return["CMYK",p,r,H,N]}}e.ColorConverters=d},(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const v={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};v.print_progress_percent="{{progress}}%";function n(O,w){switch(O){case"find_match_count":O=`find_match_count[${w.total===1?"one":"other"}]`;break;case"find_match_count_limit":O=`find_match_count_limit[${w.limit===1?"one":"other"}]`;break}return v[O]||""}function d(O,w){return w?O.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(E,p)=>p in w?w[p]:"{{"+p+"}}"):O}const re={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(O,w=null,E=n(O,w)){return d(E,w)},async translate(O){}};e.NullL10n=re},(i,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=v(25);class d{static setupStorage(O,w,E,p,r){const H=p.getValue(w,{value:null});switch(E.name){case"textarea":if(H.value!==null&&(O.textContent=H.value),r==="print")break;O.addEventListener("input",N=>{p.setValue(w,{value:N.target.value})});break;case"input":if(E.attributes.type==="radio"||E.attributes.type==="checkbox"){if(H.value===E.attributes.xfaOn?O.setAttribute("checked",!0):H.value===E.attributes.xfaOff&&O.removeAttribute("checked"),r==="print")break;O.addEventListener("change",N=>{p.setValue(w,{value:N.target.checked?N.target.getAttribute("xfaOn"):N.target.getAttribute("xfaOff")})})}else{if(H.value!==null&&O.setAttribute("value",H.value),r==="print")break;O.addEventListener("input",N=>{p.setValue(w,{value:N.target.value})})}break;case"select":if(H.value!==null){O.setAttribute("value",H.value);for(const N of E.children)N.attributes.value===H.value?N.attributes.selected=!0:N.attributes.hasOwnProperty("selected")&&delete N.attributes.selected}O.addEventListener("input",N=>{const g=N.target.options,u=g.selectedIndex===-1?"":g[g.selectedIndex].value;p.setValue(w,{value:u})});break}}static setAttributes({html:O,element:w,storage:E=null,intent:p,linkService:r}){const{attributes:H}=w,N=O instanceof HTMLAnchorElement;H.type==="radio"&&(H.name=`${H.name}-${p}`);for(const[g,u]of Object.entries(H))if(u!=null)switch(g){case"class":u.length&&O.setAttribute(g,u.join(" "));break;case"dataId":break;case"id":O.setAttribute("data-element-id",u);break;case"style":Object.assign(O.style,u);break;case"textContent":O.textContent=u;break;default:(!N||g!=="href"&&g!=="newWindow")&&O.setAttribute(g,u)}N&&r.addLinkAttributes(O,H.href,H.newWindow),E&&H.dataId&&this.setupStorage(O,H.dataId,w,E)}static render(O){var M;const w=O.annotationStorage,E=O.linkService,p=O.xfaHtml,r=O.intent||"display",H=document.createElement(p.name);p.attributes&&this.setAttributes({html:H,element:p,intent:r,linkService:E});const N=[[p,-1,H]],g=O.div;if(g.append(H),O.viewport){const P=`matrix(${O.viewport.transform.join(",")})`;g.style.transform=P}r!=="richText"&&g.setAttribute("class","xfaLayer xfaFont");const u=[];for(;N.length>0;){const[P,x,S]=N.at(-1);if(x+1===P.children.length){N.pop();continue}const F=P.children[++N.at(-1)[1]];if(F===null)continue;const{name:I}=F;if(I==="#text"){const s=document.createTextNode(F.value);u.push(s),S.append(s);continue}const o=(M=F==null?void 0:F.attributes)!=null&&M.xmlns?document.createElementNS(F.attributes.xmlns,I):document.createElement(I);if(S.append(o),F.attributes&&this.setAttributes({html:o,element:F,storage:w,intent:r,linkService:E}),F.children&&F.children.length>0)N.push([F,-1,o]);else if(F.value){const s=document.createTextNode(F.value);n.XfaText.shouldBuildText(I)&&u.push(s),o.append(s)}}for(const P of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))P.setAttribute("readOnly",!0);return{textDivs:u}}static update(O){const w=`matrix(${O.viewport.transform.join(",")})`;O.div.style.transform=w,O.div.hidden=!1}}e.XfaLayer=d},(i,e,v)=>{var p,r,H,N,g,u,M,P,x,S,F,I,o,s,c,ts,is,ns,ss,tn,rs,nn,as,os,ls,cs,hs,Lt,sn,pi,gi,Ut,rn,mi,ye,ds,an,us,fs,on,_i,Ht;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=v(1),d=v(4),re=v(29),O=v(6),w=v(5);const Ye=class Ye extends d.AnnotationEditor{constructor(J){super({...J,name:"inkEditor"});Me(this,c);Me(this,p,0);Me(this,r,0);Me(this,H,this.canvasPointermove.bind(this));Me(this,N,this.canvasPointerleave.bind(this));Me(this,g,this.canvasPointerup.bind(this));Me(this,u,this.canvasPointerdown.bind(this));Me(this,M,new Path2D);Me(this,P,!1);Me(this,x,!1);Me(this,S,!1);Me(this,F,null);Me(this,I,0);Me(this,o,0);Me(this,s,null);this.color=J.color||null,this.thickness=J.thickness||null,this.opacity=J.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(J){d.AnnotationEditor.initialize(J,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(J,Ee){switch(J){case n.AnnotationEditorParamsType.INK_THICKNESS:Ye._defaultThickness=Ee;break;case n.AnnotationEditorParamsType.INK_COLOR:Ye._defaultColor=Ee;break;case n.AnnotationEditorParamsType.INK_OPACITY:Ye._defaultOpacity=Ee/100;break}}updateParams(J,Ee){switch(J){case n.AnnotationEditorParamsType.INK_THICKNESS:ne(this,c,ts).call(this,Ee);break;case n.AnnotationEditorParamsType.INK_COLOR:ne(this,c,is).call(this,Ee);break;case n.AnnotationEditorParamsType.INK_OPACITY:ne(this,c,ns).call(this,Ee);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,Ye._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,Ye._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ye._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ye._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||Ye._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ye._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(ne(this,c,pi).call(this),ne(this,c,gi).call(this)),this.isAttachedToDOM||(this.parent.add(this),ne(this,c,Ut).call(this)),ne(this,c,Ht).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,F).disconnect(),Ce(this,F,null),super.remove())}setParent(J){!this.parent&&J?this._uiManager.removeShouldRescale(this):this.parent&&J===null&&this._uiManager.addShouldRescale(this),super.setParent(J)}onScaleChanging(){const[J,Ee]=this.parentDimensions,Ie=this.width*J,z=this.height*Ee;this.setDimensions(Ie,z)}enableEditMode(){t(this,P)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,u)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,u)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,P)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Ce(this,P,!0),this.div.classList.add("disabled"),ne(this,c,Ht).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(J){this._focusEventsAllowed&&(super.focusin(J),this.enableEditMode())}canvasPointerdown(J){J.button!==0||!this.isInEditMode()||t(this,P)||(this.setInForeground(),J.preventDefault(),J.type!=="mouse"&&this.div.focus(),ne(this,c,rs).call(this,J.offsetX,J.offsetY))}canvasPointermove(J){J.preventDefault(),ne(this,c,nn).call(this,J.offsetX,J.offsetY)}canvasPointerup(J){J.preventDefault(),ne(this,c,sn).call(this,J)}canvasPointerleave(J){ne(this,c,sn).call(this,J)}get isResizable(){return!this.isEmpty()&&t(this,P)}render(){if(this.div)return this.div;let J,Ee;this.width&&(J=this.x,Ee=this.y),super.render(),d.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(oe=>{var Z;return(Z=this.div)==null?void 0:Z.setAttribute("aria-label",oe)});const[Ie,z,h,X]=ne(this,c,ss).call(this);if(this.setAt(Ie,z,0,0),this.setDims(h,X),ne(this,c,pi).call(this),this.width){const[oe,Z]=this.parentDimensions;this.setAspectRatio(this.width*oe,this.height*Z),this.setAt(J*oe,Ee*Z,this.width*oe,this.height*Z),Ce(this,S,!0),ne(this,c,Ut).call(this),this.setDims(this.width*oe,this.height*Z),ne(this,c,Lt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ne(this,c,gi).call(this),this.div}setDimensions(J,Ee){const Ie=Math.round(J),z=Math.round(Ee);if(t(this,I)===Ie&&t(this,o)===z)return;Ce(this,I,Ie),Ce(this,o,z),this.canvas.style.visibility="hidden";const[h,X]=this.parentDimensions;this.width=J/h,this.height=Ee/X,this.fixAndSetPosition(),t(this,P)&&ne(this,c,rn).call(this,J,Ee),ne(this,c,Ut).call(this),ne(this,c,Lt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(J,Ee,Ie){var it,pt,mt;if(J instanceof re.InkAnnotationElement)return null;const z=super.deserialize(J,Ee,Ie);z.thickness=J.thickness,z.color=n.Util.makeHexColor(...J.color),z.opacity=J.opacity;const[h,X]=z.pageDimensions,oe=z.width*h,Z=z.height*X,Le=z.parentScale,De=J.thickness/2;Ce(z,P,!0),Ce(z,I,Math.round(oe)),Ce(z,o,Math.round(Z));const{paths:Ge,rect:Ve,rotation:Je}=J;for(let{bezier:Xe}of Ge){Xe=ne(it=Ye,ye,us).call(it,Xe,Ve,Je);const Be=[];z.paths.push(Be);let Ue=Le*(Xe[0]-De),nt=Le*(Xe[1]-De);for(let ut=2,Se=Xe.length;ut<Se;ut+=6){const We=Le*(Xe[ut]-De),et=Le*(Xe[ut+1]-De),rt=Le*(Xe[ut+2]-De),ot=Le*(Xe[ut+3]-De),tt=Le*(Xe[ut+4]-De),ve=Le*(Xe[ut+5]-De);Be.push([[Ue,nt],[We,et],[rt,ot],[tt,ve]]),Ue=tt,nt=ve}const ft=ne(this,ye,ds).call(this,Be);z.bezierPath2D.push(ft)}const Ze=ne(pt=z,c,on).call(pt);return Ce(z,r,Math.max(d.AnnotationEditor.MIN_SIZE,Ze[2]-Ze[0])),Ce(z,p,Math.max(d.AnnotationEditor.MIN_SIZE,Ze[3]-Ze[1])),ne(mt=z,c,rn).call(mt,oe,Z),z}serialize(){if(this.isEmpty())return null;const J=this.getRect(0,0),Ee=d.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:Ee,thickness:this.thickness,opacity:this.opacity,paths:ne(this,c,fs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,J),pageIndex:this.pageIndex,rect:J,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};p=new WeakMap,r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,S=new WeakMap,F=new WeakMap,I=new WeakMap,o=new WeakMap,s=new WeakMap,c=new WeakSet,ts=function(J){const Ee=this.thickness;this.addCommands({cmd:()=>{this.thickness=J,ne(this,c,Ht).call(this)},undo:()=>{this.thickness=Ee,ne(this,c,Ht).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},is=function(J){const Ee=this.color;this.addCommands({cmd:()=>{this.color=J,ne(this,c,Lt).call(this)},undo:()=>{this.color=Ee,ne(this,c,Lt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ns=function(J){J/=100;const Ee=this.opacity;this.addCommands({cmd:()=>{this.opacity=J,ne(this,c,Lt).call(this)},undo:()=>{this.opacity=Ee,ne(this,c,Lt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ss=function(){const{parentRotation:J,parentDimensions:[Ee,Ie]}=this;switch(J){case 90:return[0,Ie,Ie,Ee];case 180:return[Ee,Ie,Ee,Ie];case 270:return[Ee,0,Ie,Ee];default:return[0,0,Ee,Ie]}},tn=function(){const{ctx:J,color:Ee,opacity:Ie,thickness:z,parentScale:h,scaleFactor:X}=this;J.lineWidth=z*h/X,J.lineCap="round",J.lineJoin="round",J.miterLimit=10,J.strokeStyle=`${Ee}${(0,w.opacityToHex)(Ie)}`},rs=function(J,Ee){this.canvas.addEventListener("contextmenu",O.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,N)),this.canvas.addEventListener("pointermove",t(this,H)),this.canvas.addEventListener("pointerup",t(this,g)),this.canvas.removeEventListener("pointerdown",t(this,u)),this.isEditing=!0,t(this,S)||(Ce(this,S,!0),ne(this,c,Ut).call(this),this.thickness||(this.thickness=Ye._defaultThickness),this.color||(this.color=Ye._defaultColor||d.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ye._defaultOpacity)),this.currentPath.push([J,Ee]),Ce(this,x,!1),ne(this,c,tn).call(this),Ce(this,s,()=>{ne(this,c,ls).call(this),t(this,s)&&window.requestAnimationFrame(t(this,s))}),window.requestAnimationFrame(t(this,s))},nn=function(J,Ee){const[Ie,z]=this.currentPath.at(-1);if(this.currentPath.length>1&&J===Ie&&Ee===z)return;const h=this.currentPath;let X=t(this,M);if(h.push([J,Ee]),Ce(this,x,!0),h.length<=2){X.moveTo(...h[0]),X.lineTo(J,Ee);return}h.length===3&&(Ce(this,M,X=new Path2D),X.moveTo(...h[0])),ne(this,c,cs).call(this,X,...h.at(-3),...h.at(-2),J,Ee)},as=function(){if(this.currentPath.length===0)return;const J=this.currentPath.at(-1);t(this,M).lineTo(...J)},os=function(J,Ee){Ce(this,s,null),J=Math.min(Math.max(J,0),this.canvas.width),Ee=Math.min(Math.max(Ee,0),this.canvas.height),ne(this,c,nn).call(this,J,Ee),ne(this,c,as).call(this);let Ie;if(this.currentPath.length!==1)Ie=ne(this,c,hs).call(this);else{const Z=[J,Ee];Ie=[[Z,Z.slice(),Z.slice(),Z]]}const z=t(this,M),h=this.currentPath;this.currentPath=[],Ce(this,M,new Path2D);const X=()=>{this.allRawPaths.push(h),this.paths.push(Ie),this.bezierPath2D.push(z),this.rebuild()},oe=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ne(this,c,pi).call(this),ne(this,c,gi).call(this)),ne(this,c,Ht).call(this))};this.addCommands({cmd:X,undo:oe,mustExec:!0})},ls=function(){if(!t(this,x))return;Ce(this,x,!1);const J=Math.ceil(this.thickness*this.parentScale),Ee=this.currentPath.slice(-3),Ie=Ee.map(X=>X[0]),z=Ee.map(X=>X[1]);Math.min(...Ie)-J,Math.max(...Ie)+J,Math.min(...z)-J,Math.max(...z)+J;const{ctx:h}=this;h.save(),h.clearRect(0,0,this.canvas.width,this.canvas.height);for(const X of this.bezierPath2D)h.stroke(X);h.stroke(t(this,M)),h.restore()},cs=function(J,Ee,Ie,z,h,X,oe){const Z=(Ee+z)/2,Le=(Ie+h)/2,De=(z+X)/2,Ge=(h+oe)/2;J.bezierCurveTo(Z+2*(z-Z)/3,Le+2*(h-Le)/3,De+2*(z-De)/3,Ge+2*(h-Ge)/3,De,Ge)},hs=function(){const J=this.currentPath;if(J.length<=2)return[[J[0],J[0],J.at(-1),J.at(-1)]];const Ee=[];let Ie,[z,h]=J[0];for(Ie=1;Ie<J.length-2;Ie++){const[Ve,Je]=J[Ie],[Ze,it]=J[Ie+1],pt=(Ve+Ze)/2,mt=(Je+it)/2,Xe=[z+2*(Ve-z)/3,h+2*(Je-h)/3],Be=[pt+2*(Ve-pt)/3,mt+2*(Je-mt)/3];Ee.push([[z,h],Xe,Be,[pt,mt]]),[z,h]=[pt,mt]}const[X,oe]=J[Ie],[Z,Le]=J[Ie+1],De=[z+2*(X-z)/3,h+2*(oe-h)/3],Ge=[Z+2*(X-Z)/3,Le+2*(oe-Le)/3];return Ee.push([[z,h],De,Ge,[Z,Le]]),Ee},Lt=function(){if(this.isEmpty()){ne(this,c,mi).call(this);return}ne(this,c,tn).call(this);const{canvas:J,ctx:Ee}=this;Ee.setTransform(1,0,0,1,0,0),Ee.clearRect(0,0,J.width,J.height),ne(this,c,mi).call(this);for(const Ie of this.bezierPath2D)Ee.stroke(Ie)},sn=function(J){this.canvas.removeEventListener("pointerleave",t(this,N)),this.canvas.removeEventListener("pointermove",t(this,H)),this.canvas.removeEventListener("pointerup",t(this,g)),this.canvas.addEventListener("pointerdown",t(this,u)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",O.noContextMenu)},10),ne(this,c,os).call(this,J.offsetX,J.offsetY),this.addToAnnotationStorage(),this.setInBackground()},pi=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",d.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(J=>{var Ee;return(Ee=this.canvas)==null?void 0:Ee.setAttribute("aria-label",J)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},gi=function(){Ce(this,F,new ResizeObserver(J=>{const Ee=J[0].contentRect;Ee.width&&Ee.height&&this.setDimensions(Ee.width,Ee.height)})),t(this,F).observe(this.div)},Ut=function(){if(!t(this,S))return;const[J,Ee]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*J),this.canvas.height=Math.ceil(this.height*Ee),ne(this,c,mi).call(this)},rn=function(J,Ee){const Ie=ne(this,c,_i).call(this),z=(J-Ie)/t(this,r),h=(Ee-Ie)/t(this,p);this.scaleFactor=Math.min(z,h)},mi=function(){const J=ne(this,c,_i).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+J,this.translationY*this.scaleFactor+J)},ye=new WeakSet,ds=function(J){const Ee=new Path2D;for(let Ie=0,z=J.length;Ie<z;Ie++){const[h,X,oe,Z]=J[Ie];Ie===0&&Ee.moveTo(...h),Ee.bezierCurveTo(X[0],X[1],oe[0],oe[1],Z[0],Z[1])}return Ee},an=function(J,Ee,Ie){const[z,h,X,oe]=Ee;switch(Ie){case 0:for(let Z=0,Le=J.length;Z<Le;Z+=2)J[Z]+=z,J[Z+1]=oe-J[Z+1];break;case 90:for(let Z=0,Le=J.length;Z<Le;Z+=2){const De=J[Z];J[Z]=J[Z+1]+z,J[Z+1]=De+h}break;case 180:for(let Z=0,Le=J.length;Z<Le;Z+=2)J[Z]=X-J[Z],J[Z+1]+=h;break;case 270:for(let Z=0,Le=J.length;Z<Le;Z+=2){const De=J[Z];J[Z]=X-J[Z+1],J[Z+1]=oe-De}break;default:throw new Error("Invalid rotation")}return J},us=function(J,Ee,Ie){const[z,h,X,oe]=Ee;switch(Ie){case 0:for(let Z=0,Le=J.length;Z<Le;Z+=2)J[Z]-=z,J[Z+1]=oe-J[Z+1];break;case 90:for(let Z=0,Le=J.length;Z<Le;Z+=2){const De=J[Z];J[Z]=J[Z+1]-h,J[Z+1]=De-z}break;case 180:for(let Z=0,Le=J.length;Z<Le;Z+=2)J[Z]=X-J[Z],J[Z+1]-=h;break;case 270:for(let Z=0,Le=J.length;Z<Le;Z+=2){const De=J[Z];J[Z]=oe-J[Z+1],J[Z+1]=X-De}break;default:throw new Error("Invalid rotation")}return J},fs=function(J,Ee,Ie,z){var Le,De;const h=[],X=this.thickness/2,oe=J*Ee+X,Z=J*Ie+X;for(const Ge of this.paths){const Ve=[],Je=[];for(let Ze=0,it=Ge.length;Ze<it;Ze++){const[pt,mt,Xe,Be]=Ge[Ze],Ue=J*pt[0]+oe,nt=J*pt[1]+Z,ft=J*mt[0]+oe,ut=J*mt[1]+Z,Se=J*Xe[0]+oe,We=J*Xe[1]+Z,et=J*Be[0]+oe,rt=J*Be[1]+Z;Ze===0&&(Ve.push(Ue,nt),Je.push(Ue,nt)),Ve.push(ft,ut,Se,We,et,rt),Je.push(ft,ut),Ze===it-1&&Je.push(et,rt)}h.push({bezier:ne(Le=Ye,ye,an).call(Le,Ve,z,this.rotation),points:ne(De=Ye,ye,an).call(De,Je,z,this.rotation)})}return h},on=function(){let J=1/0,Ee=-1/0,Ie=1/0,z=-1/0;for(const h of this.paths)for(const[X,oe,Z,Le]of h){const De=n.Util.bezierBoundingBox(...X,...oe,...Z,...Le);J=Math.min(J,De[0]),Ie=Math.min(Ie,De[1]),Ee=Math.max(Ee,De[2]),z=Math.max(z,De[3])}return[J,Ie,Ee,z]},_i=function(){return t(this,P)?Math.ceil(this.thickness*this.parentScale):0},Ht=function(J=!1){if(this.isEmpty())return;if(!t(this,P)){ne(this,c,Lt).call(this);return}const Ee=ne(this,c,on).call(this),Ie=ne(this,c,_i).call(this);Ce(this,r,Math.max(d.AnnotationEditor.MIN_SIZE,Ee[2]-Ee[0])),Ce(this,p,Math.max(d.AnnotationEditor.MIN_SIZE,Ee[3]-Ee[1]));const z=Math.ceil(Ie+t(this,r)*this.scaleFactor),h=Math.ceil(Ie+t(this,p)*this.scaleFactor),[X,oe]=this.parentDimensions;this.width=z/X,this.height=h/oe,this.setAspectRatio(z,h);const Z=this.translationX,Le=this.translationY;this.translationX=-Ee[0],this.translationY=-Ee[1],ne(this,c,Ut).call(this),ne(this,c,Lt).call(this),Ce(this,I,z),Ce(this,o,h),this.setDims(z,h);const De=J?Ie/this.scaleFactor/2:0;this.translate(Z-this.translationX-De,Le-this.translationY-De)},Me(Ye,ye),at(Ye,"_defaultColor",null),at(Ye,"_defaultOpacity",1),at(Ye,"_defaultThickness",1),at(Ye,"_type","ink");let E=Ye;e.InkEditor=E},(i,e,v)=>{var E,p,r,H,N,g,u,M,P,x,S,Yt,Kt,bi,ln,ps,gs,hn,vi,ms;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=v(1),d=v(4),re=v(6),O=v(29);const j=class j extends d.AnnotationEditor{constructor(_e){super({..._e,name:"stampEditor"});Me(this,S);Me(this,E,null);Me(this,p,null);Me(this,r,null);Me(this,H,null);Me(this,N,null);Me(this,g,null);Me(this,u,null);Me(this,M,null);Me(this,P,!1);Me(this,x,!1);Ce(this,H,_e.bitmapUrl),Ce(this,N,_e.bitmapFile)}static initialize(_e){d.AnnotationEditor.initialize(_e)}static get supportedTypes(){const _e=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",_e.map(be=>`image/${be}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(_e){return this.supportedTypes.includes(_e)}static paste(_e,be){be.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:_e.getAsFile()})}remove(){var _e,be;t(this,p)&&(Ce(this,E,null),this._uiManager.imageManager.deleteId(t(this,p)),(_e=t(this,g))==null||_e.remove(),Ce(this,g,null),(be=t(this,u))==null||be.disconnect(),Ce(this,u,null)),super.remove()}rebuild(){if(!this.parent){t(this,p)&&ne(this,S,bi).call(this);return}super.rebuild(),this.div!==null&&(t(this,p)&&ne(this,S,bi).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,r)||t(this,E)||t(this,H)||t(this,N))}get isResizable(){return!0}render(){if(this.div)return this.div;let _e,be;if(this.width&&(_e=this.x,be=this.y),super.render(),this.div.hidden=!0,t(this,E)?ne(this,S,ln).call(this):ne(this,S,bi).call(this),this.width){const[W,Pe]=this.parentDimensions;this.setAt(_e*W,be*Pe,this.width*W,this.height*Pe)}return this.div}static deserialize(_e,be,W){if(_e instanceof O.StampAnnotationElement)return null;const Pe=super.deserialize(_e,be,W),{rect:D,bitmapUrl:k,bitmapId:Te,isSvg:q,accessibilityData:m}=_e;Te&&W.imageManager.isValidId(Te)?Ce(Pe,p,Te):Ce(Pe,H,k),Ce(Pe,P,q);const[y,U]=Pe.pageDimensions;return Pe.width=(D[2]-D[0])/y,Pe.height=(D[3]-D[1])/U,m&&(Pe.altTextData=m),Pe}serialize(_e=!1,be=null){if(this.isEmpty())return null;const W={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,p),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,P),structTreeParentId:this._structTreeParentId};if(_e)return W.bitmapUrl=ne(this,S,vi).call(this,!0),W.accessibilityData=this.altTextData,W;const{decorative:Pe,altText:D}=this.altTextData;if(!Pe&&D&&(W.accessibilityData={type:"Figure",alt:D}),be===null)return W;be.stamps||(be.stamps=new Map);const k=t(this,P)?(W.rect[2]-W.rect[0])*(W.rect[3]-W.rect[1]):null;if(!be.stamps.has(t(this,p)))be.stamps.set(t(this,p),{area:k,serialized:W}),W.bitmap=ne(this,S,vi).call(this,!1);else if(t(this,P)){const Te=be.stamps.get(t(this,p));k>Te.area&&(Te.area=k,Te.serialized.bitmap.close(),Te.serialized.bitmap=ne(this,S,vi).call(this,!1))}return W}};E=new WeakMap,p=new WeakMap,r=new WeakMap,H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,S=new WeakSet,Yt=function(_e,be=!1){if(!_e){this.remove();return}Ce(this,E,_e.bitmap),be||(Ce(this,p,_e.id),Ce(this,P,_e.isSvg)),ne(this,S,ln).call(this)},Kt=function(){Ce(this,r,null),this._uiManager.enableWaiting(!1),t(this,g)&&this.div.focus()},bi=function(){if(t(this,p)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,p)).then(be=>ne(this,S,Yt).call(this,be,!0)).finally(()=>ne(this,S,Kt).call(this));return}if(t(this,H)){const be=t(this,H);Ce(this,H,null),this._uiManager.enableWaiting(!0),Ce(this,r,this._uiManager.imageManager.getFromUrl(be).then(W=>ne(this,S,Yt).call(this,W)).finally(()=>ne(this,S,Kt).call(this)));return}if(t(this,N)){const be=t(this,N);Ce(this,N,null),this._uiManager.enableWaiting(!0),Ce(this,r,this._uiManager.imageManager.getFromFile(be).then(W=>ne(this,S,Yt).call(this,W)).finally(()=>ne(this,S,Kt).call(this)));return}const _e=document.createElement("input");_e.type="file",_e.accept=j.supportedTypesStr,Ce(this,r,new Promise(be=>{_e.addEventListener("change",async()=>{if(!_e.files||_e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const W=await this._uiManager.imageManager.getFromFile(_e.files[0]);ne(this,S,Yt).call(this,W)}be()}),_e.addEventListener("cancel",()=>{this.remove(),be()})}).finally(()=>ne(this,S,Kt).call(this))),_e.click()},ln=function(){const{div:_e}=this;let{width:be,height:W}=t(this,E);const[Pe,D]=this.pageDimensions,k=.75;if(this.width)be=this.width*Pe,W=this.height*D;else if(be>k*Pe||W>k*D){const y=Math.min(k*Pe/be,k*D/W);be*=y,W*=y}const[Te,q]=this.parentDimensions;this.setDims(be*Te/Pe,W*q/D),this._uiManager.enableWaiting(!1);const m=Ce(this,g,document.createElement("canvas"));_e.append(m),_e.hidden=!1,ne(this,S,hn).call(this,be,W),ne(this,S,ms).call(this),t(this,x)||(this.parent.addUndoableEditor(this),Ce(this,x,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},ps=function(_e,be){var k;const[W,Pe]=this.parentDimensions;this.width=_e/W,this.height=be/Pe,this.setDims(_e,be),(k=this._initialOptions)!=null&&k.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,M)!==null&&clearTimeout(t(this,M)),Ce(this,M,setTimeout(()=>{Ce(this,M,null),ne(this,S,hn).call(this,_e,be)},200))},gs=function(_e,be){const{width:W,height:Pe}=t(this,E);let D=W,k=Pe,Te=t(this,E);for(;D>2*_e||k>2*be;){const q=D,m=k;D>2*_e&&(D=D>=16384?Math.floor(D/2)-1:Math.ceil(D/2)),k>2*be&&(k=k>=16384?Math.floor(k/2)-1:Math.ceil(k/2));const y=new OffscreenCanvas(D,k);y.getContext("2d").drawImage(Te,0,0,q,m,0,0,D,k),Te=y.transferToImageBitmap()}return Te},hn=function(_e,be){_e=Math.ceil(_e),be=Math.ceil(be);const W=t(this,g);if(!W||W.width===_e&&W.height===be)return;W.width=_e,W.height=be;const Pe=t(this,P)?t(this,E):ne(this,S,gs).call(this,_e,be),D=W.getContext("2d");D.filter=this._uiManager.hcmFilter,D.drawImage(Pe,0,0,Pe.width,Pe.height,0,0,_e,be)},vi=function(_e){if(_e){if(t(this,P)){const Pe=this._uiManager.imageManager.getSvgUrl(t(this,p));if(Pe)return Pe}const be=document.createElement("canvas");return{width:be.width,height:be.height}=t(this,E),be.getContext("2d").drawImage(t(this,E),0,0),be.toDataURL()}if(t(this,P)){const[be,W]=this.pageDimensions,Pe=Math.round(this.width*be*re.PixelsPerInch.PDF_TO_CSS_UNITS),D=Math.round(this.height*W*re.PixelsPerInch.PDF_TO_CSS_UNITS),k=new OffscreenCanvas(Pe,D);return k.getContext("2d").drawImage(t(this,E),0,0,t(this,E).width,t(this,E).height,0,0,Pe,D),k.transferToImageBitmap()}return structuredClone(t(this,E))},ms=function(){Ce(this,u,new ResizeObserver(_e=>{const be=_e[0].contentRect;be.width&&be.height&&ne(this,S,ps).call(this,be.width,be.height)})),t(this,u).observe(this.div)},at(j,"_type","stamp");let w=j;e.StampEditor=w}],__webpack_module_cache__={};function __w_pdfjs_require__(i){var e=__webpack_module_cache__[i];if(e!==void 0)return e.exports;var v=__webpack_module_cache__[i]={exports:{}};return __webpack_modules__[i](v,v.exports,__w_pdfjs_require__),v.exports}var __webpack_exports__={};return(()=>{var i=__webpack_exports__;Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(i,"AnnotationEditorLayer",{enumerable:!0,get:function(){return re.AnnotationEditorLayer}}),Object.defineProperty(i,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(i,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(i,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return O.AnnotationEditorUIManager}}),Object.defineProperty(i,"AnnotationLayer",{enumerable:!0,get:function(){return w.AnnotationLayer}}),Object.defineProperty(i,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(i,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(i,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(i,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(i,"GlobalWorkerOptions",{enumerable:!0,get:function(){return E.GlobalWorkerOptions}}),Object.defineProperty(i,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(i,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(i,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(i,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(i,"PDFDataRangeTransport",{enumerable:!0,get:function(){return v.PDFDataRangeTransport}}),Object.defineProperty(i,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(i,"PDFWorker",{enumerable:!0,get:function(){return v.PDFWorker}}),Object.defineProperty(i,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(i,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(i,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(i,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(i,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(i,"SVGGraphics",{enumerable:!0,get:function(){return v.SVGGraphics}}),Object.defineProperty(i,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(i,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(i,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(i,"XfaLayer",{enumerable:!0,get:function(){return p.XfaLayer}}),Object.defineProperty(i,"build",{enumerable:!0,get:function(){return v.build}}),Object.defineProperty(i,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(i,"getDocument",{enumerable:!0,get:function(){return v.getDocument}}),Object.defineProperty(i,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(i,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(i,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(i,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(i,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(i,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(i,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(i,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(i,"renderTextLayer",{enumerable:!0,get:function(){return d.renderTextLayer}}),Object.defineProperty(i,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(i,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(i,"updateTextLayer",{enumerable:!0,get:function(){return d.updateTextLayer}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return v.version}});var e=__w_pdfjs_require__(1),v=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),d=__w_pdfjs_require__(26),re=__w_pdfjs_require__(27),O=__w_pdfjs_require__(5),w=__w_pdfjs_require__(29),E=__w_pdfjs_require__(14),p=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,pdf_viewer={exports:{}};(function(i,e){(function(n,d){i.exports=n.pdfjsViewer=d()})(globalThis,()=>(()=>{var v=[,(O,w,E)=>{var be,W,Pe,D,_s,dn,un,bs,vs,ys,fn,Ss,As,yi,Qt,Wt,Es,pn,gn,Si,ws,mn,_n,Zt;Object.defineProperty(w,"__esModule",{value:!0}),w.PDFFindController=w.FindState=void 0;var p=E(2),r=E(3),H=E(4);const N={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};w.FindState=N;const g=250,u=-50,M=-400,P={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},x=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let S;const F=new RegExp("\\p{M}+","gu"),I=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),o=new RegExp("([^\\p{M}])\\p{M}*$","u"),s=new RegExp("^\\p{M}*([^\\p{M}])","u"),c=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,f=new Map,T="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",Y=new Map;let _=null,j=null;function fe(Ie){const z=[];let h;for(;(h=c.exec(Ie))!==null;){let{index:pt}=h;for(const mt of h[0]){let Xe=f.get(mt);Xe||(Xe=mt.normalize("NFD").length,f.set(mt,Xe)),z.push([Xe,pt++])}}let X;if(z.length===0&&_)X=_;else if(z.length>0&&j)X=j;else{const pt=Object.keys(P).join(""),mt=(0,r.getNormalizeWithNFKC)(),Ue=`([${pt}])|([${mt}])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;z.length===0?X=_=new RegExp(Ue+"|(\\u0000)","gum"):X=j=new RegExp(Ue+`|(${T})`,"gum")}const oe=[];for(;(h=F.exec(Ie))!==null;)oe.push([h[0].length,h.index]);let Z=Ie.normalize("NFD");const Le=[[0,0]];let De=0,Ge=0,Ve=0,Je=0,Ze=0,it=!1;return Z=Z.replace(X,(pt,mt,Xe,Be,Ue,nt,ft,ut,Se,We)=>{var et,rt,ot;if(We-=Je,mt){const tt=P[mt],ve=tt.length;for(let le=1;le<ve;le++)Le.push([We-Ve+le,Ve-le]);return Ve-=ve-1,tt}if(Xe){let tt=Y.get(Xe);tt||(tt=Xe.normalize("NFKC"),Y.set(Xe,tt));const ve=tt.length;for(let le=1;le<ve;le++)Le.push([We-Ve+le,Ve-le]);return Ve-=ve-1,tt}if(Be)return it=!0,We+Ze===((et=oe[De])==null?void 0:et[1])?++De:(Le.push([We-1-Ve+1,Ve-1]),Ve-=1,Je+=1),Le.push([We-Ve+1,Ve]),Je+=1,Ze+=1,Be.charAt(0);if(Ue){const tt=Ue.endsWith(`
`),ve=tt?Ue.length-2:Ue.length;it=!0;let le=ve;We+Ze===((rt=oe[De])==null?void 0:rt[1])&&(le-=oe[De][0],++De);for(let ke=1;ke<=le;ke++)Le.push([We-1-Ve+ke,Ve-ke]);return Ve-=le,Je+=le,tt?(We+=ve-1,Le.push([We-Ve+1,1+Ve]),Ve+=1,Je+=1,Ze+=1,Ue.slice(0,ve)):Ue}if(nt){const tt=nt.length-2;return Le.push([We-Ve+tt,1+Ve]),Ve+=1,Je+=1,Ze+=1,nt.slice(0,-2)}if(ft){const tt=ft.length-1;return Le.push([We-Ve+tt,Ve]),Je+=1,Ze+=1,ft.slice(0,-1)}if(ut)return Le.push([We-Ve+1,Ve-1]),Ve-=1,Je+=1,Ze+=1," ";if(We+Ze===((ot=z[Ge])==null?void 0:ot[1])){const tt=z[Ge][0]-1;++Ge;for(let ve=1;ve<=tt;ve++)Le.push([We-(Ve-ve),Ve-ve]);Ve-=tt,Je+=tt}return Se}),Le.push([Z.length,Ve]),[Z,Le,it]}function te(Ie,z,h){if(!Ie)return[z,h];const X=z,oe=z+h-1;let Z=(0,p.binarySearchFirstItem)(Ie,Je=>Je[0]>=X);Ie[Z][0]>X&&--Z;let Le=(0,p.binarySearchFirstItem)(Ie,Je=>Je[0]>=oe,Z);Ie[Le][0]>oe&&--Le;const De=X+Ie[Z][1],Ve=oe+Ie[Le][1]+1-De;return[De,Ve]}class _e{constructor({linkService:z,eventBus:h,updateMatchesCountOnProgress:X=!0}){Me(this,D);Me(this,be,null);Me(this,W,!0);Me(this,Pe,0);this._linkService=z,this._eventBus=h,Ce(this,W,X),this.onIsPageVisible=null,ne(this,D,dn).call(this),h._on("find",ne(this,D,_s).bind(this)),h._on("findbarclose",ne(this,D,ws).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return t(this,be)}setDocument(z){this._pdfDocument&&ne(this,D,dn).call(this),z&&(this._pdfDocument=z,this._firstPageCapability.resolve())}scrollMatchIntoView({element:z=null,selectedLeft:h=0,pageIndex:X=-1,matchIndex:oe=-1}){if(!this._scrollMatches||!z)return;if(oe===-1||oe!==this._selected.matchIdx)return;if(X===-1||X!==this._selected.pageIdx)return;this._scrollMatches=!1;const Z={top:u,left:h+M};(0,p.scrollIntoView)(z,Z,!0)}}be=new WeakMap,W=new WeakMap,Pe=new WeakMap,D=new WeakSet,_s=function(z){if(!z)return;z.phraseSearch===!1&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),typeof z.query=="string"&&(z.query=z.query.match(/\S+/g)));const h=this._pdfDocument,{type:X}=z;(t(this,be)===null||ne(this,D,bs).call(this,z))&&(this._dirtyMatch=!0),Ce(this,be,z),X!=="highlightallchange"&&ne(this,D,Zt).call(this,N.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||h&&this._pdfDocument!==h)return;ne(this,D,As).call(this);const oe=!this._highlightMatches,Z=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),X?this._dirtyMatch?ne(this,D,Wt).call(this):X==="again"?(ne(this,D,Wt).call(this),oe&&t(this,be).highlightAll&&ne(this,D,Qt).call(this)):X==="highlightallchange"?(Z?ne(this,D,Wt).call(this):this._highlightMatches=!0,ne(this,D,Qt).call(this)):ne(this,D,Wt).call(this):this._findTimeout=setTimeout(()=>{ne(this,D,Wt).call(this),this._findTimeout=null},g)})},dn=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],Ce(this,Pe,0),Ce(this,be,null),this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new H.PromiseCapability},un=function(){const{query:z}=t(this,be);return typeof z=="string"?(z!==this._rawQuery&&(this._rawQuery=z,[this._normalizedQuery]=fe(z)),this._normalizedQuery):(z||[]).filter(h=>!!h).map(h=>fe(h)[0])},bs=function(z){var Le;const h=z.query,X=t(this,be).query,oe=typeof h;if(oe!==typeof X)return!0;if(oe==="string"){if(h!==X)return!0}else if(JSON.stringify(h)!==JSON.stringify(X))return!0;switch(z.type){case"again":const De=this._selected.pageIdx+1,Ge=this._linkService;return De>=1&&De<=Ge.pagesCount&&De!==Ge.page&&!(((Le=this.onIsPageVisible)==null?void 0:Le.call(this,De))??!0);case"highlightallchange":return!1}return!0},vs=function(z,h,X){let oe=z.slice(0,h).match(o);if(oe){const Z=z.charCodeAt(h),Le=oe[1].charCodeAt(0);if((0,r.getCharacterType)(Z)===(0,r.getCharacterType)(Le))return!1}if(oe=z.slice(h+X).match(s),oe){const Z=z.charCodeAt(h+X-1),Le=oe[1].charCodeAt(0);if((0,r.getCharacterType)(Z)===(0,r.getCharacterType)(Le))return!1}return!0},ys=function(z,h,X,oe){const Z=this._pageMatches[X]=[],Le=this._pageMatchesLength[X]=[];if(!z)return;const De=this._pageDiffs[X];let Ge;for(;(Ge=z.exec(oe))!==null;){if(h&&!ne(this,D,vs).call(this,oe,Ge.index,Ge[0].length))continue;const[Ve,Je]=te(De,Ge.index,Ge[0].length);Je&&(Z.push(Ve),Le.push(Je))}},fn=function(z,h){const{matchDiacritics:X}=t(this,be);let oe=!1;z=z.replaceAll(I,(Le,De,Ge,Ve,Je,Ze)=>De?`[ ]*\\${De}[ ]*`:Ge?`[ ]*${Ge}[ ]*`:Ve?"[ ]+":X?Je||Ze:Je?x.has(Je.charCodeAt(0))?Je:"":h?(oe=!0,`${Ze}\\p{M}*`):Ze);const Z="[ ]*";return z.endsWith(Z)&&(z=z.slice(0,z.length-Z.length)),X&&h&&(S||(S=String.fromCharCode(...x)),oe=!0,z=`${z}(?=[${S}]|[^\\p{M}]|$)`),[oe,z]},Ss=function(z){let h=t(this,D,un);if(h.length===0)return;const{caseSensitive:X,entireWord:oe}=t(this,be),Z=this._pageContents[z],Le=this._hasDiacritics[z];let De=!1;typeof h=="string"?[De,h]=ne(this,D,fn).call(this,h,Le):h=h.sort().reverse().map(Je=>{const[Ze,it]=ne(this,D,fn).call(this,Je,Le);return De||(De=Ze),`(${it})`}).join("|");const Ge=`g${De?"u":""}${X?"":"i"}`;h=h?new RegExp(h,Ge):null,ne(this,D,ys).call(this,h,oe,z,Z),t(this,be).highlightAll&&ne(this,D,yi).call(this,z),this._resumePageIdx===z&&(this._resumePageIdx=null,ne(this,D,pn).call(this));const Ve=this._pageMatches[z].length;this._matchesCountTotal+=Ve,t(this,W)?Ve>0&&ne(this,D,_n).call(this):++Ot(this,Pe)._===this._linkService.pagesCount&&ne(this,D,_n).call(this)},As=function(){if(this._extractTextPromises.length>0)return;let z=Promise.resolve();const h={disableNormalization:!0};for(let X=0,oe=this._linkService.pagesCount;X<oe;X++){const Z=new H.PromiseCapability;this._extractTextPromises[X]=Z.promise,z=z.then(()=>this._pdfDocument.getPage(X+1).then(Le=>Le.getTextContent(h)).then(Le=>{const De=[];for(const Ge of Le.items)De.push(Ge.str),Ge.hasEOL&&De.push(`
`);[this._pageContents[X],this._pageDiffs[X],this._hasDiacritics[X]]=fe(De.join("")),Z.resolve()},Le=>{console.error(`Unable to get text content for page ${X+1}`,Le),this._pageContents[X]="",this._pageDiffs[X]=null,this._hasDiacritics[X]=!1,Z.resolve()}))}},yi=function(z){this._scrollMatches&&this._selected.pageIdx===z&&(this._linkService.page=z+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:z})},Qt=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},Wt=function(){const z=t(this,be).findPrevious,h=this._linkService.page-1,X=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=h,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,Ce(this,Pe,0),this._matchesCountTotal=0,ne(this,D,Qt).call(this);for(let Le=0;Le<X;Le++)this._pendingFindMatches.has(Le)||(this._pendingFindMatches.add(Le),this._extractTextPromises[Le].then(()=>{this._pendingFindMatches.delete(Le),ne(this,D,Ss).call(this,Le)}))}if(t(this,D,un).length===0){ne(this,D,Zt).call(this,N.FOUND);return}if(this._resumePageIdx)return;const Z=this._offset;if(this._pagesToSearch=X,Z.matchIdx!==null){const Le=this._pageMatches[Z.pageIdx].length;if(!z&&Z.matchIdx+1<Le||z&&Z.matchIdx>0){Z.matchIdx=z?Z.matchIdx-1:Z.matchIdx+1,ne(this,D,Si).call(this,!0);return}ne(this,D,gn).call(this,z)}ne(this,D,pn).call(this)},Es=function(z){const h=this._offset,X=z.length,oe=t(this,be).findPrevious;return X?(h.matchIdx=oe?X-1:0,ne(this,D,Si).call(this,!0),!0):(ne(this,D,gn).call(this,oe),h.wrapped&&(h.matchIdx=null,this._pagesToSearch<0)?(ne(this,D,Si).call(this,!1),!0):!1)},pn=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let z=null;do{const h=this._offset.pageIdx;if(z=this._pageMatches[h],!z){this._resumePageIdx=h;break}}while(!ne(this,D,Es).call(this,z))},gn=function(z){const h=this._offset,X=this._linkService.pagesCount;h.pageIdx=z?h.pageIdx-1:h.pageIdx+1,h.matchIdx=null,this._pagesToSearch--,(h.pageIdx>=X||h.pageIdx<0)&&(h.pageIdx=z?X-1:0,h.wrapped=!0)},Si=function(z=!1){let h=N.NOT_FOUND;const X=this._offset.wrapped;if(this._offset.wrapped=!1,z){const oe=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,h=X?N.WRAPPED:N.FOUND,oe!==-1&&oe!==this._selected.pageIdx&&ne(this,D,yi).call(this,oe)}ne(this,D,Zt).call(this,h,t(this,be).findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,ne(this,D,yi).call(this,this._selected.pageIdx))},ws=function(z){const h=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||h&&this._pdfDocument!==h||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),ne(this,D,Zt).call(this,N.FOUND),this._highlightMatches=!1,ne(this,D,Qt).call(this))})},mn=function(){var Z;const{pageIdx:z,matchIdx:h}=this._selected;let X=0,oe=this._matchesCountTotal;if(h!==-1){for(let Le=0;Le<z;Le++)X+=((Z=this._pageMatches[Le])==null?void 0:Z.length)||0;X+=h+1}return(X<1||X>oe)&&(X=oe=0),{current:X,total:oe}},_n=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:ne(this,D,mn).call(this)})},Zt=function(z,h=!1){var X;!t(this,W)&&(t(this,Pe)!==this._linkService.pagesCount||z===N.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:z,previous:h,matchesCount:ne(this,D,mn).call(this),rawQuery:((X=t(this,be))==null?void 0:X.query)??null})},w.PDFFindController=_e},(O,w)=>{var Oe,Fe,J,Ee,Ie;Object.defineProperty(w,"__esModule",{value:!0}),w.animationStarted=w.VERTICAL_PADDING=w.UNKNOWN_SCALE=w.TextLayerMode=w.SpreadMode=w.SidebarView=w.ScrollMode=w.SCROLLBAR_PADDING=w.RenderingStates=w.ProgressBar=w.PresentationModeState=w.OutputScale=w.MIN_SCALE=w.MAX_SCALE=w.MAX_AUTO_SCALE=w.DEFAULT_SCALE_VALUE=w.DEFAULT_SCALE_DELTA=w.DEFAULT_SCALE=w.CursorTool=w.AutoPrintRegExp=void 0,w.apiPageLayoutToViewerModes=He,w.apiPageModeToSidebarView=$e,w.approximateFraction=be,w.backtrackBeforeAllVisibleElements=D,w.binarySearchFirstItem=_e,w.docStyle=void 0,w.getActiveOrFocusedElement=Ne,w.getPageSizeInches=Pe,w.getVisibleElements=k,w.isPortraitOrientation=Ae,w.isValidRotation=m,w.isValidScrollMode=y,w.isValidSpreadMode=U,w.normalizeWheelEventDelta=q,w.normalizeWheelEventDirection=Te,w.parseQueryString=j,w.removeNullCharacters=te,w.roundToDivide=W,w.scrollIntoView=Y,w.toggleCheckedBtn=qe,w.toggleExpandedBtn=Ye,w.watchScroll=_;const E="auto";w.DEFAULT_SCALE_VALUE=E;const p=1;w.DEFAULT_SCALE=p;const r=1.1;w.DEFAULT_SCALE_DELTA=r;const H=.1;w.MIN_SCALE=H;const N=10;w.MAX_SCALE=N;const g=0;w.UNKNOWN_SCALE=g;const u=1.25;w.MAX_AUTO_SCALE=u;const M=40;w.SCROLLBAR_PADDING=M;const P=5;w.VERTICAL_PADDING=P;const x={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};w.RenderingStates=x;const S={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};w.PresentationModeState=S;const F={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};w.SidebarView=F;const I={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};w.TextLayerMode=I;const o={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};w.ScrollMode=o;const s={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};w.SpreadMode=s;const c={SELECT:0,HAND:1,ZOOM:2};w.CursorTool=c;const f=/\bprint\s*\(/;w.AutoPrintRegExp=f;class T{constructor(){const h=window.devicePixelRatio||1;this.sx=h,this.sy=h}get scaled(){return this.sx!==1||this.sy!==1}}w.OutputScale=T;function Y(z,h,X=!1){let oe=z.offsetParent;if(!oe){console.error("offsetParent is not set -- cannot scroll");return}let Z=z.offsetTop+z.clientTop,Le=z.offsetLeft+z.clientLeft;for(;oe.clientHeight===oe.scrollHeight&&oe.clientWidth===oe.scrollWidth||X&&(oe.classList.contains("markedContent")||getComputedStyle(oe).overflow==="hidden");)if(Z+=oe.offsetTop,Le+=oe.offsetLeft,oe=oe.offsetParent,!oe)return;h&&(h.top!==void 0&&(Z+=h.top),h.left!==void 0&&(Le+=h.left,oe.scrollLeft=Le)),oe.scrollTop=Z}function _(z,h){const X=function(Le){Z||(Z=window.requestAnimationFrame(function(){Z=null;const Ge=z.scrollLeft,Ve=oe.lastX;Ge!==Ve&&(oe.right=Ge>Ve),oe.lastX=Ge;const Je=z.scrollTop,Ze=oe.lastY;Je!==Ze&&(oe.down=Je>Ze),oe.lastY=Je,h(oe)}))},oe={right:!0,down:!0,lastX:z.scrollLeft,lastY:z.scrollTop,_eventHandler:X};let Z=null;return z.addEventListener("scroll",X,!0),oe}function j(z){const h=new Map;for(const[X,oe]of new URLSearchParams(z))h.set(X.toLowerCase(),oe);return h}const fe=/[\x01-\x1F]/g;function te(z,h=!1){return typeof z!="string"?(console.error("The argument must be a string."),z):(h&&(z=z.replaceAll(fe," ")),z.replaceAll("\0",""))}function _e(z,h,X=0){let oe=X,Z=z.length-1;if(Z<0||!h(z[Z]))return z.length;if(h(z[oe]))return oe;for(;oe<Z;){const Le=oe+Z>>1,De=z[Le];h(De)?Z=Le:oe=Le+1}return oe}function be(z){if(Math.floor(z)===z)return[z,1];const h=1/z,X=8;if(h>X)return[1,X];if(Math.floor(h)===h)return[1,h];const oe=z>1?h:z;let Z=0,Le=1,De=1,Ge=1;for(;;){const Je=Z+De,Ze=Le+Ge;if(Ze>X)break;oe<=Je/Ze?(De=Je,Ge=Ze):(Z=Je,Le=Ze)}let Ve;return oe-Z/Le<De/Ge-oe?Ve=oe===z?[Z,Le]:[Le,Z]:Ve=oe===z?[De,Ge]:[Ge,De],Ve}function W(z,h){const X=z%h;return X===0?z:Math.round(z-X+h)}function Pe({view:z,userUnit:h,rotate:X}){const[oe,Z,Le,De]=z,Ge=X%180!==0,Ve=(Le-oe)/72*h,Je=(De-Z)/72*h;return{width:Ge?Je:Ve,height:Ge?Ve:Je}}function D(z,h,X){if(z<2)return z;let oe=h[z].div,Z=oe.offsetTop+oe.clientTop;Z>=X&&(oe=h[z-1].div,Z=oe.offsetTop+oe.clientTop);for(let Le=z-2;Le>=0&&(oe=h[Le].div,!(oe.offsetTop+oe.clientTop+oe.clientHeight<=Z));--Le)z=Le;return z}function k({scrollEl:z,views:h,sortByVisibility:X=!1,horizontal:oe=!1,rtl:Z=!1}){const Le=z.scrollTop,De=Le+z.clientHeight,Ge=z.scrollLeft,Ve=Ge+z.clientWidth;function Je(ft){const ut=ft.div;return ut.offsetTop+ut.clientTop+ut.clientHeight>Le}function Ze(ft){const ut=ft.div,Se=ut.offsetLeft+ut.clientLeft,We=Se+ut.clientWidth;return Z?Se<Ve:We>Ge}const it=[],pt=new Set,mt=h.length;let Xe=_e(h,oe?Ze:Je);Xe>0&&Xe<mt&&!oe&&(Xe=D(Xe,h,Le));let Be=oe?Ve:-1;for(let ft=Xe;ft<mt;ft++){const ut=h[ft],Se=ut.div,We=Se.offsetLeft+Se.clientLeft,et=Se.offsetTop+Se.clientTop,rt=Se.clientWidth,ot=Se.clientHeight,tt=We+rt,ve=et+ot;if(Be===-1)ve>=De&&(Be=ve);else if((oe?We:et)>Be)break;if(ve<=Le||et>=De||tt<=Ge||We>=Ve)continue;const le=Math.max(0,Le-et)+Math.max(0,ve-De),ke=Math.max(0,Ge-We)+Math.max(0,tt-Ve),je=(ot-le)/ot,ze=(rt-ke)/rt,Ke=je*ze*100|0;it.push({id:ut.id,x:We,y:et,view:ut,percent:Ke,widthPercent:ze*100|0}),pt.add(ut.id)}const Ue=it[0],nt=it.at(-1);return X&&it.sort(function(ft,ut){const Se=ft.percent-ut.percent;return Math.abs(Se)>.001?-Se:ft.id-ut.id}),{first:Ue,last:nt,views:it,ids:pt}}function Te(z){let h=Math.hypot(z.deltaX,z.deltaY);const X=Math.atan2(z.deltaY,z.deltaX);return-.25*Math.PI<X&&X<.75*Math.PI&&(h=-h),h}function q(z){const h=z.deltaMode;let X=Te(z);const oe=30,Z=30;return h===WheelEvent.DOM_DELTA_PIXEL?X/=oe*Z:h===WheelEvent.DOM_DELTA_LINE&&(X/=Z),X}function m(z){return Number.isInteger(z)&&z%90===0}function y(z){return Number.isInteger(z)&&Object.values(o).includes(z)&&z!==o.UNKNOWN}function U(z){return Number.isInteger(z)&&Object.values(s).includes(z)&&z!==s.UNKNOWN}function Ae(z){return z.width<=z.height}const ye=new Promise(function(z){window.requestAnimationFrame(z)});w.animationStarted=ye;const Q=document.documentElement.style;w.docStyle=Q;function we(z,h,X){return Math.min(Math.max(z,h),X)}class Re{constructor(h){Me(this,Oe,null);Me(this,Fe,null);Me(this,J,0);Me(this,Ee,null);Me(this,Ie,!0);Ce(this,Oe,h.classList),Ce(this,Ee,h.style)}get percent(){return t(this,J)}set percent(h){if(Ce(this,J,we(h,0,100)),isNaN(h)){t(this,Oe).add("indeterminate");return}t(this,Oe).remove("indeterminate"),t(this,Ee).setProperty("--progressBar-percent",`${t(this,J)}%`)}setWidth(h){if(!h)return;const oe=h.parentNode.offsetWidth-h.offsetWidth;oe>0&&t(this,Ee).setProperty("--progressBar-end-offset",`${oe}px`)}setDisableAutoFetch(h=5e3){isNaN(t(this,J))||(t(this,Fe)&&clearTimeout(t(this,Fe)),this.show(),Ce(this,Fe,setTimeout(()=>{Ce(this,Fe,null),this.hide()},h)))}hide(){t(this,Ie)&&(Ce(this,Ie,!1),t(this,Oe).add("hidden"))}show(){t(this,Ie)||(Ce(this,Ie,!0),t(this,Oe).remove("hidden"))}}Oe=new WeakMap,Fe=new WeakMap,J=new WeakMap,Ee=new WeakMap,Ie=new WeakMap,w.ProgressBar=Re;function Ne(){let z=document,h=z.activeElement||z.querySelector(":focus");for(;h!=null&&h.shadowRoot;)z=h.shadowRoot,h=z.activeElement||z.querySelector(":focus");return h}function He(z){let h=o.VERTICAL,X=s.NONE;switch(z){case"SinglePage":h=o.PAGE;break;case"OneColumn":break;case"TwoPageLeft":h=o.PAGE;case"TwoColumnLeft":X=s.ODD;break;case"TwoPageRight":h=o.PAGE;case"TwoColumnRight":X=s.EVEN;break}return{scrollMode:h,spreadMode:X}}function $e(z){switch(z){case"UseNone":return F.NONE;case"UseThumbs":return F.THUMBS;case"UseOutlines":return F.OUTLINE;case"UseAttachments":return F.ATTACHMENTS;case"UseOC":return F.LAYERS}return F.NONE}function qe(z,h,X=null){z.classList.toggle("toggled",h),z.setAttribute("aria-checked",h),X==null||X.classList.toggle("hidden",!h)}function Ye(z,h,X=null){z.classList.toggle("toggled",h),z.setAttribute("aria-expanded",h),X==null||X.classList.toggle("hidden",!h)}},(O,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.CharacterType=void 0,w.getCharacterType=F,w.getNormalizeWithNFKC=o;const E={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};w.CharacterType=E;function p(s){return s<11904}function r(s){return(s&65408)===0}function H(s){return s>=97&&s<=122||s>=65&&s<=90}function N(s){return s>=48&&s<=57}function g(s){return s===32||s===9||s===13||s===10}function u(s){return s>=13312&&s<=40959||s>=63744&&s<=64255}function M(s){return s>=12448&&s<=12543}function P(s){return s>=12352&&s<=12447}function x(s){return s>=65376&&s<=65439}function S(s){return(s&65408)===3584}function F(s){return p(s)?r(s)?g(s)?E.SPACE:H(s)||N(s)||s===95?E.ALPHA_LETTER:E.PUNCT:S(s)?E.THAI_LETTER:s===160?E.SPACE:E.ALPHA_LETTER:u(s)?E.HAN_LETTER:M(s)?E.KATAKANA_LETTER:P(s)?E.HIRAGANA_LETTER:x(s)?E.HALFWIDTH_KATAKANA_LETTER:E.ALPHA_LETTER}let I;function o(){return I||(I=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦"),I}},O=>{O.exports=globalThis.pdfjsLib},(O,w,E)=>{var M,P,bn,S,Ps;Object.defineProperty(w,"__esModule",{value:!0}),w.SimpleLinkService=w.PDFLinkService=w.LinkTarget=void 0;var p=E(2);const r="noopener noreferrer nofollow",H={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};w.LinkTarget=H;function N(o,{url:s,target:c,rel:f,enabled:T=!0}={}){if(!s||typeof s!="string")throw new Error('A valid "url" parameter must provided.');T?o.href=o.title=s:(o.href="",o.title=`Disabled: ${s}`,o.onclick=()=>!1);let Y="";switch(c){case H.NONE:break;case H.SELF:Y="_self";break;case H.BLANK:Y="_blank";break;case H.PARENT:Y="_parent";break;case H.TOP:Y="_top";break}o.target=Y,o.rel=typeof f=="string"?f:r}const I=class I{constructor({eventBus:s,externalLinkTarget:c=null,externalLinkRel:f=null,ignoreDestinationZoom:T=!1}={}){Me(this,P);Me(this,M,new Map);this.eventBus=s,this.externalLinkTarget=c,this.externalLinkRel=f,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=T,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(s,c=null){this.baseUrl=c,this.pdfDocument=s,t(this,M).clear()}setViewer(s){this.pdfViewer=s}setHistory(s){this.pdfHistory=s}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(s){this.pdfViewer.currentPageNumber=s}get rotation(){return this.pdfViewer.pagesRotation}set rotation(s){this.pdfViewer.pagesRotation=s}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}async goToDestination(s){if(!this.pdfDocument)return;let c,f;if(typeof s=="string"?(c=s,f=await this.pdfDocument.getDestination(s)):(c=null,f=await s),!Array.isArray(f)){console.error(`PDFLinkService.goToDestination: "${f}" is not a valid destination array, for dest="${s}".`);return}ne(this,P,bn).call(this,s,c,f)}goToPage(s){if(!this.pdfDocument)return;const c=typeof s=="string"&&this.pdfViewer.pageLabelToPageNumber(s)||s|0;if(!(Number.isInteger(c)&&c>0&&c<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${s}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(c)),this.pdfViewer.scrollPageIntoView({pageNumber:c})}addLinkAttributes(s,c,f=!1){N(s,{url:c,target:f?H.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(s){if(typeof s=="string"){if(s.length>0)return this.getAnchorUrl("#"+escape(s))}else if(Array.isArray(s)){const c=JSON.stringify(s);if(c.length>0)return this.getAnchorUrl("#"+escape(c))}return this.getAnchorUrl("")}getAnchorUrl(s){return this.baseUrl?this.baseUrl+s:s}setHash(s){var T;if(!this.pdfDocument)return;let c,f;if(s.includes("=")){const Y=(0,p.parseQueryString)(s);if(Y.has("search")){const _=Y.get("search").replaceAll('"',""),j=Y.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:j?_:_.match(/\S+/g)})}if(Y.has("page")&&(c=Y.get("page")|0||1),Y.has("zoom")){const _=Y.get("zoom").split(","),j=_[0],fe=parseFloat(j);j.includes("Fit")?j==="Fit"||j==="FitB"?f=[null,{name:j}]:j==="FitH"||j==="FitBH"||j==="FitV"||j==="FitBV"?f=[null,{name:j},_.length>1?_[1]|0:null]:j==="FitR"?_.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):f=[null,{name:j},_[1]|0,_[2]|0,_[3]|0,_[4]|0]:console.error(`PDFLinkService.setHash: "${j}" is not a valid zoom value.`):f=[null,{name:"XYZ"},_.length>1?_[1]|0:null,_.length>2?_[2]|0:null,fe?fe/100:j]}f?this.pdfViewer.scrollPageIntoView({pageNumber:c||this.page,destArray:f,allowNegativeOffset:!0}):c&&(this.page=c),Y.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:Y.get("pagemode")}),Y.has("nameddest")&&this.goToDestination(Y.get("nameddest"))}else{f=unescape(s);try{f=JSON.parse(f),Array.isArray(f)||(f=f.toString())}catch{}if(typeof f=="string"||ne(T=I,S,Ps).call(T,f)){this.goToDestination(f);return}console.error(`PDFLinkService.setHash: "${unescape(s)}" is not a valid destination.`)}}executeNamedAction(s){var c,f;switch(s){case"GoBack":(c=this.pdfHistory)==null||c.back();break;case"GoForward":(f=this.pdfHistory)==null||f.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:s})}async executeSetOCGState(s){const c=this.pdfDocument,f=await this.pdfViewer.optionalContentConfigPromise;if(c!==this.pdfDocument)return;let T;for(const Y of s.state){switch(Y){case"ON":case"OFF":case"Toggle":T=Y;continue}switch(T){case"ON":f.setVisibility(Y,!0);break;case"OFF":f.setVisibility(Y,!1);break;case"Toggle":const _=f.getGroup(Y);_&&f.setVisibility(Y,!_.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(f)}cachePageRef(s,c){if(!c)return;const f=c.gen===0?`${c.num}R`:`${c.num}R${c.gen}`;t(this,M).set(f,s)}_cachedPageNumber(s){if(!s)return null;const c=s.gen===0?`${s.num}R`:`${s.num}R${s.gen}`;return t(this,M).get(c)||null}};M=new WeakMap,P=new WeakSet,bn=function(s,c=null,f){const T=f[0];let Y;if(typeof T=="object"&&T!==null){if(Y=this._cachedPageNumber(T),!Y){this.pdfDocument.getPageIndex(T).then(_=>{this.cachePageRef(_+1,T),ne(this,P,bn).call(this,s,c,f)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${T}" is not a valid page reference, for dest="${s}".`)});return}}else if(Number.isInteger(T))Y=T+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${T}" is not a valid destination reference, for dest="${s}".`);return}if(!Y||Y<1||Y>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${Y}" is not a valid page number, for dest="${s}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:c,explicitDest:f,pageNumber:Y})),this.pdfViewer.scrollPageIntoView({pageNumber:Y,destArray:f,ignoreDestinationZoom:this._ignoreDestinationZoom})},S=new WeakSet,Ps=function(s){if(!Array.isArray(s))return!1;const c=s.length;if(c<2)return!1;const f=s[0];if(!(typeof f=="object"&&Number.isInteger(f.num)&&Number.isInteger(f.gen))&&!(Number.isInteger(f)&&f>=0))return!1;const T=s[1];if(!(typeof T=="object"&&typeof T.name=="string"))return!1;let Y=!0;switch(T.name){case"XYZ":if(c!==5)return!1;break;case"Fit":case"FitB":return c===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c!==3)return!1;break;case"FitR":if(c!==6)return!1;Y=!1;break;default:return!1}for(let _=2;_<c;_++){const j=s[_];if(!(typeof j=="number"||Y&&j===null))return!1}return!0},Me(I,S);let g=I;w.PDFLinkService=g;class u{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(s){}get rotation(){return 0}set rotation(s){}get isInPresentationMode(){return!1}async goToDestination(s){}goToPage(s){}addLinkAttributes(s,c,f=!1){N(s,{url:c,enabled:this.externalLinkEnabled})}getDestinationHash(s){return"#"}getAnchorUrl(s){return"#"}setHash(s){}executeNamedAction(s){}executeSetOCGState(s){}cachePageRef(s,c){}}w.SimpleLinkService=u},(O,w,E)=>{var g,u,vn;Object.defineProperty(w,"__esModule",{value:!0}),w.AnnotationLayerBuilder=void 0;var p=E(4),r=E(7),H=E(2);class N{constructor({pageDiv:x,pdfPage:S,linkService:F,downloadManager:I,annotationStorage:o=null,imageResourcesPath:s="",renderForms:c=!0,l10n:f=r.NullL10n,enableScripting:T=!1,hasJSActionsPromise:Y=null,fieldObjectsPromise:_=null,annotationCanvasMap:j=null,accessibilityManager:fe=null}){Me(this,u);Me(this,g,null);this.pageDiv=x,this.pdfPage=S,this.linkService=F,this.downloadManager=I,this.imageResourcesPath=s,this.renderForms=c,this.l10n=f,this.annotationStorage=o,this.enableScripting=T,this._hasJSActionsPromise=Y||Promise.resolve(!1),this._fieldObjectsPromise=_||Promise.resolve(null),this._annotationCanvasMap=j,this._accessibilityManager=fe,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=F.eventBus}async render(x,S="display"){var c;if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:x.clone({dontFlip:!0})});return}const[F,I,o]=await Promise.all([this.pdfPage.getAnnotations({intent:S}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const s=this.div=document.createElement("div");if(s.className="annotationLayer",this.pageDiv.append(s),F.length===0){this.hide();return}this.annotationLayer=new p.AnnotationLayer({div:s,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,l10n:this.l10n,page:this.pdfPage,viewport:x.clone({dontFlip:!0})}),await this.annotationLayer.render({annotations:F,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:I,fieldObjects:o}),this.linkService.isInPresentationMode&&ne(this,u,vn).call(this,H.PresentationModeState.FULLSCREEN),t(this,g)||(Ce(this,g,f=>{ne(this,u,vn).call(this,f.state)}),(c=this._eventBus)==null||c._on("presentationmodechanged",t(this,g)))}cancel(){var x;this._cancelled=!0,t(this,g)&&((x=this._eventBus)==null||x._off("presentationmodechanged",t(this,g)),Ce(this,g,null))}hide(){this.div&&(this.div.hidden=!0)}}g=new WeakMap,u=new WeakSet,vn=function(x){if(!this.div)return;let S=!1;switch(x){case H.PresentationModeState.FULLSCREEN:S=!0;break;case H.PresentationModeState.NORMAL:break;default:return}for(const F of this.div.childNodes)F.hasAttribute("data-internal-link")||(F.inert=S)},w.AnnotationLayerBuilder=N},(O,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.NullL10n=void 0,w.getL10nFallback=p;const E={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};E.print_progress_percent="{{progress}}%";function p(N,g){switch(N){case"find_match_count":N=`find_match_count[${g.total===1?"one":"other"}]`;break;case"find_match_count_limit":N=`find_match_count_limit[${g.limit===1?"one":"other"}]`;break}return E[N]||""}function r(N,g){return g?N.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(u,M)=>M in g?g[M]:"{{"+M+"}}"):N}const H={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(N,g=null,u=p(N,g)){return r(u,g)},async translate(N){}};w.NullL10n=H},(O,w,E)=>{var N;Object.defineProperty(w,"__esModule",{value:!0}),w.DownloadManager=void 0;var p=E(4);function r(g,u){const M=document.createElement("a");if(!M.click)throw new Error('DownloadManager: "a.click()" is not supported.');M.href=g,M.target="_parent","download"in M&&(M.download=u),(document.body||document.documentElement).append(M),M.click(),M.remove()}class H{constructor(){Me(this,N,new WeakMap)}downloadUrl(u,M,P){if(!(0,p.createValidAbsoluteUrl)(u,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${u}`);return}r(u+"#pdfjs.action=download",M)}downloadData(u,M,P){const x=URL.createObjectURL(new Blob([u],{type:P}));r(x,M)}openOrDownloadData(u,M,P){const S=(0,p.isPdfFile)(P)?"application/pdf":"";return this.downloadData(M,P,S),!1}download(u,M,P,x){const S=URL.createObjectURL(u);r(S,P)}}N=new WeakMap,w.DownloadManager=H},(O,w)=>{var N;Object.defineProperty(w,"__esModule",{value:!0}),w.WaitOnType=w.EventBus=w.AutomationEventBus=void 0,w.waitOnEventOrTimeout=p;const E={EVENT:"event",TIMEOUT:"timeout"};w.WaitOnType=E;function p({target:g,name:u,delay:M=0}){return new Promise(function(P,x){if(typeof g!="object"||!(u&&typeof u=="string")||!(Number.isInteger(M)&&M>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function S(s){g instanceof r?g._off(u,F):g.removeEventListener(u,F),o&&clearTimeout(o),P(s)}const F=S.bind(null,E.EVENT);g instanceof r?g._on(u,F):g.addEventListener(u,F);const I=S.bind(null,E.TIMEOUT),o=setTimeout(I,M)})}class r{constructor(){Me(this,N,Object.create(null))}on(u,M,P=null){this._on(u,M,{external:!0,once:P==null?void 0:P.once})}off(u,M,P=null){this._off(u,M,{external:!0,once:P==null?void 0:P.once})}dispatch(u,M){const P=t(this,N)[u];if(!P||P.length===0)return;let x;for(const{listener:S,external:F,once:I}of P.slice(0)){if(I&&this._off(u,S),F){(x||(x=[])).push(S);continue}S(M)}if(x){for(const S of x)S(M);x=null}}_on(u,M,P=null){var S;((S=t(this,N))[u]||(S[u]=[])).push({listener:M,external:(P==null?void 0:P.external)===!0,once:(P==null?void 0:P.once)===!0})}_off(u,M,P=null){const x=t(this,N)[u];if(x){for(let S=0,F=x.length;S<F;S++)if(x[S].listener===M){x.splice(S,1);return}}}}N=new WeakMap,w.EventBus=r;class H extends r{dispatch(u,M){throw new Error("Not implemented: AutomationEventBus.dispatch")}}w.AutomationEventBus=H},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.GenericL10n=void 0,E(11);var p=E(7);const r={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function H(g){return r[g==null?void 0:g.toLowerCase()]||g}class N{constructor(u){const{webL10n:M}=document;this._lang=u,this._ready=new Promise((P,x)=>{M.setLanguage(H(u),()=>{P(M)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(u,M=null,P=(0,p.getL10nFallback)(u,M)){return(await this._ready).get(u,M,P)}async translate(u){return(await this._ready).translate(u)}}w.GenericL10n=N},()=>{document.webL10n=function(O,w){var E={},p="",r="textContent",H="",N={},g="loading",u=!0;function M(){return w.querySelectorAll('link[type="application/l10n"]')}function P(){var te=w.querySelector('script[type="application/l10n"]');return te?JSON.parse(te.innerHTML):null}function x(te){return te?te.querySelectorAll("*[data-l10n-id]"):[]}function S(te){if(!te)return{};var _e=te.getAttribute("data-l10n-id"),be=te.getAttribute("data-l10n-args"),W={};if(be)try{W=JSON.parse(be)}catch{console.warn("could not parse arguments for #"+_e)}return{id:_e,args:W}}function F(te,_e,be){_e=_e||function(D){},be=be||function(){};var W=new XMLHttpRequest;W.open("GET",te,u),W.overrideMimeType&&W.overrideMimeType("text/plain; charset=utf-8"),W.onreadystatechange=function(){W.readyState==4&&(W.status==200||W.status===0?_e(W.responseText):be())},W.onerror=be,W.ontimeout=be;try{W.send(null)}catch{be()}}function I(te,_e,be,W){var Pe=te.replace(/[^\/]*$/,"")||"./";function D(Te){return Te.lastIndexOf("\\")<0?Te:Te.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function k(Te,q){var m={},y=/^\s*|\s*$/,U=/^\s*#|^\s*$/,Ae=/^\s*\[(.*)\]\s*$/,ye=/^\s*@import\s+url\((.*)\)\s*$/i,Q=/^([^=\s]*)\s*=\s*(.+)$/;function we(Ne,He,$e){var qe=Ne.replace(y,"").split(/[\r\n]+/),Ye="*",Oe=_e.split("-",1)[0],Fe=!1,J="";function Ee(){for(;;){if(!qe.length){$e();return}var Ie=qe.shift();if(!U.test(Ie)){if(He){if(J=Ae.exec(Ie),J){Ye=J[1].toLowerCase(),Fe=Ye!=="*"&&Ye!==_e&&Ye!==Oe;continue}else if(Fe)continue;if(J=ye.exec(Ie),J){Re(Pe+J[1],Ee);return}}var z=Ie.match(Q);z&&z.length==3&&(m[z[1]]=D(z[2]))}}}Ee()}function Re(Ne,He){F(Ne,function($e){we($e,!1,He)},function(){console.warn(Ne+" not found."),He()})}we(Te,!0,function(){q(m)})}F(te,function(Te){p+=Te,k(Te,function(q){for(var m in q){var y,U,Ae=m.lastIndexOf(".");Ae>0?(y=m.substring(0,Ae),U=m.substring(Ae+1)):(y=m,U=r),E[y]||(E[y]={}),E[y][U]=q[m]}be&&be()})},W)}function o(te,_e){te&&(te=te.toLowerCase()),_e=_e||function(){},s(),H=te;var be=M(),W=be.length;if(W===0){var Pe=P();if(Pe&&Pe.locales&&Pe.default_locale){if(console.log("using the embedded JSON directory, early way out"),E=Pe.locales[te],!E){var D=Pe.default_locale.toLowerCase();for(var k in Pe.locales)if(k=k.toLowerCase(),k===te){E=Pe.locales[te];break}else k===D&&(E=Pe.locales[D])}_e()}else console.log("no resource to load, early way out");g="complete";return}var Te=null,q=0;Te=function(){q++,q>=W&&(_e(),g="complete")};function m(Ae){var ye=Ae.href;this.load=function(Q,we){I(ye,Q,we,function(){console.warn(ye+" not found."),console.warn('"'+Q+'" resource not found'),H="",we()})}}for(var y=0;y<W;y++){var U=new m(be[y]);U.load(te,Te)}}function s(){E={},p="",H=""}function c(te){var _e={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function be(k,Te){return Te.indexOf(k)!==-1}function W(k,Te,q){return Te<=k&&k<=q}var Pe={0:function(k){return"other"},1:function(k){return W(k%100,3,10)?"few":k===0?"zero":W(k%100,11,99)?"many":k==2?"two":k==1?"one":"other"},2:function(k){return k!==0&&k%10===0?"many":k==2?"two":k==1?"one":"other"},3:function(k){return k==1?"one":"other"},4:function(k){return W(k,0,1)?"one":"other"},5:function(k){return W(k,0,2)&&k!=2?"one":"other"},6:function(k){return k===0?"zero":k%10==1&&k%100!=11?"one":"other"},7:function(k){return k==2?"two":k==1?"one":"other"},8:function(k){return W(k,3,6)?"few":W(k,7,10)?"many":k==2?"two":k==1?"one":"other"},9:function(k){return k===0||k!=1&&W(k%100,1,19)?"few":k==1?"one":"other"},10:function(k){return W(k%10,2,9)&&!W(k%100,11,19)?"few":k%10==1&&!W(k%100,11,19)?"one":"other"},11:function(k){return W(k%10,2,4)&&!W(k%100,12,14)?"few":k%10===0||W(k%10,5,9)||W(k%100,11,14)?"many":k%10==1&&k%100!=11?"one":"other"},12:function(k){return W(k,2,4)?"few":k==1?"one":"other"},13:function(k){return W(k%10,2,4)&&!W(k%100,12,14)?"few":k!=1&&W(k%10,0,1)||W(k%10,5,9)||W(k%100,12,14)?"many":k==1?"one":"other"},14:function(k){return W(k%100,3,4)?"few":k%100==2?"two":k%100==1?"one":"other"},15:function(k){return k===0||W(k%100,2,10)?"few":W(k%100,11,19)?"many":k==1?"one":"other"},16:function(k){return k%10==1&&k!=11?"one":"other"},17:function(k){return k==3?"few":k===0?"zero":k==6?"many":k==2?"two":k==1?"one":"other"},18:function(k){return k===0?"zero":W(k,0,2)&&k!==0&&k!=2?"one":"other"},19:function(k){return W(k,2,10)?"few":W(k,0,1)?"one":"other"},20:function(k){return(W(k%10,3,4)||k%10==9)&&!(W(k%100,10,19)||W(k%100,70,79)||W(k%100,90,99))?"few":k%1e6===0&&k!==0?"many":k%10==2&&!be(k%100,[12,72,92])?"two":k%10==1&&!be(k%100,[11,71,91])?"one":"other"},21:function(k){return k===0?"zero":k==1?"one":"other"},22:function(k){return W(k,0,1)||W(k,11,99)?"one":"other"},23:function(k){return W(k%10,1,2)||k%20===0?"one":"other"},24:function(k){return W(k,3,10)||W(k,13,19)?"few":be(k,[2,12])?"two":be(k,[1,11])?"one":"other"}},D=_e[te.replace(/-.*$/,"")];return D in Pe?Pe[D]:(console.warn("plural form unknown for ["+te+"]"),function(){return"other"})}N.plural=function(te,_e,be,W){var Pe=parseFloat(_e);if(isNaN(Pe)||W!=r)return te;N._pluralRules||(N._pluralRules=c(H));var D="["+N._pluralRules(Pe)+"]";return Pe===0&&be+"[zero]"in E?te=E[be+"[zero]"][W]:Pe==1&&be+"[one]"in E?te=E[be+"[one]"][W]:Pe==2&&be+"[two]"in E?te=E[be+"[two]"][W]:be+D in E?te=E[be+D][W]:be+"[other]"in E&&(te=E[be+"[other]"][W]),te};function f(te,_e,be){var W=E[te];if(!W){if(console.warn("#"+te+" is undefined."),!be)return null;W=be}var Pe={};for(var D in W){var k=W[D];k=T(k,_e,te,D),k=Y(k,_e,te),Pe[D]=k}return Pe}function T(te,_e,be,W){var Pe=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,D=Pe.exec(te);if(!D||!D.length)return te;var k=D[1],Te=D[2],q;if(_e&&Te in _e?q=_e[Te]:Te in E&&(q=E[Te]),k in N){var m=N[k];te=m(te,q,be,W)}return te}function Y(te,_e,be){var W=/\{\{\s*(.+?)\s*\}\}/g;return te.replace(W,function(Pe,D){return _e&&D in _e?_e[D]:D in E?E[D]:(console.log("argument {{"+D+"}} for #"+be+" is undefined."),Pe)})}function _(te){var _e=S(te);if(_e.id){var be=f(_e.id,_e.args);if(!be){console.warn("#"+_e.id+" is undefined.");return}if(be[r]){if(j(te)===0)te[r]=be[r];else{for(var W=te.childNodes,Pe=!1,D=0,k=W.length;D<k;D++)W[D].nodeType===3&&/\S/.test(W[D].nodeValue)&&(Pe?W[D].nodeValue="":(W[D].nodeValue=be[r],Pe=!0));if(!Pe){var Te=w.createTextNode(be[r]);te.prepend(Te)}}delete be[r]}for(var q in be)te[q]=be[q]}}function j(te){if(te.children)return te.children.length;if(typeof te.childElementCount<"u")return te.childElementCount;for(var _e=0,be=0;be<te.childNodes.length;be++)_e+=te.nodeType===1?1:0;return _e}function fe(te){te=te||w.documentElement;for(var _e=x(te),be=_e.length,W=0;W<be;W++)_(_e[W]);_(te)}return{get:function(te,_e,be){var W=te.lastIndexOf("."),Pe=r;W>0&&(Pe=te.substring(W+1),te=te.substring(0,W));var D;be&&(D={},D[Pe]=be);var k=f(te,_e,D);return k&&Pe in k?k[Pe]:"{{"+te+"}}"},getData:function(){return E},getText:function(){return p},getLanguage:function(){return H},setLanguage:function(te,_e){o(te,function(){_e&&_e()})},getDirection:function(){var te=["ar","he","fa","ps","ur"],_e=H.split("-",1)[0];return te.indexOf(_e)>=0?"rtl":"ltr"},translate:fe,getReadyState:function(){return g},ready:function(te){if(te)g=="complete"||g=="interactive"?O.setTimeout(function(){te()}):w.addEventListener&&w.addEventListener("localized",function _e(){w.removeEventListener("localized",_e),te()});else return}}}(window,document)},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFHistory=void 0,w.isDestArraysEqual=x,w.isDestHashesEqual=P;var p=E(2),r=E(9);const H=1e3,N=50,g=1e3;function u(){return document.location.hash}class M{constructor({linkService:F,eventBus:I}){this.linkService=F,this.eventBus=I,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",o=>{this._isPagesLoaded=!!o.pagesCount},{once:!0})})}initialize({fingerprint:F,resetHistory:I=!1,updateUrl:o=!1}){if(!F||typeof F!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const s=this._fingerprint!==""&&this._fingerprint!==F;this._fingerprint=F,this._updateUrl=o===!0,this._initialized=!0,this._bindEvents();const c=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=u(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(c,!0)||I){const{hash:T,page:Y,rotation:_}=this._parseCurrentHash(!0);if(!T||s||I){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:T,page:Y,rotation:_},!0);return}const f=c.destination;this._updateInternalState(f,c.uid,!0),f.rotation!==void 0&&(this._initialRotation=f.rotation),f.dest?(this._initialBookmark=JSON.stringify(f.dest),this._destination.page=null):f.hash?this._initialBookmark=f.hash:f.page&&(this._initialBookmark=`page=${f.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:F=null,explicitDest:I,pageNumber:o}){if(!this._initialized)return;if(F&&typeof F!="string"){console.error(`PDFHistory.push: "${F}" is not a valid namedDest parameter.`);return}else if(Array.isArray(I)){if(!this._isValidPage(o)&&(o!==null||this._destination)){console.error(`PDFHistory.push: "${o}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${I}" is not a valid explicitDest parameter.`);return}const s=F||JSON.stringify(I);if(!s)return;let c=!1;if(this._destination&&(P(this._destination.hash,s)||x(this._destination.dest,I))){if(this._destination.page)return;c=!0}this._popStateInProgress&&!c||(this._pushOrReplaceState({dest:I,hash:s,page:o,rotation:this.linkService.rotation},c),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(F){var I;if(this._initialized){if(!this._isValidPage(F)){console.error(`PDFHistory.pushPage: "${F}" is not a valid page number.`);return}((I=this._destination)==null?void 0:I.page)!==F&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${F}`,page:F,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const F=window.history.state;this._isValidState(F)&&F.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const F=window.history.state;this._isValidState(F)&&F.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(F,I=!1){const o=I||!this._destination,s={fingerprint:this._fingerprint,uid:o?this._uid:this._uid+1,destination:F};this._updateInternalState(F,s.uid);let c;if(this._updateUrl&&(F!=null&&F.hash)){const f=document.location.href.split("#")[0];f.startsWith("file://")||(c=`${f}#${F.hash}`)}o?window.history.replaceState(s,"",c):window.history.pushState(s,"",c)}_tryPushCurrentPosition(F=!1){if(!this._position)return;let I=this._position;if(F&&(I=Object.assign(Object.create(null),this._position),I.temporary=!0),!this._destination){this._pushOrReplaceState(I);return}if(this._destination.temporary){this._pushOrReplaceState(I,!0);return}if(this._destination.hash===I.hash||!this._destination.page&&this._numPositionUpdates<=N)return;let o=!1;if(this._destination.page>=I.first&&this._destination.page<=I.page){if(this._destination.dest!==void 0||!this._destination.first)return;o=!0}this._pushOrReplaceState(I,o)}_isValidPage(F){return Number.isInteger(F)&&F>0&&F<=this.linkService.pagesCount}_isValidState(F,I=!1){if(!F)return!1;if(F.fingerprint!==this._fingerprint)if(I){if(typeof F.fingerprint!="string"||F.fingerprint.length!==this._fingerprint.length)return!1;const[o]=performance.getEntriesByType("navigation");if((o==null?void 0:o.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(F.uid)||F.uid<0||F.destination===null||typeof F.destination!="object")}_updateInternalState(F,I,o=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),o&&(F!=null&&F.temporary)&&delete F.temporary,this._destination=F,this._uid=I,this._maxUid=Math.max(this._maxUid,I),this._numPositionUpdates=0}_parseCurrentHash(F=!1){const I=unescape(u()).substring(1),o=(0,p.parseQueryString)(I),s=o.get("nameddest")||"";let c=o.get("page")|0;return(!this._isValidPage(c)||F&&s.length>0)&&(c=null),{hash:I,page:c,rotation:this.linkService.rotation}}_updateViewarea({location:F}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:F.pdfOpenParams.substring(1),page:this.linkService.page,first:F.pageNumber,rotation:F.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},g))}_popState({state:F}){const I=u(),o=this._currentHash!==I;if(this._currentHash=I,!F){this._uid++;const{hash:c,page:f,rotation:T}=this._parseCurrentHash();this._pushOrReplaceState({hash:c,page:f,rotation:T},!0);return}if(!this._isValidState(F))return;this._popStateInProgress=!0,o&&(this._blockHashChange++,(0,r.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:H}).then(()=>{this._blockHashChange--}));const s=F.destination;this._updateInternalState(s,F.uid,!0),(0,p.isValidRotation)(s.rotation)&&(this.linkService.rotation=s.rotation),s.dest?this.linkService.goToDestination(s.dest):s.hash?this.linkService.setHash(s.hash):s.page&&(this.linkService.page=s.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}w.PDFHistory=M;function P(S,F){return typeof S!="string"||typeof F!="string"?!1:S===F||(0,p.parseQueryString)(S).get("nameddest")===F}function x(S,F){function I(o,s){if(typeof o!=typeof s||Array.isArray(o)||Array.isArray(s))return!1;if(o!==null&&typeof o=="object"&&s!==null){if(Object.keys(o).length!==Object.keys(s).length)return!1;for(const c in o)if(!I(o[c],s[c]))return!1;return!0}return o===s||Number.isNaN(o)&&Number.isNaN(s)}if(!(Array.isArray(S)&&Array.isArray(F))||S.length!==F.length)return!1;for(let o=0,s=S.length;o<s;o++)if(!I(S[o],F[o]))return!1;return!0}},(O,w,E)=>{var f,T,Y,_,j,fe,te,_e,be,W,Pe,Ai,yn,Sn,An,En,Cs,Ts,wn;Object.defineProperty(w,"__esModule",{value:!0}),w.PDFPageView=void 0;var p=E(4),r=E(2),H=E(14),N=E(6),g=E(15),u=E(7),M=E(5),P=E(16),x=E(17),S=E(18),F=E(19),I=E(20);const o=g.compatibilityParams.maxCanvasPixels||16777216,s=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new M.SimpleLinkService}});class c{constructor(Q){Me(this,Pe);Me(this,f,p.AnnotationMode.ENABLE_FORMS);Me(this,T,!1);Me(this,Y,null);Me(this,_,null);Me(this,j,null);Me(this,fe,null);Me(this,te,r.RenderingStates.INITIAL);Me(this,_e,r.TextLayerMode.ENABLE);Me(this,be,{directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0});Me(this,W,new WeakMap);var He;const we=Q.container,Re=Q.defaultViewport;this.id=Q.id,this.renderingId="page"+this.id,Ce(this,Y,Q.layerProperties||s),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=Q.scale||r.DEFAULT_SCALE,this.viewport=Re,this.pdfPageRotate=Re.rotation,this._optionalContentConfigPromise=Q.optionalContentConfigPromise||null,Ce(this,_e,Q.textLayerMode??r.TextLayerMode.ENABLE),Ce(this,f,Q.annotationMode??p.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=Q.imageResourcesPath||"",this.isOffscreenCanvasSupported=Q.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=Q.maxCanvasPixels??o,this.pageColors=Q.pageColors||null,this.eventBus=Q.eventBus,this.renderingQueue=Q.renderingQueue,this.l10n=Q.l10n||u.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!((He=this.renderingQueue)!=null&&He.hasViewer()),this._container=we,Q.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),this.maxCanvasPixels=0),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const Ne=document.createElement("div");if(Ne.className="page",Ne.setAttribute("data-page-number",this.id),Ne.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then($e=>{Ne.setAttribute("aria-label",$e)}),this.div=Ne,ne(this,Pe,Ai).call(this),we==null||we.append(Ne),this._isStandalone){we==null||we.style.setProperty("--scale-factor",this.scale*p.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:$e}=Q;$e&&$e.then(qe=>{$e===this._optionalContentConfigPromise&&(t(this,be).initialOptionalContent=qe.hasInitialVisibility)})}}get renderingState(){return t(this,te)}set renderingState(Q){if(Q!==t(this,te))switch(Ce(this,te,Q),t(this,_)&&(clearTimeout(t(this,_)),Ce(this,_,null)),Q){case r.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case r.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),Ce(this,_,setTimeout(()=>{this.div.classList.add("loading"),Ce(this,_,null)},0));break;case r.RenderingStates.INITIAL:case r.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}setPdfPage(Q){var Re,Ne,He;this._isStandalone&&(((Re=this.pageColors)==null?void 0:Re.foreground)==="CanvasText"||((Ne=this.pageColors)==null?void 0:Ne.background)==="Canvas")&&((He=this._container)==null||He.style.setProperty("--hcm-highligh-filter",Q.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=Q,this.pdfPageRotate=Q.rotate;const we=(this.rotation+this.pdfPageRotate)%360;this.viewport=Q.getViewport({scale:this.scale*p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:we}),ne(this,Pe,Ai).call(this),this.reset()}destroy(){var Q;this.reset(),(Q=this.pdfPage)==null||Q.cleanup()}get _textHighlighter(){return(0,p.shadow)(this,"_textHighlighter",new S.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:t(this,Y).call(this).findController}))}_resetZoomLayer(Q=!1){if(!this.zoomLayer)return;const we=this.zoomLayer.firstChild;t(this,W).delete(we),we.width=0,we.height=0,Q&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:Q=!1,keepAnnotationLayer:we=!1,keepAnnotationEditorLayer:Re=!1,keepXfaLayer:Ne=!1,keepTextLayer:He=!1}={}){var Ie,z,h,X,oe;this.cancelRendering({keepAnnotationLayer:we,keepAnnotationEditorLayer:Re,keepXfaLayer:Ne,keepTextLayer:He}),this.renderingState=r.RenderingStates.INITIAL;const $e=this.div,qe=$e.childNodes,Ye=Q&&this.zoomLayer||null,Oe=we&&((Ie=this.annotationLayer)==null?void 0:Ie.div)||null,Fe=Re&&((z=this.annotationEditorLayer)==null?void 0:z.div)||null,J=Ne&&((h=this.xfaLayer)==null?void 0:h.div)||null,Ee=He&&((X=this.textLayer)==null?void 0:X.div)||null;for(let Z=qe.length-1;Z>=0;Z--){const Le=qe[Z];switch(Le){case Ye:case Oe:case Fe:case J:case Ee:continue}Le.remove()}$e.removeAttribute("data-loaded"),Oe&&this.annotationLayer.hide(),Fe&&this.annotationEditorLayer.hide(),J&&this.xfaLayer.hide(),Ee&&this.textLayer.hide(),(oe=this.structTreeLayer)==null||oe.hide(),Ye||(this.canvas&&(t(this,W).delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:Q=0,rotation:we=null,optionalContentConfigPromise:Re=null,drawingDelay:Ne=-1}){var $e;this.scale=Q||this.scale,typeof we=="number"&&(this.rotation=we),Re instanceof Promise&&(this._optionalContentConfigPromise=Re,Re.then(qe=>{Re===this._optionalContentConfigPromise&&(t(this,be).initialOptionalContent=qe.hasInitialVisibility)})),t(this,be).directDrawing=!0;const He=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:He}),ne(this,Pe,Ai).call(this),this._isStandalone&&(($e=this._container)==null||$e.style.setProperty("--scale-factor",this.viewport.scale)),this.canvas){let qe=!1;if(t(this,T)){if(this.maxCanvasPixels===0)qe=!0;else if(this.maxCanvasPixels>0){const{width:Oe,height:Fe}=this.viewport,{sx:J,sy:Ee}=this.outputScale;qe=(Math.floor(Oe)*J|0)*(Math.floor(Fe)*Ee|0)>this.maxCanvasPixels}}const Ye=!qe&&Ne>=0&&Ne<1e3;if(Ye||qe){if(Ye&&this.renderingState!==r.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:Ne}),this.renderingState=r.RenderingStates.FINISHED,t(this,be).directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!Ye,hideTextLayer:Ye}),Ye)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:t(this,fe)});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:Q=!1,keepAnnotationEditorLayer:we=!1,keepXfaLayer:Re=!1,keepTextLayer:Ne=!1,cancelExtraDelay:He=0}={}){var $e;this.renderTask&&(this.renderTask.cancel(He),this.renderTask=null),this.resume=null,this.textLayer&&(!Ne||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!Q||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!we||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!Re||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,($e=this._textHighlighter)==null||$e.disable())}cssTransform({target:Q,redrawAnnotationLayer:we=!1,redrawAnnotationEditorLayer:Re=!1,redrawXfaLayer:Ne=!1,redrawTextLayer:He=!1,hideTextLayer:$e=!1}){var Ye;if(!Q.hasAttribute("zooming")){Q.setAttribute("zooming",!0);const{style:Oe}=Q;Oe.width=Oe.height=""}const qe=t(this,W).get(Q);if(this.viewport!==qe){const Oe=this.viewport.rotation-qe.rotation,Fe=Math.abs(Oe);let J=1,Ee=1;if(Fe===90||Fe===270){const{width:Ie,height:z}=this.viewport;J=z/Ie,Ee=Ie/z}Q.style.transform=`rotate(${Oe}deg) scale(${J}, ${Ee})`}we&&this.annotationLayer&&ne(this,Pe,yn).call(this),Re&&this.annotationEditorLayer&&ne(this,Pe,Sn).call(this),Ne&&this.xfaLayer&&ne(this,Pe,An).call(this),this.textLayer&&($e?(this.textLayer.hide(),(Ye=this.structTreeLayer)==null||Ye.hide()):He&&ne(this,Pe,En).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(Q,we){return this.viewport.convertToPdfPoint(Q,we)}async draw(){this.renderingState!==r.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:Q,l10n:we,pageColors:Re,pdfPage:Ne,viewport:He}=this;if(!Ne)throw this.renderingState=r.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=r.RenderingStates.RUNNING;const $e=document.createElement("div");if($e.classList.add("canvasWrapper"),Q.append($e),!this.textLayer&&t(this,_e)!==r.TextLayerMode.DISABLE&&!Ne.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new x.TextAccessibilityManager),this.textLayer=new F.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:t(this,_e)===r.TextLayerMode.ENABLE_PERMISSIONS}),Q.append(this.textLayer.div)),!this.annotationLayer&&t(this,f)!==p.AnnotationMode.DISABLE){const{annotationStorage:Ve,downloadManager:Je,enableScripting:Ze,fieldObjectsPromise:it,hasJSActionsPromise:pt,linkService:mt}=t(this,Y).call(this);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new N.AnnotationLayerBuilder({pageDiv:Q,pdfPage:Ne,annotationStorage:Ve,imageResourcesPath:this.imageResourcesPath,renderForms:t(this,f)===p.AnnotationMode.ENABLE_FORMS,linkService:mt,downloadManager:Je,l10n:we,enableScripting:Ze,hasJSActionsPromise:pt,fieldObjectsPromise:it,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const qe=Ve=>{if(Ee==null||Ee(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=r.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=r.RenderingStates.RUNNING,Ve()};return}Ve()},{width:Ye,height:Oe}=He,Fe=document.createElement("canvas");Fe.setAttribute("role","presentation"),Fe.hidden=!0;const J=!!(Re!=null&&Re.background&&(Re!=null&&Re.foreground));let Ee=Ve=>{(!J||Ve)&&(Fe.hidden=!1,Ee=null)};$e.append(Fe),this.canvas=Fe;const Ie=Fe.getContext("2d",{alpha:!1}),z=this.outputScale=new r.OutputScale;if(this.maxCanvasPixels===0){const Ve=1/this.scale;z.sx*=Ve,z.sy*=Ve,Ce(this,T,!0)}else if(this.maxCanvasPixels>0){const Ve=Ye*Oe,Je=Math.sqrt(this.maxCanvasPixels/Ve);z.sx>Je||z.sy>Je?(z.sx=Je,z.sy=Je,Ce(this,T,!0)):Ce(this,T,!1)}const h=(0,r.approximateFraction)(z.sx),X=(0,r.approximateFraction)(z.sy);Fe.width=(0,r.roundToDivide)(Ye*z.sx,h[0]),Fe.height=(0,r.roundToDivide)(Oe*z.sy,X[0]);const{style:oe}=Fe;oe.width=(0,r.roundToDivide)(Ye,h[1])+"px",oe.height=(0,r.roundToDivide)(Oe,X[1])+"px",t(this,W).set(Fe,He);const Z=z.scaled?[z.sx,0,0,z.sy,0,0]:null,Le={canvasContext:Ie,transform:Z,viewport:He,annotationMode:t(this,f),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:Re},De=this.renderTask=this.pdfPage.render(Le);De.onContinue=qe;const Ge=De.promise.then(async()=>{var Ve;if(Ee==null||Ee(!0),await ne(this,Pe,wn).call(this,De),ne(this,Pe,En).call(this),this.annotationLayer&&await ne(this,Pe,yn).call(this),!this.annotationEditorLayer){const{annotationEditorUIManager:Je}=t(this,Y).call(this);if(!Je)return;this.annotationEditorLayer=new H.AnnotationEditorLayerBuilder({uiManager:Je,pageDiv:Q,pdfPage:Ne,l10n:we,accessibilityManager:this._accessibilityManager,annotationLayer:(Ve=this.annotationLayer)==null?void 0:Ve.annotationLayer})}ne(this,Pe,Sn).call(this)},Ve=>(Ve instanceof p.RenderingCancelledException||Ee==null||Ee(!0),ne(this,Pe,wn).call(this,De,Ve)));if(Ne.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&Q.append(this.xfaLayer.div);else{const{annotationStorage:Ve,linkService:Je}=t(this,Y).call(this);this.xfaLayer=new I.XfaLayerBuilder({pageDiv:Q,pdfPage:Ne,annotationStorage:Ve,linkService:Je})}ne(this,Pe,An).call(this)}return Q.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),Ge}setPageLabel(Q){this.pageLabel=typeof Q=="string"?Q:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:Q,initialOptionalContent:we,regularAnnotations:Re}=t(this,be);return Q&&we&&Re?this.canvas:null}}f=new WeakMap,T=new WeakMap,Y=new WeakMap,_=new WeakMap,j=new WeakMap,fe=new WeakMap,te=new WeakMap,_e=new WeakMap,be=new WeakMap,W=new WeakMap,Pe=new WeakSet,Ai=function(){const{viewport:Q}=this;if(this.pdfPage){if(t(this,j)===Q.rotation)return;Ce(this,j,Q.rotation)}(0,p.setLayerDimensions)(this.div,Q,!0,!1)},yn=async function(){let Q=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(we){console.error(`#renderAnnotationLayer: "${we}".`),Q=we}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:Q})}},Sn=async function(){let Q=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(we){console.error(`#renderAnnotationEditorLayer: "${we}".`),Q=we}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:Q})}},An=async function(){let Q=null;try{const we=await this.xfaLayer.render(this.viewport,"display");we!=null&&we.textDivs&&this._textHighlighter&&ne(this,Pe,Ts).call(this,we.textDivs)}catch(we){console.error(`#renderXfaLayer: "${we}".`),Q=we}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:Q})}},En=async function(){const{pdfPage:Q,textLayer:we,viewport:Re}=this;if(!we)return;let Ne=null;try{if(!we.renderingDone){const He=Q.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});we.setTextContentSource(He)}await we.render(Re)}catch(He){if(He instanceof p.AbortException)return;console.error(`#renderTextLayer: "${He}".`),Ne=He}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:we.numTextDivs,error:Ne}),ne(this,Pe,Cs).call(this)},Cs=async function(){var Re,Ne,He;if(!this.textLayer)return;this.structTreeLayer||(this.structTreeLayer=new P.StructTreeLayerBuilder);const Q=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),we=(Re=this.structTreeLayer)==null?void 0:Re.render(Q);we&&((Ne=this.canvas)==null||Ne.append(we)),(He=this.structTreeLayer)==null||He.show()},Ts=async function(Q){const we=await this.pdfPage.getTextContent(),Re=[];for(const Ne of we.items)Re.push(Ne.str);this._textHighlighter.setTextMapping(Q,Re),this._textHighlighter.enable()},wn=async function(Q,we=null){if(Q===this.renderTask&&(this.renderTask=null),we instanceof p.RenderingCancelledException){Ce(this,fe,null);return}if(Ce(this,fe,we),this.renderingState=r.RenderingStates.FINISHED,this._resetZoomLayer(!0),t(this,be).regularAnnotations=!Q.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:t(this,fe)}),we)throw we},w.PDFPageView=c},(O,w,E)=>{var N,g;Object.defineProperty(w,"__esModule",{value:!0}),w.AnnotationEditorLayerBuilder=void 0;var p=E(4),r=E(7);class H{constructor(M){Me(this,N,null);Me(this,g);this.pageDiv=M.pageDiv,this.pdfPage=M.pdfPage,this.accessibilityManager=M.accessibilityManager,this.l10n=M.l10n||r.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,Ce(this,g,M.uiManager),Ce(this,N,M.annotationLayer||null)}async render(M,P="display"){if(P!=="display"||this._cancelled)return;const x=M.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:x}),this.show();return}const S=this.div=document.createElement("div");S.className="annotationEditorLayer",S.tabIndex=0,S.hidden=!0,S.dir=t(this,g).direction,this.pageDiv.append(S),this.annotationEditorLayer=new p.AnnotationEditorLayer({uiManager:t(this,g),div:S,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:x,annotationLayer:t(this,N)});const F={viewport:x,div:S,annotations:null,intent:P};this.annotationEditorLayer.render(F),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}N=new WeakMap,g=new WeakMap,w.AnnotationEditorLayerBuilder=H},(O,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.compatibilityParams=w.OptionKind=w.AppOptions=void 0;const E=Object.create(null);w.compatibilityParams=E;{const g=navigator.userAgent||"",u=navigator.platform||"",M=navigator.maxTouchPoints||1,P=/Android/.test(g),x=/\b(iPad|iPhone|iPod)(?=;)/.test(g)||u==="MacIntel"&&M>1;(function(){(x||P)&&(E.maxCanvasPixels=5242880)})()}const p={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};w.OptionKind=p;const r={annotationEditorMode:{value:0,kind:p.VIEWER+p.PREFERENCE},annotationMode:{value:2,kind:p.VIEWER+p.PREFERENCE},cursorToolOnLoad:{value:0,kind:p.VIEWER+p.PREFERENCE},defaultZoomDelay:{value:400,kind:p.VIEWER+p.PREFERENCE},defaultZoomValue:{value:"",kind:p.VIEWER+p.PREFERENCE},disableHistory:{value:!1,kind:p.VIEWER},disablePageLabels:{value:!1,kind:p.VIEWER+p.PREFERENCE},enablePermissions:{value:!1,kind:p.VIEWER+p.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:p.VIEWER+p.PREFERENCE},enableScripting:{value:!0,kind:p.VIEWER+p.PREFERENCE},enableStampEditor:{value:!0,kind:p.VIEWER+p.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:p.VIEWER},externalLinkTarget:{value:0,kind:p.VIEWER+p.PREFERENCE},historyUpdateUrl:{value:!1,kind:p.VIEWER+p.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:p.VIEWER+p.PREFERENCE},imageResourcesPath:{value:"./images/",kind:p.VIEWER},maxCanvasPixels:{value:16777216,kind:p.VIEWER},forcePageColors:{value:!1,kind:p.VIEWER+p.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:p.VIEWER+p.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:p.VIEWER+p.PREFERENCE},pdfBugEnabled:{value:!1,kind:p.VIEWER+p.PREFERENCE},printResolution:{value:150,kind:p.VIEWER},sidebarViewOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},scrollModeOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},spreadModeOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},textLayerMode:{value:1,kind:p.VIEWER+p.PREFERENCE},viewerCssTheme:{value:0,kind:p.VIEWER+p.PREFERENCE},viewOnLoad:{value:0,kind:p.VIEWER+p.PREFERENCE},cMapPacked:{value:!0,kind:p.API},cMapUrl:{value:"../web/cmaps/",kind:p.API},disableAutoFetch:{value:!1,kind:p.API+p.PREFERENCE},disableFontFace:{value:!1,kind:p.API+p.PREFERENCE},disableRange:{value:!1,kind:p.API+p.PREFERENCE},disableStream:{value:!1,kind:p.API+p.PREFERENCE},docBaseUrl:{value:"",kind:p.API},enableXfa:{value:!0,kind:p.API+p.PREFERENCE},fontExtraProperties:{value:!1,kind:p.API},isEvalSupported:{value:!0,kind:p.API},isOffscreenCanvasSupported:{value:!0,kind:p.API},maxImageSize:{value:-1,kind:p.API},pdfBug:{value:!1,kind:p.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:p.API},verbosity:{value:1,kind:p.API},workerPort:{value:null,kind:p.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:p.WORKER}};r.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:p.VIEWER},r.disablePreferences={value:!1,kind:p.VIEWER},r.locale={value:navigator.language||"en-US",kind:p.VIEWER},r.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:p.VIEWER};const H=Object.create(null);class N{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(u){const M=H[u];if(M!==void 0)return M;const P=r[u];if(P!==void 0)return E[u]??P.value}static getAll(u=null){const M=Object.create(null);for(const P in r){const x=r[P];if(u){if(!(u&x.kind))continue;if(u===p.PREFERENCE){const F=x.value,I=typeof F;if(I==="boolean"||I==="string"||I==="number"&&Number.isInteger(F)){M[P]=F;continue}throw new Error(`Invalid type for preference: ${P}`)}}const S=H[P];M[P]=S!==void 0?S:E[P]??x.value}return M}static set(u,M){H[u]=M}static setAll(u){for(const M in u)H[M]=u[M]}static remove(u){delete H[u]}}w.AppOptions=N,N._hasUserOptions=function(){return Object.keys(H).length>0}},(O,w,E)=>{var g,u,Pn,Cn;Object.defineProperty(w,"__esModule",{value:!0}),w.StructTreeLayerBuilder=void 0;var p=E(2);const r={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},H=/^H(\d+)$/;class N{constructor(){Me(this,u);Me(this,g)}get renderingDone(){return t(this,g)!==void 0}render(S){if(t(this,g)!==void 0)return t(this,g);const F=ne(this,u,Cn).call(this,S);return F==null||F.classList.add("structTree"),Ce(this,g,F)}hide(){t(this,g)&&!t(this,g).hidden&&(t(this,g).hidden=!0)}show(){var S;(S=t(this,g))!=null&&S.hidden&&(t(this,g).hidden=!1)}}g=new WeakMap,u=new WeakSet,Pn=function(S,F){const{alt:I,id:o,lang:s}=S;I!==void 0&&F.setAttribute("aria-label",(0,p.removeNullCharacters)(I)),o!==void 0&&F.setAttribute("aria-owns",o),s!==void 0&&F.setAttribute("lang",(0,p.removeNullCharacters)(s,!0))},Cn=function(S){if(!S)return null;const F=document.createElement("span");if("role"in S){const{role:I}=S,o=I.match(H);o?(F.setAttribute("role","heading"),F.setAttribute("aria-level",o[1])):r[I]&&F.setAttribute("role",r[I])}if(ne(this,u,Pn).call(this,S,F),S.children)if(S.children.length===1&&"id"in S.children[0])ne(this,u,Pn).call(this,S.children[0],F);else for(const I of S.children)F.append(ne(this,u,Cn).call(this,I));return F},w.StructTreeLayerBuilder=N},(O,w,E)=>{var H,N,g,u,M,Ei,x,Tn;Object.defineProperty(w,"__esModule",{value:!0}),w.TextAccessibilityManager=void 0;var p=E(2);const F=class F{constructor(){Me(this,x);Me(this,H,!1);Me(this,N,null);Me(this,g,new Map);Me(this,u,new Map)}setTextMapping(o){Ce(this,N,o)}enable(){if(t(this,H))throw new Error("TextAccessibilityManager is already enabled.");if(!t(this,N))throw new Error("Text divs and strings have not been set.");if(Ce(this,H,!0),Ce(this,N,t(this,N).slice()),t(this,N).sort(ne(F,M,Ei)),t(this,g).size>0){const o=t(this,N);for(const[s,c]of t(this,g)){if(!document.getElementById(s)){t(this,g).delete(s);continue}ne(this,x,Tn).call(this,s,o[c])}}for(const[o,s]of t(this,u))this.addPointerInTextLayer(o,s);t(this,u).clear()}disable(){t(this,H)&&(t(this,u).clear(),Ce(this,N,null),Ce(this,H,!1))}removePointerInTextLayer(o){if(!t(this,H)){t(this,u).delete(o);return}const s=t(this,N);if(!s||s.length===0)return;const{id:c}=o,f=t(this,g).get(c);if(f===void 0)return;const T=s[f];t(this,g).delete(c);let Y=T.getAttribute("aria-owns");Y!=null&&Y.includes(c)&&(Y=Y.split(" ").filter(_=>_!==c).join(" "),Y?T.setAttribute("aria-owns",Y):(T.removeAttribute("aria-owns"),T.setAttribute("role","presentation")))}addPointerInTextLayer(o,s){const{id:c}=o;if(!c)return null;if(!t(this,H))return t(this,u).set(o,s),null;s&&this.removePointerInTextLayer(o);const f=t(this,N);if(!f||f.length===0)return null;const T=(0,p.binarySearchFirstItem)(f,fe=>{var te;return ne(te=F,M,Ei).call(te,o,fe)<0}),Y=Math.max(0,T-1),_=f[Y];ne(this,x,Tn).call(this,c,_),t(this,g).set(c,Y);const j=_.parentNode;return j!=null&&j.classList.contains("markedContent")?j.id:null}moveElementInDOM(o,s,c,f){const T=this.addPointerInTextLayer(c,f);if(!o.hasChildNodes())return o.append(s),T;const Y=Array.from(o.childNodes).filter(fe=>fe!==s);if(Y.length===0)return T;const _=c||s,j=(0,p.binarySearchFirstItem)(Y,fe=>{var te;return ne(te=F,M,Ei).call(te,_,fe)<0});return j===0?Y[0].before(s):Y[j-1].after(s),T}};H=new WeakMap,N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakSet,Ei=function(o,s){const c=o.getBoundingClientRect(),f=s.getBoundingClientRect();if(c.width===0&&c.height===0)return 1;if(f.width===0&&f.height===0)return-1;const T=c.y,Y=c.y+c.height,_=c.y+c.height/2,j=f.y,fe=f.y+f.height,te=f.y+f.height/2;if(_<=j&&te>=Y)return-1;if(te<=T&&_>=fe)return 1;const _e=c.x+c.width/2,be=f.x+f.width/2;return _e-be},x=new WeakSet,Tn=function(o,s){const c=s.getAttribute("aria-owns");c!=null&&c.includes(o)||s.setAttribute("aria-owns",c?`${c} ${o}`:o),s.removeAttribute("role")},Me(F,M);let r=F;w.TextAccessibilityManager=r},(O,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.TextHighlighter=void 0;class E{constructor({findController:r,eventBus:H,pageIndex:N}){this.findController=r,this.matches=[],this.eventBus=H,this.pageIdx=N,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(r,H){this.textDivs=r,this.textContentItemsStr=H}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=r=>{(r.pageIndex===this.pageIdx||r.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(r,H){if(!r)return[];const{textContentItemsStr:N}=this;let g=0,u=0;const M=N.length-1,P=[];for(let x=0,S=r.length;x<S;x++){let F=r[x];for(;g!==M&&F>=u+N[g].length;)u+=N[g].length,g++;g===N.length&&console.error("Could not find a matching mapping");const I={begin:{divIdx:g,offset:F-u}};for(F+=H[x];g!==M&&F>u+N[g].length;)u+=N[g].length,g++;I.end={divIdx:g,offset:F-u},P.push(I)}return P}_renderMatches(r){if(r.length===0)return;const{findController:H,pageIdx:N}=this,{textContentItemsStr:g,textDivs:u}=this,M=N===H.selected.pageIdx,P=H.selected.matchIdx,x=H.state.highlightAll;let S=null;const F={divIdx:-1,offset:void 0};function I(Y,_){const j=Y.divIdx;return u[j].textContent="",o(j,0,Y.offset,_)}function o(Y,_,j,fe){let te=u[Y];if(te.nodeType===Node.TEXT_NODE){const W=document.createElement("span");te.before(W),W.append(te),u[Y]=W,te=W}const _e=g[Y].substring(_,j),be=document.createTextNode(_e);if(fe){const W=document.createElement("span");return W.className=`${fe} appended`,W.append(be),te.append(W),fe.includes("selected")?W.offsetLeft:0}return te.append(be),0}let s=P,c=s+1;if(x)s=0,c=r.length;else if(!M)return;let f=-1,T=-1;for(let Y=s;Y<c;Y++){const _=r[Y],j=_.begin;if(j.divIdx===f&&j.offset===T)continue;f=j.divIdx,T=j.offset;const fe=_.end,te=M&&Y===P,_e=te?" selected":"";let be=0;if(!S||j.divIdx!==S.divIdx?(S!==null&&o(S.divIdx,S.offset,F.offset),I(j)):o(S.divIdx,S.offset,j.offset),j.divIdx===fe.divIdx)be=o(j.divIdx,j.offset,fe.offset,"highlight"+_e);else{be=o(j.divIdx,j.offset,F.offset,"highlight begin"+_e);for(let W=j.divIdx+1,Pe=fe.divIdx;W<Pe;W++)u[W].className="highlight middle"+_e;I(fe,"highlight end"+_e)}S=fe,te&&H.scrollMatchIntoView({element:u[j.divIdx],selectedLeft:be,pageIndex:N,matchIndex:P})}S&&o(S.divIdx,S.offset,F.offset)}_updateMatches(r=!1){if(!this.enabled&&!r)return;const{findController:H,matches:N,pageIdx:g}=this,{textContentItemsStr:u,textDivs:M}=this;let P=-1;for(const F of N){const I=Math.max(P,F.begin.divIdx);for(let o=I,s=F.end.divIdx;o<=s;o++){const c=M[o];c.textContent=u[o],c.className=""}P=F.end.divIdx+1}if(!(H!=null&&H.highlightMatches)||r)return;const x=H.pageMatches[g]||null,S=H.pageMatchesLength[g]||null;this.matches=this._convertMatches(x,S),this._renderMatches(this.matches)}}w.TextHighlighter=E},(O,w,E)=>{var N,g,u,M,P,xs,Ms;Object.defineProperty(w,"__esModule",{value:!0}),w.TextLayerBuilder=void 0;var p=E(4),r=E(2);class H{constructor({highlighter:I=null,accessibilityManager:o=null,isOffscreenCanvasSupported:s=!0,enablePermissions:c=!1}){Me(this,P);Me(this,N,!1);Me(this,g,0);Me(this,u,0);Me(this,M,null);this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=I,this.accessibilityManager=o,this.isOffscreenCanvasSupported=s,Ce(this,N,c===!0),this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}get numTextDivs(){return this.textDivs.length}async render(I){var c,f,T;if(!t(this,M))throw new Error('No "textContentSource" parameter specified.');const o=I.scale*(globalThis.devicePixelRatio||1),{rotation:s}=I;if(this.renderingDone){const Y=s!==t(this,g),_=o!==t(this,u);(Y||_)&&(this.hide(),(0,p.updateTextLayer)({container:this.div,viewport:I,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:_,mustRotate:Y}),Ce(this,u,o),Ce(this,g,s)),this.show();return}this.cancel(),(c=this.highlighter)==null||c.setTextMapping(this.textDivs,this.textContentItemsStr),(f=this.accessibilityManager)==null||f.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,p.renderTextLayer)({textContentSource:t(this,M),container:this.div,viewport:I,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,ne(this,P,xs).call(this),Ce(this,u,o),Ce(this,g,s),this.show(),(T=this.accessibilityManager)==null||T.enable()}hide(){var I;this.div.hidden||((I=this.highlighter)==null||I.disable(),this.div.hidden=!0)}show(){var I;this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,(I=this.highlighter)==null||I.enable())}cancel(){var I,o;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(I=this.highlighter)==null||I.disable(),(o=this.accessibilityManager)==null||o.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(I){this.cancel(),Ce(this,M,I)}}N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakSet,xs=function(){this.renderingDone=!0;const I=document.createElement("div");I.className="endOfContent",this.div.append(I),ne(this,P,Ms).call(this)},Ms=function(){const{div:I}=this;I.addEventListener("mousedown",o=>{const s=I.querySelector(".endOfContent");if(!s)return;let c=o.target!==I;if(c&&(c=getComputedStyle(s).getPropertyValue("-moz-user-select")!=="none"),c){const f=I.getBoundingClientRect(),T=Math.max(0,(o.pageY-f.top)/f.height);s.style.top=(T*100).toFixed(2)+"%"}s.classList.add("active")}),I.addEventListener("mouseup",()=>{const o=I.querySelector(".endOfContent");o&&(o.style.top="",o.classList.remove("active"))}),I.addEventListener("copy",o=>{if(!t(this,N)){const s=document.getSelection();o.clipboardData.setData("text/plain",(0,r.removeNullCharacters)((0,p.normalizeUnicode)(s.toString())))}o.preventDefault(),o.stopPropagation()})},w.TextLayerBuilder=H},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.XfaLayerBuilder=void 0;var p=E(4);class r{constructor({pageDiv:N,pdfPage:g,annotationStorage:u=null,linkService:M,xfaHtml:P=null}){this.pageDiv=N,this.pdfPage=g,this.annotationStorage=u,this.linkService=M,this.xfaHtml=P,this.div=null,this._cancelled=!1}async render(N,g="display"){if(g==="print"){const P={viewport:N.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:g},x=document.createElement("div");return this.pageDiv.append(x),P.div=x,p.XfaLayer.render(P)}const u=await this.pdfPage.getXfa();if(this._cancelled||!u)return{textDivs:[]};const M={viewport:N.clone({dontFlip:!0}),div:this.div,xfaHtml:u,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:g};return this.div?p.XfaLayer.update(M):(this.div=document.createElement("div"),this.pageDiv.append(this.div),M.div=this.div,p.XfaLayer.render(M))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}w.XfaLayerBuilder=r},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFScriptingManager=void 0;var p=E(22),r=E(23);class H extends r.PDFScriptingManager{constructor(g){g.externalServices||window.addEventListener("updatefromsandbox",u=>{g.eventBus.dispatch("updatefromsandbox",{source:window,detail:u.detail})}),g.externalServices||(g.externalServices={createScripting:({sandboxBundleSrc:u})=>new p.GenericScripting(u)}),g.docProperties||(g.docProperties=u=>(0,p.docProperties)(u)),super(g)}}w.PDFScriptingManager=H},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.GenericScripting=void 0,w.docProperties=r;var p=E(4);async function r(N){const g="",u=g.split("#")[0];let{info:M,metadata:P,contentDispositionFilename:x,contentLength:S}=await N.getMetadata();if(!S){const{length:F}=await N.getDownloadInfo();S=F}return{...M,baseURL:u,filesize:S,filename:x||(0,p.getPdfFilenameFromUrl)(g),metadata:P==null?void 0:P.getRaw(),authors:P==null?void 0:P.get("dc:creator"),numPages:N.numPages,URL:g}}class H{constructor(g){this._ready=(0,p.loadScript)(g,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(g){(await this._ready).create(g)}async dispatchEventInSandbox(g){const u=await this._ready;setTimeout(()=>u.dispatchEvent(g),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}w.GenericScripting=H},(O,w,E)=>{var N,g,u,M,P,x,S,F,I,o,s,c,Ls,wi,xn,Rs,Jt;Object.defineProperty(w,"__esModule",{value:!0}),w.PDFScriptingManager=void 0;var p=E(2),r=E(4);class H{constructor({eventBus:te,sandboxBundleSrc:_e=null,externalServices:be=null,docProperties:W=null}){Me(this,c);Me(this,N,null);Me(this,g,null);Me(this,u,null);Me(this,M,null);Me(this,P,null);Me(this,x,null);Me(this,S,null);Me(this,F,!1);Me(this,I,null);Me(this,o,null);Me(this,s,null);Ce(this,M,te),Ce(this,I,_e),Ce(this,P,be),Ce(this,u,W)}setViewer(te){Ce(this,S,te)}async setDocument(te){var Pe;if(t(this,x)&&await ne(this,c,Jt).call(this),Ce(this,x,te),!te)return;const[_e,be,W]=await Promise.all([te.getFieldObjects(),te.getCalculationOrderIds(),te.getJSActions()]);if(!_e&&!W){await ne(this,c,Jt).call(this);return}if(te===t(this,x)){try{Ce(this,o,ne(this,c,Rs).call(this))}catch(D){console.error(`setDocument: "${D.message}".`),await ne(this,c,Jt).call(this);return}this._internalEvents.set("updatefromsandbox",D=>{(D==null?void 0:D.source)===window&&ne(this,c,Ls).call(this,D.detail)}),this._internalEvents.set("dispatcheventinsandbox",D=>{var k;(k=t(this,o))==null||k.dispatchEventInSandbox(D.detail)}),this._internalEvents.set("pagechanging",({pageNumber:D,previous:k})=>{D!==k&&(ne(this,c,xn).call(this,k),ne(this,c,wi).call(this,D))}),this._internalEvents.set("pagerendered",({pageNumber:D})=>{this._pageOpenPending.has(D)&&D===t(this,S).currentPageNumber&&ne(this,c,wi).call(this,D)}),this._internalEvents.set("pagesdestroy",async()=>{var D,k;await ne(this,c,xn).call(this,t(this,S).currentPageNumber),await((D=t(this,o))==null?void 0:D.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(k=t(this,N))==null||k.resolve()});for(const[D,k]of this._internalEvents)t(this,M)._on(D,k);try{const D=await t(this,u).call(this,te);if(te!==t(this,x))return;await t(this,o).createSandbox({objects:_e,calculationOrder:be,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...D,actions:W}}),t(this,M).dispatch("sandboxcreated",{source:this})}catch(D){console.error(`setDocument: "${D.message}".`),await ne(this,c,Jt).call(this);return}await((Pe=t(this,o))==null?void 0:Pe.dispatchEventInSandbox({id:"doc",name:"Open"})),await ne(this,c,wi).call(this,t(this,S).currentPageNumber,!0),Promise.resolve().then(()=>{te===t(this,x)&&Ce(this,F,!0)})}}async dispatchWillSave(){var te;return(te=t(this,o))==null?void 0:te.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){var te;return(te=t(this,o))==null?void 0:te.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){var te;if(t(this,o)){await((te=t(this,s))==null?void 0:te.promise),Ce(this,s,new r.PromiseCapability);try{await t(this,o).dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(_e){throw t(this,s).resolve(),Ce(this,s,null),_e}await t(this,s).promise}}async dispatchDidPrint(){var te;return(te=t(this,o))==null?void 0:te.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var te;return((te=t(this,g))==null?void 0:te.promise)||null}get ready(){return t(this,F)}get _internalEvents(){return(0,r.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,r.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,r.shadow)(this,"_visitedPages",new Map)}}N=new WeakMap,g=new WeakMap,u=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,S=new WeakMap,F=new WeakMap,I=new WeakMap,o=new WeakMap,s=new WeakMap,c=new WeakSet,Ls=async function(te){var q,m;const _e=t(this,S),be=_e.isInPresentationMode||_e.isChangingPresentationMode,{id:W,siblings:Pe,command:D,value:k}=te;if(!W){switch(D){case"clear":console.clear();break;case"error":console.error(k);break;case"layout":if(!be){const y=(0,p.apiPageLayoutToViewerModes)(k);_e.spreadMode=y.spreadMode}break;case"page-num":_e.currentPageNumber=k+1;break;case"print":await _e.pagesPromise,t(this,M).dispatch("print",{source:this});break;case"println":console.log(k);break;case"zoom":be||(_e.currentScaleValue=k);break;case"SaveAs":t(this,M).dispatch("download",{source:this});break;case"FirstPage":_e.currentPageNumber=1;break;case"LastPage":_e.currentPageNumber=_e.pagesCount;break;case"NextPage":_e.nextPage();break;case"PrevPage":_e.previousPage();break;case"ZoomViewIn":be||_e.increaseScale();break;case"ZoomViewOut":be||_e.decreaseScale();break;case"WillPrintFinished":(q=t(this,s))==null||q.resolve(),Ce(this,s,null);break}return}if(be&&te.focus)return;delete te.id,delete te.siblings;const Te=Pe?[W,...Pe]:[W];for(const y of Te){const U=document.querySelector(`[data-element-id="${y}"]`);U?U.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:te})):(m=t(this,x))==null||m.annotationStorage.setValue(y,te)}},wi=async function(te,_e=!1){const be=t(this,x),W=this._visitedPages;if(_e&&Ce(this,N,new r.PromiseCapability),!t(this,N))return;const Pe=t(this,S).getPageView(te-1);if((Pe==null?void 0:Pe.renderingState)!==p.RenderingStates.FINISHED){this._pageOpenPending.add(te);return}this._pageOpenPending.delete(te);const D=(async()=>{var Te,q;const k=await(W.has(te)?null:(Te=Pe.pdfPage)==null?void 0:Te.getJSActions());be===t(this,x)&&await((q=t(this,o))==null?void 0:q.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:te,actions:k}))})();W.set(te,D)},xn=async function(te){var Pe;const _e=t(this,x),be=this._visitedPages;if(!t(this,N)||this._pageOpenPending.has(te))return;const W=be.get(te);W&&(be.set(te,null),await W,_e===t(this,x)&&await((Pe=t(this,o))==null?void 0:Pe.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:te})))},Rs=function(){if(Ce(this,g,new r.PromiseCapability),t(this,o))throw new Error("#initScripting: Scripting already exists.");return t(this,P).createScripting({sandboxBundleSrc:t(this,I)})},Jt=async function(){var te,_e,be;if(!t(this,o)){Ce(this,x,null),(te=t(this,g))==null||te.resolve();return}t(this,N)&&(await Promise.race([t(this,N).promise,new Promise(W=>{setTimeout(W,1e3)})]).catch(()=>{}),Ce(this,N,null)),Ce(this,x,null);try{await t(this,o).destroySandbox()}catch{}(_e=t(this,s))==null||_e.reject(new Error("Scripting destroyed.")),Ce(this,s,null);for(const[W,Pe]of this._internalEvents)t(this,M)._off(W,Pe);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),Ce(this,o,null),Ce(this,F,!1),(be=t(this,g))==null||be.resolve()},w.PDFScriptingManager=H},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFSinglePageViewer=void 0;var p=E(2),r=E(25);class H extends r.PDFViewer{_resetView(){super._resetView(),this._scrollMode=p.ScrollMode.PAGE,this._spreadMode=p.SpreadMode.NONE}set scrollMode(g){}_updateScrollMode(){}set spreadMode(g){}_updateSpreadMode(){}}w.PDFSinglePageViewer=H},(O,w,E)=>{var I,o,s,Mn,f,T,Y,_,j,fe,te,_e,be,W,Pe,D,k,Te,q,m,y,U,Is,ks,Ds,Fs,ei,Pi,Os,Ln,Ns,Rt,Rn,Bs,Vs,In,Us;Object.defineProperty(w,"__esModule",{value:!0}),w.PagesCountLimit=w.PDFViewer=w.PDFPageViewBuffer=void 0;var p=E(4),r=E(2),H=E(7),N=E(13),g=E(26),u=E(5);const M=10,P={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};w.PagesCountLimit=P;function x(z){return Object.values(p.AnnotationEditorType).includes(z)&&z!==p.AnnotationEditorType.DISABLE}class S{constructor(h){Me(this,s);Me(this,I,new Set);Me(this,o,0);Ce(this,o,h)}push(h){const X=t(this,I);X.has(h)&&X.delete(h),X.add(h),X.size>t(this,o)&&ne(this,s,Mn).call(this)}resize(h,X=null){Ce(this,o,h);const oe=t(this,I);if(X){const Z=oe.size;let Le=1;for(const De of oe)if(X.has(De.id)&&(oe.delete(De),oe.add(De)),++Le>Z)break}for(;oe.size>t(this,o);)ne(this,s,Mn).call(this)}has(h){return t(this,I).has(h)}[Symbol.iterator](){return t(this,I).keys()}}I=new WeakMap,o=new WeakMap,s=new WeakSet,Mn=function(){const h=t(this,I).keys().next().value;h==null||h.destroy(),t(this,I).delete(h)},w.PDFPageViewBuffer=S;class F{constructor(h){Me(this,U);Me(this,f,null);Me(this,T,null);Me(this,Y,p.AnnotationEditorType.NONE);Me(this,_,null);Me(this,j,p.AnnotationMode.ENABLE_FORMS);Me(this,fe,null);Me(this,te,null);Me(this,_e,!1);Me(this,be,!1);Me(this,W,null);Me(this,Pe,!1);Me(this,D,0);Me(this,k,new ResizeObserver(ne(this,U,Us).bind(this)));Me(this,Te,null);Me(this,q,null);Me(this,m,null);Me(this,y,r.TextLayerMode.ENABLE);var oe,Z;const X="3.11.174";if(p.version!==X)throw new Error(`The API version "${p.version}" does not match the Viewer version "${X}".`);if(this.container=h.container,this.viewer=h.viewer||h.container.firstElementChild,((oe=this.container)==null?void 0:oe.tagName)!=="DIV"||((Z=this.viewer)==null?void 0:Z.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");t(this,k).observe(this.container),this.eventBus=h.eventBus,this.linkService=h.linkService||new u.SimpleLinkService,this.downloadManager=h.downloadManager||null,this.findController=h.findController||null,Ce(this,T,h.altTextManager||null),this.findController&&(this.findController.onIsPageVisible=Le=>this._getVisiblePages().ids.has(Le)),this._scriptingManager=h.scriptingManager||null,Ce(this,y,h.textLayerMode??r.TextLayerMode.ENABLE),Ce(this,j,h.annotationMode??p.AnnotationMode.ENABLE_FORMS),Ce(this,Y,h.annotationEditorMode??p.AnnotationEditorType.NONE),this.imageResourcesPath=h.imageResourcesPath||"",this.enablePrintAutoRotate=h.enablePrintAutoRotate||!1,this.removePageBorders=h.removePageBorders||!1,h.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),h.maxCanvasPixels=0),this.isOffscreenCanvasSupported=h.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=h.maxCanvasPixels,this.l10n=h.l10n||H.NullL10n,Ce(this,_e,h.enablePermissions||!1),this.pageColors=h.pageColors||null,this.defaultRenderingQueue=!h.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new g.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=h.renderingQueue,this.scroll=(0,r.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=r.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),ne(this,U,In).call(this),this.eventBus._on("thumbnailrendered",({pageNumber:Le,pdfPage:De})=>{const Ge=this._pages[Le-1];t(this,f).has(Ge)||De==null||De.cleanup()})}get pagesCount(){return this._pages.length}getPageView(h){return this._pages[h]}getCachedPageViews(){return new Set(t(this,f))}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(h=>h==null?void 0:h.pdfPage)}get renderForms(){return t(this,j)===p.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(h){if(!Number.isInteger(h))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(h,!0)||console.error(`currentPageNumber: "${h}" is not a valid page.`))}_setCurrentPageNumber(h,X=!1){var Z;if(this._currentPageNumber===h)return X&&ne(this,U,Rn).call(this),!0;if(!(0<h&&h<=this.pagesCount))return!1;const oe=this._currentPageNumber;return this._currentPageNumber=h,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:h,pageLabel:((Z=this._pageLabels)==null?void 0:Z[h-1])??null,previous:oe}),X&&ne(this,U,Rn).call(this),!0}get currentPageLabel(){var h;return((h=this._pageLabels)==null?void 0:h[this._currentPageNumber-1])??null}set currentPageLabel(h){if(!this.pdfDocument)return;let X=h|0;if(this._pageLabels){const oe=this._pageLabels.indexOf(h);oe>=0&&(X=oe+1)}this._setCurrentPageNumber(X,!0)||console.error(`currentPageLabel: "${h}" is not a valid page.`)}get currentScale(){return this._currentScale!==r.UNKNOWN_SCALE?this._currentScale:r.DEFAULT_SCALE}set currentScale(h){if(isNaN(h))throw new Error("Invalid numeric scale.");this.pdfDocument&&ne(this,U,Rt).call(this,h,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(h){this.pdfDocument&&ne(this,U,Rt).call(this,h,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(h){if(!(0,r.isValidRotation)(h))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(h%=360,h<0&&(h+=360),this._pagesRotation===h))return;this._pagesRotation=h;const X=this._currentPageNumber;this.refresh(!0,{rotation:h}),this._currentScaleValue&&ne(this,U,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:h,pageNumber:X}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}async getAllText(){const h=[],X=[];for(let oe=1,Z=this.pdfDocument.numPages;oe<=Z;++oe){if(t(this,Pe))return null;X.length=0;const Le=await this.pdfDocument.getPage(oe),{items:De}=await Le.getTextContent();for(const Ge of De)Ge.str&&X.push(Ge.str),Ge.hasEOL&&X.push(`
`);h.push((0,r.removeNullCharacters)(X.join("")))}return h.join(`
`)}setDocument(h){var De,Ge;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(De=this.findController)==null||De.setDocument(null),(Ge=this._scriptingManager)==null||Ge.setDocument(null),t(this,_)&&(t(this,_).destroy(),Ce(this,_,null))),this.pdfDocument=h,!h)return;const X=h.numPages,oe=h.getPage(1),Z=h.getOptionalContentConfig(),Le=t(this,_e)?h.getPermissions():Promise.resolve();if(X>P.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const Ve=this._scrollMode=r.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:Ve})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:X})},()=>{}),this._onBeforeDraw=Ve=>{const Je=this._pages[Ve.pageNumber-1];Je&&t(this,f).push(Je)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=Ve=>{Ve.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:Ve.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,t(this,q)&&(document.removeEventListener("visibilitychange",t(this,q)),Ce(this,q,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([oe,Le]).then(([Ve,Je])=>{var ft,ut;if(h!==this.pdfDocument)return;this._firstPageCapability.resolve(Ve),this._optionalContentConfigPromise=Z;const{annotationEditorMode:Ze,annotationMode:it,textLayerMode:pt}=ne(this,U,ks).call(this,Je);if(pt!==r.TextLayerMode.DISABLE){const Se=Ce(this,W,document.createElement("div"));Se.id="hiddenCopyElement",this.viewer.before(Se)}if(Ze!==p.AnnotationEditorType.DISABLE){const Se=Ze;h.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):x(Se)?(Ce(this,_,new p.AnnotationEditorUIManager(this.container,this.viewer,t(this,T),this.eventBus,h,this.pageColors)),Se!==p.AnnotationEditorType.NONE&&t(this,_).updateMode(Se)):console.error(`Invalid AnnotationEditor mode: ${Se}`)}const mt=ne(this,U,Is).bind(this),Xe=this._scrollMode===r.ScrollMode.PAGE?null:this.viewer,Be=this.currentScale,Ue=Ve.getViewport({scale:Be*p.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",Ue.scale),(((ft=this.pageColors)==null?void 0:ft.foreground)==="CanvasText"||((ut=this.pageColors)==null?void 0:ut.background)==="Canvas")&&this.viewer.style.setProperty("--hcm-highligh-filter",h.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"));for(let Se=1;Se<=X;++Se){const We=new N.PDFPageView({container:Xe,eventBus:this.eventBus,id:Se,scale:Be,defaultViewport:Ue.clone(),optionalContentConfigPromise:Z,renderingQueue:this.renderingQueue,textLayerMode:pt,annotationMode:it,imageResourcesPath:this.imageResourcesPath,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:mt});this._pages.push(We)}const nt=this._pages[0];nt&&(nt.setPdfPage(Ve),this.linkService.cachePageRef(1,Ve.ref)),this._scrollMode===r.ScrollMode.PAGE?ne(this,U,ei).call(this):this._spreadMode!==r.SpreadMode.NONE&&this._updateSpreadMode(),ne(this,U,Ds).call(this).then(async()=>{var We,et;if((We=this.findController)==null||We.setDocument(h),(et=this._scriptingManager)==null||et.setDocument(h),t(this,W)&&(Ce(this,te,ne(this,U,Fs).bind(this,pt)),document.addEventListener("copy",t(this,te))),t(this,_)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:t(this,Y)}),h.loadingParams.disableAutoFetch||X>P.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let Se=X-1;if(Se<=0){this._pagesCapability.resolve();return}for(let rt=2;rt<=X;++rt){const ot=h.getPage(rt).then(tt=>{const ve=this._pages[rt-1];ve.pdfPage||ve.setPdfPage(tt),this.linkService.cachePageRef(rt,tt.ref),--Se===0&&this._pagesCapability.resolve()},tt=>{console.error(`Unable to get page ${rt} to initialize viewer`,tt),--Se===0&&this._pagesCapability.resolve()});rt%P.PAUSE_EAGER_PAGE_INIT===0&&await ot}}),this.eventBus.dispatch("pagesinit",{source:this}),h.getMetadata().then(({info:Se})=>{h===this.pdfDocument&&Se.Language&&(this.viewer.lang=Se.Language)}),this.defaultRenderingQueue&&this.update()}).catch(Ve=>{console.error("Unable to initialize viewer",Ve),this._pagesCapability.reject(Ve)})}setPageLabels(h){var X;if(this.pdfDocument){h?Array.isArray(h)&&this.pdfDocument.numPages===h.length?this._pageLabels=h:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let oe=0,Z=this._pages.length;oe<Z;oe++)this._pages[oe].setPageLabel(((X=this._pageLabels)==null?void 0:X[oe])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=r.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,Ce(this,f,new S(M)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new p.PromiseCapability,this._onePageRenderedCapability=new p.PromiseCapability,this._pagesCapability=new p.PromiseCapability,this._scrollMode=r.ScrollMode.VERTICAL,this._previousScrollMode=r.ScrollMode.UNKNOWN,this._spreadMode=r.SpreadMode.NONE,Ce(this,Te,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),t(this,q)&&(document.removeEventListener("visibilitychange",t(this,q)),Ce(this,q,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),t(this,W)&&(document.removeEventListener("copy",t(this,te)),Ce(this,te,null),t(this,W).remove(),Ce(this,W,null))}_scrollUpdate(){this.pagesCount!==0&&this.update()}pageLabelToPageNumber(h){if(!this._pageLabels)return null;const X=this._pageLabels.indexOf(h);return X<0?null:X+1}scrollPageIntoView({pageNumber:h,destArray:X=null,allowNegativeOffset:oe=!1,ignoreDestinationZoom:Z=!1}){if(!this.pdfDocument)return;const Le=Number.isInteger(h)&&this._pages[h-1];if(!Le){console.error(`scrollPageIntoView: "${h}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!X){this._setCurrentPageNumber(h,!0);return}let De=0,Ge=0,Ve=0,Je=0,Ze,it;const pt=Le.rotation%180!==0,mt=(pt?Le.height:Le.width)/Le.scale/p.PixelsPerInch.PDF_TO_CSS_UNITS,Xe=(pt?Le.width:Le.height)/Le.scale/p.PixelsPerInch.PDF_TO_CSS_UNITS;let Be=0;switch(X[1].name){case"XYZ":De=X[2],Ge=X[3],Be=X[4],De=De!==null?De:0,Ge=Ge!==null?Ge:Xe;break;case"Fit":case"FitB":Be="page-fit";break;case"FitH":case"FitBH":Ge=X[2],Be="page-width",Ge===null&&this._location?(De=this._location.left,Ge=this._location.top):(typeof Ge!="number"||Ge<0)&&(Ge=Xe);break;case"FitV":case"FitBV":De=X[2],Ve=mt,Je=Xe,Be="page-height";break;case"FitR":De=X[2],Ge=X[3],Ve=X[4]-De,Je=X[5]-Ge;let ut=r.SCROLLBAR_PADDING,Se=r.VERTICAL_PADDING;this.removePageBorders&&(ut=Se=0),Ze=(this.container.clientWidth-ut)/Ve/p.PixelsPerInch.PDF_TO_CSS_UNITS,it=(this.container.clientHeight-Se)/Je/p.PixelsPerInch.PDF_TO_CSS_UNITS,Be=Math.min(Math.abs(Ze),Math.abs(it));break;default:console.error(`scrollPageIntoView: "${X[1].name}" is not a valid destination type.`);return}if(Z||(Be&&Be!==this._currentScale?this.currentScaleValue=Be:this._currentScale===r.UNKNOWN_SCALE&&(this.currentScaleValue=r.DEFAULT_SCALE_VALUE)),Be==="page-fit"&&!X[4]){ne(this,U,Pi).call(this,Le);return}const Ue=[Le.viewport.convertToViewportPoint(De,Ge),Le.viewport.convertToViewportPoint(De+Ve,Ge+Je)];let nt=Math.min(Ue[0][0],Ue[1][0]),ft=Math.min(Ue[0][1],Ue[1][1]);oe||(nt=Math.max(nt,0),ft=Math.max(ft,0)),ne(this,U,Pi).call(this,Le,{left:nt,top:ft})}_updateLocation(h){const X=this._currentScale,oe=this._currentScaleValue,Z=parseFloat(oe)===X?Math.round(X*1e4)/100:oe,Le=h.id,De=this._pages[Le-1],Ge=this.container,Ve=De.getPagePoint(Ge.scrollLeft-h.x,Ge.scrollTop-h.y),Je=Math.round(Ve[0]),Ze=Math.round(Ve[1]);let it=`#page=${Le}`;this.isInPresentationMode||(it+=`&zoom=${Z},${Je},${Ze}`),this._location={pageNumber:Le,scale:Z,top:Ze,left:Je,rotation:this._pagesRotation,pdfOpenParams:it}}update(){const h=this._getVisiblePages(),X=h.views,oe=X.length;if(oe===0)return;const Z=Math.max(M,2*oe+1);t(this,f).resize(Z,h.ids),this.renderingQueue.renderHighestPriority(h);const Le=this._spreadMode===r.SpreadMode.NONE&&(this._scrollMode===r.ScrollMode.PAGE||this._scrollMode===r.ScrollMode.VERTICAL),De=this._currentPageNumber;let Ge=!1;for(const Ve of X){if(Ve.percent<100)break;if(Ve.id===De&&Le){Ge=!0;break}}this._setCurrentPageNumber(Ge?De:X[0].id),this._updateLocation(h.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(h){return this.container.contains(h)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===r.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===r.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const h=this._scrollMode===r.ScrollMode.PAGE?t(this,Te).pages:this._pages,X=this._scrollMode===r.ScrollMode.HORIZONTAL,oe=X&&this._isContainerRtl;return(0,r.getVisibleElements)({scrollEl:this.container,views:h,sortByVisibility:!0,horizontal:X,rtl:oe})}cleanup(){for(const h of this._pages)h.renderingState!==r.RenderingStates.FINISHED&&h.reset()}_cancelRendering(){for(const h of this._pages)h.cancelRendering()}forceRendering(h){const X=h||this._getVisiblePages(),oe=ne(this,U,Vs).call(this,X),Z=this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL,Le=this.renderingQueue.getHighestPriority(X,this._pages,oe,Z);return Le?(ne(this,U,Bs).call(this,Le).then(()=>{this.renderingQueue.renderView(Le)}),!0):!1}get hasEqualPageSizes(){const h=this._pages[0];for(let X=1,oe=this._pages.length;X<oe;++X){const Z=this._pages[X];if(Z.width!==h.width||Z.height!==h.height)return!1}return!0}getPagesOverview(){let h;return this._pages.map(X=>{const oe=X.pdfPage.getViewport({scale:1}),Z=(0,r.isPortraitOrientation)(oe);if(h===void 0)h=Z;else if(this.enablePrintAutoRotate&&Z!==h)return{width:oe.height,height:oe.width,rotation:(oe.rotation-90)%360};return{width:oe.width,height:oe.height,rotation:oe.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(h){if(!(h instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${h}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=h,this.refresh(!1,{optionalContentConfigPromise:h}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:h}))}get scrollMode(){return this._scrollMode}set scrollMode(h){if(this._scrollMode!==h){if(!(0,r.isValidScrollMode)(h))throw new Error(`Invalid scroll mode: ${h}`);this.pagesCount>P.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=h,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:h}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(h=null){const X=this._scrollMode,oe=this.viewer;oe.classList.toggle("scrollHorizontal",X===r.ScrollMode.HORIZONTAL),oe.classList.toggle("scrollWrapped",X===r.ScrollMode.WRAPPED),!(!this.pdfDocument||!h)&&(X===r.ScrollMode.PAGE?ne(this,U,ei).call(this):this._previousScrollMode===r.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&ne(this,U,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(h,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(h){if(this._spreadMode!==h){if(!(0,r.isValidSpreadMode)(h))throw new Error(`Invalid spread mode: ${h}`);this._spreadMode=h,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:h}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(h=null){if(!this.pdfDocument)return;const X=this.viewer,oe=this._pages;if(this._scrollMode===r.ScrollMode.PAGE)ne(this,U,ei).call(this);else if(X.textContent="",this._spreadMode===r.SpreadMode.NONE)for(const Z of this._pages)X.append(Z.div);else{const Z=this._spreadMode-1;let Le=null;for(let De=0,Ge=oe.length;De<Ge;++De)Le===null?(Le=document.createElement("div"),Le.className="spread",X.append(Le)):De%2===Z&&(Le=Le.cloneNode(!1),X.append(Le)),Le.append(oe[De].div)}h&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&ne(this,U,Rt).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(h,!0),this.update())}_getPageAdvance(h,X=!1){switch(this._scrollMode){case r.ScrollMode.WRAPPED:{const{views:oe}=this._getVisiblePages(),Z=new Map;for(const{id:Le,y:De,percent:Ge,widthPercent:Ve}of oe){if(Ge===0||Ve<100)continue;let Je=Z.get(De);Je||Z.set(De,Je||(Je=[])),Je.push(Le)}for(const Le of Z.values()){const De=Le.indexOf(h);if(De===-1)continue;const Ge=Le.length;if(Ge===1)break;if(X)for(let Ve=De-1,Je=0;Ve>=Je;Ve--){const Ze=Le[Ve],it=Le[Ve+1]-1;if(Ze<it)return h-it}else for(let Ve=De+1,Je=Ge;Ve<Je;Ve++){const Ze=Le[Ve],it=Le[Ve-1]+1;if(Ze>it)return it-h}if(X){const Ve=Le[0];if(Ve<h)return h-Ve+1}else{const Ve=Le[Ge-1];if(Ve>h)return Ve-h+1}break}break}case r.ScrollMode.HORIZONTAL:break;case r.ScrollMode.PAGE:case r.ScrollMode.VERTICAL:{if(this._spreadMode===r.SpreadMode.NONE)break;const oe=this._spreadMode-1;if(X&&h%2!==oe)break;if(!X&&h%2===oe)break;const{views:Z}=this._getVisiblePages(),Le=X?h-1:h+1;for(const{id:De,percent:Ge,widthPercent:Ve}of Z)if(De===Le){if(Ge>0&&Ve===100)return 2;break}break}}return 1}nextPage(){const h=this._currentPageNumber,X=this.pagesCount;if(h>=X)return!1;const oe=this._getPageAdvance(h,!1)||1;return this.currentPageNumber=Math.min(h+oe,X),!0}previousPage(){const h=this._currentPageNumber;if(h<=1)return!1;const X=this._getPageAdvance(h,!0)||1;return this.currentPageNumber=Math.max(h-X,1),!0}increaseScale({drawingDelay:h,scaleFactor:X,steps:oe}={}){if(!this.pdfDocument)return;let Z=this._currentScale;if(X>1)Z=Math.round(Z*X*100)/100;else{oe??(oe=1);do Z=Math.ceil((Z*r.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--oe>0&&Z<r.MAX_SCALE)}ne(this,U,Rt).call(this,Math.min(r.MAX_SCALE,Z),{noScroll:!1,drawingDelay:h})}decreaseScale({drawingDelay:h,scaleFactor:X,steps:oe}={}){if(!this.pdfDocument)return;let Z=this._currentScale;if(X>0&&X<1)Z=Math.round(Z*X*100)/100;else{oe??(oe=1);do Z=Math.floor((Z/r.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--oe>0&&Z>r.MIN_SCALE)}ne(this,U,Rt).call(this,Math.max(r.MIN_SCALE,Z),{noScroll:!1,drawingDelay:h})}get containerTopLeft(){return t(this,fe)||Ce(this,fe,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return t(this,_)?t(this,Y):p.AnnotationEditorType.DISABLE}set annotationEditorMode({mode:h,editId:X=null}){if(!t(this,_))throw new Error("The AnnotationEditor is not enabled.");if(t(this,Y)!==h){if(!x(h))throw new Error(`Invalid AnnotationEditor mode: ${h}`);this.pdfDocument&&(Ce(this,Y,h),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:h}),t(this,_).updateMode(h,X))}}set annotationEditorParams({type:h,value:X}){if(!t(this,_))throw new Error("The AnnotationEditor is not enabled.");t(this,_).updateParams(h,X)}refresh(h=!1,X=Object.create(null)){if(this.pdfDocument){for(const oe of this._pages)oe.update(X);t(this,m)!==null&&(clearTimeout(t(this,m)),Ce(this,m,null)),h||this.update()}}}f=new WeakMap,T=new WeakMap,Y=new WeakMap,_=new WeakMap,j=new WeakMap,fe=new WeakMap,te=new WeakMap,_e=new WeakMap,be=new WeakMap,W=new WeakMap,Pe=new WeakMap,D=new WeakMap,k=new WeakMap,Te=new WeakMap,q=new WeakMap,m=new WeakMap,y=new WeakMap,U=new WeakSet,Is=function(){const h=this;return{get annotationEditorUIManager(){return t(h,_)},get annotationStorage(){var X;return(X=h.pdfDocument)==null?void 0:X.annotationStorage},get downloadManager(){return h.downloadManager},get enableScripting(){return!!h._scriptingManager},get fieldObjectsPromise(){var X;return(X=h.pdfDocument)==null?void 0:X.getFieldObjects()},get findController(){return h.findController},get hasJSActionsPromise(){var X;return(X=h.pdfDocument)==null?void 0:X.hasJSActions()},get linkService(){return h.linkService}}},ks=function(h){const X={annotationEditorMode:t(this,Y),annotationMode:t(this,j),textLayerMode:t(this,y)};return h&&(!h.includes(p.PermissionFlag.COPY)&&t(this,y)===r.TextLayerMode.ENABLE&&(X.textLayerMode=r.TextLayerMode.ENABLE_PERMISSIONS),h.includes(p.PermissionFlag.MODIFY_CONTENTS)||(X.annotationEditorMode=p.AnnotationEditorType.DISABLE),!h.includes(p.PermissionFlag.MODIFY_ANNOTATIONS)&&!h.includes(p.PermissionFlag.FILL_INTERACTIVE_FORMS)&&t(this,j)===p.AnnotationMode.ENABLE_FORMS&&(X.annotationMode=p.AnnotationMode.ENABLE)),X},Ds=function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const h=new Promise(X=>{Ce(this,q,()=>{document.visibilityState==="hidden"&&(X(),document.removeEventListener("visibilitychange",t(this,q)),Ce(this,q,null))}),document.addEventListener("visibilitychange",t(this,q))});return Promise.race([this._onePageRenderedCapability.promise,h])},Fs=function(h,X){const oe=document.getSelection(),{focusNode:Z,anchorNode:Le}=oe;if(Le&&Z&&oe.containsNode(t(this,W))){if(t(this,be)||h===r.TextLayerMode.ENABLE_PERMISSIONS){X.preventDefault(),X.stopPropagation();return}Ce(this,be,!0);const De=this.container.style.cursor;this.container.style.cursor="wait";const Ge=Ve=>Ce(this,Pe,Ve.key==="Escape");window.addEventListener("keydown",Ge),this.getAllText().then(async Ve=>{Ve!==null&&await navigator.clipboard.writeText(Ve)}).catch(Ve=>{console.warn(`Something goes wrong when extracting the text: ${Ve.message}`)}).finally(()=>{Ce(this,be,!1),Ce(this,Pe,!1),window.removeEventListener("keydown",Ge),this.container.style.cursor=De}),X.preventDefault(),X.stopPropagation()}},ei=function(){if(this._scrollMode!==r.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const h=this._currentPageNumber,X=t(this,Te),oe=this.viewer;if(oe.textContent="",X.pages.length=0,this._spreadMode===r.SpreadMode.NONE&&!this.isInPresentationMode){const Z=this._pages[h-1];oe.append(Z.div),X.pages.push(Z)}else{const Z=new Set,Le=this._spreadMode-1;Le===-1?Z.add(h-1):h%2!==Le?(Z.add(h-1),Z.add(h)):(Z.add(h-2),Z.add(h-1));const De=document.createElement("div");if(De.className="spread",this.isInPresentationMode){const Ge=document.createElement("div");Ge.className="dummyPage",De.append(Ge)}for(const Ge of Z){const Ve=this._pages[Ge];Ve&&(De.append(Ve.div),X.pages.push(Ve))}oe.append(De)}X.scrollDown=h>=X.previousPageNumber,X.previousPageNumber=h},Pi=function(h,X=null){const{div:oe,id:Z}=h;if(this._currentPageNumber!==Z&&this._setCurrentPageNumber(Z),this._scrollMode===r.ScrollMode.PAGE&&(ne(this,U,ei).call(this),this.update()),!X&&!this.isInPresentationMode){const Le=oe.offsetLeft+oe.clientLeft,De=Le+oe.clientWidth,{scrollLeft:Ge,clientWidth:Ve}=this.container;(this._scrollMode===r.ScrollMode.HORIZONTAL||Le<Ge||De>Ge+Ve)&&(X={left:0,top:0})}(0,r.scrollIntoView)(oe,X),!this._currentScaleValue&&this._location&&(this._location=null)},Os=function(h){return h===this._currentScale||Math.abs(h-this._currentScale)<1e-15},Ln=function(h,X,{noScroll:oe=!1,preset:Z=!1,drawingDelay:Le=-1}){if(this._currentScaleValue=X.toString(),ne(this,U,Os).call(this,h)){Z&&this.eventBus.dispatch("scalechanging",{source:this,scale:h,presetValue:X});return}this.viewer.style.setProperty("--scale-factor",h*p.PixelsPerInch.PDF_TO_CSS_UNITS);const De=Le>=0&&Le<1e3;if(this.refresh(!0,{scale:h,drawingDelay:De?Le:-1}),De&&Ce(this,m,setTimeout(()=>{Ce(this,m,null),this.refresh()},Le)),this._currentScale=h,!oe){let Ge=this._currentPageNumber,Ve;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(Ge=this._location.pageNumber,Ve=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:Ge,destArray:Ve,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:h,presetValue:Z?X:void 0}),this.defaultRenderingQueue&&this.update()},Ns=function(){return this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL?2:1},Rt=function(h,X){let oe=parseFloat(h);if(oe>0)X.preset=!1,ne(this,U,Ln).call(this,oe,h,X);else{const Z=this._pages[this._currentPageNumber-1];if(!Z)return;let Le=r.SCROLLBAR_PADDING,De=r.VERTICAL_PADDING;this.isInPresentationMode?(Le=De=4,this._spreadMode!==r.SpreadMode.NONE&&(Le*=2)):this.removePageBorders?Le=De=0:this._scrollMode===r.ScrollMode.HORIZONTAL&&([Le,De]=[De,Le]);const Ge=(this.container.clientWidth-Le)/Z.width*Z.scale/t(this,U,Ns),Ve=(this.container.clientHeight-De)/Z.height*Z.scale;switch(h){case"page-actual":oe=1;break;case"page-width":oe=Ge;break;case"page-height":oe=Ve;break;case"page-fit":oe=Math.min(Ge,Ve);break;case"auto":const Je=(0,r.isPortraitOrientation)(Z)?Ge:Math.min(Ve,Ge);oe=Math.min(r.MAX_AUTO_SCALE,Je);break;default:console.error(`#setScale: "${h}" is an unknown zoom value.`);return}X.preset=!0,ne(this,U,Ln).call(this,oe,h,X)}},Rn=function(){const h=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&ne(this,U,Rt).call(this,this._currentScaleValue,{noScroll:!0}),ne(this,U,Pi).call(this,h)},Bs=async function(h){var X,oe;if(h.pdfPage)return h.pdfPage;try{const Z=await this.pdfDocument.getPage(h.id);return h.pdfPage||h.setPdfPage(Z),(oe=(X=this.linkService)._cachedPageNumber)!=null&&oe.call(X,Z.ref)||this.linkService.cachePageRef(h.id,Z.ref),Z}catch(Z){return console.error("Unable to get page for page view",Z),null}},Vs=function(h){var X,oe;if(((X=h.first)==null?void 0:X.id)===1)return!0;if(((oe=h.last)==null?void 0:oe.id)===this.pagesCount)return!1;switch(this._scrollMode){case r.ScrollMode.PAGE:return t(this,Te).scrollDown;case r.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},In=function(h=this.container.clientHeight){h!==t(this,D)&&(Ce(this,D,h),r.docStyle.setProperty("--viewer-container-height",`${h}px`))},Us=function(h){for(const X of h)if(X.target===this.container){ne(this,U,In).call(this,Math.floor(X.borderBoxSize[0].blockSize)),Ce(this,fe,null);break}},w.PDFViewer=F},(O,w,E)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFRenderingQueue=void 0;var p=E(4),r=E(2);const H=3e4;class N{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(u){this.pdfViewer=u}setThumbnailViewer(u){this.pdfThumbnailViewer=u}isHighestPriority(u){return this.highestPriorityPage===u.renderingId}renderHighestPriority(u){var M;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(u)&&(this.isThumbnailViewEnabled&&((M=this.pdfThumbnailViewer)!=null&&M.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),H)))}getHighestPriority(u,M,P,x=!1){const S=u.views,F=S.length;if(F===0)return null;for(let f=0;f<F;f++){const T=S[f].view;if(!this.isViewFinished(T))return T}const I=u.first.id,o=u.last.id;if(o-I+1>F){const f=u.ids;for(let T=1,Y=o-I;T<Y;T++){const _=P?I+T:o-T;if(f.has(_))continue;const j=M[_-1];if(!this.isViewFinished(j))return j}}let s=P?o:I-2,c=M[s];return c&&!this.isViewFinished(c)||x&&(s+=P?1:-1,c=M[s],c&&!this.isViewFinished(c))?c:null}isViewFinished(u){return u.renderingState===r.RenderingStates.FINISHED}renderView(u){switch(u.renderingState){case r.RenderingStates.FINISHED:return!1;case r.RenderingStates.PAUSED:this.highestPriorityPage=u.renderingId,u.resume();break;case r.RenderingStates.RUNNING:this.highestPriorityPage=u.renderingId;break;case r.RenderingStates.INITIAL:this.highestPriorityPage=u.renderingId,u.draw().finally(()=>{this.renderHighestPriority()}).catch(M=>{M instanceof p.RenderingCancelledException||console.error(`renderView: "${M}"`)});break}return!0}}w.PDFRenderingQueue=N}],n={};function d(O){var w=n[O];if(w!==void 0)return w.exports;var E=n[O]={exports:{}};return v[O](E,E.exports,d),E.exports}var re={};return(()=>{var O=re;Object.defineProperty(O,"__esModule",{value:!0}),Object.defineProperty(O,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return r.AnnotationLayerBuilder}}),Object.defineProperty(O,"DownloadManager",{enumerable:!0,get:function(){return H.DownloadManager}}),Object.defineProperty(O,"EventBus",{enumerable:!0,get:function(){return N.EventBus}}),Object.defineProperty(O,"FindState",{enumerable:!0,get:function(){return w.FindState}}),Object.defineProperty(O,"GenericL10n",{enumerable:!0,get:function(){return g.GenericL10n}}),Object.defineProperty(O,"LinkTarget",{enumerable:!0,get:function(){return E.LinkTarget}}),Object.defineProperty(O,"NullL10n",{enumerable:!0,get:function(){return u.NullL10n}}),Object.defineProperty(O,"PDFFindController",{enumerable:!0,get:function(){return w.PDFFindController}}),Object.defineProperty(O,"PDFHistory",{enumerable:!0,get:function(){return M.PDFHistory}}),Object.defineProperty(O,"PDFLinkService",{enumerable:!0,get:function(){return E.PDFLinkService}}),Object.defineProperty(O,"PDFPageView",{enumerable:!0,get:function(){return P.PDFPageView}}),Object.defineProperty(O,"PDFScriptingManager",{enumerable:!0,get:function(){return x.PDFScriptingManager}}),Object.defineProperty(O,"PDFSinglePageViewer",{enumerable:!0,get:function(){return S.PDFSinglePageViewer}}),Object.defineProperty(O,"PDFViewer",{enumerable:!0,get:function(){return F.PDFViewer}}),Object.defineProperty(O,"ProgressBar",{enumerable:!0,get:function(){return p.ProgressBar}}),Object.defineProperty(O,"RenderingStates",{enumerable:!0,get:function(){return p.RenderingStates}}),Object.defineProperty(O,"ScrollMode",{enumerable:!0,get:function(){return p.ScrollMode}}),Object.defineProperty(O,"SimpleLinkService",{enumerable:!0,get:function(){return E.SimpleLinkService}}),Object.defineProperty(O,"SpreadMode",{enumerable:!0,get:function(){return p.SpreadMode}}),Object.defineProperty(O,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return I.StructTreeLayerBuilder}}),Object.defineProperty(O,"TextLayerBuilder",{enumerable:!0,get:function(){return o.TextLayerBuilder}}),Object.defineProperty(O,"XfaLayerBuilder",{enumerable:!0,get:function(){return s.XfaLayerBuilder}}),Object.defineProperty(O,"parseQueryString",{enumerable:!0,get:function(){return p.parseQueryString}});var w=d(1),E=d(5),p=d(2),r=d(6),H=d(8),N=d(9),g=d(10),u=d(7),M=d(12),P=d(13),x=d(21),S=d(24),F=d(25),I=d(16),o=d(19),s=d(20)})(),re})())})(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;const DELAY_BEFORE_HIDING_CONTROLS=3e3,ACTIVE_SELECTOR="pdfPresentationMode",CONTROLS_SELECTOR="pdfPresentationModeControls",MOUSE_SCROLL_COOLDOWN_TIME=50,PAGE_SWITCH_THRESHOLD=.1,SWIPE_MIN_DISTANCE_THRESHOLD=50,SWIPE_ANGLE_THRESHOLD=Math.PI/6;var jt,Pt,vt,Hs,ti,Ws,js,$s,zs,kn,Gs,ii,Xs,qs,Ys,Ks,Qs,Dn;class PDFPresentationMode{constructor({container:e,pdfViewer:v,eventBus:n}){Me(this,vt);at(this,"container");at(this,"pdfViewer");at(this,"eventBus");at(this,"contextMenuOpen");at(this,"mouseScrollTimeStamp");at(this,"mouseScrollDelta");at(this,"touchSwipeState");at(this,"controlsTimeout");at(this,"showControlsBind");at(this,"mouseDownBind");at(this,"mouseWheelBind");at(this,"resetMouseScrollStateBind");at(this,"contextMenuBind");at(this,"touchSwipeBind");at(this,"fullscreenChangeBind");Me(this,jt,PresentationModeState.UNKNOWN);Me(this,Pt,null);this.container=e,this.pdfViewer=v,this.eventBus=n,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}async request(){const{container:e,pdfViewer:v}=this;if(this.active||!v.pagesCount||!e.requestFullscreen)return!1;ne(this,vt,Qs).call(this),ne(this,vt,ti).call(this,PresentationModeState.CHANGING);const n=e.requestFullscreen();Ce(this,Pt,{pageNumber:v.currentPageNumber,scaleValue:v.currentScaleValue,scrollMode:v.scrollMode,spreadMode:null,annotationEditorMode:null}),v.spreadMode!==SpreadMode.NONE&&!(v.pageViewsReady&&v.hasEqualPageSizes)&&(console.warn("Ignoring Spread modes when entering PresentationMode, since the document may contain varying page sizes."),t(this,Pt).spreadMode=v.spreadMode),v.annotationEditorMode!==pdfExports.AnnotationEditorType.DISABLE&&(t(this,Pt).annotationEditorMode=v.annotationEditorMode);try{return await n,v.focus(),!0}catch{ne(this,vt,Dn).call(this),ne(this,vt,ti).call(this,PresentationModeState.NORMAL)}return!1}get active(){return t(this,jt)===PresentationModeState.CHANGING||t(this,jt)===PresentationModeState.FULLSCREEN}}jt=new WeakMap,Pt=new WeakMap,vt=new WeakSet,Hs=function(e){if(!this.active)return;e.preventDefault();const v=normalizeWheelEventDelta(e),n=Date.now(),d=this.mouseScrollTimeStamp;if(!(n>d&&n-d<MOUSE_SCROLL_COOLDOWN_TIME)&&((this.mouseScrollDelta>0&&v<0||this.mouseScrollDelta<0&&v>0)&&ne(this,vt,ii).call(this),this.mouseScrollDelta+=v,Math.abs(this.mouseScrollDelta)>=PAGE_SWITCH_THRESHOLD)){const re=this.mouseScrollDelta;ne(this,vt,ii).call(this),(re>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=n)}},ti=function(e){Ce(this,jt,e),this.eventBus.dispatch("presentationmodechanged",{source:this,state:e})},Ws=function(){var e;ne(this,vt,ti).call(this,PresentationModeState.FULLSCREEN),this.container.classList.add(ACTIVE_SELECTOR),setTimeout(()=>{this.pdfViewer.scrollMode=ScrollMode.PAGE,t(this,Pt).spreadMode!==null&&(this.pdfViewer.spreadMode=SpreadMode.NONE),this.pdfViewer.currentPageNumber=t(this,Pt).pageNumber,this.pdfViewer.currentScaleValue="page-fit",t(this,Pt).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},0),ne(this,vt,qs).call(this),ne(this,vt,kn).call(this),this.contextMenuOpen=!1,(e=window.getSelection())==null||e.removeAllRanges()},js=function(){const e=this.pdfViewer.currentPageNumber;this.container.classList.remove(ACTIVE_SELECTOR),setTimeout(()=>{var v;ne(this,vt,Dn).call(this),ne(this,vt,ti).call(this,PresentationModeState.NORMAL),this.pdfViewer.scrollMode=t(this,Pt).scrollMode,((v=t(this,Pt))==null?void 0:v.spreadMode)!==null&&(this.pdfViewer.spreadMode=t(this,Pt).spreadMode),this.pdfViewer.currentScaleValue=t(this,Pt).scaleValue,this.pdfViewer.currentPageNumber=e,t(this,Pt).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode=t(this,Pt).annotationEditorMode),Ce(this,Pt,null)},0),ne(this,vt,Ys).call(this),ne(this,vt,Gs).call(this),ne(this,vt,ii).call(this),this.contextMenuOpen=!1},$s=function(e){var v;if(this.contextMenuOpen){this.contextMenuOpen=!1,e.preventDefault();return}e.button===0&&(e.target.href&&((v=e.target.parentNode)!=null&&v.hasAttribute("data-internal-link"))||(e.preventDefault(),e.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))},zs=function(){this.contextMenuOpen=!0},kn=function(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(CONTROLS_SELECTOR),this.controlsTimeout=setTimeout(()=>{this.container.classList.remove(CONTROLS_SELECTOR),delete this.controlsTimeout},DELAY_BEFORE_HIDING_CONTROLS)},Gs=function(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(CONTROLS_SELECTOR),delete this.controlsTimeout)},ii=function(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0},Xs=function(e){if(this.active){if(e.touches.length>1){this.touchSwipeState=null;return}switch(e.type){case"touchstart":this.touchSwipeState={startX:e.touches[0].pageX,startY:e.touches[0].pageY,endX:e.touches[0].pageX,endY:e.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null)return;this.touchSwipeState.endX=e.touches[0].pageX,this.touchSwipeState.endY=e.touches[0].pageY,e.preventDefault();break;case"touchend":if(this.touchSwipeState===null)return;let v=0;const n=this.touchSwipeState.endX-this.touchSwipeState.startX,d=this.touchSwipeState.endY-this.touchSwipeState.startY,re=Math.abs(Math.atan2(d,n));Math.abs(n)>SWIPE_MIN_DISTANCE_THRESHOLD&&(re<=SWIPE_ANGLE_THRESHOLD||re>=Math.PI-SWIPE_ANGLE_THRESHOLD)?v=n:Math.abs(d)>SWIPE_MIN_DISTANCE_THRESHOLD&&Math.abs(re-Math.PI/2)<=SWIPE_ANGLE_THRESHOLD&&(v=d),v>0?this.pdfViewer.previousPage():v<0&&this.pdfViewer.nextPage();break}}},qs=function(){this.showControlsBind=ne(this,vt,kn).bind(this),this.mouseDownBind=ne(this,vt,$s).bind(this),this.mouseWheelBind=ne(this,vt,Hs).bind(this),this.resetMouseScrollStateBind=ne(this,vt,ii).bind(this),this.contextMenuBind=ne(this,vt,zs).bind(this),this.touchSwipeBind=ne(this,vt,Xs).bind(this),window.addEventListener("mousemove",this.showControlsBind),window.addEventListener("mousedown",this.mouseDownBind),window.addEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.addEventListener("keydown",this.resetMouseScrollStateBind),window.addEventListener("contextmenu",this.contextMenuBind),window.addEventListener("touchstart",this.touchSwipeBind),window.addEventListener("touchmove",this.touchSwipeBind),window.addEventListener("touchend",this.touchSwipeBind)},Ys=function(){window.removeEventListener("mousemove",this.showControlsBind),window.removeEventListener("mousedown",this.mouseDownBind),window.removeEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.removeEventListener("keydown",this.resetMouseScrollStateBind),window.removeEventListener("contextmenu",this.contextMenuBind),window.removeEventListener("touchstart",this.touchSwipeBind),window.removeEventListener("touchmove",this.touchSwipeBind),window.removeEventListener("touchend",this.touchSwipeBind),delete this.showControlsBind,delete this.mouseDownBind,delete this.mouseWheelBind,delete this.resetMouseScrollStateBind,delete this.contextMenuBind,delete this.touchSwipeBind},Ks=function(){document.fullscreenElement?ne(this,vt,Ws).call(this):ne(this,vt,js).call(this)},Qs=function(){this.fullscreenChangeBind=ne(this,vt,Ks).bind(this),window.addEventListener("fullscreenchange",this.fullscreenChangeBind)},Dn=function(){window.removeEventListener("fullscreenchange",this.fullscreenChangeBind),delete this.fullscreenChangeBind};const CLEANUP_TIMEOUT=3e4;class PDFRenderingQueue{constructor(){at(this,"pdfViewer");at(this,"pdfThumbnailViewer");at(this,"onIdle");at(this,"highestPriorityPage");at(this,"idleTimeout");at(this,"printing");at(this,"isThumbnailViewEnabled");this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(e){var v,n;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!((v=this.pdfViewer)!=null&&v.forceRendering(e))&&(this.isThumbnailViewEnabled&&((n=this.pdfThumbnailViewer)!=null&&n.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),CLEANUP_TIMEOUT)))}getHighestPriority(e,v,n,d=!1){const re=e.views,O=re.length;if(O===0)return null;for(let H=0;H<O;H++){const N=re[H].view;if(!this.isViewFinished(N))return N}const w=e.first.id,E=e.last.id;if(E-w+1>O){const H=e.ids;for(let N=1,g=E-w;N<g;N++){const u=n?w+N:E-N;if(H.has(u))continue;const M=v[u-1];if(!this.isViewFinished(M))return M}}let p=n?E:w-2,r=v[p];return r&&!this.isViewFinished(r)||d&&(p+=n?1:-1,r=v[p],r&&!this.isViewFinished(r))?r:null}isViewFinished(e){return e.renderingState===RenderingStates.FINISHED}renderView(e){switch(e.renderingState){case RenderingStates.FINISHED:return!1;case RenderingStates.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case RenderingStates.RUNNING:this.highestPriorityPage=e.renderingId;break;case RenderingStates.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(v=>{v instanceof pdfExports.RenderingCancelledException||console.error(`renderView: "${v}"`)});break}return!0}}var xt,Ct;class OverlayManager{constructor(){Me(this,xt,new WeakMap);Me(this,Ct,null)}get active(){return t(this,Ct)}async register(e,v=!1){if(typeof e!="object")throw new Error("Not enough parameters.");if(t(this,xt).has(e))throw new Error("The overlay is already registered.");t(this,xt).set(e,{canForceClose:v}),e.addEventListener("cancel",()=>{Ce(this,Ct,null)})}async unregister(e){if(t(this,xt).has(e)){if(t(this,Ct)===e)throw new Error("The overlay cannot be removed while it is active.")}else throw new Error("The overlay does not exist.");t(this,xt).delete(e)}async open(e){if(t(this,xt).has(e)){if(t(this,Ct)){if(t(this,Ct)===e)throw new Error("The overlay is already active.");if(t(this,xt).get(e).canForceClose)await this.close();else throw new Error("Another overlay is currently active.")}}else throw new Error("The overlay does not exist.");Ce(this,Ct,e),e.showModal()}async close(e=t(this,Ct)){if(!e||!t(this,xt).has(e))throw new Error("The overlay does not exist.");if(t(this,Ct)){if(t(this,Ct)!==e)throw new Error("Another overlay is currently active.")}else throw new Error("The overlay is currently not active.");e.close(),Ce(this,Ct,null)}}xt=new WeakMap,Ct=new WeakMap;function getXfaHtmlForPrinting(i,e){const v=e.allXfaHtml,n=new pdf_viewerExports.SimpleLinkService,d=Math.round(pdfExports.PixelsPerInch.PDF_TO_CSS_UNITS*100)/100;for(const re of v==null?void 0:v.children){const O=document.createElement("div");O.className="xfaPrintedPage",i.append(O);const w=new pdf_viewerExports.XfaLayerBuilder({pageDiv:O,pdfPage:null,annotationStorage:e.annotationStorage,linkService:n,xfaHtml:re}),E=pdfExports.getXfaPageViewport(re,{scale:d});w.render(E,"print")}}let activeService=null,dialog=null,overlayManager=new OverlayManager;function renderPage(i,e,v,n,d,re,O){const w=activeService.scratchCanvas,E=d/pdfExports.PixelsPerInch.PDF;w.width=Math.floor(n.width*E),w.height=Math.floor(n.height*E);const p=w.getContext("2d");return p.save(),p.fillStyle="rgb(255, 255, 255)",p.fillRect(0,0,w.width,w.height),p.restore(),Promise.all([e.getPage(v),O]).then(function([r,H]){const N={canvasContext:p,transform:[E,0,0,E,0,0],viewport:r.getViewport({scale:1,rotation:n.rotation}),intent:"print",annotationMode:pdfExports.AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:re,printAnnotationStorage:H};return r.render(N).promise})}class PDFPrintService{constructor(e,v,n,d,re=null,O=null,w){at(this,"pdfDocument");at(this,"pagesOverview");at(this,"printContainer");at(this,"_printResolution");at(this,"_optionalContentConfigPromise");at(this,"_printAnnotationStoragePromise");at(this,"l10n");at(this,"currentPage");at(this,"scratchCanvas");at(this,"pageStyleSheet");this.pdfDocument=e,this.pagesOverview=v,this.printContainer=n,this._printResolution=d||150,this._optionalContentConfigPromise=re||e.getOptionalContentConfig(),this._printAnnotationStoragePromise=O||Promise.resolve(),this.l10n=w,this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}layout(){this.throwIfInactive();const e=document.querySelector("body");e==null||e.setAttribute("data-pdfjsprinting","true"),this.pagesOverview.every(d=>d.width===this.pagesOverview[0].width&&d.height===this.pagesOverview[0].height,this)||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style");const n=this.pagesOverview[0];this.pageStyleSheet.textContent="@page { size: "+n.width+"pt "+n.height+"pt;}",e==null||e.append(this.pageStyleSheet)}destroy(){if(activeService!==this)return;this.printContainer.textContent="";const e=document.querySelector("body");e==null||e.removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,activeService=null,ensureOverlay().then(function(){overlayManager.active===dialog&&overlayManager.close(dialog)})}renderPages(){if(this.pdfDocument.isPureXfa)return getXfaHtmlForPrinting(this.printContainer,this.pdfDocument),Promise.resolve();const e=this.pagesOverview.length,v=(n,d)=>{if(this.throwIfInactive(),++this.currentPage>=e){renderProgress(e,e,this.l10n),n();return}const re=this.currentPage;renderProgress(re,e,this.l10n),renderPage(this,this.pdfDocument,re+1,this.pagesOverview[re],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then(function(){v(n,d)},d)};return new Promise(v)}useRenderedPage(){this.throwIfInactive();const e=document.createElement("img"),v=this.scratchCanvas;"toBlob"in v?v.toBlob(function(d){e.src=URL.createObjectURL(d)}):e.src=v==null?void 0:v.toDataURL();const n=document.createElement("div");return n.className="printedPage",n.append(e),this.printContainer.append(n),new Promise(function(d,re){e.onload=d,e.onerror=re})}performPrint(){return this.throwIfInactive(),new Promise(e=>{setTimeout(()=>{if(!this.active){e();return}print.call(window),setTimeout(e,20)},0)})}get active(){return this===activeService}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}const print=window.print;window.print=function(){if(activeService){console.warn("Ignored window.print() because of a pending print job.");return}ensureOverlay().then(function(){activeService&&overlayManager.open(dialog)});try{dispatchEvent("beforeprint")}finally{if(!activeService){console.error("Expected print service to be initialized."),ensureOverlay().then(function(){overlayManager.active===dialog&&overlayManager.close(dialog)});return}const i=activeService;activeService.renderPages().then(function(){return i.performPrint()}).catch(function(){}).then(function(){i.active&&abort()})}};function dispatchEvent(i){const e=document.createEvent("CustomEvent");e.initCustomEvent(i,!1,!1,"custom"),window.dispatchEvent(e)}function abort(){activeService&&(activeService.destroy(),dispatchEvent("afterprint"))}function renderProgress(i,e,v){dialog||(dialog=document.getElementById("printServiceDialog"));const n=Math.round(100*i/e),d=dialog.querySelector("progress"),re=dialog.querySelector(".relative-progress");d.value=n,v.get("print_progress_percent",{progress:n}).then(O=>{re.textContent=O})}window.addEventListener("keydown",function(i){i.keyCode===80&&(i.ctrlKey||i.metaKey)&&!i.altKey&&!i.shiftKey&&(window.print(),i.preventDefault(),i.stopImmediatePropagation())},!0);if("onbeforeprint"in window){const i=function(e){e.detail!=="custom"&&e.stopImmediatePropagation()};window.addEventListener("beforeprint",i),window.addEventListener("afterprint",i)}let overlayPromise;function ensureOverlay(){if(!overlayPromise){if(!overlayManager)throw new Error("The overlay manager has not yet been initialized.");dialog||(dialog=document.getElementById("printServiceDialog")),overlayPromise=overlayManager.register(dialog,!0),document.getElementById("printCancel").onclick=abort,dialog.addEventListener("close",abort)}return overlayPromise}const PDFPrintServiceFactory={instance:{supportsPrinting:!0,createPrintService(i,e,v,n,d,re,O){if(activeService)throw new Error("The print service is created and active.");return activeService=new PDFPrintService(i,e,v,n,d,re,O),activeService}}},US_PAGE_NAMES={"8.5x11":"Letter","8.5x14":"Legal"},METRIC_PAGE_NAMES={"297x420":"A3","210x297":"A4"};function getPageName(i,e,v){const n=e?i.width:i.height,d=e?i.height:i.width;return v[`${n}x${d}`]}pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.js`;var Ft,Ci,Ti,ni,si,ri,At,Zs,Js,er,tr,ir,nr,sr,rr,ar,or,lr;class PDFDocument{constructor({container:e,viewer:v,thumbs:n,options:d,store:re}){Me(this,At);Me(this,Ft);Me(this,Ci);Me(this,Ti);Me(this,ni);at(this,"printService");at(this,"url");at(this,"eventBus");at(this,"linkService");at(this,"downloadManager",null);at(this,"findController",null);at(this,"pdfPresentationMode",null);at(this,"viewer");at(this,"document",null);at(this,"store");at(this,"filename","");Me(this,si);Me(this,ri);at(this,"l10n");at(this,"singlePageViewer");at(this,"removePageBorders");at(this,"enablePrintAutoRotate");at(this,"useOnlyCssZoom");at(this,"pageColors");at(this,"textLayerMode");at(this,"maxCanvasPixels");at(this,"printResolution");at(this,"thumbnailWidth");Ce(this,Ci,e),Ce(this,Ti,v),Ce(this,ni,n),this.l10n=(d==null?void 0:d.l10n)??pdf_viewerExports.NullL10n,this.downloadManager=new pdf_viewerExports.DownloadManager,this.textLayerMode=(d==null?void 0:d.textLayerMode)??TextLayerMode.ENABLE,Ce(this,si,pdfExports.AnnotationMode.DISABLE),Ce(this,ri,pdfExports.AnnotationEditorType.DISABLE),this.removePageBorders=(d==null?void 0:d.removePageBorders)??!1,this.singlePageViewer=(d==null?void 0:d.singlePageViewer)??!1,this.enablePrintAutoRotate=(d==null?void 0:d.enablePrintAutoRotate)??!1,this.useOnlyCssZoom=(d==null?void 0:d.useOnlyCssZoom)??!1,this.pageColors=(d==null?void 0:d.pageColors)??null,this.maxCanvasPixels=(d==null?void 0:d.maxCanvasPixels)??16777216,this.printResolution=(d==null?void 0:d.printResolution)??96,this.thumbnailWidth=(d==null?void 0:d.thumbnailWidth)??125,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.l10n=pdf_viewerExports.NullL10n,this.store=re;const O=new PDFRenderingQueue;O.onIdle=this._cleanup.bind(this),O.isThumbnailViewEnabled=!0,Ce(this,Ft,O);const w=new pdf_viewerExports.EventBus,E=new pdf_viewerExports.PDFLinkService({eventBus:w,externalLinkTarget:2,externalLinkRel:"noopener noreferrer nofollow",ignoreDestinationZoom:!1}),p={container:e,...v&&{viewer:v},eventBus:w,linkService:E,renderingQueue:O,defaultRenderingQueue:!0,textLayerMode:this.textLayerMode,l10n:this.l10n,annotationMode:t(this,si),annotationEditorMode:t(this,ri),removePageBorders:this.removePageBorders,imageResourcesPath:"/images/",useOnlyCssZoom:this.useOnlyCssZoom},r=this.singlePageViewer?new pdf_viewerExports.PDFSinglePageViewer(p):new pdf_viewerExports.PDFViewer(p);O.setViewer(r),document.fullscreenEnabled&&(this.pdfPresentationMode=new PDFPresentationMode({container:e,pdfViewer:r,eventBus:w})),this.eventBus=w,this.linkService=E,this.viewer=r,this.linkService.setViewer(r);const H=(d==null?void 0:d.scaleValue)??"auto";this.store.setDocumentState({scaleValue:H})}async loadDocument(e,v){var re,O,w;if(this.url)try{URL.revokeObjectURL(this.url.toString())}catch{}(re=this.document)==null||re.destroy(),(O=this.viewer)==null||O.cleanup(),this.url=e.toString();const n=(v==null?void 0:v.filename)??pdfExports.getPdfFilenameFromUrl((w=this.url)==null?void 0:w.toString());this.filename=n;const d=await pdfExports.getDocument({url:e}).promise;this.document=d,this.viewer.setDocument(this.document),this.linkService.setDocument(this.document),ne(this,At,tr).call(this),await ne(this,At,Zs).call(this),this.store.setDocumentState({filename:n,numPages:d.numPages,pageNumber:0,url:e.toString()}),await ne(this,At,Js).call(this),this.forceRendering()}forceRendering(e=!0){t(this,Ft).printing=!!this.printService,t(this,Ft).isThumbnailViewEnabled=e,t(this,Ft).renderHighestPriority()}gotoPage(e){this.linkService.goToPage(e)}openOrDownloadData(e,v,n){var d;(d=this.downloadManager)==null||d.openOrDownloadData(e,v,n)}async download(){var n,d;const e=this.url,{filename:v}=this;try{const re=await this.document.getData(),O=new Blob([re],{type:"application/pdf"});await((n=this.downloadManager)==null?void 0:n.download(O,e,v,{}))}catch{await((d=this.downloadManager)==null?void 0:d.downloadUrl(e,v,{}))}}async save(){var n;const e=this.url,{filename:v}=this;try{const d=await this.document.saveDocument(),re=new Blob([d],{type:"application/pdf"});await((n=this.downloadManager)==null?void 0:n.download(re,e,v,{}))}catch(d){console.error(`Error when saving the document: ${d.message}`),await this.download()}finally{}}downloadOrSave(){const{annotationStorage:e}=this.document??{};e&&e.size>0?this.save():this.download()}get supportsPrinting(){return PDFPrintServiceFactory.instance.supportsPrinting}beforePrint(){if(this.printService||!this.supportsPrinting)return;if(!this.viewer.pageViewsReady){this.l10n.get("printing_not_ready").then(O=>{window.alert(O)});return}const e=this.viewer.getPagesOverview(),v=document.getElementById("printContainer"),n=this.printResolution,d=this.viewer.optionalContentConfigPromise,re=PDFPrintServiceFactory.instance.createPrintService(this.document,e,v,n,d,null,this.l10n);this.printService=re,this.forceRendering(),re.layout()}afterPrint(){var e;this.printService&&(this.printService.destroy(),this.printService=null,(e=this.document)==null||e.annotationStorage.resetModified()),this.forceRendering()}requestPresentationMode(){var e;(e=this.pdfPresentationMode)==null||e.request()}triggerPrinting(){this.supportsPrinting&&window.print()}_cleanup(){if(this.document)try{this.viewer.cleanup(),this.document.cleanup()}catch(e){console.error("Unable to perform cleanup",e)}}setAnnotationEditorMode(e){this.viewer.annotationEditorMode={mode:e},this.store.setDocumentState({annotationEditorMode:e})}setAnnotationEditorParams(e){const v=Array.isArray(e)?e:[e];for(const n of v)this.viewer.annotationEditorParams=n}setSpreadMode(e){isValidSpreadMode(e)&&(this.viewer.spreadMode=e,this.dispatch("switchspreadmode",{mode:e}))}setScrollMode(e){isValidScrollMode(e)&&(this.viewer.scrollMode=e,this.dispatch("switchscrollmode",{mode:e}))}setRotation(e){isValidRotation(e)&&(this.viewer.pagesRotation=e)}getPagesOverview(){var e;try{return((e=this.viewer)==null?void 0:e.getPagesOverview())??[]}catch{return[]}}increaseScale(){this.viewer.increaseScale()}decreaseScale(){this.viewer.decreaseScale()}set currentScaleValue(e){this.viewer.currentScaleValue=e}set currentScale(e){this.viewer.currentScale=e}getPageView(e){return this.viewer.getPageView(e)}on(e,v,n){this.eventBus.on(e,v,n)}off(e,v,n){this.eventBus.off(e,v,n)}dispatch(e,v){this.eventBus.dispatch(e,v)}}Ft=new WeakMap,Ci=new WeakMap,Ti=new WeakMap,ni=new WeakMap,si=new WeakMap,ri=new WeakMap,At=new WeakSet,Zs=async function(){const v=await this.document.getPageLabels()??[],n=v.length;let d=0,re=0;for(let w=0;w<n;w++){const E=v[w];if(E===(w+1).toString())d++;else if(E==="")re++;else break}if(d>=n||re>=n)return;const{viewer:O}=this;O.setPageLabels(v)},Js=async function(){const{info:e,contentLength:v}=await this.document.getMetadata(),n=await this.document.getPage(1),d=ne(this,At,er).call(this,getPageSizeInches(n),0);this.store.setDocumentState({filesize:v,isLinearized:e.IsLinearized,pageSize:d})},er=async function(e,v){if(!e)return;v%180!==0&&(e={width:e.height,height:e.width});const n=isPortraitOrientation(e);let d={width:Math.round(e.width*100)/100,height:Math.round(e.height*100)/100},re={width:Math.round(e.width*25.4*10)/10,height:Math.round(e.height*25.4*10)/10},O=getPageName(d,n,US_PAGE_NAMES)||getPageName(re,n,METRIC_PAGE_NAMES);if(!O&&!(Number.isInteger(re.width)&&Number.isInteger(re.height))){const N={width:e.width*25.4,height:e.height*25.4},g={width:Math.round(re.width),height:Math.round(re.height)};Math.abs(N.width-g.width)<.1&&Math.abs(N.height-g.height)<.1&&(O=getPageName(g,n,METRIC_PAGE_NAMES),O&&(d={width:Math.round(g.width/25.4*100)/100,height:Math.round(g.height/25.4*100)/100},re=g))}const[{width:w,height:E},p,r,H]=await Promise.all([d,this.l10n.get("document_properties_page_size_unit_inches"),O&&this.l10n.get(`document_properties_page_size_name_${O.toLowerCase()}`),this.l10n.get(`document_properties_page_size_orientation_${n?"portrait":"landscape"}`)]);return{width:w.toLocaleString(),height:E.toLocaleString(),unit:p,name:r,orientation:H}},tr=function(){this.eventBus._on("pagesinit",ne(this,At,ir).bind(this)),this.eventBus._on("scalechanging",ne(this,At,ar).bind(this)),this.eventBus._on("pagechanging",ne(this,At,or).bind(this)),this.eventBus._on("pagerendered",ne(this,At,lr).bind(this)),this.eventBus._on("rotationchanging",ne(this,At,nr).bind(this)),this.eventBus._on("switchspreadmode",ne(this,At,sr).bind(this)),this.eventBus._on("switchscrollmode",ne(this,At,rr).bind(this)),this.eventBus._on("beforeprint",this.beforePrint.bind(this)),this.eventBus._on("afterprint",this.afterPrint.bind(this)),window.onbeforeprint=e=>{this.eventBus.dispatch("beforeprint",{source:window})},window.onafterprint=e=>{this.eventBus.dispatch("afterprint",{source:window})}},ir=async function({source:e}){var n;await((n=this.document)==null?void 0:n.getOutline());const v="auto";e.currentScale=1,e.currentScaleValue="auto",this.store.setDocumentState({pageNumber:1,scaleValue:v,pagesReady:!0})},nr=function({pagesRotation:e,pageNumber:v}){this.store.setDocumentState({pagesRotation:e}),this.forceRendering(),this.viewer.currentPageNumber=v},sr=function({mode:e}){this.store.setDocumentState({spreadMode:e})},rr=function({mode:e}){this.store.setDocumentState({scrollMode:e}),this.viewer.update()},ar=function({scale:e,presetValue:v}){this.store.setDocumentState({scale:e,scaleValue:v}),this.viewer.update()},or=function({pageNumber:e}){this.store.setDocumentState({pageNumber:e})},lr=function({pageNumber:e,error:v}){t(this,ni)&&this.viewer.getPageView(e-1)};function createUndoHistory(i,e){let v=!1;const n=100,d=Array.isArray(i)?i.map(r=>createMemo(r)):[i],re=createMicrotask(()=>v=!1),O=createMemo(r=>{const H=[];for(const M of d){const P=M();P&&H.push(P)}if(v||!H.length)return v=!1,r;const N=untrack(r.count[0]),g=r.list.length-N,u=r.list.slice(Math.max(0,g-n),g);return u.push(H),{count:N?createSignal(0):r.count,list:u}},{list:[],count:createSignal(0)}),w=createMemo(()=>{const r=O();return r.list.length-r.count[0]()>1}),E=createMemo(()=>O().count[0]()>0),p=r=>{v=!0,re();const H=O(),N=H.count[1](P=>P+r),g=H.list.length-N-1,u=H.list[g+r],M=H.list[g];for(let P=0;P<M.length;P++)M[P]!==u[P]&&M[P]()};return{canUndo:w,canRedo:E,undo(){untrack(()=>w()&&batch(()=>p(1)))},redo(){untrack(()=>E()&&batch(()=>p(-1)))}}}var EQUALS_FALSE={equals:!1},TrackStoreCache=new WeakMap,TrackVersion=0;function getTrackStoreNode(i){let e=TrackStoreCache.get(i);return e||createRoot(()=>{const v=unwrap(i);let n=!1,d=!0,re=0;const[O,w]=createSignal(void 0,EQUALS_FALSE),E=createMemo(()=>{var p;if(n){i[$TRACK];for(const[r,H]of Object.entries(v)){let N;H!=null&&typeof H=="object"&&((N=H[$PROXY])||$TRACK in(N=untrack(()=>i[r])))&&((p=getTrackStoreNode(N))==null||p())}}else O(),d=!0},void 0,EQUALS_FALSE);e=()=>{n=!0,d&&(w(),d=!1);const p=re===TrackVersion;re=TrackVersion,p||E(),n=!1},TrackStoreCache.set(i,e)}),e}function trackStore(i){var e;return TrackVersion++,$TRACK in i&&((e=getTrackStoreNode(i))==null||e()),i}const PDFDocumentStoreContext=createContext(),initialState={documentState:{isDocumentLoaded:!1,pagesReady:!1,numPages:0,pageNumber:0,scale:0,scaleValue:"auto",pagesRotation:0,spreadMode:SpreadMode.UNKNOWN,scrollMode:ScrollMode.UNKNOWN,annotationEditorMode:pdfExports.AnnotationEditorType.NONE,url:null},layersState:{layerIds:[],layers:{},selectionLayerIds:[]}},PDViewerProvider=i=>{const[e,v]=splitProps(i,["initialAnnotation","onUpdate"]),[n,d]=createStore(initialState.documentState),[re,O]=createStore(initialState.layersState),[w,E]=createSignal(!1),p=createUndoHistory([()=>{if(w()){trackStore(re.layers);const N=structuredClone(unwrap(untrack(()=>re)));return()=>{O(N)}}}]);createEffect(()=>{var N;E(!1),(N=e.initialAnnotation)!=null&&N.length&&batch(()=>{O("layerIds",[]),O("layers",{}),e.initialAnnotation.forEach((g,u)=>{O("layerIds",u,g.id),O("layers",g.id,{...g})})}),E(!0)});const r={setLayerState:(N,g)=>{N.push(g),O(...N)},setDocumentState:d,history:{canUndo:p.canUndo,canRedo:p.canRedo,undo:p.undo,redo:p.redo,pause:()=>{untrack(()=>E(!1))},resume:()=>{untrack(()=>E(!0))}}};createEffect(()=>{trackStore(re),untrack(()=>e.onUpdate)&&untrack(()=>i.onUpdate)(re.layerIds.map(N=>({id:N,...re.layers[N]})))});const H=[{documentState:n,layersState:re,pdfDocument:null,pdfUrl:v.pdfUrl,thumbnails:new Map},r];return createComponent(PDFDocumentStoreContext.Provider,{value:H,get children(){return v.children}})},usePDFStoreContext=()=>{const i=useContext(PDFDocumentStoreContext);if(!i)throw new Error("Cannot PDFDocumentStoreContext outside provider");return i},usePDFViewer=i=>{const[e,{setDocumentState:v}]=usePDFStoreContext();let n=null;const[d,re]=createSignal([]),O=w=>{n=w};return createEffect(()=>{if(e.documentState.isDocumentLoaded&&e.documentState.numPages){const w=[];new Array(e.documentState.numPages).fill(0).forEach((E,p)=>{w[p]=document.getElementById(`stree-pdf-page-${p+1}`)}),re(w)}}),onMount(()=>{if(e.pdfUrl){const w=new PDFDocument({container:n,store:{setDocumentState:v}});e.pdfDocument=w,e.pdfDocument.loadDocument(e.pdfUrl,i).then(()=>{var E;new Array((E=w.document)==null?void 0:E.numPages).fill(0).map((p,r)=>{const H=w.getPageView(r).div;H&&(H.id=`stree-pdf-page-${r+1}`);const N=document.createElement("svg");N.classList.add("annotationLayer"),N.id=`stree-pdf-annotationLayer-${r+1}`,H.append(N)}),v({isDocumentLoaded:!0})})}}),{isDocumentLoaded:e.documentState.isDocumentLoaded,setViewRef:O,documentState:e.documentState,pdfDocument:e.pdfDocument,listPageDiv:d(),viewerRef:n}};var ELEMENT_SIZE_FALLBACK={width:null,height:null};function getElementSize(i){if(!i)return{...ELEMENT_SIZE_FALLBACK};const{width:e,height:v}=i.getBoundingClientRect();return{width:e,height:v}}function createElementSize(i){const e=typeof i=="function",[v,n]=createStaticStore(sharedConfig.context||e?ELEMENT_SIZE_FALLBACK:getElementSize(i)),d=new ResizeObserver(([re])=>n(getElementSize(re.target)));return onCleanup(()=>d.disconnect()),e?createEffect(()=>{const re=i();re&&(n(getElementSize(re)),d.observe(re),onCleanup(()=>d.unobserve(re)))}):(d.observe(i),onCleanup(()=>d.unobserve(i))),v}function $(i,e,v,n=d=>d){return i*n(.5-e*(.5-v))}function se(i){return[-i[0],-i[1]]}function l(i,e){return[i[0]+e[0],i[1]+e[1]]}function a(i,e){return[i[0]-e[0],i[1]-e[1]]}function b(i,e){return[i[0]*e,i[1]*e]}function he(i,e){return[i[0]/e,i[1]/e]}function R(i){return[i[1],-i[0]]}function B(i,e){return i[0]*e[0]+i[1]*e[1]}function ue(i,e){return i[0]===e[0]&&i[1]===e[1]}function ge(i){return Math.hypot(i[0],i[1])}function de(i){return i[0]*i[0]+i[1]*i[1]}function A(i,e){return de(a(i,e))}function G(i){return he(i,ge(i))}function ie(i,e){return Math.hypot(i[1]-e[1],i[0]-e[0])}function L(i,e,v){let n=Math.sin(v),d=Math.cos(v),re=i[0]-e[0],O=i[1]-e[1],w=re*d-O*n,E=re*n+O*d;return[w+e[0],E+e[1]]}function K(i,e,v){return l(i,b(a(e,i),v))}function ee(i,e,v){return l(i,b(e,v))}var{min:C,PI:xe}=Math,pe=.275,V=xe+1e-4;function ce(i,e={}){let{size:v=16,smoothing:n=.5,thinning:d=.5,simulatePressure:re=!0,easing:O=W=>W,start:w={},end:E={},last:p=!1}=e,{cap:r=!0,easing:H=W=>W*(2-W)}=w,{cap:N=!0,easing:g=W=>--W*W*W+1}=E;if(i.length===0||v<=0)return[];let u=i[i.length-1].runningLength,M=w.taper===!1?0:w.taper===!0?Math.max(v,u):w.taper,P=E.taper===!1?0:E.taper===!0?Math.max(v,u):E.taper,x=Math.pow(v*n,2),S=[],F=[],I=i.slice(0,10).reduce((W,Pe)=>{let D=Pe.pressure;if(re){let k=C(1,Pe.distance/v),Te=C(1,1-k);D=C(1,W+(Te-W)*(k*pe))}return(W+D)/2},i[0].pressure),o=$(v,d,i[i.length-1].pressure,O),s,c=i[0].vector,f=i[0].point,T=f,Y=f,_=T,j=!1;for(let W=0;W<i.length;W++){let{pressure:Pe}=i[W],{point:D,vector:k,distance:Te,runningLength:q}=i[W];if(W<i.length-1&&u-q<3)continue;if(d){if(re){let Re=C(1,Te/v),Ne=C(1,1-Re);Pe=C(1,I+(Ne-I)*(Re*pe))}o=$(v,d,Pe,O)}else o=v/2;s===void 0&&(s=o);let m=q<M?H(q/M):1,y=u-q<P?g((u-q)/P):1;o=Math.max(.01,o*Math.min(m,y));let U=(W<i.length-1?i[W+1]:i[W]).vector,Ae=W<i.length-1?B(k,U):1,ye=B(k,c)<0&&!j,Q=Ae!==null&&Ae<0;if(ye||Q){let Re=b(R(c),o);for(let Ne=1/13,He=0;He<=1;He+=Ne)Y=L(a(D,Re),D,V*He),S.push(Y),_=L(l(D,Re),D,V*-He),F.push(_);f=Y,T=_,Q&&(j=!0);continue}if(j=!1,W===i.length-1){let Re=b(R(k),o);S.push(a(D,Re)),F.push(l(D,Re));continue}let we=b(R(K(U,k,Ae)),o);Y=a(D,we),(W<=1||A(f,Y)>x)&&(S.push(Y),f=Y),_=l(D,we),(W<=1||A(T,_)>x)&&(F.push(_),T=_),I=Pe,c=k}let fe=i[0].point.slice(0,2),te=i.length>1?i[i.length-1].point.slice(0,2):l(i[0].point,[1,1]),_e=[],be=[];if(i.length===1){if(!(M||P)||p){let W=ee(fe,G(R(a(fe,te))),-(s||o)),Pe=[];for(let D=1/13,k=D;k<=1;k+=D)Pe.push(L(W,fe,V*2*k));return Pe}}else{if(!(M||P&&i.length===1))if(r)for(let Pe=1/13,D=Pe;D<=1;D+=Pe){let k=L(F[0],fe,V*D);_e.push(k)}else{let Pe=a(S[0],F[0]),D=b(Pe,.5),k=b(Pe,.51);_e.push(a(fe,D),a(fe,k),l(fe,k),l(fe,D))}let W=R(se(i[i.length-1].vector));if(P||M&&i.length===1)be.push(te);else if(N){let Pe=ee(te,W,o);for(let D=1/29,k=D;k<1;k+=D)be.push(L(Pe,te,V*3*k))}else be.push(l(te,b(W,o)),l(te,b(W,o*.99)),a(te,b(W,o*.99)),a(te,b(W,o)))}return S.concat(be,F.reverse(),_e)}function me(i,e={}){var v;let{streamline:n=.5,size:d=16,last:re=!1}=e;if(i.length===0)return[];let O=.15+(1-n)*.85,w=Array.isArray(i[0])?i:i.map(({x:g,y:u,pressure:M=.5})=>[g,u,M]);if(w.length===2){let g=w[1];w=w.slice(0,-1);for(let u=1;u<5;u++)w.push(K(w[0],g,u/4))}w.length===1&&(w=[...w,[...l(w[0],[1,1]),...w[0].slice(2)]]);let E=[{point:[w[0][0],w[0][1]],pressure:w[0][2]>=0?w[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],p=!1,r=0,H=E[0],N=w.length-1;for(let g=1;g<w.length;g++){let u=re&&g===N?w[g].slice(0,2):K(H.point,w[g],O);if(ue(H.point,u))continue;let M=ie(u,H.point);if(r+=M,g<N&&!p){if(r<d)continue;p=!0}H={point:u,pressure:w[g][2]>=0?w[g][2]:.5,vector:G(a(H.point,u)),distance:M,runningLength:r},E.push(H)}return E[0].vector=((v=E[1])==null?void 0:v.vector)||[0,0],E}function ae(i,e={}){return ce(me(i,e),e)}var _tmpl$$2=template("<svg><path class=drop-shadow-md></svg>",!1,!0);const LayerPath=i=>(()=>{var e=_tmpl$$2();return e.$$pointerdown=v=>i.onPointerDown&&i.onPointerDown(v),createRenderEffect(v=>{var n=getSvgPathFromStroke(ae(i.points,{size:8,thinning:.5,smoothing:.5,streamline:.5})),d=`translate(${i.x}px, ${i.y}px)`,re=i.fill,O=i.fill;return n!==v.e&&setAttribute(e,"d",v.e=n),d!==v.t&&((v.t=d)!=null?e.style.setProperty("transform",d):e.style.removeProperty("transform")),re!==v.a&&setAttribute(e,"fill",v.a=re),O!==v.o&&setAttribute(e,"stroke",v.o=O),v},{e:void 0,t:void 0,a:void 0,o:void 0}),e})();delegateEvents(["pointerdown"]);var _tmpl$$1=template("<div><div><div id=viewer></div><div><svg><g>"),_tmpl$2$1=template('<svg><foreignObject class=drop-shadow-lg x=0 y=0><div class="bg-slate-700/25 shadow-2xl h-full w-full rounded-full"></svg>',!1,!0);const Toolbar=lazy(()=>__vitePreload(()=>import("./toolbar-CvegUleh.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),LayerPreview=lazy(()=>__vitePreload(()=>import("./index-q2OQhd4T.js"),__vite__mapDeps([8,1,2,4,5,6,7]))),SelectionBox=lazy(()=>__vitePreload(()=>import("./index-CNdpZk6j.js"),__vite__mapDeps([9,1,2,10,4,5,6,7]))),SelectionTools=lazy(()=>__vitePreload(()=>import("./index-CphTHXtg.js"),__vite__mapDeps([11,1,2,3,10,4,5,6,7]))),PDFPageViewer=i=>{const{setViewRef:e,pdfDocument:v,documentState:n}=usePDFViewer(),[d,{setLayerState:re,history:O}]=usePDFStoreContext();let w;const[E,p]=createSignal(),r=createElementSize(E),[H,N]=createSignal({x:0,y:0});let g;const[u,M]=createSignal([]),[P,x]=createSignal(),[S,F]=createStore({mode:CanvasMode.None}),[I,o]=createSignal({r:38,g:38,b:38,a:1}),s=()=>{if(w){const k=w.getBoundingClientRect();x(x),N(Te=>({...Te,x:k.x,y:k.y}))}},c=(k,Te)=>{d.layersState.layerIds.length>=MAX_LAYER||(O.pause(),batch(()=>{const q=uuid(),m={type:k,x:Te.x,y:Te.y,width:100,height:100,fill:{...I()},value:S.value||""};k===LayerType.Comment&&(m.width=25,m.height=25),re(["layerIds",d.layersState.layerIds.length.toString()],q),re(["layers",q],m),k===LayerType.Comment&&re(["selectionLayerIds"],[q]),F("mode",CanvasMode.None)}),O.resume())};createEffect(()=>{r.width&&r.height&&(v&&(n.scaleValue==="auto"||n.scaleValue==="page-fit"||n.scaleValue==="page-width")&&(v.viewer.currentScaleValue=n.scaleValue),v==null||v.viewer.update()),s()});const f=k=>{if(S.mode==CanvasMode.Inserting)return;batch(()=>{re(["selectionLayerIds"],[]),s()});const Te=pointerEventToCanvasPoint(k,H());S.mode===CanvasMode.Eraser?M([Te]):S.mode===CanvasMode.Pencil&&W(Te,k.pressure)},T=(k,Te)=>{if(S.mode===CanvasMode.Pencil||S.mode===CanvasMode.Inserting||S.mode===CanvasMode.Hightlight||S.mode===CanvasMode.Eraser)return;s();const q=pointerEventToCanvasPoint(k,H());k.stopPropagation(),d.layersState.layerIds.includes(Te)&&(O.pause(),batch(()=>{re(["selectionLayerIds","0"],Te),F({mode:CanvasMode.Translating,current:q})}))},Y=k=>{if(S.mode===CanvasMode.Inserting){s();const Te=pointerEventToCanvasPoint(k,H());c(S.layerType,Te)}else S.mode==CanvasMode.Eraser?(g&&clearTimeout(g),M([])):S.mode===CanvasMode.Pencil?D():(CanvasMode.Translating&&O.resume(),F({mode:CanvasMode.None}))},_=()=>{var Te;if(S.mode!=CanvasMode.Hightlight)return;s();const k=getSelectionRects(H(),n.scale);if(k.listRects.length){const q=uuid(),m={type:LayerType.Highlight,x:k.bounds.x,y:k.bounds.y,width:k.bounds.width,height:k.bounds.height,fill:I().r===38&&I().g===38&&I().b===38?{r:255,g:255,b:0,a:.2}:{...I(),a:.2},rects:k.listRects};O.pause(),batch(()=>{re(["layerIds",d.layersState.layerIds.length.toString()],q),re(["layers",q],m)}),O.resume()}(Te=window==null?void 0:window.getSelection())==null||Te.removeAllRanges()},j=k=>{if(k.preventDefault(),S.mode!==CanvasMode.Translating&&S.mode!==CanvasMode.Eraser&&S.mode!==CanvasMode.Resizing&&S.mode!==CanvasMode.Pencil)return;s();const Te=pointerEventToCanvasPoint(k,H());S.mode==CanvasMode.Translating?fe(Te):S.mode===CanvasMode.Eraser&&u().length?(M([...u().reverse().slice(0,50).reverse(),Te]),g=setTimeout(()=>{M(q=>(q.length&&q.shift(),q.map(m=>({...m,y:m.y+1}))))},2500/(u().length+1))):S.mode==CanvasMode.Resizing?_e(Te):S.mode===CanvasMode.Pencil&&Pe(Te,k)},fe=k=>{if(S.mode!==CanvasMode.Translating)return;const Te={x:k.x-S.current.x,y:k.y-S.current.y};batch(()=>{for(const q of d.layersState.selectionLayerIds){const m=d.layersState.layers[q];m&&m.type!==LayerType.Highlight&&(re(["layers",q,"x"],y=>Math.max(y+Te.x,BORDERWIDTH+2)),re(["layers",q,"y"],y=>Math.max(y+Te.y,BORDERWIDTH+2)))}F({mode:CanvasMode.Translating,current:k})})},te=k=>{N(Te=>({x:Te.x+k.deltaX,y:Te.y+k.deltaY}))},_e=k=>{if(S.mode!==CanvasMode.Resizing)return;const Te=resizeBounds(S.initialBounds,S.corner,k),q=d.layersState.selectionLayerIds[0];q&&d.layersState.layers[q]&&(O.pause(),batch(()=>{re(["layers",q,"x"],Te.x),re(["layers",q,"y"],Te.y),re(["layers",q,"width"],Te.width),re(["layers",q,"height"],Te.height)}),O.resume())},be=(k,Te)=>{F({mode:CanvasMode.Resizing,initialBounds:Te,corner:k})},W=(k,Te)=>{batch(()=>{re(["penColor"],{...I()}),re(["pencilDraft"],[[k.x,k.y,Te]])})},Pe=(k,Te)=>{S.mode!==CanvasMode.Pencil||Te.buttons!==1||!d.layersState.pencilDraft||!d.layersState.pencilDraft.length||re(["pencilDraft"],q=>[...q,[k.x,k.y,Te.pressure]])},D=()=>{O.pause();const k=d.layersState.pencilDraft;if(k==null||k.length<2||d.layersState.layerIds.length>=MAX_LAYER){re(["pencilDraft"],null);return}batch(()=>{const Te=uuid();re(["layers",Te],penPointsToPathLayer(k,{...I()})),re(["layerIds",d.layersState.layerIds.length.toString()],Te),re(["pencilDraft"],null),F({mode:CanvasMode.Pencil})}),O.resume()};return onMount(()=>{w&&w.addEventListener("wheel",te,{passive:!0})}),(()=>{var k=_tmpl$$1(),Te=k.firstChild,q=Te.firstChild,m=q.nextSibling,y=m.firstChild,U=y.firstChild;use(ye=>{e(ye),p(ye)},Te),Te.style.setProperty("position","absolute"),q.$$pointerup=_,insert(m,createComponent(SelectionTools,{get camera(){return H()},get lastUsedColor(){return I()},setLastUsedColor:o}),y),y.$$pointermove=j,y.$$pointerup=Y,y.$$pointerdown=f;var Ae=w;return typeof Ae=="function"?use(Ae,y):w=y,insert(U,createComponent(For,{get each(){return d.layersState.layerIds},children:ye=>createComponent(LayerPreview,{id:ye,onLayerPointerDown:T,selectionColor:"#0000ff"})}),null),insert(U,createComponent(SelectionBox,{onResizeHandlePointerDown:be}),null),insert(U,createComponent(Show,{get when(){return u().length},get children(){return createComponent(For,{get each(){return u()},children:(ye,Q)=>(()=>{var we=_tmpl$2$1();return createRenderEffect(Re=>{var Ne=`translate(${ye.x-3}px, ${ye.y+3}px)`,He=Math.min(Q()+1,20),$e=Math.min(Q()+1,20);return Ne!==Re.e&&((Re.e=Ne)!=null?we.style.setProperty("transform",Ne):we.style.removeProperty("transform")),He!==Re.t&&setAttribute(we,"width",Re.t=He),$e!==Re.a&&setAttribute(we,"height",Re.a=$e),Re},{e:void 0,t:void 0,a:void 0}),we})()})}}),null),insert(U,(()=>{var ye=createMemo(()=>d.layersState.pencilDraft!=null&&d.layersState.pencilDraft.length>0);return()=>ye()&&createComponent(LayerPath,{get points(){return d.layersState.pencilDraft},get fill(){return colorToCss(I())},x:0,y:0})})(),null),insert(k,createComponent(Toolbar,{canvasState:S,setCanvasState:F}),null),createRenderEffect(ye=>{var Q=cn("relative w-full h-full canvas-pdf-annotate bg-fixed overflow-auto",i.class),we=cn("left-1/2 -translate-x-1/2",i.canEdit&&"touch-none",S.mode===CanvasMode.Eraser&&"!cursor-[var(--cursor-icon-eraser)]"),Re=cn("pdfViewer"),Ne=cn("absolute top-0 left-0 h-full w-full z-[2]",S.mode===CanvasMode.Hightlight&&"touch-none z-0",S.mode===CanvasMode.Inserting&&(S.layerType===LayerType.Text||S.layerType===LayerType.Sticker)&&"cursor-[var(--cursor-icon-add-text)]",S.mode===CanvasMode.Inserting&&S.layerType==LayerType.Comment&&"cursor-[var(--cursor-icon-comment)]",S.mode===CanvasMode.Inserting&&S.layerType==LayerType.Rectangle&&"cursor-[var(--cursor-icon-rectangle)]",S.mode===CanvasMode.Eraser&&"!cursor-[var(--cursor-icon-eraser)]",S.mode===CanvasMode.Pencil&&"!cursor-[var(--cursor-icon-pencil)]"),He=cn("h-full w-full");return Q!==ye.e&&className(k,ye.e=Q),we!==ye.t&&className(Te,ye.t=we),Re!==ye.a&&className(q,ye.a=Re),Ne!==ye.o&&className(m,ye.o=Ne),He!==ye.i&&setAttribute(y,"class",ye.i=He),ye},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};delegateEvents(["pointerup","pointerdown","pointermove"]);var _tmpl$=template('<div class="flex flex-col items-center">'),_tmpl$2=template("<div>");function PDFAnnotateTry(){const i=useParams(),[e,v]=useLocalStorage({key:i.sessionId,defaultValue:{pdfData:"",annotation:[]}});return[createComponent(Show,{get when(){return!e().pdfData},get children(){return createComponent(Container,{get children(){return[createComponent(Heading,{children:"PDF Annotate"}),(()=>{var n=_tmpl$();return insert(n,createComponent(FileUpload,{}),null),insert(n,createComponent(Button,{onClick:()=>{v({pdfData:"https://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf",annotation:[]})},class:"items-center gap-1 group/button rounded-full focus:outline-none transition ring-offset-gray-900 bg-gray-800 text-white shadow-lg shadow-black/20 sm:backdrop-blur-sm group-hover/button:bg-gray-50/15 group-hover/button:scale-105 focus-visible:ring-1 focus-visible:ring-offset-2 ring-gray-50/60 text-xs font-medium px-4 py-2 mt-auto origin-left",children:"Using Sample pdf"}),null),n})()]}})}}),createComponent(Show,{get when(){return e().pdfData},get children(){var n=_tmpl$2();return insert(n,createComponent(PDViewerProvider,{get pdfUrl(){return e().pdfData},get initialAnnotation(){return e().annotation||[]},onUpdate:d=>localStorage.setItem(i.sessionId,JSON.stringify({pdfData:e().pdfData,annotation:d})),get children(){return createComponent(PDFPageViewer,{class:"bg-neutral-100 shadow rounded smoth-scroll"})}})),createRenderEffect(()=>className(n,cn("relative overflow-y-hidden p-5 rounded h-[calc(100vh-10px)] smoth-scroll"))),n}})]}const pdfAnnotateTry=Object.freeze(Object.defineProperty({__proto__:null,default:PDFAnnotateTry},Symbol.toStringTag,{value:"Module"}));export{composeEventHandlers as A,ButtonRoot as B,CanvasMode as C,scrollIntoViewport as D,EventKey as E,noop as F,isCtrlKey as G,pdfAnnotateTry as H,LayerType as L,Polymorphic as P,Side as S,__export as _,getWindow as a,contains as b,createGenerateId as c,getEventPoint as d,callHandler as e,colorToCss as f,getDocument as g,LayerPath as h,isPointInPolygon as i,addItemToArray as j,isString as k,isNumber as l,mergeDefaultProps as m,normalizeHtml as n,focusWithoutScrolling as o,isAppleDevice as p,isMac as q,getFocusableTreeWalker as r,scrollIntoView as s,getActiveElement as t,usePDFStoreContext as u,removeItemFromArray as v,visuallyHiddenStyles as w,isFocusable as x,getAllTabbableIn as y,createTagName as z};
