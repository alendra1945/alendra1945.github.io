var Ht=Object.defineProperty;var Wt=(e,t,o)=>t in e?Ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var z=(e,t,o)=>Wt(e,typeof t!="symbol"?t+"":t,o);import{g as F,a as nt,ai as Ne,aj as m,ak as Yt,W as k,p as J,n as Q,c as K,k as R,al as me,am as jt,f as E,m as C,o as Xt,a7 as ee,e as O,Q as ne,a6 as qt,S as te,a5 as Zt,b as ot,i as _e,an as Jt,ao as Qt,j as en,t as rt}from"./index-DhydKnRP.js";import{m as A,g as st,j as tn,k as ce,l as nn,o as V,p as on,s as Ue,q as rn,e as L,r as sn,t as he,b as Z,v as Me,w as ln,x as cn,y as an,z as it,B as un,P as H,A as N,D as dn,c as Pe,i as fn,_ as lt,u as gn,L as we,f as hn}from"./pdf-annotate-try-B1lHKnOM.js";import{d as yn,u as le,e as ct,f as mn,g as De,h as vn,i as G,c as at,b as ue,a as ut,D as pn,s as bn,P as dt,B as Be}from"./button-DOW7-XBW.js";import{u as Sn}from"./use-selection-bouds-CJIWiPAm.js";import"./container-C3qi2OK9.js";import"./animate.es-CJ9iIyw4.js";import"./velocity.es-CI47LKMS.js";import"./use-local-storage-CH-ZvHM0.js";function wn(e,t,o,n){return e.addEventListener(t,o,n),Yt(e.removeEventListener.bind(e,t,o,n))}function Kn(e,t,o,n){const r=()=>{Ne(m(e)).forEach(s=>{s&&Ne(m(t)).forEach(l=>wn(s,l,o,n))})};typeof e=="function"?F(r):nt(r)}var ft=Q();function gt(){return J(ft)}function In(){const e=gt();if(e===void 0)throw new Error("[kobalte]: `useDomCollectionContext` must be used within a `DomCollectionProvider` component");return e}function ht(e,t){return!!(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING)}function Mn(e,t){var r;const o=t.ref();if(!o)return-1;let n=e.length;if(!n)return-1;for(;n--;){const s=(r=e[n])==null?void 0:r.ref();if(s&&ht(s,o))return n+1}return 0}function Dn(e){const t=e.map((n,r)=>[r,n]);let o=!1;return t.sort(([n,r],[s,l])=>{const f=r.ref(),i=l.ref();return f===i||!f||!i?0:ht(f,i)?(n>s&&(o=!0),-1):(n<s&&(o=!0),1)}),o?t.map(([n,r])=>r):e}function yt(e,t){const o=Dn(e);e!==o&&t(o)}function Tn(e){var r,s;const t=e[0],o=(r=e[e.length-1])==null?void 0:r.ref();let n=(s=t==null?void 0:t.ref())==null?void 0:s.parentElement;for(;n;){if(o&&n.contains(o))return n;n=n.parentElement}return st(n).body}function Pn(e,t){F(()=>{const o=setTimeout(()=>{yt(e(),t)});k(()=>clearTimeout(o))})}function Fn(e,t){if(typeof IntersectionObserver!="function"){Pn(e,t);return}let o=[];F(()=>{const n=()=>{const l=!!o.length;o=e(),l&&yt(e(),t)},r=Tn(e()),s=new IntersectionObserver(n,{root:r});for(const l of e()){const f=l.ref();f&&s.observe(f)}k(()=>s.disconnect())})}function Cn(e={}){const[t,o]=yn({value:()=>m(e.items),onChange:s=>{var l;return(l=e.onItemsChange)==null?void 0:l.call(e,s)}});Fn(t,o);const n=s=>(o(l=>{const f=Mn(l,s);return tn(l,s,f)}),()=>{o(l=>{const f=l.filter(i=>i.ref()!==s.ref());return l.length===f.length?l:f})});return{DomCollectionProvider:s=>K(ft.Provider,{value:{registerItem:n},get children(){return s.children}})}}function xn(e){const t=In(),o=A({shouldRegisterItem:!0},e);F(()=>{if(!o.shouldRegisterItem)return;const n=t.registerItem(o.getItem());k(n)})}function mt(e){let t=e.startIndex??0;const o=e.startLevel??0,n=[],r=i=>{if(i==null)return"";const c=e.getKey??"key",u=ce(c)?i[c]:c(i);return u!=null?String(u):""},s=i=>{if(i==null)return"";const c=e.getTextValue??"textValue",u=ce(c)?i[c]:c(i);return u!=null?String(u):""},l=i=>{if(i==null)return!1;const c=e.getDisabled??"disabled";return(ce(c)?i[c]:c(i))??!1},f=i=>{var c;if(i!=null)return ce(e.getSectionChildren)?i[e.getSectionChildren]:(c=e.getSectionChildren)==null?void 0:c.call(e,i)};for(const i of e.dataSource){if(ce(i)||nn(i)){n.push({type:"item",rawValue:i,key:String(i),textValue:String(i),disabled:l(i),level:o,index:t}),t++;continue}if(f(i)!=null){n.push({type:"section",rawValue:i,key:"",textValue:"",disabled:!1,level:o,index:t}),t++;const c=f(i)??[];if(c.length>0){const u=mt({dataSource:c,getKey:e.getKey,getTextValue:e.getTextValue,getDisabled:e.getDisabled,getSectionChildren:e.getSectionChildren,startIndex:t,startLevel:o+1});n.push(...u),t+=u.length}}else n.push({type:"item",rawValue:i,key:r(i),textValue:s(i),disabled:l(i),level:o,index:t}),t++}return n}function kn(e,t=[]){return R(()=>{const o=mt({dataSource:m(e.dataSource),getKey:m(e.getKey),getTextValue:m(e.getTextValue),getDisabled:m(e.getDisabled),getSectionChildren:m(e.getSectionChildren)});for(let n=0;n<t.length;n++)t[n]();return e.factory(o)})}var j=class vt extends Set{constructor(o,n,r){super(o);z(this,"anchorKey");z(this,"currentKey");o instanceof vt?(this.anchorKey=n||o.anchorKey,this.currentKey=r||o.currentKey):(this.anchorKey=n,this.currentKey=r)}};function En(e){const[t,o]=ct(e);return[()=>t()??new j,o]}function pt(e){return on()?e.altKey:e.ctrlKey}function ie(e){return rn()?e.metaKey:e.ctrlKey}function ze(e){return new j(e)}function On(e,t){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}function An(e){const t=A({selectionMode:"none",selectionBehavior:"toggle"},e),[o,n]=E(!1),[r,s]=E(),l=R(()=>{const S=m(t.selectedKeys);return S!=null?ze(S):S}),f=R(()=>{const S=m(t.defaultSelectedKeys);return S!=null?ze(S):new j}),[i,c]=En({value:l,defaultValue:f,onChange:S=>{var h;return(h=t.onSelectionChange)==null?void 0:h.call(t,S)}}),[u,w]=E(m(t.selectionBehavior)),b=()=>m(t.selectionMode),I=()=>m(t.disallowEmptySelection)??!1,v=S=>{(m(t.allowDuplicateSelectionEvents)||!On(S,i()))&&c(S)};return F(()=>{const S=i();m(t.selectionBehavior)==="replace"&&u()==="toggle"&&typeof S=="object"&&S.size===0&&w("replace")}),F(()=>{w(m(t.selectionBehavior)??"toggle")}),{selectionMode:b,disallowEmptySelection:I,selectionBehavior:u,setSelectionBehavior:w,isFocused:o,setFocused:n,focusedKey:r,setFocusedKey:s,selectedKeys:i,setSelectedKeys:v}}function Ln(e){const[t,o]=E(""),[n,r]=E(-1);return{typeSelectHandlers:{onKeyDown:l=>{var b;if(m(e.isDisabled))return;const f=m(e.keyboardDelegate),i=m(e.selectionManager);if(!f.getKeyForSearch)return;const c=Rn(l.key);if(!c||l.ctrlKey||l.metaKey)return;c===" "&&t().trim().length>0&&(l.preventDefault(),l.stopPropagation());let u=o(I=>I+c),w=f.getKeyForSearch(u,i.focusedKey())??f.getKeyForSearch(u);w==null&&Vn(u)&&(u=u[0],w=f.getKeyForSearch(u,i.focusedKey())??f.getKeyForSearch(u)),w!=null&&(i.setFocusedKey(w),(b=e.onTypeSelect)==null||b.call(e,w)),clearTimeout(n()),r(window.setTimeout(()=>o(""),500))}}}}function Rn(e){return e.length===1||!/^[A-Z]/i.test(e)?e:""}function Vn(e){return e.split("").every(t=>t===e[0])}function Nn(e,t,o){const r=C({selectOnFocus:()=>m(e.selectionManager).selectionBehavior()==="replace"},e),s=()=>t(),{direction:l}=le();let f={top:0,left:0};Kn(()=>m(r.isVirtualized)?void 0:s(),"scroll",()=>{const h=s();h&&(f={top:h.scrollTop,left:h.scrollLeft})});const{typeSelectHandlers:i}=Ln({isDisabled:()=>m(r.disallowTypeAhead),keyboardDelegate:()=>m(r.keyboardDelegate),selectionManager:()=>m(r.selectionManager)}),c=()=>m(r.orientation)??"vertical",u=h=>{var U,P,q,oe,fe,B,ge,re;L(h,i.onKeyDown),h.altKey&&h.key==="Tab"&&h.preventDefault();const g=t();if(!(g!=null&&g.contains(h.target)))return;const d=m(r.selectionManager),a=m(r.selectOnFocus),y=M=>{M!=null&&(d.setFocusedKey(M),h.shiftKey&&d.selectionMode()==="multiple"?d.extendSelection(M):a&&!pt(h)&&d.replaceSelection(M))},p=m(r.keyboardDelegate),x=m(r.shouldFocusWrap),T=d.focusedKey();switch(h.key){case(c()==="vertical"?"ArrowDown":"ArrowRight"):{if(p.getKeyBelow){h.preventDefault();let M;T!=null?M=p.getKeyBelow(T):M=(U=p.getFirstKey)==null?void 0:U.call(p),M==null&&x&&(M=(P=p.getFirstKey)==null?void 0:P.call(p,T)),y(M)}break}case(c()==="vertical"?"ArrowUp":"ArrowLeft"):{if(p.getKeyAbove){h.preventDefault();let M;T!=null?M=p.getKeyAbove(T):M=(q=p.getLastKey)==null?void 0:q.call(p),M==null&&x&&(M=(oe=p.getLastKey)==null?void 0:oe.call(p,T)),y(M)}break}case(c()==="vertical"?"ArrowLeft":"ArrowUp"):{if(p.getKeyLeftOf){h.preventDefault();const M=l()==="rtl";let _;T!=null?_=p.getKeyLeftOf(T):_=M?(fe=p.getFirstKey)==null?void 0:fe.call(p):(B=p.getLastKey)==null?void 0:B.call(p),y(_)}break}case(c()==="vertical"?"ArrowRight":"ArrowDown"):{if(p.getKeyRightOf){h.preventDefault();const M=l()==="rtl";let _;T!=null?_=p.getKeyRightOf(T):_=M?(ge=p.getLastKey)==null?void 0:ge.call(p):(re=p.getFirstKey)==null?void 0:re.call(p),y(_)}break}case"Home":if(p.getFirstKey){h.preventDefault();const M=p.getFirstKey(T,ie(h));M!=null&&(d.setFocusedKey(M),ie(h)&&h.shiftKey&&d.selectionMode()==="multiple"?d.extendSelection(M):a&&d.replaceSelection(M))}break;case"End":if(p.getLastKey){h.preventDefault();const M=p.getLastKey(T,ie(h));M!=null&&(d.setFocusedKey(M),ie(h)&&h.shiftKey&&d.selectionMode()==="multiple"?d.extendSelection(M):a&&d.replaceSelection(M))}break;case"PageDown":if(p.getKeyPageBelow&&T!=null){h.preventDefault();const M=p.getKeyPageBelow(T);y(M)}break;case"PageUp":if(p.getKeyPageAbove&&T!=null){h.preventDefault();const M=p.getKeyPageAbove(T);y(M)}break;case"a":ie(h)&&d.selectionMode()==="multiple"&&m(r.disallowSelectAll)!==!0&&(h.preventDefault(),d.selectAll());break;case"Escape":h.defaultPrevented||(h.preventDefault(),m(r.disallowEmptySelection)||d.clearSelection());break;case"Tab":if(!m(r.allowsTabNavigation)){if(h.shiftKey)g.focus();else{const M=sn(g,{tabbable:!0});let _,se;do se=M.lastChild(),se&&(_=se);while(se);_&&!_.contains(document.activeElement)&&V(_)}break}}},w=h=>{var y,p;const g=m(r.selectionManager),d=m(r.keyboardDelegate),a=m(r.selectOnFocus);if(g.isFocused()){h.currentTarget.contains(h.target)||g.setFocused(!1);return}if(h.currentTarget.contains(h.target)){if(g.setFocused(!0),g.focusedKey()==null){const x=U=>{U!=null&&(g.setFocusedKey(U),a&&g.replaceSelection(U))},T=h.relatedTarget;T&&h.currentTarget.compareDocumentPosition(T)&Node.DOCUMENT_POSITION_FOLLOWING?x(g.lastSelectedKey()??((y=d.getLastKey)==null?void 0:y.call(d))):x(g.firstSelectedKey()??((p=d.getFirstKey)==null?void 0:p.call(d)))}else if(!m(r.isVirtualized)){const x=s();if(x){x.scrollTop=f.top,x.scrollLeft=f.left;const T=x.querySelector(`[data-key="${g.focusedKey()}"]`);T&&(V(T),Ue(x,T))}}}},b=h=>{const g=m(r.selectionManager);h.currentTarget.contains(h.relatedTarget)||g.setFocused(!1)},I=h=>{s()===h.target&&h.preventDefault()},v=()=>{var x,T;const h=m(r.autoFocus);if(!h)return;const g=m(r.selectionManager),d=m(r.keyboardDelegate);let a;h==="first"&&(a=(x=d.getFirstKey)==null?void 0:x.call(d)),h==="last"&&(a=(T=d.getLastKey)==null?void 0:T.call(d));const y=g.selectedKeys();y.size&&(a=y.values().next().value),g.setFocused(!0),g.setFocusedKey(a);const p=t();p&&a==null&&!m(r.shouldUseVirtualFocus)&&V(p)};return Xt(()=>{r.deferAutoFocus?setTimeout(v,0):v()}),F(me([s,()=>m(r.isVirtualized),()=>m(r.selectionManager).focusedKey()],h=>{var y;const[g,d,a]=h;if(d)a&&((y=r.scrollToKey)==null||y.call(r,a));else if(a&&g){const p=g.querySelector(`[data-key="${a}"]`);p&&Ue(g,p)}})),{tabIndex:R(()=>{if(!m(r.shouldUseVirtualFocus))return m(r.selectionManager).focusedKey()==null?0:-1}),onKeyDown:u,onMouseDown:I,onFocusIn:w,onFocusOut:b}}function bt(e,t){const o=()=>m(e.selectionManager),n=()=>m(e.key),r=()=>m(e.shouldUseVirtualFocus),s=d=>{o().selectionMode()!=="none"&&(o().selectionMode()==="single"?o().isSelected(n())&&!o().disallowEmptySelection()?o().toggleSelection(n()):o().replaceSelection(n()):d!=null&&d.shiftKey?o().extendSelection(n()):o().selectionBehavior()==="toggle"||ie(d)||"pointerType"in d&&d.pointerType==="touch"?o().toggleSelection(n()):o().replaceSelection(n()))},l=()=>o().isSelected(n()),f=()=>m(e.disabled)||o().isDisabled(n()),i=()=>!f()&&o().canSelectItem(n());let c=null;const u=d=>{i()&&(c=d.pointerType,d.pointerType==="mouse"&&d.button===0&&!m(e.shouldSelectOnPressUp)&&s(d))},w=d=>{i()&&d.pointerType==="mouse"&&d.button===0&&m(e.shouldSelectOnPressUp)&&m(e.allowsDifferentPressOrigin)&&s(d)},b=d=>{i()&&(m(e.shouldSelectOnPressUp)&&!m(e.allowsDifferentPressOrigin)||c!=="mouse")&&s(d)},I=d=>{!i()||!["Enter"," "].includes(d.key)||(pt(d)?o().toggleSelection(n()):s(d))},v=d=>{f()&&d.preventDefault()},S=d=>{const a=t();r()||f()||!a||d.target===a&&o().setFocusedKey(n())},h=R(()=>{if(!(r()||f()))return n()===o().focusedKey()?0:-1}),g=R(()=>m(e.virtualized)?void 0:n());return F(me([t,n,r,()=>o().focusedKey(),()=>o().isFocused()],([d,a,y,p,x])=>{d&&a===p&&x&&!y&&document.activeElement!==d&&(e.focus?e.focus():V(d))})),{isSelected:l,isDisabled:f,allowsSelection:i,tabIndex:h,dataKey:g,onPointerDown:u,onPointerUp:w,onClick:b,onKeyDown:I,onMouseDown:v,onFocus:S}}var _n=class{constructor(e,t){z(this,"collection");z(this,"state");this.collection=e,this.state=t}selectionMode(){return this.state.selectionMode()}disallowEmptySelection(){return this.state.disallowEmptySelection()}selectionBehavior(){return this.state.selectionBehavior()}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}isFocused(){return this.state.isFocused()}setFocused(e){this.state.setFocused(e)}focusedKey(){return this.state.focusedKey()}setFocusedKey(e){(e==null||this.collection().getItem(e))&&this.state.setFocusedKey(e)}selectedKeys(){return this.state.selectedKeys()}isSelected(e){if(this.state.selectionMode()==="none")return!1;const t=this.getKey(e);return t==null?!1:this.state.selectedKeys().has(t)}isEmpty(){return this.state.selectedKeys().size===0}isSelectAll(){if(this.isEmpty())return!1;const e=this.state.selectedKeys();return this.getAllSelectableKeys().every(t=>e.has(t))}firstSelectedKey(){let e;for(const t of this.state.selectedKeys()){const o=this.collection().getItem(t),n=(o==null?void 0:o.index)!=null&&(e==null?void 0:e.index)!=null&&o.index<e.index;(!e||n)&&(e=o)}return e==null?void 0:e.key}lastSelectedKey(){let e;for(const t of this.state.selectedKeys()){const o=this.collection().getItem(t),n=(o==null?void 0:o.index)!=null&&(e==null?void 0:e.index)!=null&&o.index>e.index;(!e||n)&&(e=o)}return e==null?void 0:e.key}extendSelection(e){if(this.selectionMode()==="none")return;if(this.selectionMode()==="single"){this.replaceSelection(e);return}const t=this.getKey(e);if(t==null)return;const o=this.state.selectedKeys(),n=o.anchorKey||t,r=new j(o,n,t);for(const s of this.getKeyRange(n,o.currentKey||t))r.delete(s);for(const s of this.getKeyRange(t,n))this.canSelectItem(s)&&r.add(s);this.state.setSelectedKeys(r)}getKeyRange(e,t){const o=this.collection().getItem(e),n=this.collection().getItem(t);return o&&n?o.index!=null&&n.index!=null&&o.index<=n.index?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){const o=[];let n=e;for(;n!=null;){const r=this.collection().getItem(n);if(r&&r.type==="item"&&o.push(n),n===t)return o;n=this.collection().getKeyAfter(n)}return[]}getKey(e){const t=this.collection().getItem(e);return t?!t||t.type!=="item"?null:t.key:e}toggleSelection(e){if(this.selectionMode()==="none")return;if(this.selectionMode()==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}const t=this.getKey(e);if(t==null)return;const o=new j(this.state.selectedKeys());o.has(t)?o.delete(t):this.canSelectItem(t)&&(o.add(t),o.anchorKey=t,o.currentKey=t),!(this.disallowEmptySelection()&&o.size===0)&&this.state.setSelectedKeys(o)}replaceSelection(e){if(this.selectionMode()==="none")return;const t=this.getKey(e);if(t==null)return;const o=this.canSelectItem(t)?new j([t],t,t):new j;this.state.setSelectedKeys(o)}setSelectedKeys(e){if(this.selectionMode()==="none")return;const t=new j;for(const o of e){const n=this.getKey(o);if(n!=null&&(t.add(n),this.selectionMode()==="single"))break}this.state.setSelectedKeys(t)}selectAll(){this.selectionMode()==="multiple"&&this.state.setSelectedKeys(new Set(this.getAllSelectableKeys()))}clearSelection(){const e=this.state.selectedKeys();!this.disallowEmptySelection()&&e.size>0&&this.state.setSelectedKeys(new j)}toggleSelectAll(){this.isSelectAll()?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode()!=="none"&&(this.selectionMode()==="single"?this.isSelected(e)&&!this.disallowEmptySelection()?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior()==="toggle"||t&&t.pointerType==="touch"?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys())return!0;const t=this.selectedKeys();if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;for(const o of t)if(!e.has(o))return!1;return!0}canSelectItem(e){if(this.state.selectionMode()==="none")return!1;const t=this.collection().getItem(e);return t!=null&&!t.disabled}isDisabled(e){const t=this.collection().getItem(e);return!t||t.disabled}getAllSelectableKeys(){const e=[];return(o=>{for(;o!=null;){if(this.canSelectItem(o)){const n=this.collection().getItem(o);if(!n)continue;n.type==="item"&&e.push(o)}o=this.collection().getKeyAfter(o)}})(this.collection().getFirstKey()),e}},$e=class{constructor(e){z(this,"keyMap",new Map);z(this,"iterable");z(this,"firstKey");z(this,"lastKey");this.iterable=e;for(const n of e)this.keyMap.set(n.key,n);if(this.keyMap.size===0)return;let t,o=0;for(const[n,r]of this.keyMap)t?(t.nextKey=n,r.prevKey=t.key):(this.firstKey=n,r.prevKey=void 0),r.type==="item"&&(r.index=o++),t=r,t.nextKey=void 0;this.lastKey=t.key}*[Symbol.iterator](){yield*this.iterable}getSize(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){var t;return(t=this.keyMap.get(e))==null?void 0:t.prevKey}getKeyAfter(e){var t;return(t=this.keyMap.get(e))==null?void 0:t.nextKey}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}};function Un(e){const t=An(e),n=kn({dataSource:()=>m(e.dataSource),getKey:()=>m(e.getKey),getTextValue:()=>m(e.getTextValue),getDisabled:()=>m(e.getDisabled),getSectionChildren:()=>m(e.getSectionChildren),factory:s=>e.filter?new $e(e.filter(s)):new $e(s)},[()=>e.filter]),r=new _n(n,t);return jt(()=>{const s=t.focusedKey();s!=null&&!n().getItem(s)&&t.setFocusedKey(void 0)}),{collection:n,selectionManager:()=>r}}var Bn=class{constructor(e,t,o){z(this,"collection");z(this,"ref");z(this,"collator");this.collection=e,this.ref=t,this.collator=o}getKeyBelow(e){let t=this.collection().getKeyAfter(e);for(;t!=null;){const o=this.collection().getItem(t);if(o&&o.type==="item"&&!o.disabled)return t;t=this.collection().getKeyAfter(t)}}getKeyAbove(e){let t=this.collection().getKeyBefore(e);for(;t!=null;){const o=this.collection().getItem(t);if(o&&o.type==="item"&&!o.disabled)return t;t=this.collection().getKeyBefore(t)}}getFirstKey(){let e=this.collection().getFirstKey();for(;e!=null;){const t=this.collection().getItem(e);if(t&&t.type==="item"&&!t.disabled)return e;e=this.collection().getKeyAfter(e)}}getLastKey(){let e=this.collection().getLastKey();for(;e!=null;){const t=this.collection().getItem(e);if(t&&t.type==="item"&&!t.disabled)return e;e=this.collection().getKeyBefore(e)}}getItem(e){var t,o;return((o=(t=this.ref)==null?void 0:t.call(this))==null?void 0:o.querySelector(`[data-key="${e}"]`))??null}getKeyPageAbove(e){var s;const t=(s=this.ref)==null?void 0:s.call(this);let o=this.getItem(e);if(!t||!o)return;const n=Math.max(0,o.offsetTop+o.offsetHeight-t.offsetHeight);let r=e;for(;r&&o&&o.offsetTop>n;)r=this.getKeyAbove(r),o=r!=null?this.getItem(r):null;return r}getKeyPageBelow(e){var s;const t=(s=this.ref)==null?void 0:s.call(this);let o=this.getItem(e);if(!t||!o)return;const n=Math.min(t.scrollHeight,o.offsetTop-o.offsetHeight+t.offsetHeight);let r=e;for(;r&&o&&o.offsetTop<n;)r=this.getKeyBelow(r),o=r!=null?this.getItem(r):null;return r}getKeyForSearch(e,t){var r;const o=(r=this.collator)==null?void 0:r.call(this);if(!o)return;let n=t!=null?this.getKeyBelow(t):this.getFirstKey();for(;n!=null;){const s=this.collection().getItem(n);if(s){const l=s.textValue.slice(0,e.length);if(s.textValue&&o.compare(l,e)===0)return n}n=this.getKeyBelow(n)}}};function zn(e,t,o){const n=mn({usage:"search",sensitivity:"base"}),r=R(()=>{const s=m(e.keyboardDelegate);return s||new Bn(e.collection,t,n)});return Nn({selectionManager:()=>m(e.selectionManager),keyboardDelegate:r,autoFocus:()=>m(e.autoFocus),deferAutoFocus:()=>m(e.deferAutoFocus),shouldFocusWrap:()=>m(e.shouldFocusWrap),disallowEmptySelection:()=>m(e.disallowEmptySelection),selectOnFocus:()=>m(e.selectOnFocus),disallowTypeAhead:()=>m(e.disallowTypeAhead),shouldUseVirtualFocus:()=>m(e.shouldUseVirtualFocus),allowsTabNavigation:()=>m(e.allowsTabNavigation),isVirtualized:()=>m(e.isVirtualized),scrollToKey:s=>{var l;return(l=m(e.scrollToKey))==null?void 0:l(s)},orientation:()=>m(e.orientation)},t)}var Ke="focusScope.autoFocusOnMount",Ie="focusScope.autoFocusOnUnmount",Ge={bubbles:!1,cancelable:!0},He={stack:[],active(){return this.stack[0]},add(e){var t;e!==this.active()&&((t=this.active())==null||t.pause()),this.stack=Me(this.stack,e),this.stack.unshift(e)},remove(e){var t;this.stack=Me(this.stack,e),(t=this.active())==null||t.resume()}};function $n(e,t){const[o,n]=E(!1),r={pause(){n(!0)},resume(){n(!1)}};let s=null;const l=v=>{var S;return(S=e.onMountAutoFocus)==null?void 0:S.call(e,v)},f=v=>{var S;return(S=e.onUnmountAutoFocus)==null?void 0:S.call(e,v)},i=()=>st(t()),c=()=>{const v=i().createElement("span");return v.setAttribute("data-focus-trap",""),v.tabIndex=0,Object.assign(v.style,ln),v},u=()=>{const v=t();return v?an(v,!0).filter(S=>!S.hasAttribute("data-focus-trap")):[]},w=()=>{const v=u();return v.length>0?v[0]:null},b=()=>{const v=u();return v.length>0?v[v.length-1]:null},I=()=>{const v=t();if(!v)return!1;const S=he(v);return!S||Z(v,S)?!1:cn(S)};F(()=>{const v=t();if(!v)return;He.add(r);const S=he(v);if(!Z(v,S)){const g=new CustomEvent(Ke,Ge);v.addEventListener(Ke,l),v.dispatchEvent(g),g.defaultPrevented||setTimeout(()=>{V(w()),he(v)===S&&V(v)},0)}k(()=>{v.removeEventListener(Ke,l),setTimeout(()=>{const g=new CustomEvent(Ie,Ge);I()&&g.preventDefault(),v.addEventListener(Ie,f),v.dispatchEvent(g),g.defaultPrevented||V(S??i().body),v.removeEventListener(Ie,f),He.remove(r)},0)})}),F(()=>{const v=t();if(!v||!m(e.trapFocus)||o())return;const S=g=>{const d=g.target;d!=null&&d.closest(`[${De}]`)||(Z(v,d)?s=d:V(s))},h=g=>{const a=g.relatedTarget??he(v);a!=null&&a.closest(`[${De}]`)||Z(v,a)||V(s)};i().addEventListener("focusin",S),i().addEventListener("focusout",h),k(()=>{i().removeEventListener("focusin",S),i().removeEventListener("focusout",h)})}),F(()=>{const v=t();if(!v||!m(e.trapFocus)||o())return;const S=c();v.insertAdjacentElement("afterbegin",S);const h=c();v.insertAdjacentElement("beforeend",h);function g(a){const y=w(),p=b();a.relatedTarget===y?V(p):V(y)}S.addEventListener("focusin",g),h.addEventListener("focusin",g);const d=new MutationObserver(a=>{for(const y of a)y.previousSibling===h&&(h.remove(),v.insertAdjacentElement("beforeend",h)),y.nextSibling===S&&(S.remove(),v.insertAdjacentElement("afterbegin",S))});d.observe(v,{childList:!0,subtree:!1}),k(()=>{S.removeEventListener("focusin",g),h.removeEventListener("focusin",g),S.remove(),h.remove(),d.disconnect()})})}var Gn="data-live-announcer";function Hn(e){F(()=>{m(e.isDisabled)||k(Wn(m(e.targets),m(e.root)))})}var ae=new WeakMap,$=[];function Wn(e,t=document.body){const o=new Set(e),n=new Set,r=i=>{for(const b of i.querySelectorAll(`[${Gn}], [${De}]`))o.add(b);const c=b=>{if(o.has(b)||b.parentElement&&n.has(b.parentElement)&&b.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(const I of o)if(b.contains(I))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},u=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),w=c(i);if(w===NodeFilter.FILTER_ACCEPT&&s(i),w!==NodeFilter.FILTER_REJECT){let b=u.nextNode();for(;b!=null;)s(b),b=u.nextNode()}},s=i=>{const c=ae.get(i)??0;i.getAttribute("aria-hidden")==="true"&&c===0||(c===0&&i.setAttribute("aria-hidden","true"),n.add(i),ae.set(i,c+1))};$.length&&$[$.length-1].disconnect(),r(t);const l=new MutationObserver(i=>{for(const c of i)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...o,...n].some(u=>u.contains(c.target))){for(const u of c.removedNodes)u instanceof Element&&(o.delete(u),n.delete(u));for(const u of c.addedNodes)(u instanceof HTMLElement||u instanceof SVGElement)&&(u.dataset.liveAnnouncer==="true"||u.dataset.reactAriaTopLayer==="true")?o.add(u):u instanceof Element&&r(u)}});l.observe(t,{childList:!0,subtree:!0});const f={observe(){l.observe(t,{childList:!0,subtree:!0})},disconnect(){l.disconnect()}};return $.push(f),()=>{l.disconnect();for(const i of n){const c=ae.get(i);if(c==null)return;c===1?(i.removeAttribute("aria-hidden"),ae.delete(i)):ae.set(i,c-1)}f===$[$.length-1]?($.pop(),$.length&&$[$.length-1].observe()):$.splice($.indexOf(f),1)}}function Yn(e={}){const[t,o]=vn({value:()=>m(e.isSelected),defaultValue:()=>!!m(e.defaultIsSelected),onChange:s=>{var l;return(l=e.onSelectedChange)==null?void 0:l.call(e,s)}});return{isSelected:t,setIsSelected:s=>{!m(e.isReadOnly)&&!m(e.isDisabled)&&o(s)},toggle:()=>{!m(e.isReadOnly)&&!m(e.isDisabled)&&o(!t())}}}var Te=(e,t)=>{if(e.contains(t))return!0;let o=t;for(;o;){if(o===e)return!0;o=o._$host??o.parentElement}return!1},ye=new Map,jn=e=>{F(()=>{const t=G(e.style)??{},o=G(e.properties)??[],n={};for(const s in t)n[s]=e.element.style[s];const r=ye.get(e.key);r?r.activeCount++:ye.set(e.key,{activeCount:1,originalStyles:n,properties:o.map(s=>s.key)}),Object.assign(e.element.style,e.style);for(const s of o)e.element.style.setProperty(s.key,s.value);k(()=>{var l;const s=ye.get(e.key);if(s){if(s.activeCount!==1){s.activeCount--;return}ye.delete(e.key);for(const[f,i]of Object.entries(s.originalStyles))e.element.style[f]=i;for(const f of s.properties)e.element.style.removeProperty(f);e.element.style.length===0&&e.element.removeAttribute("style"),(l=e.cleanup)==null||l.call(e)}})})},We=jn,Xn=(e,t)=>{switch(t){case"x":return[e.clientWidth,e.scrollLeft,e.scrollWidth];case"y":return[e.clientHeight,e.scrollTop,e.scrollHeight]}},qn=(e,t)=>{const o=getComputedStyle(e),n=t==="x"?o.overflowX:o.overflowY;return n==="auto"||n==="scroll"||e.tagName==="HTML"&&n==="visible"},Zn=(e,t,o)=>{const n=t==="x"&&window.getComputedStyle(e).direction==="rtl"?-1:1;let r=e,s=0,l=0,f=!1;do{const[i,c,u]=Xn(r,t),w=u-i-n*c;(c!==0||w!==0)&&qn(r,t)&&(s+=w,l+=c),r===(o??document.documentElement)?f=!0:r=r._$host??r.parentElement}while(r&&!f);return[s,l]},[Ye,je]=E([]),Jn=e=>Ye().indexOf(e)===Ye().length-1,Qn=e=>{const t=C({element:null,enabled:!0,hideScrollbar:!0,preventScrollbarShift:!0,preventScrollbarShiftMode:"padding",restoreScrollPosition:!0,allowPinchZoom:!1},e),o=ee();let n=[0,0],r=null,s=null;F(()=>{G(t.enabled)&&(je(c=>[...c,o]),k(()=>{je(c=>c.filter(u=>u!==o))}))}),F(()=>{if(!G(t.enabled)||!G(t.hideScrollbar))return;const{body:c}=document,u=window.innerWidth-c.offsetWidth;if(G(t.preventScrollbarShift)){const w={overflow:"hidden"},b=[];u>0&&(G(t.preventScrollbarShiftMode)==="padding"?w.paddingRight=`calc(${window.getComputedStyle(c).paddingRight} + ${u}px)`:w.marginRight=`calc(${window.getComputedStyle(c).marginRight} + ${u}px)`,b.push({key:"--scrollbar-width",value:`${u}px`}));const I=window.scrollY,v=window.scrollX;We({key:"prevent-scroll",element:c,style:w,properties:b,cleanup:()=>{G(t.restoreScrollPosition)&&u>0&&window.scrollTo(v,I)}})}else We({key:"prevent-scroll",element:c,style:{overflow:"hidden"}})}),F(()=>{!Jn(o)||!G(t.enabled)||(document.addEventListener("wheel",f,{passive:!1}),document.addEventListener("touchstart",l,{passive:!1}),document.addEventListener("touchmove",i,{passive:!1}),k(()=>{document.removeEventListener("wheel",f),document.removeEventListener("touchstart",l),document.removeEventListener("touchmove",i)}))});const l=c=>{n=Xe(c),r=null,s=null},f=c=>{const u=c.target,w=G(t.element),b=eo(c),I=Math.abs(b[0])>Math.abs(b[1])?"x":"y",v=I==="x"?b[0]:b[1],S=qe(u,I,v,w);let h;w&&Te(w,u)?h=!S:h=!0,h&&c.cancelable&&c.preventDefault()},i=c=>{const u=G(t.element),w=c.target;let b;if(c.touches.length===2)b=!G(t.allowPinchZoom);else{if(r==null||s===null){const I=Xe(c).map((S,h)=>n[h]-S),v=Math.abs(I[0])>Math.abs(I[1])?"x":"y";r=v,s=v==="x"?I[0]:I[1]}if(w.type==="range")b=!1;else{const I=qe(w,r,s,u);u&&Te(u,w)?b=!I:b=!0}}b&&c.cancelable&&c.preventDefault()}},eo=e=>[e.deltaX,e.deltaY],Xe=e=>e.changedTouches[0]?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0],qe=(e,t,o,n)=>{const r=n!==null&&Te(n,e),[s,l]=Zn(e,t,r?n:void 0);return!(o>0&&Math.abs(s)<=1||o<0&&Math.abs(l)<1)},to=Qn,no=to,St=Q();function wt(){return J(St)}function X(){const e=wt();if(e===void 0)throw new Error("[kobalte]: `useMenuContext` must be used within a `Menu` component");return e}var Kt=Q();function Fe(){const e=J(Kt);if(e===void 0)throw new Error("[kobalte]: `useMenuItemContext` must be used within a `Menu.Item` component");return e}var It=Q();function W(){const e=J(It);if(e===void 0)throw new Error("[kobalte]: `useMenuRootContext` must be used within a `MenuRoot` component");return e}function Ce(e){let t;const o=W(),n=X(),r=A({id:o.generateId(`item-${ee()}`)},e),[s,l]=O(r,["ref","textValue","disabled","closeOnSelect","checked","indeterminate","onSelect","onPointerMove","onPointerLeave","onPointerDown","onPointerUp","onClick","onKeyDown","onMouseDown","onFocus"]),[f,i]=E(),[c,u]=E(),[w,b]=E(),I=()=>n.listState().selectionManager(),v=()=>l.id,S=()=>I().focusedKey()===v(),h=()=>{var P;(P=s.onSelect)==null||P.call(s),s.closeOnSelect&&setTimeout(()=>{n.close(!0)})};xn({getItem:()=>{var P;return{ref:()=>t,type:"item",key:v(),textValue:s.textValue??((P=w())==null?void 0:P.textContent)??(t==null?void 0:t.textContent)??"",disabled:s.disabled??!1}}});const g=bt({key:v,selectionManager:I,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,disabled:()=>s.disabled},()=>t),d=P=>{L(P,s.onPointerMove),P.pointerType==="mouse"&&(s.disabled?n.onItemLeave(P):(n.onItemEnter(P),P.defaultPrevented||(V(P.currentTarget),n.listState().selectionManager().setFocused(!0),n.listState().selectionManager().setFocusedKey(v()))))},a=P=>{L(P,s.onPointerLeave),P.pointerType==="mouse"&&n.onItemLeave(P)},y=P=>{L(P,s.onPointerUp),!s.disabled&&P.button===0&&h()},p=P=>{if(L(P,s.onKeyDown),!P.repeat&&!s.disabled)switch(P.key){case"Enter":case" ":h();break}},x=R(()=>{if(s.indeterminate)return"mixed";if(s.checked!=null)return s.checked}),T=R(()=>({"data-indeterminate":s.indeterminate?"":void 0,"data-checked":s.checked&&!s.indeterminate?"":void 0,"data-disabled":s.disabled?"":void 0,"data-highlighted":S()?"":void 0})),U={isChecked:()=>s.checked,dataset:T,setLabelRef:b,generateId:Pe(()=>l.id),registerLabel:ue(i),registerDescription:ue(u)};return K(Kt.Provider,{value:U,get children(){return K(H,C({as:"div",ref(P){var q=ne(oe=>t=oe,s.ref);typeof q=="function"&&q(P)},get tabIndex(){return g.tabIndex()},get"aria-checked"(){return x()},get"aria-disabled"(){return s.disabled},get"aria-labelledby"(){return f()},get"aria-describedby"(){return c()},get"data-key"(){return g.dataKey()},get onPointerDown(){return N([s.onPointerDown,g.onPointerDown])},get onPointerUp(){return N([y,g.onPointerUp])},get onClick(){return N([s.onClick,g.onClick])},get onKeyDown(){return N([p,g.onKeyDown])},get onMouseDown(){return N([s.onMouseDown,g.onMouseDown])},get onFocus(){return N([s.onFocus,g.onFocus])},onPointerMove:d,onPointerLeave:a},T,l))}})}function Mt(e){const t=A({closeOnSelect:!1},e),[o,n]=O(t,["checked","defaultChecked","onChange","onSelect"]),r=Yn({isSelected:()=>o.checked,defaultIsSelected:()=>o.defaultChecked,onSelectedChange:l=>{var f;return(f=o.onChange)==null?void 0:f.call(o,l)},isDisabled:()=>n.disabled});return K(Ce,C({role:"menuitemcheckbox",get checked(){return r.isSelected()},onSelect:()=>{var l;(l=o.onSelect)==null||l.call(o),r.toggle()}},n))}var oo=Q();function ve(){return J(oo)}var de={next:(e,t)=>e==="ltr"?t==="horizontal"?"ArrowRight":"ArrowDown":t==="horizontal"?"ArrowLeft":"ArrowUp",previous:(e,t)=>de.next(e==="ltr"?"rtl":"ltr",t)},Ze={first:e=>e==="horizontal"?"ArrowDown":"ArrowRight",last:e=>e==="horizontal"?"ArrowUp":"ArrowLeft"};function xe(e){const t=W(),o=X(),n=ve(),{direction:r}=le(),s=A({id:t.generateId("trigger")},e),[l,f]=O(s,["ref","id","disabled","onPointerDown","onClick","onKeyDown","onMouseOver","onFocus"]);let i=()=>t.value();n!==void 0&&(i=()=>t.value()??l.id,n.lastValue()===void 0&&n.setLastValue(i));const c=it(()=>o.triggerRef(),()=>"button"),u=R(()=>{var g;return c()==="a"&&((g=o.triggerRef())==null?void 0:g.getAttribute("href"))!=null});F(me(()=>n==null?void 0:n.value(),g=>{var d;u()&&g===i()&&((d=o.triggerRef())==null||d.focus())}));const w=()=>{n!==void 0?o.isOpen()?n.value()===i()&&n.closeMenu():(n.autoFocusMenu()||n.setAutoFocusMenu(!0),o.open(!1)):o.toggle(!0)},b=g=>{L(g,l.onPointerDown),g.currentTarget.dataset.pointerType=g.pointerType,!l.disabled&&g.pointerType!=="touch"&&g.button===0&&w()},I=g=>{L(g,l.onClick),l.disabled||g.currentTarget.dataset.pointerType==="touch"&&w()},v=g=>{if(L(g,l.onKeyDown),!l.disabled){if(u())switch(g.key){case"Enter":case" ":return}switch(g.key){case"Enter":case" ":case Ze.first(t.orientation()):g.stopPropagation(),g.preventDefault(),dn(g.currentTarget),o.open("first"),n==null||n.setAutoFocusMenu(!0),n==null||n.setValue(i);break;case Ze.last(t.orientation()):g.stopPropagation(),g.preventDefault(),o.open("last");break;case de.next(r(),t.orientation()):if(n===void 0)break;g.stopPropagation(),g.preventDefault(),n.nextMenu();break;case de.previous(r(),t.orientation()):if(n===void 0)break;g.stopPropagation(),g.preventDefault(),n.previousMenu();break}}},S=g=>{var d;L(g,l.onMouseOver),((d=o.triggerRef())==null?void 0:d.dataset.pointerType)!=="touch"&&!l.disabled&&n!==void 0&&n.value()!==void 0&&n.setValue(i)},h=g=>{L(g,l.onFocus),n!==void 0&&g.currentTarget.dataset.pointerType!=="touch"&&n.setValue(i)};return F(()=>k(o.registerTriggerId(l.id))),K(un,C({ref(g){var d=ne(o.setTriggerRef,l.ref);typeof d=="function"&&d(g)},get"data-kb-menu-value-trigger"(){return t.value()},get id(){return l.id},get disabled(){return l.disabled},"aria-haspopup":"true",get"aria-expanded"(){return o.isOpen()},get"aria-controls"(){return R(()=>!!o.isOpen())()?o.contentId():void 0},get"data-highlighted"(){return i()!==void 0&&(n==null?void 0:n.value())===i()?!0:void 0},get tabIndex(){return n!==void 0?n.value()===i()||n.lastValue()===i()?0:-1:void 0},onPointerDown:b,onMouseOver:S,onClick:I,onKeyDown:v,onFocus:h,role:n!==void 0?"menuitem":void 0},()=>o.dataset(),f))}var ro=Q();function Dt(){return J(ro)}function Tt(e){let t;const o=W(),n=X(),r=ve(),s=Dt(),{direction:l}=le(),f=A({id:o.generateId(`content-${ee()}`)},e),[i,c]=O(f,["ref","id","style","onOpenAutoFocus","onCloseAutoFocus","onEscapeKeyDown","onFocusOutside","onPointerEnter","onPointerMove","onKeyDown","onMouseDown","onFocusIn","onFocusOut"]);let u=0;const w=()=>n.parentMenuContext()==null&&r===void 0&&o.isModal(),b=zn({selectionManager:n.listState().selectionManager,collection:n.listState().collection,autoFocus:n.autoFocus,deferAutoFocus:!0,shouldFocusWrap:!0,disallowTypeAhead:()=>!n.listState().selectionManager().isFocused(),orientation:()=>o.orientation()==="horizontal"?"vertical":"horizontal"},()=>t);$n({trapFocus:()=>w()&&n.isOpen(),onMountAutoFocus:a=>{var y;r===void 0&&((y=i.onOpenAutoFocus)==null||y.call(i,a))},onUnmountAutoFocus:i.onCloseAutoFocus},()=>t);const I=a=>{if(Z(a.currentTarget,a.target)&&(a.key==="Tab"&&n.isOpen()&&a.preventDefault(),r!==void 0&&a.currentTarget.getAttribute("aria-haspopup")!=="true"))switch(a.key){case de.next(l(),o.orientation()):a.stopPropagation(),a.preventDefault(),n.close(!0),r.setAutoFocusMenu(!0),r.nextMenu();break;case de.previous(l(),o.orientation()):if(a.currentTarget.hasAttribute("data-closed"))break;a.stopPropagation(),a.preventDefault(),n.close(!0),r.setAutoFocusMenu(!0),r.previousMenu();break}},v=a=>{var y;(y=i.onEscapeKeyDown)==null||y.call(i,a),r==null||r.setAutoFocusMenu(!1),n.close(!0)},S=a=>{var y;(y=i.onFocusOutside)==null||y.call(i,a),o.isModal()&&a.preventDefault()},h=a=>{var y,p;L(a,i.onPointerEnter),n.isOpen()&&((y=n.parentMenuContext())==null||y.listState().selectionManager().setFocused(!1),(p=n.parentMenuContext())==null||p.listState().selectionManager().setFocusedKey(void 0))},g=a=>{if(L(a,i.onPointerMove),a.pointerType!=="mouse")return;const y=a.target,p=u!==a.clientX;Z(a.currentTarget,y)&&p&&(n.setPointerDir(a.clientX>u?"right":"left"),u=a.clientX)};F(()=>k(n.registerContentId(i.id))),k(()=>n.setContentRef(void 0));const d={ref:ne(a=>{n.setContentRef(a),t=a},i.ref),role:"menu",get id(){return i.id},get tabIndex(){return b.tabIndex()},get"aria-labelledby"(){return n.triggerId()},onKeyDown:N([i.onKeyDown,b.onKeyDown,I]),onMouseDown:N([i.onMouseDown,b.onMouseDown]),onFocusIn:N([i.onFocusIn,b.onFocusIn]),onFocusOut:N([i.onFocusOut,b.onFocusOut]),onPointerEnter:h,onPointerMove:g,get"data-orientation"(){return o.orientation()}};return K(te,{get when(){return n.contentPresent()},get children(){return K(te,{get when(){return s===void 0||n.parentMenuContext()!=null},get fallback(){return K(H,C({as:"div"},()=>n.dataset(),d,c))},get children(){return K(ut.Positioner,{get children(){return K(pn,C({get disableOutsidePointerEvents(){return R(()=>!!w())()&&n.isOpen()},get excludedElements(){return[n.triggerRef]},bypassTopMostLayerCheck:!0,get style(){return Zt({"--kb-menu-content-transform-origin":"var(--kb-popper-content-transform-origin)",position:"relative"},i.style)},onEscapeKeyDown:v,onFocusOutside:S,get onDismiss(){return n.close}},()=>n.dataset(),d,c))}})}})}})}function so(e){let t;const o=W(),n=X(),[r,s]=O(e,["ref"]);return no({element:()=>t??null,enabled:()=>n.contentPresent()&&o.preventScroll()}),K(Tt,C({ref(l){var f=ne(i=>{t=i},r.ref);typeof f=="function"&&f(l)}},s))}var Pt=Q();function io(){const e=J(Pt);if(e===void 0)throw new Error("[kobalte]: `useMenuGroupContext` must be used within a `Menu.Group` component");return e}function ke(e){const t=W(),o=A({id:t.generateId(`group-${ee()}`)},e),[n,r]=E(),s={generateId:Pe(()=>o.id),registerLabelId:ue(r)};return K(Pt.Provider,{value:s,get children(){return K(H,C({as:"div",role:"group",get"aria-labelledby"(){return n()}},o))}})}function Ft(e){const t=io(),o=A({id:t.generateId("label")},e),[n,r]=O(o,["id"]);return F(()=>k(t.registerLabelId(n.id))),K(H,C({as:"span",get id(){return n.id},"aria-hidden":"true"},r))}function Ct(e){const t=X(),o=A({children:"▼"},e);return K(H,C({as:"span","aria-hidden":"true"},()=>t.dataset(),o))}function Ee(e){return K(Ce,C({role:"menuitem",closeOnSelect:!0},e))}function xt(e){const t=Fe(),o=A({id:t.generateId("description")},e),[n,r]=O(o,["id"]);return F(()=>k(t.registerDescription(n.id))),K(H,C({as:"div",get id(){return n.id}},()=>t.dataset(),r))}function kt(e){const t=Fe(),o=A({id:t.generateId("indicator")},e),[n,r]=O(o,["forceMount"]);return K(te,{get when(){return n.forceMount||t.isChecked()},get children(){return K(H,C({as:"div"},()=>t.dataset(),r))}})}function Et(e){const t=Fe(),o=A({id:t.generateId("label")},e),[n,r]=O(o,["ref","id"]);return F(()=>k(t.registerLabel(n.id))),K(H,C({as:"div",ref(s){var l=ne(t.setLabelRef,n.ref);typeof l=="function"&&l(s)},get id(){return n.id}},()=>t.dataset(),r))}function Oe(e){const t=X();return K(te,{get when(){return t.contentPresent()},get children(){return K(qt,e)}})}var Ot=Q();function lo(){const e=J(Ot);if(e===void 0)throw new Error("[kobalte]: `useMenuRadioGroupContext` must be used within a `Menu.RadioGroup` component");return e}function At(e){const o=W().generateId(`radiogroup-${ee()}`),n=A({id:o},e),[r,s]=O(n,["value","defaultValue","onChange","disabled"]),[l,f]=ct({value:()=>r.value,defaultValue:()=>r.defaultValue,onChange:c=>{var u;return(u=r.onChange)==null?void 0:u.call(r,c)}}),i={isDisabled:()=>r.disabled,isSelectedValue:c=>c===l(),setSelectedValue:f};return K(Ot.Provider,{value:i,get children(){return K(ke,s)}})}function Lt(e){const t=lo(),o=A({closeOnSelect:!1},e),[n,r]=O(o,["value","onSelect"]);return K(Ce,C({role:"menuitemradio",get checked(){return t.isSelectedValue(n.value)},onSelect:()=>{var l;(l=n.onSelect)==null||l.call(n),t.setSelectedValue(n.value)}},r))}function co(e,t,o){const n=e.split("-")[0],r=o.getBoundingClientRect(),s=[],l=t.clientX,f=t.clientY;switch(n){case"top":s.push([l,f+5]),s.push([r.left,r.bottom]),s.push([r.left,r.top]),s.push([r.right,r.top]),s.push([r.right,r.bottom]);break;case"right":s.push([l-5,f]),s.push([r.left,r.top]),s.push([r.right,r.top]),s.push([r.right,r.bottom]),s.push([r.left,r.bottom]);break;case"bottom":s.push([l,f-5]),s.push([r.right,r.top]),s.push([r.right,r.bottom]),s.push([r.left,r.bottom]),s.push([r.left,r.top]);break;case"left":s.push([l+5,f]),s.push([r.right,r.bottom]),s.push([r.left,r.bottom]),s.push([r.left,r.top]),s.push([r.right,r.top]);break}return s}function ao(e,t){return t?fn([e.clientX,e.clientY],t):!1}function Rt(e){const t=W(),o=gt(),n=wt(),r=ve(),s=Dt(),l=A({placement:t.orientation()==="horizontal"?"bottom-start":"right-start"},e),[f,i]=O(l,["open","defaultOpen","onOpenChange"]);let c=0,u=null,w="right";const[b,I]=E(),[v,S]=E(),[h,g]=E(),[d,a]=E(),[y,p]=E(!0),[x,T]=E(i.placement),[U,P]=E([]),[q,oe]=E([]),{DomCollectionProvider:fe}=Cn({items:q,onItemsChange:oe}),B=at({open:()=>f.open,defaultOpen:()=>f.defaultOpen,onOpenChange:D=>{var Y;return(Y=f.onOpenChange)==null?void 0:Y.call(f,D)}}),{present:ge}=bn({show:()=>t.forceMount()||B.isOpen(),element:()=>d()??null}),re=Un({selectionMode:"none",dataSource:q}),M=D=>{p(D),B.open()},_=(D=!1)=>{B.close(),D&&n&&n.close(!0)},se=D=>{p(D),B.toggle()},Re=()=>{const D=d();D&&(V(D),re.selectionManager().setFocused(!0),re.selectionManager().setFocusedKey(void 0))},Ve=()=>{s!=null?setTimeout(()=>Re()):Re()},Ut=D=>{P(Se=>[...Se,D]);const Y=n==null?void 0:n.registerNestedMenu(D);return()=>{P(Se=>Me(Se,D)),Y==null||Y()}},be=D=>w===(u==null?void 0:u.side)&&ao(D,u==null?void 0:u.area),Bt=D=>{be(D)&&D.preventDefault()},zt=D=>{be(D)||Ve()},$t=D=>{be(D)&&D.preventDefault()};Hn({isDisabled:()=>!(n==null&&B.isOpen()&&t.isModal()),targets:()=>[d(),...U()].filter(Boolean)}),F(()=>{const D=d();if(!D||!n)return;const Y=n.registerNestedMenu(D);k(()=>{Y()})}),F(()=>{n===void 0&&(r==null||r.registerMenu(t.value(),[d(),...U()]))}),F(()=>{var D;n!==void 0||r===void 0||(r.value()===t.value()?((D=h())==null||D.focus(),r.autoFocusMenu()&&M(!0)):_())}),F(()=>{n!==void 0||r===void 0||B.isOpen()&&r.setValue(t.value())}),k(()=>{n===void 0&&(r==null||r.unregisterMenu(t.value()))});const Gt={dataset:R(()=>({"data-expanded":B.isOpen()?"":void 0,"data-closed":B.isOpen()?void 0:""})),isOpen:B.isOpen,contentPresent:ge,nestedMenus:U,currentPlacement:x,pointerGraceTimeoutId:()=>c,autoFocus:y,listState:()=>re,parentMenuContext:()=>n,triggerRef:h,contentRef:d,triggerId:b,contentId:v,setTriggerRef:g,setContentRef:a,open:M,close:_,toggle:se,focusContent:Ve,onItemEnter:Bt,onItemLeave:zt,onTriggerLeave:$t,setPointerDir:D=>w=D,setPointerGraceTimeoutId:D=>c=D,setPointerGraceIntent:D=>u=D,registerNestedMenu:Ut,registerItemToParentDomCollection:o==null?void 0:o.registerItem,registerTriggerId:ue(I),registerContentId:ue(S)};return K(fe,{get children(){return K(St.Provider,{value:Gt,get children(){return K(te,{when:s===void 0,get fallback(){return i.children},get children(){return K(ut,C({anchorRef:h,contentRef:d,onCurrentPlacementChange:T},i))}})}})}})}function Vt(e){const{direction:t}=le();return K(Rt,C({get placement(){return t()==="rtl"?"left-start":"right-start"},flip:!0},e))}var uo={close:(e,t)=>e==="ltr"?[t==="horizontal"?"ArrowLeft":"ArrowUp"]:[t==="horizontal"?"ArrowRight":"ArrowDown"]};function Nt(e){const t=X(),o=W(),[n,r]=O(e,["onFocusOutside","onKeyDown"]),{direction:s}=le();return K(Tt,C({onOpenAutoFocus:u=>{u.preventDefault()},onCloseAutoFocus:u=>{u.preventDefault()},onFocusOutside:u=>{var b;(b=n.onFocusOutside)==null||b.call(n,u);const w=u.target;Z(t.triggerRef(),w)||t.close()},onKeyDown:u=>{L(u,n.onKeyDown);const w=Z(u.currentTarget,u.target),b=uo.close(s(),o.orientation()).includes(u.key),I=t.parentMenuContext()!=null;w&&b&&I&&(t.close(),V(t.triggerRef()))}},r))}var Je=["Enter"," "],fo={open:(e,t)=>e==="ltr"?[...Je,t==="horizontal"?"ArrowRight":"ArrowDown"]:[...Je,t==="horizontal"?"ArrowLeft":"ArrowUp"]};function _t(e){let t;const o=W(),n=X(),r=A({id:o.generateId(`sub-trigger-${ee()}`)},e),[s,l]=O(r,["ref","id","textValue","disabled","onPointerMove","onPointerLeave","onPointerDown","onPointerUp","onClick","onKeyDown","onMouseDown","onFocus"]);let f=null;const i=()=>{f&&window.clearTimeout(f),f=null},{direction:c}=le(),u=()=>s.id,w=()=>{const a=n.parentMenuContext();if(a==null)throw new Error("[kobalte]: `Menu.SubTrigger` must be used within a `Menu.Sub` component");return a.listState().selectionManager()},b=()=>n.listState().collection(),I=()=>w().focusedKey()===u(),v=bt({key:u,selectionManager:w,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,disabled:()=>s.disabled},()=>t),S=a=>{L(a,s.onClick),!n.isOpen()&&!s.disabled&&n.open(!0)},h=a=>{var p;if(L(a,s.onPointerMove),a.pointerType!=="mouse")return;const y=n.parentMenuContext();if(y==null||y.onItemEnter(a),!a.defaultPrevented){if(s.disabled){y==null||y.onItemLeave(a);return}!n.isOpen()&&!f&&((p=n.parentMenuContext())==null||p.setPointerGraceIntent(null),f=window.setTimeout(()=>{n.open(!1),i()},100)),y==null||y.onItemEnter(a),a.defaultPrevented||(n.listState().selectionManager().isFocused()&&(n.listState().selectionManager().setFocused(!1),n.listState().selectionManager().setFocusedKey(void 0)),V(a.currentTarget),y==null||y.listState().selectionManager().setFocused(!0),y==null||y.listState().selectionManager().setFocusedKey(u()))}},g=a=>{if(L(a,s.onPointerLeave),a.pointerType!=="mouse")return;i();const y=n.parentMenuContext(),p=n.contentRef();if(p){y==null||y.setPointerGraceIntent({area:co(n.currentPlacement(),a,p),side:n.currentPlacement().split("-")[0]}),window.clearTimeout(y==null?void 0:y.pointerGraceTimeoutId());const x=window.setTimeout(()=>{y==null||y.setPointerGraceIntent(null)},300);y==null||y.setPointerGraceTimeoutId(x)}else{if(y==null||y.onTriggerLeave(a),a.defaultPrevented)return;y==null||y.setPointerGraceIntent(null)}y==null||y.onItemLeave(a)},d=a=>{L(a,s.onKeyDown),!a.repeat&&(s.disabled||fo.open(c(),o.orientation()).includes(a.key)&&(a.stopPropagation(),a.preventDefault(),w().setFocused(!1),w().setFocusedKey(void 0),n.isOpen()||n.open("first"),n.focusContent(),n.listState().selectionManager().setFocused(!0),n.listState().selectionManager().setFocusedKey(b().getFirstKey())))};return F(()=>{if(n.registerItemToParentDomCollection==null)throw new Error("[kobalte]: `Menu.SubTrigger` must be used within a `Menu.Sub` component");const a=n.registerItemToParentDomCollection({ref:()=>t,type:"item",key:u(),textValue:s.textValue??(t==null?void 0:t.textContent)??"",disabled:s.disabled??!1});k(a)}),F(me(()=>{var a;return(a=n.parentMenuContext())==null?void 0:a.pointerGraceTimeoutId()},a=>{k(()=>{var y;window.clearTimeout(a),(y=n.parentMenuContext())==null||y.setPointerGraceIntent(null)})})),F(()=>k(n.registerTriggerId(s.id))),k(()=>{i()}),K(H,C({as:"div",ref(a){var y=ne(p=>{n.setTriggerRef(p),t=p},s.ref);typeof y=="function"&&y(a)},get id(){return s.id},role:"menuitem",get tabIndex(){return v.tabIndex()},"aria-haspopup":"true",get"aria-expanded"(){return n.isOpen()},get"aria-controls"(){return R(()=>!!n.isOpen())()?n.contentId():void 0},get"aria-disabled"(){return s.disabled},get"data-key"(){return v.dataKey()},get"data-highlighted"(){return I()?"":void 0},get"data-disabled"(){return s.disabled?"":void 0},get onPointerDown(){return N([s.onPointerDown,v.onPointerDown])},get onPointerUp(){return N([s.onPointerUp,v.onPointerUp])},get onClick(){return N([S,v.onClick])},get onKeyDown(){return N([d,v.onKeyDown])},get onMouseDown(){return N([s.onMouseDown,v.onMouseDown])},get onFocus(){return N([s.onFocus,v.onFocus])},onPointerMove:h,onPointerLeave:g},()=>n.dataset(),l))}function go(e){const t=ve(),o=`menu-${ee()}`,n=A({id:o,modal:!0},e),[r,s]=O(n,["id","modal","preventScroll","forceMount","open","defaultOpen","onOpenChange","value","orientation"]),l=at({open:()=>r.open,defaultOpen:()=>r.defaultOpen,onOpenChange:i=>{var c;return(c=r.onOpenChange)==null?void 0:c.call(r,i)}}),f={isModal:()=>r.modal??!0,preventScroll:()=>r.preventScroll??f.isModal(),forceMount:()=>r.forceMount??!1,generateId:Pe(()=>r.id),value:()=>r.value,orientation:()=>r.orientation??(t==null?void 0:t.orientation())??"horizontal"};return K(It.Provider,{value:f,get children(){return K(Rt,C({get open(){return l.isOpen()},get onOpenChange(){return l.setIsOpen}},s))}})}var ho={};lt(ho,{Root:()=>pe,Separator:()=>yo});function pe(e){let t;const o=A({orientation:"horizontal"},e),[n,r]=O(o,["ref","orientation"]),s=it(()=>t,()=>"hr");return K(H,C({as:"hr",ref(l){var f=ne(i=>t=i,n.ref);typeof f=="function"&&f(l)},get role(){return s()!=="hr"?"separator":void 0},get"aria-orientation"(){return n.orientation==="vertical"?"vertical":void 0},get"data-orientation"(){return n.orientation}},r))}var yo=pe,mo={};lt(mo,{Arrow:()=>dt,CheckboxItem:()=>Mt,Content:()=>Ae,DropdownMenu:()=>vo,Group:()=>ke,GroupLabel:()=>Ft,Icon:()=>Ct,Item:()=>Ee,ItemDescription:()=>xt,ItemIndicator:()=>kt,ItemLabel:()=>Et,Portal:()=>Oe,RadioGroup:()=>At,RadioItem:()=>Lt,Root:()=>Le,Separator:()=>pe,Sub:()=>Vt,SubContent:()=>Nt,SubTrigger:()=>_t,Trigger:()=>xe});function Ae(e){const t=W(),o=X(),[n,r]=O(e,["onCloseAutoFocus","onInteractOutside"]);let s=!1;return K(so,C({onCloseAutoFocus:i=>{var c;(c=n.onCloseAutoFocus)==null||c.call(n,i),s||V(o.triggerRef()),s=!1,i.preventDefault()},onInteractOutside:i=>{var c;(c=n.onInteractOutside)==null||c.call(n,i),(!t.isModal()||i.detail.isContextMenu)&&(s=!0)}},r))}function Le(e){const t=`dropdownmenu-${ee()}`,o=A({id:t},e);return K(go,o)}var vo=Object.assign(Le,{Arrow:dt,CheckboxItem:Mt,Content:Ae,Group:ke,GroupLabel:Ft,Icon:Ct,Item:Ee,ItemDescription:xt,ItemIndicator:kt,ItemLabel:Et,Portal:Oe,RadioGroup:At,RadioItem:Lt,Separator:pe,Sub:Vt,SubContent:Nt,SubTrigger:_t,Trigger:xe});const Qe=xe,et=e=>K(Le,C({gutter:4},e)),tt=e=>{const[,t]=O(e,["class"]);return K(Oe,{get children(){return K(Ae,C({get class(){return ot("z-50 min-w-32 origin-[var(--kb-menu-content-transform-origin)] animate-content-hide overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[expanded]:animate-content-show",e.class)}},t))}})},po=e=>{const[,t]=O(e,["class"]);return K(Ee,C({get class(){return ot("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e.class)}},t))};var bo=rt("<span class=text-sm>Delete"),So=rt('<div class="flex absolute justify-center select-none"><div class="bg-white px-3 py-1 rounded-lg drop-shadow-md flex gap-3 justify-center items-center">');const ko=e=>{const[t,{setLayerState:o}]=gn(),n=R(()=>Sn(),t.layersState.selectionLayerIds.length),r=R(()=>t.layersState.selectionLayerIds.some(l=>[we.Comment,we.Sticker].includes(t.layersState.layers[l].type)),t.layersState.selectionLayerIds.length),s=()=>{t.layersState.selectionLayerIds.forEach(l=>{const f=t.layersState.layerIds.filter(i=>i!==l);o(["layerIds"],f),o(["layers"],f.reduce((i,c)=>({...i,[c]:t.layersState.layers[c]}),{})),o(["selectionLayerIds"],[])})};return R(()=>t.layersState.selectionLayerIds.length==1&&t.layersState.selectionLayerIds.some(l=>t.layersState.layers[l].type===we.Text),t.layersState.selectionLayerIds.length),K(te,{get when(){return n()},get children(){var l=So(),f=l.firstChild;return l.$$click=i=>{i.stopPropagation(),i.preventDefault()},_e(f,K(te,{get when(){return!r()},get children(){return K(et,{placement:"top",get children(){return[K(Qe,{as:Be,class:"!size-6 !p-0",size:"icon",get style(){return{background:hn({...e.lastUsedColor,a:1})}}}),K(tt,{class:"mb-2 border border-gray-200 shadow-none"})]}})}}),null),_e(f,K(et,{placement:"right-start",get children(){return[K(Qe,{as:Be,variant:"buttonToolbar",size:"icon",onClick:()=>{},class:"p-0 size-8",get children(){return K(Jt,{class:"h-5 w-5"})}}),K(tt,{class:"w-40 ml-3 border-none",get children(){return K(po,{onClick:s,get children(){return[K(Qt,{class:"w-4 h-5 mr-2"}),bo()]}})}})]}}),null),nt(i=>{var w,b,I;var c=`${(w=n())==null?void 0:w.width}px`,u=`translate(calc(${(b=n())==null?void 0:b.x}px), calc(${((I=n())==null?void 0:I.y)-16}px - 100%))`;return c!==i.e&&((i.e=c)!=null?l.style.setProperty("width",c):l.style.removeProperty("width")),u!==i.t&&((i.t=u)!=null?l.style.setProperty("transform",u):l.style.removeProperty("transform")),i},{e:void 0,t:void 0}),l}})};en(["click"]);export{ko as default};
