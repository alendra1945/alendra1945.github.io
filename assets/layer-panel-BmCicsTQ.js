var ve=Object.defineProperty;var ye=(t,e,n)=>e in t?ve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var W=(t,e,n)=>ye(t,typeof e!="symbol"?e+"":e,n);import{g as E,L as he,l as be,c as d,n as ie,p as le,f as $,o as G,W as U,e as T,u as pe,h as Ie,m as D,b as P,i as K,S as F,a3 as xe,F as V,a as J,d as re,t as N,ar as _,a7 as Q,aq as Se,k as H,ao as Le,as as oe,s as X}from"./index-CONonrmZ.js";import{u as R,m as we,e as Te,t as De,a as Ce,n as Y,E as j,g as Ke,b as Me,S as q}from"./reporting-designer-try-BWdnggUy.js";import{D as Ee}from"./dynamic-CMGeCz-q.js";import{e as Pe,_ as $e,D as z,I as M,x as ce,J as ke,K as Fe,N as Oe,l as Ae}from"./index-Dn2xiQBh.js";import{C as _e,a as Ne,b as Re,c as ze}from"./context-menu-BlUGM1mj.js";import{P as We}from"./panel-resizer-CHIQHmlq.js";import{c as je,a as qe,b as Ue,d as Ve,e as He}from"./index-BA8OFV39.js";import{s as Be,u as de,d as Xe}from"./index-DrStG47M.js";import{a as Ye}from"./index-CfooAA2k.js";import"./button-BfLWysEP.js";import"./use-local-storage-BteJbqdo.js";import"./base-data-dummy-D5f9491l.js";import"./T4C3DMHT-DzaLNui5.js";const ue=ie(),Je=t=>{const[e]=R(),n=()=>e.documentState,[o,a]=Pe({initialIds:[],sortedIds:[],dataIdTree:{}}),I=s=>s>=0&&s<o.initialIds.length,v=(s,r=null,g=[])=>s.reduce((m,{content:c,id:i})=>(a("dataIdTree",i,{id:i,parentId:r,parentIdPath:g,childrenIds:c.map(p=>p.id),contentLength:c.length}),r&&a("dataIdTree",r,"contentLength",p=>p+c.length),[...m,i,...v(c,i,[...g,i])]),[]);E(()=>{he(()=>{const s=v([...t.ids]);a("initialIds",s),a("sortedIds",s)})}),E(()=>{n().activeMovingLayer.draggableLayerId&&n().activeMovingLayer.droppableLayerId?be(()=>{const s=o.sortedIds.indexOf(n().activeMovingLayer.draggableLayerId),r=o.initialIds.indexOf(n().activeMovingLayer.droppableLayerId);if(!I(s)||!I(r))a("sortedIds",v([...t.ids]));else if(s!==r&&!o.dataIdTree[n().activeMovingLayer.droppableLayerId].parentIdPath.includes(n().activeMovingLayer.draggableLayerId)&&(o.dataIdTree[n().activeMovingLayer.draggableLayerId].parentId||!o.dataIdTree[n().activeMovingLayer.draggableLayerId].parentId&&!o.dataIdTree[n().activeMovingLayer.droppableLayerId].parentId)&&o.dataIdTree[n().activeMovingLayer.draggableLayerId].parentId!=n().activeMovingLayer.droppableLayerId){const g=we(o.sortedIds,s,r,o.dataIdTree[n().activeMovingLayer.draggableLayerId].contentLength);a("sortedIds",g)}}):a("sortedIds",v([...t.ids]))});const l=[o,{}];return d(ue.Provider,{value:l,get children(){return t.children}})},Ge=()=>le(ue)||null,Qe=(t,e)=>{const[n]=Ge(),[o,{addLayer:a,removeLayer:I,draggableActivators:v,addTransformer:y,removeTransformer:l}]=R(),[s,r]=$(null),g=()=>o.documentState,u=()=>n.initialIds.indexOf(t),m=()=>n.sortedIds.indexOf(t),c=b=>{var x;return((x=o.documentState.layerElement[b])==null?void 0:x.layout)||null},i=()=>g().layerElement[g().activeMovingLayer.draggableLayerId||""],p=()=>{const b=Y();if(!i()||i().id===t||!i().data.parentId&&e.parentId||i().data.parentId&&i().data.parentIds.includes(t)||i().data.parentId&&i().data.parentId!==e.parentId)return b;{const x=u();let w=m();if(w!==x){const L=c(t),C=c(n.initialIds[w]);L&&C&&(b.x=C.x-L.x,b.y=C.y-L.y)}}return b},h={id:"treeLayerOffset",order:100,callback:b=>{const x=p();return{x:b.x,y:b.y+x.y}}},f=()=>{var b;return((b=o.documentState.layerElement[t])==null?void 0:b.transform)||Y()};return G(()=>{const b=s();b&&(a({id:t,node:b,layout:Te(b),data:e}),y("layer",t,h))}),U(()=>{l("layer",t,h.id),I(t)}),Object.defineProperties((b,x)=>{const w=x?x():{};E(()=>{const L=s(),C=v(t,"layer");if(L)for(const A in C)L.addEventListener(A,C[A]);U(()=>{if(L)for(const A in C)L.removeEventListener(A,C[A])})}),r(b),w.skipTransform||E(()=>{const L=f();if(De(L,Y()))b.style.removeProperty("transform");else{const C=Ce(f());b.style.setProperty("transform",C.transform??null)}})},{ref:{enumerable:!0,value:r},transform:{enumerable:!0,get:f},isActiveDraggable:{enumerable:!0,get:()=>o.documentState.activeMovingLayer.draggableLayerId===t},dragActivators:{enumerable:!0,get:()=>v(t,"layer",!0)},isActiveDroppable:{enumerable:!0,get:()=>o.documentState.activeMovingLayer.droppableLayerId===t}})};var Ze=N("<div>"),et=N('<div><span class="group my-[4px] flex items-center gap-1.5 pr-[2px]"><span>');const ge=t=>{const[e,n]=T(t,["details","depth","parentId","parentIds","index"]),o=()=>e.parentId?[...e.parentIds,e.parentId]:e.parentIds,a=Qe(e.details.id,{depth:e.depth,index:e.index,type:e.details.type,parentId:e.parentId,parentIds:o(),childrenIds:e.details.content.map(c=>c.id)}),[I,v]=$(e.details.type!==j.TABLE&&!["table","thead","tbody","tr","th","td"].includes(e.details.originalElement||"")),[y,{deleteElement:l,duplicateElement:s}]=R(),r=()=>y.documentState.blockNodeElement[e.details.id],g=()=>a.isActiveDraggable||y.documentState.selectedElementIds.length===1&&y.documentState.selectedElementIds.includes(e.details.id),u=()=>{v(c=>!c)},m=[{label:"Duplicate",action:()=>{s(e.details.id)},condition:()=>t.details.type!==j.SECTION&&!t.details.isRepeaterElement&&!["thead","tbody"].includes(t.details.originalElement||"")},{label:"Delete",action:()=>{l(e.details.id)},condition:()=>t.details.type!==j.SECTION}];return d(ze,{get children(){return[d(_e,{as:"div",get children(){var c=et(),i=c.firstChild,p=i.firstChild;return pe(a,c,()=>a),Ie(c,D({get"data-block-layer-id"(){return e.details.id}},n,{get class(){return P(e.details.classes,"relative min-w-24 px-1 cursor-grab rounded border border-transparent bg-white text-sm text-gray-600",g()&&"border-blue-300 z-50",a.isActiveDroppable&&"z-0")}}),!1,!0),K(i,d(F,{get when(){var h,f,S;return(((h=r())==null?void 0:h.isContainer)||((f=r())==null?void 0:f.isTable))&&e.details.content.length||((S=r())==null?void 0:S.isRoot)},get children(){return d(xe,{get class(){return P("size-5 -mt-1",!I()&&"-rotate-90")},onClick:u})}}),p),K(i,d(Ee,{get as(){var h;return(h=r())==null?void 0:h.getIcon()},class:"size-4 shrink-0"}),p),K(p,d(F,{get when(){var h;return(h=r())==null?void 0:h.isText},get children(){var h;return`${e.details.originalElement} | ${Ke(((h=e.details)==null?void 0:h.innerHTML)||"")}`}}),null),K(p,d(F,{get when(){var h;return!((h=r())!=null&&h.isText)},get children(){return e.details.name}}),null),K(c,d(F,{get when(){return e.details.content.length},get children(){var h=Ze();return K(h,d(V,{get each(){return e.details.content},children:(f,S)=>d(ge,{details:f,get index(){return S()},get parentId(){return e.details.id},get depth(){return e.depth+1},get parentIds(){return o()}})})),J(f=>{var S=P(!I()&&"hidden"),k=Me(e.depth+1*12);return S!==f.e&&re(h,f.e=S),k!==f.t&&((f.t=k)!=null?h.style.setProperty("padding-left",k):h.style.removeProperty("padding-left")),f},{e:void 0,t:void 0}),h}}),null),J(()=>re(p,P("min-h-[1em] min-w-[2em] truncate"))),c}}),d(F,{get when(){return e.details.type!==j.SECTION},get children(){return d(Ne,{class:"w-48 focus-visible:outline-0",get children(){return d(V,{each:m,children:c=>d(F,{get when(){return!c.condition||c.condition()},get children(){return d(Re,{onSelect:()=>c.action(),get children(){return c.label}})}})})}})}})]}})},tt=(t="pointer-sensor",e)=>{const[n,{addSensor:o,removeSensor:a,sensorStart:I,sensorMove:v,sensorEnd:y,dragStart:l,dragEnd:s,addSelectedElement:r}]=R(),g=250,u=10;G(()=>{o({id:t,activators:{pointerdown:h}})}),U(()=>{a(t)});const m=()=>n.documentState.activeSensor===t,c={x:0,y:0};let i=null,p=null;const h=(x,w,L)=>{x.button===0&&(document.addEventListener("pointermove",k),document.addEventListener("pointerup",O),document.addEventListener("pointercancel",O),p=w,e=L,c.x=x.clientX,c.y=x.clientY,i=window.setTimeout(S,g),r(w),x.stopPropagation())},f=()=>{i&&(clearTimeout(i),i=null),document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",O),document.removeEventListener("pointercancel",O),document.removeEventListener("selectionchange",b)},S=()=>{n.documentState.activeSensor?m()||f():(I(t,c),l(p,e),document.addEventListener("selectionchange",b))},k=x=>{const w={x:x.clientX,y:x.clientY};if(!n.documentState.activeSensor){const L={x:w.x-c.x,y:w.y-c.y};Math.sqrt(L.x**2+L.y**2)>u&&S()}m()&&(x.preventDefault(),v(w))},O=x=>{f(),m()&&(x.preventDefault(),s(e),y())},b=()=>{var x;(x=window.getSelection())==null||x.removeAllRanges()}};var nt=class{constructor(t,e,n){W(this,"collection");W(this,"direction");W(this,"orientation");this.collection=t,this.direction=e,this.orientation=n}flipDirection(){return this.direction()==="rtl"&&this.orientation()==="horizontal"}getKeyLeftOf(t){if(this.flipDirection())return this.getNextKey(t);if(this.orientation()==="horizontal")return this.getPreviousKey(t)}getKeyRightOf(t){if(this.flipDirection())return this.getPreviousKey(t);if(this.orientation()==="horizontal")return this.getNextKey(t)}getKeyAbove(t){if(this.orientation()==="vertical")return this.getPreviousKey(t)}getKeyBelow(t){if(this.orientation()==="vertical")return this.getNextKey(t)}getFirstKey(){let t=this.collection().getFirstKey();if(t==null)return;const e=this.collection().getItem(t);return e!=null&&e.disabled&&(t=this.getNextKey(t)),t}getLastKey(){let t=this.collection().getLastKey();if(t==null)return;const e=this.collection().getItem(t);return e!=null&&e.disabled&&(t=this.getPreviousKey(t)),t}getNextKey(t){let e=t,n;do if(e=this.collection().getKeyAfter(e)??this.collection().getFirstKey(),e==null||(n=this.collection().getItem(e),n==null))return;while(n.disabled);return e}getPreviousKey(t){let e=t,n;do if(e=this.collection().getKeyBefore(e)??this.collection().getLastKey(),e==null||(n=this.collection().getItem(e),n==null))return;while(n.disabled);return e}},rt={};$e(rt,{Content:()=>Z,Indicator:()=>me,List:()=>ee,Root:()=>te,Tabs:()=>at,Trigger:()=>ne});var fe=ie();function B(){const t=le(fe);if(t===void 0)throw new Error("[kobalte]: `useTabsContext` must be used within a `Tabs` component");return t}function Z(t){const[e,n]=$(),o=B(),[a,I]=T(t,["ref","id","value","forceMount"]),[v,y]=$(0),l=()=>a.id??o.generateContentId(a.value),s=()=>o.listState().selectedKey()===a.value,{present:r}=Be({show:()=>a.forceMount||s(),element:()=>e()??null});return E(_([()=>e(),()=>r()],([g,u])=>{if(g==null||!u)return;const m=()=>{const i=Oe(g,{tabbable:!0});y(i.nextNode()?void 0:0)};m();const c=new MutationObserver(m);c.observe(g,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabindex","disabled"]}),U(()=>{c.disconnect()})})),E(_([()=>a.value,l],([g,u])=>{o.contentIdsMap().set(g,u)})),d(F,{get when(){return r()},get children(){return d(z,D({as:"div",ref(g){var u=Q(n,a.ref);typeof u=="function"&&u(g)},get id(){return l()},role:"tabpanel",get tabIndex(){return v()},get"aria-labelledby"(){return o.triggerIdsMap().get(a.value)},get"data-orientation"(){return o.orientation()},get"data-selected"(){return s()?"":void 0}},I))}})}function me(t){const e=B(),[n,o]=T(t,["style"]),[a,I]=$({width:void 0,height:void 0}),{direction:v}=de(),y=()=>{var i;const u=e.selectedTab();if(u==null)return;const m={transform:void 0,width:void 0,height:void 0},c=v()==="rtl"?-1*(((i=u.offsetParent)==null?void 0:i.offsetWidth)-u.offsetWidth-u.offsetLeft):u.offsetLeft;m.transform=e.orientation()==="vertical"?`translateY(${u.offsetTop}px)`:`translateX(${c}px)`,e.orientation()==="horizontal"?m.width=`${u.offsetWidth}px`:m.height=`${u.offsetHeight}px`,I(m)};G(()=>{queueMicrotask(()=>{y()})}),E(_([e.selectedTab,e.orientation,v],()=>{y()},{defer:!0}));const[l,s]=$(!1);let r=null,g=null;return Ye(e.selectedTab,(u,m)=>{if(g!==m){g=m;return}s(!0),r&&clearTimeout(r),r=setTimeout(()=>{r=null,s(!1)},1),y()}),d(z,D({as:"div",role:"presentation",get style(){return Le(a(),n.style)},get"data-orientation"(){return e.orientation()},get"data-resizing"(){return l()}},o))}function ee(t){let e;const n=B(),[o,a]=T(t,["ref","onKeyDown","onMouseDown","onFocusIn","onFocusOut"]),{direction:I}=de(),v=new nt(()=>n.listState().collection(),I,n.orientation),y=je({selectionManager:()=>n.listState().selectionManager(),keyboardDelegate:()=>v,selectOnFocus:()=>n.activationMode()==="automatic",shouldFocusWrap:!1,disallowEmptySelection:!0},()=>e);return E(()=>{if(e==null)return;const l=e.querySelector(`[data-key="${n.listState().selectedKey()}"]`);l!=null&&n.setSelectedTab(l)}),d(z,D({as:"div",ref(l){var s=Q(r=>e=r,o.ref);typeof s=="function"&&s(l)},role:"tablist",get"aria-orientation"(){return n.orientation()},get"data-orientation"(){return n.orientation()},get onKeyDown(){return M([o.onKeyDown,y.onKeyDown])},get onMouseDown(){return M([o.onMouseDown,y.onMouseDown])},get onFocusIn(){return M([o.onFocusIn,y.onFocusIn])},get onFocusOut(){return M([o.onFocusOut,y.onFocusOut])}},a))}function ot(t){const[e,n]=Xe({value:()=>oe(t.selectedKey),defaultValue:()=>oe(t.defaultSelectedKey),onChange:s=>{var r;return(r=t.onSelectionChange)==null?void 0:r.call(t,s)}}),o=H(()=>{const s=e();return s!=null?[s]:[]}),[,a]=T(t,["onSelectionChange"]),I=D(a,{selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:o,onSelectionChange:s=>{var g;const r=s.values().next().value;r===e()&&((g=t.onSelectionChange)==null||g.call(t,r)),n(r)}}),{collection:v,selectionManager:y}=He(I),l=H(()=>{const s=e();return s!=null?v().getItem(s):void 0});return{collection:v,selectionManager:y,selectedKey:e,setSelectedKey:n,selectedItem:l}}function te(t){const e=`tabs-${Se()}`,n=ce({id:e,orientation:"horizontal",activationMode:"automatic"},t),[o,a]=T(n,["value","defaultValue","onChange","orientation","activationMode","disabled"]),[I,v]=$([]),[y,l]=$(),{DomCollectionProvider:s}=qe({items:I,onItemsChange:v}),r=ot({selectedKey:()=>o.value,defaultSelectedKey:()=>o.defaultValue,onSelectionChange:i=>{var p;return(p=o.onChange)==null?void 0:p.call(o,String(i))},dataSource:I});let g=r.selectedKey();E(_([()=>r.selectionManager(),()=>r.collection(),()=>r.selectedKey()],([i,p,h])=>{let f=h;if(i.isEmpty()||f==null||!p.getItem(f)){f=p.getFirstKey();let S=f!=null?p.getItem(f):void 0;for(;S!=null&&S.disabled&&S.key!==p.getLastKey();)f=p.getKeyAfter(S.key),S=f!=null?p.getItem(f):void 0;S!=null&&S.disabled&&f===p.getLastKey()&&(f=p.getFirstKey()),f!=null&&i.setSelectedKeys([f])}(i.focusedKey()==null||!i.isFocused()&&f!==g)&&i.setFocusedKey(f),g=f}));const u=new Map,m=new Map,c={isDisabled:()=>o.disabled??!1,orientation:()=>o.orientation,activationMode:()=>o.activationMode,triggerIdsMap:()=>u,contentIdsMap:()=>m,listState:()=>r,selectedTab:y,setSelectedTab:l,generateTriggerId:i=>`${a.id}-trigger-${i}`,generateContentId:i=>`${a.id}-content-${i}`};return d(s,{get children(){return d(fe.Provider,{value:c,get children(){return d(z,D({as:"div",get"data-orientation"(){return c.orientation()}},a))}})}})}function ne(t){let e;const n=B(),o=ce({type:"button"},t),[a,I]=T(o,["ref","id","value","disabled","onPointerDown","onPointerUp","onClick","onKeyDown","onMouseDown","onFocus"]),v=()=>a.id??n.generateTriggerId(a.value),y=()=>n.listState().selectionManager().focusedKey()===a.value,l=()=>a.disabled||n.isDisabled(),s=()=>n.contentIdsMap().get(a.value);Ue({getItem:()=>({ref:()=>e,type:"item",key:a.value,textValue:"",disabled:l()})});const r=Ve({key:()=>a.value,selectionManager:()=>n.listState().selectionManager(),disabled:l},()=>e),g=u=>{ke()&&Fe(u.currentTarget)};return E(_([()=>a.value,v],([u,m])=>{n.triggerIdsMap().set(u,m)})),d(z,D({as:"button",ref(u){var m=Q(c=>e=c,a.ref);typeof m=="function"&&m(u)},get id(){return v()},role:"tab",get tabIndex(){return H(()=>!l())()?r.tabIndex():void 0},get disabled(){return l()},get"aria-selected"(){return r.isSelected()},get"aria-disabled"(){return l()||void 0},get"aria-controls"(){return H(()=>!!r.isSelected())()?s():void 0},get"data-key"(){return r.dataKey()},get"data-orientation"(){return n.orientation()},get"data-selected"(){return r.isSelected()?"":void 0},get"data-highlighted"(){return y()?"":void 0},get"data-disabled"(){return l()?"":void 0},get onPointerDown(){return M([a.onPointerDown,r.onPointerDown])},get onPointerUp(){return M([a.onPointerUp,r.onPointerUp])},get onClick(){return M([a.onClick,r.onClick,g])},get onKeyDown(){return M([a.onKeyDown,r.onKeyDown])},get onMouseDown(){return M([a.onMouseDown,r.onMouseDown])},get onFocus(){return M([a.onFocus,r.onFocus])}},I))}var at=Object.assign(te,{Content:Z,Indicator:me,List:ee,Trigger:ne});const st=te,it=t=>{const[e,n]=T(t,["class"]);return d(ee,D({get class(){return P("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e.class)}},n))},ae=t=>{const[e,n]=T(t,["class"]);return d(ne,D({get class(){return P("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[selected]:bg-background data-[selected]:text-foreground data-[selected]:shadow-sm",e.class)}},n))},se=t=>{const[e,n]=T(t,["class"]);return d(Z,D({get class(){return P("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e.class)}},n))};var lt=N('<div class="flex w-full gap-2">'),ct=N('<div class="px-2 h-full overflow-auto smoth-scroll">'),dt=N('<div class=w-1/2><img class="w-full aspect-square object-cover"><p class="text-center font-normal text-sm">');const ut=()=>(tt("layer-pointer-sensor","layer"),[]);function Dt(t){const[e,n]=T(t,["class"]),[o]=R(),a=()=>o.documentState.extendComponent,I=()=>{switch(o.documentState.mode){case q.HEADER:return[o.elementState.data.headers];case q.FOOTER:return[o.elementState.data.footers];case q.WATERMARK:return[o.elementState.data.watermark];case q.EDITING:return o.elementState.data.elements;default:return[]}},v=l=>({...l,id:Ae(),content:l!=null&&l.content?l.content.map(s=>v(s)):[]}),y=(l,s)=>{var r;(r=l.dataTransfer)==null||r.setData("extendedComponent",JSON.stringify(v(s)))};return d(We,D({get class(){return P("select-none relative overflow-hidden shadow-inner  h-full bg-white",e.class)}},n,{dimension:250,minDimension:200,side:"right",get children(){return[d(ut,{}),d(st,{class:"h-full relative z-50",defaultValue:"layers",get children(){return[d(it,{class:"grid w-full h-fit grid-cols-2 bg-white p-4 select-none",get children(){return[d(ae,{value:"layers",as:"h5",class:"cursor-pointer data-[selected]:shadow-none border-b border-transparent rounded-none  data-[selected]:border-gray-500 text-sm font-semibold text-gray-700",children:"Layers"}),d(ae,{value:"components",as:"h6",class:"cursor-pointer data-[selected]:shadow-none border-b border-transparent rounded-none  data-[selected]:border-gray-500 text-sm font-semibold text-gray-700",children:"Components"})]}}),(()=>{var l=ct();return K(l,d(se,{value:"layers",class:"pb-40",get children(){return d(Je,{get ids(){return I()},get children(){return d(V,{get each(){return I()},children:(s,r)=>d(ge,{details:s,depth:0,parentId:null,parentIds:[],get index(){return r()}})})}})}}),null),K(l,d(se,{value:"components",class:"pb-40",get children(){var s=lt();return K(s,d(V,{get each(){return Object.keys(a())},children:r=>{const g=a()[r];return(()=>{var u=dt(),m=u.firstChild,c=m.nextSibling;return u.addEventListener("dragstart",i=>{y(i,g.data)}),X(u,"draggable",!0),X(m,"draggable",!1),K(c,()=>g.data.name),J(()=>X(m,"src",g.icons)),u})()}})),s}}),null),l})()]}})]}}))}export{Dt as default};
